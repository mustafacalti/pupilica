(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const d of l.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&a(d)}).observe(document,{childList:!0,subtree:!0});function t(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerPolicy&&(l.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?l.credentials="include":o.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function a(o){if(o.ep)return;o.ep=!0;const l=t(o);fetch(o.href,l)}})();function oE(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var vm={exports:{}},tc={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jv;function lE(){if(jv)return tc;jv=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(a,o,l){var d=null;if(l!==void 0&&(d=""+l),o.key!==void 0&&(d=""+o.key),"key"in o){l={};for(var m in o)m!=="key"&&(l[m]=o[m])}else l=o;return o=l.ref,{$$typeof:s,type:a,key:d,ref:o!==void 0?o:null,props:l}}return tc.Fragment=e,tc.jsx=t,tc.jsxs=t,tc}var Dv;function cE(){return Dv||(Dv=1,vm.exports=lE()),vm.exports}var u=cE(),xm={exports:{}},nc={},bm={exports:{}},_m={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Mv;function uE(){return Mv||(Mv=1,(function(s){function e(q,he){var G=q.length;q.push(he);e:for(;0<G;){var re=G-1>>>1,C=q[re];if(0<o(C,he))q[re]=he,q[G]=C,G=re;else break e}}function t(q){return q.length===0?null:q[0]}function a(q){if(q.length===0)return null;var he=q[0],G=q.pop();if(G!==he){q[0]=G;e:for(var re=0,C=q.length,Z=C>>>1;re<Z;){var H=2*(re+1)-1,Y=q[H],oe=H+1,ge=q[oe];if(0>o(Y,G))oe<C&&0>o(ge,Y)?(q[re]=ge,q[oe]=G,re=oe):(q[re]=Y,q[H]=G,re=H);else if(oe<C&&0>o(ge,G))q[re]=ge,q[oe]=G,re=oe;else break e}}return he}function o(q,he){var G=q.sortIndex-he.sortIndex;return G!==0?G:q.id-he.id}if(s.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;s.unstable_now=function(){return l.now()}}else{var d=Date,m=d.now();s.unstable_now=function(){return d.now()-m}}var p=[],y=[],x=1,_=null,w=3,j=!1,B=!1,L=!1,D=!1,$=typeof setTimeout=="function"?setTimeout:null,X=typeof clearTimeout=="function"?clearTimeout:null,ne=typeof setImmediate<"u"?setImmediate:null;function ce(q){for(var he=t(y);he!==null;){if(he.callback===null)a(y);else if(he.startTime<=q)a(y),he.sortIndex=he.expirationTime,e(p,he);else break;he=t(y)}}function de(q){if(L=!1,ce(q),!B)if(t(p)!==null)B=!0,me||(me=!0,I());else{var he=t(y);he!==null&&se(de,he.startTime-q)}}var me=!1,O=-1,N=5,R=-1;function P(){return D?!0:!(s.unstable_now()-R<N)}function V(){if(D=!1,me){var q=s.unstable_now();R=q;var he=!0;try{e:{B=!1,L&&(L=!1,X(O),O=-1),j=!0;var G=w;try{t:{for(ce(q),_=t(p);_!==null&&!(_.expirationTime>q&&P());){var re=_.callback;if(typeof re=="function"){_.callback=null,w=_.priorityLevel;var C=re(_.expirationTime<=q);if(q=s.unstable_now(),typeof C=="function"){_.callback=C,ce(q),he=!0;break t}_===t(p)&&a(p),ce(q)}else a(p);_=t(p)}if(_!==null)he=!0;else{var Z=t(y);Z!==null&&se(de,Z.startTime-q),he=!1}}break e}finally{_=null,w=G,j=!1}he=void 0}}finally{he?I():me=!1}}}var I;if(typeof ne=="function")I=function(){ne(V)};else if(typeof MessageChannel<"u"){var A=new MessageChannel,we=A.port2;A.port1.onmessage=V,I=function(){we.postMessage(null)}}else I=function(){$(V,0)};function se(q,he){O=$(function(){q(s.unstable_now())},he)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(q){q.callback=null},s.unstable_forceFrameRate=function(q){0>q||125<q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):N=0<q?Math.floor(1e3/q):5},s.unstable_getCurrentPriorityLevel=function(){return w},s.unstable_next=function(q){switch(w){case 1:case 2:case 3:var he=3;break;default:he=w}var G=w;w=he;try{return q()}finally{w=G}},s.unstable_requestPaint=function(){D=!0},s.unstable_runWithPriority=function(q,he){switch(q){case 1:case 2:case 3:case 4:case 5:break;default:q=3}var G=w;w=q;try{return he()}finally{w=G}},s.unstable_scheduleCallback=function(q,he,G){var re=s.unstable_now();switch(typeof G=="object"&&G!==null?(G=G.delay,G=typeof G=="number"&&0<G?re+G:re):G=re,q){case 1:var C=-1;break;case 2:C=250;break;case 5:C=1073741823;break;case 4:C=1e4;break;default:C=5e3}return C=G+C,q={id:x++,callback:he,priorityLevel:q,startTime:G,expirationTime:C,sortIndex:-1},G>re?(q.sortIndex=G,e(y,q),t(p)===null&&q===t(y)&&(L?(X(O),O=-1):L=!0,se(de,G-re))):(q.sortIndex=C,e(p,q),B||j||(B=!0,me||(me=!0,I()))),q},s.unstable_shouldYield=P,s.unstable_wrapCallback=function(q){var he=w;return function(){var G=w;w=he;try{return q.apply(this,arguments)}finally{w=G}}}})(_m)),_m}var Ov;function dE(){return Ov||(Ov=1,bm.exports=uE()),bm.exports}var Tm={exports:{}},et={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Pv;function hE(){if(Pv)return et;Pv=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),d=Symbol.for("react.context"),m=Symbol.for("react.forward_ref"),p=Symbol.for("react.suspense"),y=Symbol.for("react.memo"),x=Symbol.for("react.lazy"),_=Symbol.iterator;function w(C){return C===null||typeof C!="object"?null:(C=_&&C[_]||C["@@iterator"],typeof C=="function"?C:null)}var j={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},B=Object.assign,L={};function D(C,Z,H){this.props=C,this.context=Z,this.refs=L,this.updater=H||j}D.prototype.isReactComponent={},D.prototype.setState=function(C,Z){if(typeof C!="object"&&typeof C!="function"&&C!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,C,Z,"setState")},D.prototype.forceUpdate=function(C){this.updater.enqueueForceUpdate(this,C,"forceUpdate")};function $(){}$.prototype=D.prototype;function X(C,Z,H){this.props=C,this.context=Z,this.refs=L,this.updater=H||j}var ne=X.prototype=new $;ne.constructor=X,B(ne,D.prototype),ne.isPureReactComponent=!0;var ce=Array.isArray,de={H:null,A:null,T:null,S:null,V:null},me=Object.prototype.hasOwnProperty;function O(C,Z,H,Y,oe,ge){return H=ge.ref,{$$typeof:s,type:C,key:Z,ref:H!==void 0?H:null,props:ge}}function N(C,Z){return O(C.type,Z,void 0,void 0,void 0,C.props)}function R(C){return typeof C=="object"&&C!==null&&C.$$typeof===s}function P(C){var Z={"=":"=0",":":"=2"};return"$"+C.replace(/[=:]/g,function(H){return Z[H]})}var V=/\/+/g;function I(C,Z){return typeof C=="object"&&C!==null&&C.key!=null?P(""+C.key):Z.toString(36)}function A(){}function we(C){switch(C.status){case"fulfilled":return C.value;case"rejected":throw C.reason;default:switch(typeof C.status=="string"?C.then(A,A):(C.status="pending",C.then(function(Z){C.status==="pending"&&(C.status="fulfilled",C.value=Z)},function(Z){C.status==="pending"&&(C.status="rejected",C.reason=Z)})),C.status){case"fulfilled":return C.value;case"rejected":throw C.reason}}throw C}function se(C,Z,H,Y,oe){var ge=typeof C;(ge==="undefined"||ge==="boolean")&&(C=null);var be=!1;if(C===null)be=!0;else switch(ge){case"bigint":case"string":case"number":be=!0;break;case"object":switch(C.$$typeof){case s:case e:be=!0;break;case x:return be=C._init,se(be(C._payload),Z,H,Y,oe)}}if(be)return oe=oe(C),be=Y===""?"."+I(C,0):Y,ce(oe)?(H="",be!=null&&(H=be.replace(V,"$&/")+"/"),se(oe,Z,H,"",function(st){return st})):oe!=null&&(R(oe)&&(oe=N(oe,H+(oe.key==null||C&&C.key===oe.key?"":(""+oe.key).replace(V,"$&/")+"/")+be)),Z.push(oe)),1;be=0;var nt=Y===""?".":Y+":";if(ce(C))for(var We=0;We<C.length;We++)Y=C[We],ge=nt+I(Y,We),be+=se(Y,Z,H,ge,oe);else if(We=w(C),typeof We=="function")for(C=We.call(C),We=0;!(Y=C.next()).done;)Y=Y.value,ge=nt+I(Y,We++),be+=se(Y,Z,H,ge,oe);else if(ge==="object"){if(typeof C.then=="function")return se(we(C),Z,H,Y,oe);throw Z=String(C),Error("Objects are not valid as a React child (found: "+(Z==="[object Object]"?"object with keys {"+Object.keys(C).join(", ")+"}":Z)+"). If you meant to render a collection of children, use an array instead.")}return be}function q(C,Z,H){if(C==null)return C;var Y=[],oe=0;return se(C,Y,"","",function(ge){return Z.call(H,ge,oe++)}),Y}function he(C){if(C._status===-1){var Z=C._result;Z=Z(),Z.then(function(H){(C._status===0||C._status===-1)&&(C._status=1,C._result=H)},function(H){(C._status===0||C._status===-1)&&(C._status=2,C._result=H)}),C._status===-1&&(C._status=0,C._result=Z)}if(C._status===1)return C._result.default;throw C._result}var G=typeof reportError=="function"?reportError:function(C){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var Z=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof C=="object"&&C!==null&&typeof C.message=="string"?String(C.message):String(C),error:C});if(!window.dispatchEvent(Z))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",C);return}console.error(C)};function re(){}return et.Children={map:q,forEach:function(C,Z,H){q(C,function(){Z.apply(this,arguments)},H)},count:function(C){var Z=0;return q(C,function(){Z++}),Z},toArray:function(C){return q(C,function(Z){return Z})||[]},only:function(C){if(!R(C))throw Error("React.Children.only expected to receive a single React element child.");return C}},et.Component=D,et.Fragment=t,et.Profiler=o,et.PureComponent=X,et.StrictMode=a,et.Suspense=p,et.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=de,et.__COMPILER_RUNTIME={__proto__:null,c:function(C){return de.H.useMemoCache(C)}},et.cache=function(C){return function(){return C.apply(null,arguments)}},et.cloneElement=function(C,Z,H){if(C==null)throw Error("The argument must be a React element, but you passed "+C+".");var Y=B({},C.props),oe=C.key,ge=void 0;if(Z!=null)for(be in Z.ref!==void 0&&(ge=void 0),Z.key!==void 0&&(oe=""+Z.key),Z)!me.call(Z,be)||be==="key"||be==="__self"||be==="__source"||be==="ref"&&Z.ref===void 0||(Y[be]=Z[be]);var be=arguments.length-2;if(be===1)Y.children=H;else if(1<be){for(var nt=Array(be),We=0;We<be;We++)nt[We]=arguments[We+2];Y.children=nt}return O(C.type,oe,void 0,void 0,ge,Y)},et.createContext=function(C){return C={$$typeof:d,_currentValue:C,_currentValue2:C,_threadCount:0,Provider:null,Consumer:null},C.Provider=C,C.Consumer={$$typeof:l,_context:C},C},et.createElement=function(C,Z,H){var Y,oe={},ge=null;if(Z!=null)for(Y in Z.key!==void 0&&(ge=""+Z.key),Z)me.call(Z,Y)&&Y!=="key"&&Y!=="__self"&&Y!=="__source"&&(oe[Y]=Z[Y]);var be=arguments.length-2;if(be===1)oe.children=H;else if(1<be){for(var nt=Array(be),We=0;We<be;We++)nt[We]=arguments[We+2];oe.children=nt}if(C&&C.defaultProps)for(Y in be=C.defaultProps,be)oe[Y]===void 0&&(oe[Y]=be[Y]);return O(C,ge,void 0,void 0,null,oe)},et.createRef=function(){return{current:null}},et.forwardRef=function(C){return{$$typeof:m,render:C}},et.isValidElement=R,et.lazy=function(C){return{$$typeof:x,_payload:{_status:-1,_result:C},_init:he}},et.memo=function(C,Z){return{$$typeof:y,type:C,compare:Z===void 0?null:Z}},et.startTransition=function(C){var Z=de.T,H={};de.T=H;try{var Y=C(),oe=de.S;oe!==null&&oe(H,Y),typeof Y=="object"&&Y!==null&&typeof Y.then=="function"&&Y.then(re,G)}catch(ge){G(ge)}finally{de.T=Z}},et.unstable_useCacheRefresh=function(){return de.H.useCacheRefresh()},et.use=function(C){return de.H.use(C)},et.useActionState=function(C,Z,H){return de.H.useActionState(C,Z,H)},et.useCallback=function(C,Z){return de.H.useCallback(C,Z)},et.useContext=function(C){return de.H.useContext(C)},et.useDebugValue=function(){},et.useDeferredValue=function(C,Z){return de.H.useDeferredValue(C,Z)},et.useEffect=function(C,Z,H){var Y=de.H;if(typeof H=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return Y.useEffect(C,Z)},et.useId=function(){return de.H.useId()},et.useImperativeHandle=function(C,Z,H){return de.H.useImperativeHandle(C,Z,H)},et.useInsertionEffect=function(C,Z){return de.H.useInsertionEffect(C,Z)},et.useLayoutEffect=function(C,Z){return de.H.useLayoutEffect(C,Z)},et.useMemo=function(C,Z){return de.H.useMemo(C,Z)},et.useOptimistic=function(C,Z){return de.H.useOptimistic(C,Z)},et.useReducer=function(C,Z,H){return de.H.useReducer(C,Z,H)},et.useRef=function(C){return de.H.useRef(C)},et.useState=function(C){return de.H.useState(C)},et.useSyncExternalStore=function(C,Z,H){return de.H.useSyncExternalStore(C,Z,H)},et.useTransition=function(){return de.H.useTransition()},et.version="19.1.1",et}var Vv;function mg(){return Vv||(Vv=1,Tm.exports=hE()),Tm.exports}var km={exports:{}},Qn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zv;function fE(){if(zv)return Qn;zv=1;var s=mg();function e(p){var y="https://react.dev/errors/"+p;if(1<arguments.length){y+="?args[]="+encodeURIComponent(arguments[1]);for(var x=2;x<arguments.length;x++)y+="&args[]="+encodeURIComponent(arguments[x])}return"Minified React error #"+p+"; visit "+y+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var a={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},o=Symbol.for("react.portal");function l(p,y,x){var _=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:o,key:_==null?null:""+_,children:p,containerInfo:y,implementation:x}}var d=s.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function m(p,y){if(p==="font")return"";if(typeof y=="string")return y==="use-credentials"?y:""}return Qn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=a,Qn.createPortal=function(p,y){var x=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!y||y.nodeType!==1&&y.nodeType!==9&&y.nodeType!==11)throw Error(e(299));return l(p,y,null,x)},Qn.flushSync=function(p){var y=d.T,x=a.p;try{if(d.T=null,a.p=2,p)return p()}finally{d.T=y,a.p=x,a.d.f()}},Qn.preconnect=function(p,y){typeof p=="string"&&(y?(y=y.crossOrigin,y=typeof y=="string"?y==="use-credentials"?y:"":void 0):y=null,a.d.C(p,y))},Qn.prefetchDNS=function(p){typeof p=="string"&&a.d.D(p)},Qn.preinit=function(p,y){if(typeof p=="string"&&y&&typeof y.as=="string"){var x=y.as,_=m(x,y.crossOrigin),w=typeof y.integrity=="string"?y.integrity:void 0,j=typeof y.fetchPriority=="string"?y.fetchPriority:void 0;x==="style"?a.d.S(p,typeof y.precedence=="string"?y.precedence:void 0,{crossOrigin:_,integrity:w,fetchPriority:j}):x==="script"&&a.d.X(p,{crossOrigin:_,integrity:w,fetchPriority:j,nonce:typeof y.nonce=="string"?y.nonce:void 0})}},Qn.preinitModule=function(p,y){if(typeof p=="string")if(typeof y=="object"&&y!==null){if(y.as==null||y.as==="script"){var x=m(y.as,y.crossOrigin);a.d.M(p,{crossOrigin:x,integrity:typeof y.integrity=="string"?y.integrity:void 0,nonce:typeof y.nonce=="string"?y.nonce:void 0})}}else y==null&&a.d.M(p)},Qn.preload=function(p,y){if(typeof p=="string"&&typeof y=="object"&&y!==null&&typeof y.as=="string"){var x=y.as,_=m(x,y.crossOrigin);a.d.L(p,x,{crossOrigin:_,integrity:typeof y.integrity=="string"?y.integrity:void 0,nonce:typeof y.nonce=="string"?y.nonce:void 0,type:typeof y.type=="string"?y.type:void 0,fetchPriority:typeof y.fetchPriority=="string"?y.fetchPriority:void 0,referrerPolicy:typeof y.referrerPolicy=="string"?y.referrerPolicy:void 0,imageSrcSet:typeof y.imageSrcSet=="string"?y.imageSrcSet:void 0,imageSizes:typeof y.imageSizes=="string"?y.imageSizes:void 0,media:typeof y.media=="string"?y.media:void 0})}},Qn.preloadModule=function(p,y){if(typeof p=="string")if(y){var x=m(y.as,y.crossOrigin);a.d.m(p,{as:typeof y.as=="string"&&y.as!=="script"?y.as:void 0,crossOrigin:x,integrity:typeof y.integrity=="string"?y.integrity:void 0})}else a.d.m(p)},Qn.requestFormReset=function(p){a.d.r(p)},Qn.unstable_batchedUpdates=function(p,y){return p(y)},Qn.useFormState=function(p,y,x){return d.H.useFormState(p,y,x)},Qn.useFormStatus=function(){return d.H.useHostTransitionStatus()},Qn.version="19.1.1",Qn}var Lv;function mE(){if(Lv)return km.exports;Lv=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),km.exports=fE(),km.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Uv;function gE(){if(Uv)return nc;Uv=1;var s=dE(),e=mg(),t=mE();function a(n){var r="https://react.dev/errors/"+n;if(1<arguments.length){r+="?args[]="+encodeURIComponent(arguments[1]);for(var i=2;i<arguments.length;i++)r+="&args[]="+encodeURIComponent(arguments[i])}return"Minified React error #"+n+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function l(n){var r=n,i=n;if(n.alternate)for(;r.return;)r=r.return;else{n=r;do r=n,(r.flags&4098)!==0&&(i=r.return),n=r.return;while(n)}return r.tag===3?i:null}function d(n){if(n.tag===13){var r=n.memoizedState;if(r===null&&(n=n.alternate,n!==null&&(r=n.memoizedState)),r!==null)return r.dehydrated}return null}function m(n){if(l(n)!==n)throw Error(a(188))}function p(n){var r=n.alternate;if(!r){if(r=l(n),r===null)throw Error(a(188));return r!==n?null:n}for(var i=n,c=r;;){var f=i.return;if(f===null)break;var g=f.alternate;if(g===null){if(c=f.return,c!==null){i=c;continue}break}if(f.child===g.child){for(g=f.child;g;){if(g===i)return m(f),n;if(g===c)return m(f),r;g=g.sibling}throw Error(a(188))}if(i.return!==c.return)i=f,c=g;else{for(var T=!1,E=f.child;E;){if(E===i){T=!0,i=f,c=g;break}if(E===c){T=!0,c=f,i=g;break}E=E.sibling}if(!T){for(E=g.child;E;){if(E===i){T=!0,i=g,c=f;break}if(E===c){T=!0,c=g,i=f;break}E=E.sibling}if(!T)throw Error(a(189))}}if(i.alternate!==c)throw Error(a(190))}if(i.tag!==3)throw Error(a(188));return i.stateNode.current===i?n:r}function y(n){var r=n.tag;if(r===5||r===26||r===27||r===6)return n;for(n=n.child;n!==null;){if(r=y(n),r!==null)return r;n=n.sibling}return null}var x=Object.assign,_=Symbol.for("react.element"),w=Symbol.for("react.transitional.element"),j=Symbol.for("react.portal"),B=Symbol.for("react.fragment"),L=Symbol.for("react.strict_mode"),D=Symbol.for("react.profiler"),$=Symbol.for("react.provider"),X=Symbol.for("react.consumer"),ne=Symbol.for("react.context"),ce=Symbol.for("react.forward_ref"),de=Symbol.for("react.suspense"),me=Symbol.for("react.suspense_list"),O=Symbol.for("react.memo"),N=Symbol.for("react.lazy"),R=Symbol.for("react.activity"),P=Symbol.for("react.memo_cache_sentinel"),V=Symbol.iterator;function I(n){return n===null||typeof n!="object"?null:(n=V&&n[V]||n["@@iterator"],typeof n=="function"?n:null)}var A=Symbol.for("react.client.reference");function we(n){if(n==null)return null;if(typeof n=="function")return n.$$typeof===A?null:n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case B:return"Fragment";case D:return"Profiler";case L:return"StrictMode";case de:return"Suspense";case me:return"SuspenseList";case R:return"Activity"}if(typeof n=="object")switch(n.$$typeof){case j:return"Portal";case ne:return(n.displayName||"Context")+".Provider";case X:return(n._context.displayName||"Context")+".Consumer";case ce:var r=n.render;return n=n.displayName,n||(n=r.displayName||r.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case O:return r=n.displayName||null,r!==null?r:we(n.type)||"Memo";case N:r=n._payload,n=n._init;try{return we(n(r))}catch{}}return null}var se=Array.isArray,q=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,he=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,G={pending:!1,data:null,method:null,action:null},re=[],C=-1;function Z(n){return{current:n}}function H(n){0>C||(n.current=re[C],re[C]=null,C--)}function Y(n,r){C++,re[C]=n.current,n.current=r}var oe=Z(null),ge=Z(null),be=Z(null),nt=Z(null);function We(n,r){switch(Y(be,r),Y(ge,n),Y(oe,null),r.nodeType){case 9:case 11:n=(n=r.documentElement)&&(n=n.namespaceURI)?iv(n):0;break;default:if(n=r.tagName,r=r.namespaceURI)r=iv(r),n=ov(r,n);else switch(n){case"svg":n=1;break;case"math":n=2;break;default:n=0}}H(oe),Y(oe,n)}function st(){H(oe),H(ge),H(be)}function Re(n){n.memoizedState!==null&&Y(nt,n);var r=oe.current,i=ov(r,n.type);r!==i&&(Y(ge,n),Y(oe,i))}function Me(n){ge.current===n&&(H(oe),H(ge)),nt.current===n&&(H(nt),Xl._currentValue=G)}var kt=Object.prototype.hasOwnProperty,St=s.unstable_scheduleCallback,Qe=s.unstable_cancelCallback,jt=s.unstable_shouldYield,rt=s.unstable_requestPaint,$e=s.unstable_now,$t=s.unstable_getCurrentPriorityLevel,at=s.unstable_ImmediatePriority,zt=s.unstable_UserBlockingPriority,Wt=s.unstable_NormalPriority,fn=s.unstable_LowPriority,Jt=s.unstable_IdlePriority,Vn=s.log,ar=s.unstable_setDisableYieldValue,Je=null,lt=null;function Yt(n){if(typeof Vn=="function"&&ar(n),lt&&typeof lt.setStrictMode=="function")try{lt.setStrictMode(Je,n)}catch{}}var Qt=Math.clz32?Math.clz32:dr,Kr=Math.log,Yr=Math.LN2;function dr(n){return n>>>=0,n===0?32:31-(Kr(n)/Yr|0)|0}var zn=256,sr=4194304;function Nn(n){var r=n&42;if(r!==0)return r;switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return n&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return n}}function Pe(n,r,i){var c=n.pendingLanes;if(c===0)return 0;var f=0,g=n.suspendedLanes,T=n.pingedLanes;n=n.warmLanes;var E=c&134217727;return E!==0?(c=E&~g,c!==0?f=Nn(c):(T&=E,T!==0?f=Nn(T):i||(i=E&~n,i!==0&&(f=Nn(i))))):(E=c&~g,E!==0?f=Nn(E):T!==0?f=Nn(T):i||(i=c&~n,i!==0&&(f=Nn(i)))),f===0?0:r!==0&&r!==f&&(r&g)===0&&(g=f&-f,i=r&-r,g>=i||g===32&&(i&4194048)!==0)?r:f}function Fe(n,r){return(n.pendingLanes&~(n.suspendedLanes&~n.pingedLanes)&r)===0}function yt(n,r){switch(n){case 1:case 2:case 4:case 8:case 64:return r+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Dt(){var n=zn;return zn<<=1,(zn&4194048)===0&&(zn=256),n}function pe(){var n=sr;return sr<<=1,(sr&62914560)===0&&(sr=4194304),n}function _e(n){for(var r=[],i=0;31>i;i++)r.push(n);return r}function Ne(n,r){n.pendingLanes|=r,r!==268435456&&(n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0)}function De(n,r,i,c,f,g){var T=n.pendingLanes;n.pendingLanes=i,n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0,n.expiredLanes&=i,n.entangledLanes&=i,n.errorRecoveryDisabledLanes&=i,n.shellSuspendCounter=0;var E=n.entanglements,M=n.expirationTimes,Q=n.hiddenUpdates;for(i=T&~i;0<i;){var ae=31-Qt(i),ue=1<<ae;E[ae]=0,M[ae]=-1;var W=Q[ae];if(W!==null)for(Q[ae]=null,ae=0;ae<W.length;ae++){var J=W[ae];J!==null&&(J.lane&=-536870913)}i&=~ue}c!==0&&Ke(n,c,0),g!==0&&f===0&&n.tag!==0&&(n.suspendedLanes|=g&~(T&~r))}function Ke(n,r,i){n.pendingLanes|=r,n.suspendedLanes&=~r;var c=31-Qt(r);n.entangledLanes|=r,n.entanglements[c]=n.entanglements[c]|1073741824|i&4194090}function Lt(n,r){var i=n.entangledLanes|=r;for(n=n.entanglements;i;){var c=31-Qt(i),f=1<<c;f&r|n[c]&r&&(n[c]|=r),i&=~f}}function ee(n){switch(n){case 2:n=1;break;case 8:n=4;break;case 32:n=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:n=128;break;case 268435456:n=134217728;break;default:n=0}return n}function Te(n){return n&=-n,2<n?8<n?(n&134217727)!==0?32:268435456:8:2}function Ie(){var n=he.p;return n!==0?n:(n=window.event,n===void 0?32:wv(n.type))}function Be(n,r){var i=he.p;try{return he.p=n,r()}finally{he.p=i}}var Ee=Math.random().toString(36).slice(2),ye="__reactFiber$"+Ee,Ae="__reactProps$"+Ee,ke="__reactContainer$"+Ee,it="__reactEvents$"+Ee,nn="__reactListeners$"+Ee,Kt="__reactHandles$"+Ee,Rn="__reactResources$"+Ee,_n="__reactMarker$"+Ee;function on(n){delete n[ye],delete n[Ae],delete n[it],delete n[nn],delete n[Kt]}function ln(n){var r=n[ye];if(r)return r;for(var i=n.parentNode;i;){if(r=i[ke]||i[ye]){if(i=r.alternate,r.child!==null||i!==null&&i.child!==null)for(n=dv(n);n!==null;){if(i=n[ye])return i;n=dv(n)}return r}n=i,i=n.parentNode}return null}function Tn(n){if(n=n[ye]||n[ke]){var r=n.tag;if(r===5||r===6||r===13||r===26||r===27||r===3)return n}return null}function Cn(n){var r=n.tag;if(r===5||r===26||r===27||r===6)return n.stateNode;throw Error(a(33))}function cn(n){var r=n[Rn];return r||(r=n[Rn]={hoistableStyles:new Map,hoistableScripts:new Map}),r}function Ut(n){n[_n]=!0}var ze=new Set,ve={};function Xe(n,r){Kn(n,r),Kn(n+"Capture",r)}function Kn(n,r){for(ve[n]=r,n=0;n<r.length;n++)ze.add(r[n])}var Qr=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Ta={},Xr={};function Yc(n){return kt.call(Xr,n)?!0:kt.call(Ta,n)?!1:Qr.test(n)?Xr[n]=!0:(Ta[n]=!0,!1)}function rs(n,r,i){if(Yc(r))if(i===null)n.removeAttribute(r);else{switch(typeof i){case"undefined":case"function":case"symbol":n.removeAttribute(r);return;case"boolean":var c=r.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){n.removeAttribute(r);return}}n.setAttribute(r,""+i)}}function Zr(n,r,i){if(i===null)n.removeAttribute(r);else{switch(typeof i){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(r);return}n.setAttribute(r,""+i)}}function Ln(n,r,i,c){if(c===null)n.removeAttribute(i);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(i);return}n.setAttributeNS(r,i,""+c)}}var Qs,Qc;function ka(n){if(Qs===void 0)try{throw Error()}catch(i){var r=i.stack.trim().match(/\n( *(at )?)/);Qs=r&&r[1]||"",Qc=-1<i.stack.indexOf(`
    at`)?" (<anonymous>)":-1<i.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Qs+n+Qc}var Li=!1;function Ui(n,r){if(!n||Li)return"";Li=!0;var i=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(r){var ue=function(){throw Error()};if(Object.defineProperty(ue.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ue,[])}catch(J){var W=J}Reflect.construct(n,[],ue)}else{try{ue.call()}catch(J){W=J}n.call(ue.prototype)}}else{try{throw Error()}catch(J){W=J}(ue=n())&&typeof ue.catch=="function"&&ue.catch(function(){})}}catch(J){if(J&&W&&typeof J.stack=="string")return[J.stack,W.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var f=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");f&&f.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var g=c.DetermineComponentFrameRoot(),T=g[0],E=g[1];if(T&&E){var M=T.split(`
`),Q=E.split(`
`);for(f=c=0;c<M.length&&!M[c].includes("DetermineComponentFrameRoot");)c++;for(;f<Q.length&&!Q[f].includes("DetermineComponentFrameRoot");)f++;if(c===M.length||f===Q.length)for(c=M.length-1,f=Q.length-1;1<=c&&0<=f&&M[c]!==Q[f];)f--;for(;1<=c&&0<=f;c--,f--)if(M[c]!==Q[f]){if(c!==1||f!==1)do if(c--,f--,0>f||M[c]!==Q[f]){var ae=`
`+M[c].replace(" at new "," at ");return n.displayName&&ae.includes("<anonymous>")&&(ae=ae.replace("<anonymous>",n.displayName)),ae}while(1<=c&&0<=f);break}}}finally{Li=!1,Error.prepareStackTrace=i}return(i=n?n.displayName||n.name:"")?ka(i):""}function rl(n){switch(n.tag){case 26:case 27:case 5:return ka(n.type);case 16:return ka("Lazy");case 13:return ka("Suspense");case 19:return ka("SuspenseList");case 0:case 15:return Ui(n.type,!1);case 11:return Ui(n.type.render,!1);case 1:return Ui(n.type,!0);case 31:return ka("Activity");default:return""}}function Bi(n){try{var r="";do r+=rl(n),n=n.return;while(n);return r}catch(i){return`
Error generating stack: `+i.message+`
`+i.stack}}function er(n){switch(typeof n){case"bigint":case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function al(n){var r=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function _h(n){var r=al(n)?"checked":"value",i=Object.getOwnPropertyDescriptor(n.constructor.prototype,r),c=""+n[r];if(!n.hasOwnProperty(r)&&typeof i<"u"&&typeof i.get=="function"&&typeof i.set=="function"){var f=i.get,g=i.set;return Object.defineProperty(n,r,{configurable:!0,get:function(){return f.call(this)},set:function(T){c=""+T,g.call(this,T)}}),Object.defineProperty(n,r,{enumerable:i.enumerable}),{getValue:function(){return c},setValue:function(T){c=""+T},stopTracking:function(){n._valueTracker=null,delete n[r]}}}}function Gi(n){n._valueTracker||(n._valueTracker=_h(n))}function sl(n){if(!n)return!1;var r=n._valueTracker;if(!r)return!0;var i=r.getValue(),c="";return n&&(c=al(n)?n.checked?"true":"false":n.value),n=c,n!==i?(r.setValue(n),!0):!1}function Xs(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}var Th=/[\n"\\]/g;function mn(n){return n.replace(Th,function(r){return"\\"+r.charCodeAt(0).toString(16)+" "})}function hr(n,r,i,c,f,g,T,E){n.name="",T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"?n.type=T:n.removeAttribute("type"),r!=null?T==="number"?(r===0&&n.value===""||n.value!=r)&&(n.value=""+er(r)):n.value!==""+er(r)&&(n.value=""+er(r)):T!=="submit"&&T!=="reset"||n.removeAttribute("value"),r!=null?as(n,T,er(r)):i!=null?as(n,T,er(i)):c!=null&&n.removeAttribute("value"),f==null&&g!=null&&(n.defaultChecked=!!g),f!=null&&(n.checked=f&&typeof f!="function"&&typeof f!="symbol"),E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"?n.name=""+er(E):n.removeAttribute("name")}function Zs(n,r,i,c,f,g,T,E){if(g!=null&&typeof g!="function"&&typeof g!="symbol"&&typeof g!="boolean"&&(n.type=g),r!=null||i!=null){if(!(g!=="submit"&&g!=="reset"||r!=null))return;i=i!=null?""+er(i):"",r=r!=null?""+er(r):i,E||r===n.value||(n.value=r),n.defaultValue=r}c=c??f,c=typeof c!="function"&&typeof c!="symbol"&&!!c,n.checked=E?n.checked:!!c,n.defaultChecked=!!c,T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"&&(n.name=T)}function as(n,r,i){r==="number"&&Xs(n.ownerDocument)===n||n.defaultValue===""+i||(n.defaultValue=""+i)}function Ea(n,r,i,c){if(n=n.options,r){r={};for(var f=0;f<i.length;f++)r["$"+i[f]]=!0;for(i=0;i<n.length;i++)f=r.hasOwnProperty("$"+n[i].value),n[i].selected!==f&&(n[i].selected=f),f&&c&&(n[i].defaultSelected=!0)}else{for(i=""+er(i),r=null,f=0;f<n.length;f++){if(n[f].value===i){n[f].selected=!0,c&&(n[f].defaultSelected=!0);return}r!==null||n[f].disabled||(r=n[f])}r!==null&&(r.selected=!0)}}function Mt(n,r,i){if(r!=null&&(r=""+er(r),r!==n.value&&(n.value=r),i==null)){n.defaultValue!==r&&(n.defaultValue=r);return}n.defaultValue=i!=null?""+er(i):""}function Ws(n,r,i,c){if(r==null){if(c!=null){if(i!=null)throw Error(a(92));if(se(c)){if(1<c.length)throw Error(a(93));c=c[0]}i=c}i==null&&(i=""),r=i}i=er(r),n.defaultValue=i,c=n.textContent,c===i&&c!==""&&c!==null&&(n.value=c)}function _r(n,r){if(r){var i=n.firstChild;if(i&&i===n.lastChild&&i.nodeType===3){i.nodeValue=r;return}}n.textContent=r}var Js=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Xc(n,r,i){var c=r.indexOf("--")===0;i==null||typeof i=="boolean"||i===""?c?n.setProperty(r,""):r==="float"?n.cssFloat="":n[r]="":c?n.setProperty(r,i):typeof i!="number"||i===0||Js.has(r)?r==="float"?n.cssFloat=i:n[r]=(""+i).trim():n[r]=i+"px"}function il(n,r,i){if(r!=null&&typeof r!="object")throw Error(a(62));if(n=n.style,i!=null){for(var c in i)!i.hasOwnProperty(c)||r!=null&&r.hasOwnProperty(c)||(c.indexOf("--")===0?n.setProperty(c,""):c==="float"?n.cssFloat="":n[c]="");for(var f in r)c=r[f],r.hasOwnProperty(f)&&i[f]!==c&&Xc(n,f,c)}else for(var g in r)r.hasOwnProperty(g)&&Xc(n,g,r[g])}function ol(n){if(n.indexOf("-")===-1)return!1;switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var kh=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Eh=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Hi(n){return Eh.test(""+n)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":n}var Sa=null;function Tr(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var wa=null,Aa=null;function ll(n){var r=Tn(n);if(r&&(n=r.stateNode)){var i=n[Ae]||null;e:switch(n=r.stateNode,r.type){case"input":if(hr(n,i.value,i.defaultValue,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name),r=i.name,i.type==="radio"&&r!=null){for(i=n;i.parentNode;)i=i.parentNode;for(i=i.querySelectorAll('input[name="'+mn(""+r)+'"][type="radio"]'),r=0;r<i.length;r++){var c=i[r];if(c!==n&&c.form===n.form){var f=c[Ae]||null;if(!f)throw Error(a(90));hr(c,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name)}}for(r=0;r<i.length;r++)c=i[r],c.form===n.form&&sl(c)}break e;case"textarea":Mt(n,i.value,i.defaultValue);break e;case"select":r=i.value,r!=null&&Ea(n,!!i.multiple,r,!1)}}}var Wr=!1;function Zc(n,r,i){if(Wr)return n(r,i);Wr=!0;try{var c=n(r);return c}finally{if(Wr=!1,(wa!==null||Aa!==null)&&(Fu(),wa&&(r=wa,n=Aa,Aa=wa=null,ll(r),n)))for(r=0;r<n.length;r++)ll(n[r])}}function ei(n,r){var i=n.stateNode;if(i===null)return null;var c=i[Ae]||null;if(c===null)return null;i=c[r];e:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(n=n.type,c=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!c;break e;default:n=!1}if(n)return null;if(i&&typeof i!="function")throw Error(a(231,r,typeof i));return i}var Pr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),kr=!1;if(Pr)try{var ti={};Object.defineProperty(ti,"passive",{get:function(){kr=!0}}),window.addEventListener("test",ti,ti),window.removeEventListener("test",ti,ti)}catch{kr=!1}var Jr=null,ss=null,Na=null;function cl(){if(Na)return Na;var n,r=ss,i=r.length,c,f="value"in Jr?Jr.value:Jr.textContent,g=f.length;for(n=0;n<i&&r[n]===f[n];n++);var T=i-n;for(c=1;c<=T&&r[i-c]===f[g-c];c++);return Na=f.slice(n,1<c?1-c:void 0)}function ea(n){var r=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&r===13&&(n=13)):n=r,n===10&&(n=13),32<=n||n===13?n:0}function ta(){return!0}function ul(){return!1}function In(n){function r(i,c,f,g,T){this._reactName=i,this._targetInst=f,this.type=c,this.nativeEvent=g,this.target=T,this.currentTarget=null;for(var E in n)n.hasOwnProperty(E)&&(i=n[E],this[E]=i?i(g):g[E]);return this.isDefaultPrevented=(g.defaultPrevented!=null?g.defaultPrevented:g.returnValue===!1)?ta:ul,this.isPropagationStopped=ul,this}return x(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var i=this.nativeEvent;i&&(i.preventDefault?i.preventDefault():typeof i.returnValue!="unknown"&&(i.returnValue=!1),this.isDefaultPrevented=ta)},stopPropagation:function(){var i=this.nativeEvent;i&&(i.stopPropagation?i.stopPropagation():typeof i.cancelBubble!="unknown"&&(i.cancelBubble=!0),this.isPropagationStopped=ta)},persist:function(){},isPersistent:ta}),r}var At={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Fi=In(At),ni=x({},At,{view:0,detail:0}),Wc=In(ni),qi,$i,na,ri=x({},ni,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ii,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==na&&(na&&n.type==="mousemove"?(qi=n.screenX-na.screenX,$i=n.screenY-na.screenY):$i=qi=0,na=n),qi)},movementY:function(n){return"movementY"in n?n.movementY:$i}}),Er=In(ri),Jc=x({},ri,{dataTransfer:0}),Sh=In(Jc),ai=x({},ni,{relatedTarget:0}),Ki=In(ai),dl=x({},At,{animationName:0,elapsedTime:0,pseudoElement:0}),Yi=In(dl),eu=x({},At,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),Qi=In(eu),wh=x({},At,{data:0}),hl=In(wh),si={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},tu={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},nu={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function fl(n){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(n):(n=nu[n])?!!r[n]:!1}function ii(){return fl}var ru=x({},ni,{key:function(n){if(n.key){var r=si[n.key]||n.key;if(r!=="Unidentified")return r}return n.type==="keypress"?(n=ea(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?tu[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ii,charCode:function(n){return n.type==="keypress"?ea(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?ea(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),Xi=In(ru),au=x({},ri,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ml=In(au),Ra=x({},ni,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ii}),su=In(Ra),iu=x({},At,{propertyName:0,elapsedTime:0,pseudoElement:0}),ou=In(iu),lu=x({},ri,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),Zi=In(lu),tr=x({},At,{newState:0,oldState:0}),cu=In(tr),uu=[9,13,27,32],ra=Pr&&"CompositionEvent"in window,h=null;Pr&&"documentMode"in document&&(h=document.documentMode);var v=Pr&&"TextEvent"in window&&!h,b=Pr&&(!ra||h&&8<h&&11>=h),S=" ",F=!1;function te(n,r){switch(n){case"keyup":return uu.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function xe(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var vt=!1;function kn(n,r){switch(n){case"compositionend":return xe(r);case"keypress":return r.which!==32?null:(F=!0,S);case"textInput":return n=r.data,n===S&&F?null:n;default:return null}}function xt(n,r){if(vt)return n==="compositionend"||!ra&&te(n,r)?(n=cl(),Na=ss=Jr=null,vt=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return b&&r.locale!=="ko"?null:r.data;default:return null}}var jn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function En(n){var r=n&&n.nodeName&&n.nodeName.toLowerCase();return r==="input"?!!jn[n.type]:r==="textarea"}function Ca(n,r,i,c){wa?Aa?Aa.push(c):Aa=[c]:wa=c,r=Xu(r,"onChange"),0<r.length&&(i=new Fi("onChange","change",null,i,c),n.push({event:i,listeners:r}))}var Un=null,aa=null;function gl(n){tv(n,0)}function du(n){var r=Cn(n);if(sl(r))return n}function Tp(n,r){if(n==="change")return r}var kp=!1;if(Pr){var Ah;if(Pr){var Nh="oninput"in document;if(!Nh){var Ep=document.createElement("div");Ep.setAttribute("oninput","return;"),Nh=typeof Ep.oninput=="function"}Ah=Nh}else Ah=!1;kp=Ah&&(!document.documentMode||9<document.documentMode)}function Sp(){Un&&(Un.detachEvent("onpropertychange",wp),aa=Un=null)}function wp(n){if(n.propertyName==="value"&&du(aa)){var r=[];Ca(r,aa,n,Tr(n)),Zc(gl,r)}}function V1(n,r,i){n==="focusin"?(Sp(),Un=r,aa=i,Un.attachEvent("onpropertychange",wp)):n==="focusout"&&Sp()}function z1(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return du(aa)}function L1(n,r){if(n==="click")return du(r)}function U1(n,r){if(n==="input"||n==="change")return du(r)}function B1(n,r){return n===r&&(n!==0||1/n===1/r)||n!==n&&r!==r}var fr=typeof Object.is=="function"?Object.is:B1;function pl(n,r){if(fr(n,r))return!0;if(typeof n!="object"||n===null||typeof r!="object"||r===null)return!1;var i=Object.keys(n),c=Object.keys(r);if(i.length!==c.length)return!1;for(c=0;c<i.length;c++){var f=i[c];if(!kt.call(r,f)||!fr(n[f],r[f]))return!1}return!0}function Ap(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function Np(n,r){var i=Ap(n);n=0;for(var c;i;){if(i.nodeType===3){if(c=n+i.textContent.length,n<=r&&c>=r)return{node:i,offset:r-n};n=c}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=Ap(i)}}function Rp(n,r){return n&&r?n===r?!0:n&&n.nodeType===3?!1:r&&r.nodeType===3?Rp(n,r.parentNode):"contains"in n?n.contains(r):n.compareDocumentPosition?!!(n.compareDocumentPosition(r)&16):!1:!1}function Cp(n){n=n!=null&&n.ownerDocument!=null&&n.ownerDocument.defaultView!=null?n.ownerDocument.defaultView:window;for(var r=Xs(n.document);r instanceof n.HTMLIFrameElement;){try{var i=typeof r.contentWindow.location.href=="string"}catch{i=!1}if(i)n=r.contentWindow;else break;r=Xs(n.document)}return r}function Rh(n){var r=n&&n.nodeName&&n.nodeName.toLowerCase();return r&&(r==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||r==="textarea"||n.contentEditable==="true")}var G1=Pr&&"documentMode"in document&&11>=document.documentMode,Wi=null,Ch=null,yl=null,Ih=!1;function Ip(n,r,i){var c=i.window===i?i.document:i.nodeType===9?i:i.ownerDocument;Ih||Wi==null||Wi!==Xs(c)||(c=Wi,"selectionStart"in c&&Rh(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),yl&&pl(yl,c)||(yl=c,c=Xu(Ch,"onSelect"),0<c.length&&(r=new Fi("onSelect","select",null,r,i),n.push({event:r,listeners:c}),r.target=Wi)))}function oi(n,r){var i={};return i[n.toLowerCase()]=r.toLowerCase(),i["Webkit"+n]="webkit"+r,i["Moz"+n]="moz"+r,i}var Ji={animationend:oi("Animation","AnimationEnd"),animationiteration:oi("Animation","AnimationIteration"),animationstart:oi("Animation","AnimationStart"),transitionrun:oi("Transition","TransitionRun"),transitionstart:oi("Transition","TransitionStart"),transitioncancel:oi("Transition","TransitionCancel"),transitionend:oi("Transition","TransitionEnd")},jh={},jp={};Pr&&(jp=document.createElement("div").style,"AnimationEvent"in window||(delete Ji.animationend.animation,delete Ji.animationiteration.animation,delete Ji.animationstart.animation),"TransitionEvent"in window||delete Ji.transitionend.transition);function li(n){if(jh[n])return jh[n];if(!Ji[n])return n;var r=Ji[n],i;for(i in r)if(r.hasOwnProperty(i)&&i in jp)return jh[n]=r[i];return n}var Dp=li("animationend"),Mp=li("animationiteration"),Op=li("animationstart"),H1=li("transitionrun"),F1=li("transitionstart"),q1=li("transitioncancel"),Pp=li("transitionend"),Vp=new Map,Dh="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Dh.push("scrollEnd");function Vr(n,r){Vp.set(n,r),Xe(r,[n])}var zp=new WeakMap;function Sr(n,r){if(typeof n=="object"&&n!==null){var i=zp.get(n);return i!==void 0?i:(r={value:n,source:r,stack:Bi(r)},zp.set(n,r),r)}return{value:n,source:r,stack:Bi(r)}}var wr=[],eo=0,Mh=0;function hu(){for(var n=eo,r=Mh=eo=0;r<n;){var i=wr[r];wr[r++]=null;var c=wr[r];wr[r++]=null;var f=wr[r];wr[r++]=null;var g=wr[r];if(wr[r++]=null,c!==null&&f!==null){var T=c.pending;T===null?f.next=f:(f.next=T.next,T.next=f),c.pending=f}g!==0&&Lp(i,f,g)}}function fu(n,r,i,c){wr[eo++]=n,wr[eo++]=r,wr[eo++]=i,wr[eo++]=c,Mh|=c,n.lanes|=c,n=n.alternate,n!==null&&(n.lanes|=c)}function Oh(n,r,i,c){return fu(n,r,i,c),mu(n)}function to(n,r){return fu(n,null,null,r),mu(n)}function Lp(n,r,i){n.lanes|=i;var c=n.alternate;c!==null&&(c.lanes|=i);for(var f=!1,g=n.return;g!==null;)g.childLanes|=i,c=g.alternate,c!==null&&(c.childLanes|=i),g.tag===22&&(n=g.stateNode,n===null||n._visibility&1||(f=!0)),n=g,g=g.return;return n.tag===3?(g=n.stateNode,f&&r!==null&&(f=31-Qt(i),n=g.hiddenUpdates,c=n[f],c===null?n[f]=[r]:c.push(r),r.lane=i|536870912),g):null}function mu(n){if(50<Gl)throw Gl=0,Gf=null,Error(a(185));for(var r=n.return;r!==null;)n=r,r=n.return;return n.tag===3?n.stateNode:null}var no={};function $1(n,r,i,c){this.tag=n,this.key=i,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function mr(n,r,i,c){return new $1(n,r,i,c)}function Ph(n){return n=n.prototype,!(!n||!n.isReactComponent)}function Ia(n,r){var i=n.alternate;return i===null?(i=mr(n.tag,r,n.key,n.mode),i.elementType=n.elementType,i.type=n.type,i.stateNode=n.stateNode,i.alternate=n,n.alternate=i):(i.pendingProps=r,i.type=n.type,i.flags=0,i.subtreeFlags=0,i.deletions=null),i.flags=n.flags&65011712,i.childLanes=n.childLanes,i.lanes=n.lanes,i.child=n.child,i.memoizedProps=n.memoizedProps,i.memoizedState=n.memoizedState,i.updateQueue=n.updateQueue,r=n.dependencies,i.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},i.sibling=n.sibling,i.index=n.index,i.ref=n.ref,i.refCleanup=n.refCleanup,i}function Up(n,r){n.flags&=65011714;var i=n.alternate;return i===null?(n.childLanes=0,n.lanes=r,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=i.childLanes,n.lanes=i.lanes,n.child=i.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=i.memoizedProps,n.memoizedState=i.memoizedState,n.updateQueue=i.updateQueue,n.type=i.type,r=i.dependencies,n.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),n}function gu(n,r,i,c,f,g){var T=0;if(c=n,typeof n=="function")Ph(n)&&(T=1);else if(typeof n=="string")T=Yk(n,i,oe.current)?26:n==="html"||n==="head"||n==="body"?27:5;else e:switch(n){case R:return n=mr(31,i,r,f),n.elementType=R,n.lanes=g,n;case B:return ci(i.children,f,g,r);case L:T=8,f|=24;break;case D:return n=mr(12,i,r,f|2),n.elementType=D,n.lanes=g,n;case de:return n=mr(13,i,r,f),n.elementType=de,n.lanes=g,n;case me:return n=mr(19,i,r,f),n.elementType=me,n.lanes=g,n;default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case $:case ne:T=10;break e;case X:T=9;break e;case ce:T=11;break e;case O:T=14;break e;case N:T=16,c=null;break e}T=29,i=Error(a(130,n===null?"null":typeof n,"")),c=null}return r=mr(T,i,r,f),r.elementType=n,r.type=c,r.lanes=g,r}function ci(n,r,i,c){return n=mr(7,n,c,r),n.lanes=i,n}function Vh(n,r,i){return n=mr(6,n,null,r),n.lanes=i,n}function zh(n,r,i){return r=mr(4,n.children!==null?n.children:[],n.key,r),r.lanes=i,r.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},r}var ro=[],ao=0,pu=null,yu=0,Ar=[],Nr=0,ui=null,ja=1,Da="";function di(n,r){ro[ao++]=yu,ro[ao++]=pu,pu=n,yu=r}function Bp(n,r,i){Ar[Nr++]=ja,Ar[Nr++]=Da,Ar[Nr++]=ui,ui=n;var c=ja;n=Da;var f=32-Qt(c)-1;c&=~(1<<f),i+=1;var g=32-Qt(r)+f;if(30<g){var T=f-f%5;g=(c&(1<<T)-1).toString(32),c>>=T,f-=T,ja=1<<32-Qt(r)+f|i<<f|c,Da=g+n}else ja=1<<g|i<<f|c,Da=n}function Lh(n){n.return!==null&&(di(n,1),Bp(n,1,0))}function Uh(n){for(;n===pu;)pu=ro[--ao],ro[ao]=null,yu=ro[--ao],ro[ao]=null;for(;n===ui;)ui=Ar[--Nr],Ar[Nr]=null,Da=Ar[--Nr],Ar[Nr]=null,ja=Ar[--Nr],Ar[Nr]=null}var nr=null,rn=null,wt=!1,hi=null,sa=!1,Bh=Error(a(519));function fi(n){var r=Error(a(418,""));throw bl(Sr(r,n)),Bh}function Gp(n){var r=n.stateNode,i=n.type,c=n.memoizedProps;switch(r[ye]=n,r[Ae]=c,i){case"dialog":ft("cancel",r),ft("close",r);break;case"iframe":case"object":case"embed":ft("load",r);break;case"video":case"audio":for(i=0;i<Fl.length;i++)ft(Fl[i],r);break;case"source":ft("error",r);break;case"img":case"image":case"link":ft("error",r),ft("load",r);break;case"details":ft("toggle",r);break;case"input":ft("invalid",r),Zs(r,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0),Gi(r);break;case"select":ft("invalid",r);break;case"textarea":ft("invalid",r),Ws(r,c.value,c.defaultValue,c.children),Gi(r)}i=c.children,typeof i!="string"&&typeof i!="number"&&typeof i!="bigint"||r.textContent===""+i||c.suppressHydrationWarning===!0||sv(r.textContent,i)?(c.popover!=null&&(ft("beforetoggle",r),ft("toggle",r)),c.onScroll!=null&&ft("scroll",r),c.onScrollEnd!=null&&ft("scrollend",r),c.onClick!=null&&(r.onclick=Zu),r=!0):r=!1,r||fi(n)}function Hp(n){for(nr=n.return;nr;)switch(nr.tag){case 5:case 13:sa=!1;return;case 27:case 3:sa=!0;return;default:nr=nr.return}}function vl(n){if(n!==nr)return!1;if(!wt)return Hp(n),wt=!0,!1;var r=n.tag,i;if((i=r!==3&&r!==27)&&((i=r===5)&&(i=n.type,i=!(i!=="form"&&i!=="button")||am(n.type,n.memoizedProps)),i=!i),i&&rn&&fi(n),Hp(n),r===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(a(317));e:{for(n=n.nextSibling,r=0;n;){if(n.nodeType===8)if(i=n.data,i==="/$"){if(r===0){rn=Lr(n.nextSibling);break e}r--}else i!=="$"&&i!=="$!"&&i!=="$?"||r++;n=n.nextSibling}rn=null}}else r===27?(r=rn,_s(n.type)?(n=lm,lm=null,rn=n):rn=r):rn=nr?Lr(n.stateNode.nextSibling):null;return!0}function xl(){rn=nr=null,wt=!1}function Fp(){var n=hi;return n!==null&&(lr===null?lr=n:lr.push.apply(lr,n),hi=null),n}function bl(n){hi===null?hi=[n]:hi.push(n)}var Gh=Z(null),mi=null,Ma=null;function is(n,r,i){Y(Gh,r._currentValue),r._currentValue=i}function Oa(n){n._currentValue=Gh.current,H(Gh)}function Hh(n,r,i){for(;n!==null;){var c=n.alternate;if((n.childLanes&r)!==r?(n.childLanes|=r,c!==null&&(c.childLanes|=r)):c!==null&&(c.childLanes&r)!==r&&(c.childLanes|=r),n===i)break;n=n.return}}function Fh(n,r,i,c){var f=n.child;for(f!==null&&(f.return=n);f!==null;){var g=f.dependencies;if(g!==null){var T=f.child;g=g.firstContext;e:for(;g!==null;){var E=g;g=f;for(var M=0;M<r.length;M++)if(E.context===r[M]){g.lanes|=i,E=g.alternate,E!==null&&(E.lanes|=i),Hh(g.return,i,n),c||(T=null);break e}g=E.next}}else if(f.tag===18){if(T=f.return,T===null)throw Error(a(341));T.lanes|=i,g=T.alternate,g!==null&&(g.lanes|=i),Hh(T,i,n),T=null}else T=f.child;if(T!==null)T.return=f;else for(T=f;T!==null;){if(T===n){T=null;break}if(f=T.sibling,f!==null){f.return=T.return,T=f;break}T=T.return}f=T}}function _l(n,r,i,c){n=null;for(var f=r,g=!1;f!==null;){if(!g){if((f.flags&524288)!==0)g=!0;else if((f.flags&262144)!==0)break}if(f.tag===10){var T=f.alternate;if(T===null)throw Error(a(387));if(T=T.memoizedProps,T!==null){var E=f.type;fr(f.pendingProps.value,T.value)||(n!==null?n.push(E):n=[E])}}else if(f===nt.current){if(T=f.alternate,T===null)throw Error(a(387));T.memoizedState.memoizedState!==f.memoizedState.memoizedState&&(n!==null?n.push(Xl):n=[Xl])}f=f.return}n!==null&&Fh(r,n,i,c),r.flags|=262144}function vu(n){for(n=n.firstContext;n!==null;){if(!fr(n.context._currentValue,n.memoizedValue))return!0;n=n.next}return!1}function gi(n){mi=n,Ma=null,n=n.dependencies,n!==null&&(n.firstContext=null)}function Yn(n){return qp(mi,n)}function xu(n,r){return mi===null&&gi(n),qp(n,r)}function qp(n,r){var i=r._currentValue;if(r={context:r,memoizedValue:i,next:null},Ma===null){if(n===null)throw Error(a(308));Ma=r,n.dependencies={lanes:0,firstContext:r},n.flags|=524288}else Ma=Ma.next=r;return i}var K1=typeof AbortController<"u"?AbortController:function(){var n=[],r=this.signal={aborted:!1,addEventListener:function(i,c){n.push(c)}};this.abort=function(){r.aborted=!0,n.forEach(function(i){return i()})}},Y1=s.unstable_scheduleCallback,Q1=s.unstable_NormalPriority,Sn={$$typeof:ne,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function qh(){return{controller:new K1,data:new Map,refCount:0}}function Tl(n){n.refCount--,n.refCount===0&&Y1(Q1,function(){n.controller.abort()})}var kl=null,$h=0,so=0,io=null;function X1(n,r){if(kl===null){var i=kl=[];$h=0,so=Qf(),io={status:"pending",value:void 0,then:function(c){i.push(c)}}}return $h++,r.then($p,$p),r}function $p(){if(--$h===0&&kl!==null){io!==null&&(io.status="fulfilled");var n=kl;kl=null,so=0,io=null;for(var r=0;r<n.length;r++)(0,n[r])()}}function Z1(n,r){var i=[],c={status:"pending",value:null,reason:null,then:function(f){i.push(f)}};return n.then(function(){c.status="fulfilled",c.value=r;for(var f=0;f<i.length;f++)(0,i[f])(r)},function(f){for(c.status="rejected",c.reason=f,f=0;f<i.length;f++)(0,i[f])(void 0)}),c}var Kp=q.S;q.S=function(n,r){typeof r=="object"&&r!==null&&typeof r.then=="function"&&X1(n,r),Kp!==null&&Kp(n,r)};var pi=Z(null);function Kh(){var n=pi.current;return n!==null?n:Ht.pooledCache}function bu(n,r){r===null?Y(pi,pi.current):Y(pi,r.pool)}function Yp(){var n=Kh();return n===null?null:{parent:Sn._currentValue,pool:n}}var El=Error(a(460)),Qp=Error(a(474)),_u=Error(a(542)),Yh={then:function(){}};function Xp(n){return n=n.status,n==="fulfilled"||n==="rejected"}function Tu(){}function Zp(n,r,i){switch(i=n[i],i===void 0?n.push(r):i!==r&&(r.then(Tu,Tu),r=i),r.status){case"fulfilled":return r.value;case"rejected":throw n=r.reason,Jp(n),n;default:if(typeof r.status=="string")r.then(Tu,Tu);else{if(n=Ht,n!==null&&100<n.shellSuspendCounter)throw Error(a(482));n=r,n.status="pending",n.then(function(c){if(r.status==="pending"){var f=r;f.status="fulfilled",f.value=c}},function(c){if(r.status==="pending"){var f=r;f.status="rejected",f.reason=c}})}switch(r.status){case"fulfilled":return r.value;case"rejected":throw n=r.reason,Jp(n),n}throw Sl=r,El}}var Sl=null;function Wp(){if(Sl===null)throw Error(a(459));var n=Sl;return Sl=null,n}function Jp(n){if(n===El||n===_u)throw Error(a(483))}var os=!1;function Qh(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Xh(n,r){n=n.updateQueue,r.updateQueue===n&&(r.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,callbacks:null})}function ls(n){return{lane:n,tag:0,payload:null,callback:null,next:null}}function cs(n,r,i){var c=n.updateQueue;if(c===null)return null;if(c=c.shared,(Ct&2)!==0){var f=c.pending;return f===null?r.next=r:(r.next=f.next,f.next=r),c.pending=r,r=mu(n),Lp(n,null,i),r}return fu(n,c,r,i),mu(n)}function wl(n,r,i){if(r=r.updateQueue,r!==null&&(r=r.shared,(i&4194048)!==0)){var c=r.lanes;c&=n.pendingLanes,i|=c,r.lanes=i,Lt(n,i)}}function Zh(n,r){var i=n.updateQueue,c=n.alternate;if(c!==null&&(c=c.updateQueue,i===c)){var f=null,g=null;if(i=i.firstBaseUpdate,i!==null){do{var T={lane:i.lane,tag:i.tag,payload:i.payload,callback:null,next:null};g===null?f=g=T:g=g.next=T,i=i.next}while(i!==null);g===null?f=g=r:g=g.next=r}else f=g=r;i={baseState:c.baseState,firstBaseUpdate:f,lastBaseUpdate:g,shared:c.shared,callbacks:c.callbacks},n.updateQueue=i;return}n=i.lastBaseUpdate,n===null?i.firstBaseUpdate=r:n.next=r,i.lastBaseUpdate=r}var Wh=!1;function Al(){if(Wh){var n=io;if(n!==null)throw n}}function Nl(n,r,i,c){Wh=!1;var f=n.updateQueue;os=!1;var g=f.firstBaseUpdate,T=f.lastBaseUpdate,E=f.shared.pending;if(E!==null){f.shared.pending=null;var M=E,Q=M.next;M.next=null,T===null?g=Q:T.next=Q,T=M;var ae=n.alternate;ae!==null&&(ae=ae.updateQueue,E=ae.lastBaseUpdate,E!==T&&(E===null?ae.firstBaseUpdate=Q:E.next=Q,ae.lastBaseUpdate=M))}if(g!==null){var ue=f.baseState;T=0,ae=Q=M=null,E=g;do{var W=E.lane&-536870913,J=W!==E.lane;if(J?(bt&W)===W:(c&W)===W){W!==0&&W===so&&(Wh=!0),ae!==null&&(ae=ae.next={lane:0,tag:E.tag,payload:E.payload,callback:null,next:null});e:{var qe=n,Le=E;W=r;var Vt=i;switch(Le.tag){case 1:if(qe=Le.payload,typeof qe=="function"){ue=qe.call(Vt,ue,W);break e}ue=qe;break e;case 3:qe.flags=qe.flags&-65537|128;case 0:if(qe=Le.payload,W=typeof qe=="function"?qe.call(Vt,ue,W):qe,W==null)break e;ue=x({},ue,W);break e;case 2:os=!0}}W=E.callback,W!==null&&(n.flags|=64,J&&(n.flags|=8192),J=f.callbacks,J===null?f.callbacks=[W]:J.push(W))}else J={lane:W,tag:E.tag,payload:E.payload,callback:E.callback,next:null},ae===null?(Q=ae=J,M=ue):ae=ae.next=J,T|=W;if(E=E.next,E===null){if(E=f.shared.pending,E===null)break;J=E,E=J.next,J.next=null,f.lastBaseUpdate=J,f.shared.pending=null}}while(!0);ae===null&&(M=ue),f.baseState=M,f.firstBaseUpdate=Q,f.lastBaseUpdate=ae,g===null&&(f.shared.lanes=0),ys|=T,n.lanes=T,n.memoizedState=ue}}function ey(n,r){if(typeof n!="function")throw Error(a(191,n));n.call(r)}function ty(n,r){var i=n.callbacks;if(i!==null)for(n.callbacks=null,n=0;n<i.length;n++)ey(i[n],r)}var oo=Z(null),ku=Z(0);function ny(n,r){n=Ga,Y(ku,n),Y(oo,r),Ga=n|r.baseLanes}function Jh(){Y(ku,Ga),Y(oo,oo.current)}function ef(){Ga=ku.current,H(oo),H(ku)}var us=0,ot=null,Ot=null,gn=null,Eu=!1,lo=!1,yi=!1,Su=0,Rl=0,co=null,W1=0;function un(){throw Error(a(321))}function tf(n,r){if(r===null)return!1;for(var i=0;i<r.length&&i<n.length;i++)if(!fr(n[i],r[i]))return!1;return!0}function nf(n,r,i,c,f,g){return us=g,ot=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,q.H=n===null||n.memoizedState===null?Ly:Uy,yi=!1,g=i(c,f),yi=!1,lo&&(g=ay(r,i,c,f)),ry(n),g}function ry(n){q.H=Iu;var r=Ot!==null&&Ot.next!==null;if(us=0,gn=Ot=ot=null,Eu=!1,Rl=0,co=null,r)throw Error(a(300));n===null||Dn||(n=n.dependencies,n!==null&&vu(n)&&(Dn=!0))}function ay(n,r,i,c){ot=n;var f=0;do{if(lo&&(co=null),Rl=0,lo=!1,25<=f)throw Error(a(301));if(f+=1,gn=Ot=null,n.updateQueue!=null){var g=n.updateQueue;g.lastEffect=null,g.events=null,g.stores=null,g.memoCache!=null&&(g.memoCache.index=0)}q.H=sk,g=r(i,c)}while(lo);return g}function J1(){var n=q.H,r=n.useState()[0];return r=typeof r.then=="function"?Cl(r):r,n=n.useState()[0],(Ot!==null?Ot.memoizedState:null)!==n&&(ot.flags|=1024),r}function rf(){var n=Su!==0;return Su=0,n}function af(n,r,i){r.updateQueue=n.updateQueue,r.flags&=-2053,n.lanes&=~i}function sf(n){if(Eu){for(n=n.memoizedState;n!==null;){var r=n.queue;r!==null&&(r.pending=null),n=n.next}Eu=!1}us=0,gn=Ot=ot=null,lo=!1,Rl=Su=0,co=null}function ir(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return gn===null?ot.memoizedState=gn=n:gn=gn.next=n,gn}function pn(){if(Ot===null){var n=ot.alternate;n=n!==null?n.memoizedState:null}else n=Ot.next;var r=gn===null?ot.memoizedState:gn.next;if(r!==null)gn=r,Ot=n;else{if(n===null)throw ot.alternate===null?Error(a(467)):Error(a(310));Ot=n,n={memoizedState:Ot.memoizedState,baseState:Ot.baseState,baseQueue:Ot.baseQueue,queue:Ot.queue,next:null},gn===null?ot.memoizedState=gn=n:gn=gn.next=n}return gn}function of(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Cl(n){var r=Rl;return Rl+=1,co===null&&(co=[]),n=Zp(co,n,r),r=ot,(gn===null?r.memoizedState:gn.next)===null&&(r=r.alternate,q.H=r===null||r.memoizedState===null?Ly:Uy),n}function wu(n){if(n!==null&&typeof n=="object"){if(typeof n.then=="function")return Cl(n);if(n.$$typeof===ne)return Yn(n)}throw Error(a(438,String(n)))}function lf(n){var r=null,i=ot.updateQueue;if(i!==null&&(r=i.memoCache),r==null){var c=ot.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(r={data:c.data.map(function(f){return f.slice()}),index:0})))}if(r==null&&(r={data:[],index:0}),i===null&&(i=of(),ot.updateQueue=i),i.memoCache=r,i=r.data[r.index],i===void 0)for(i=r.data[r.index]=Array(n),c=0;c<n;c++)i[c]=P;return r.index++,i}function Pa(n,r){return typeof r=="function"?r(n):r}function Au(n){var r=pn();return cf(r,Ot,n)}function cf(n,r,i){var c=n.queue;if(c===null)throw Error(a(311));c.lastRenderedReducer=i;var f=n.baseQueue,g=c.pending;if(g!==null){if(f!==null){var T=f.next;f.next=g.next,g.next=T}r.baseQueue=f=g,c.pending=null}if(g=n.baseState,f===null)n.memoizedState=g;else{r=f.next;var E=T=null,M=null,Q=r,ae=!1;do{var ue=Q.lane&-536870913;if(ue!==Q.lane?(bt&ue)===ue:(us&ue)===ue){var W=Q.revertLane;if(W===0)M!==null&&(M=M.next={lane:0,revertLane:0,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null}),ue===so&&(ae=!0);else if((us&W)===W){Q=Q.next,W===so&&(ae=!0);continue}else ue={lane:0,revertLane:Q.revertLane,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null},M===null?(E=M=ue,T=g):M=M.next=ue,ot.lanes|=W,ys|=W;ue=Q.action,yi&&i(g,ue),g=Q.hasEagerState?Q.eagerState:i(g,ue)}else W={lane:ue,revertLane:Q.revertLane,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null},M===null?(E=M=W,T=g):M=M.next=W,ot.lanes|=ue,ys|=ue;Q=Q.next}while(Q!==null&&Q!==r);if(M===null?T=g:M.next=E,!fr(g,n.memoizedState)&&(Dn=!0,ae&&(i=io,i!==null)))throw i;n.memoizedState=g,n.baseState=T,n.baseQueue=M,c.lastRenderedState=g}return f===null&&(c.lanes=0),[n.memoizedState,c.dispatch]}function uf(n){var r=pn(),i=r.queue;if(i===null)throw Error(a(311));i.lastRenderedReducer=n;var c=i.dispatch,f=i.pending,g=r.memoizedState;if(f!==null){i.pending=null;var T=f=f.next;do g=n(g,T.action),T=T.next;while(T!==f);fr(g,r.memoizedState)||(Dn=!0),r.memoizedState=g,r.baseQueue===null&&(r.baseState=g),i.lastRenderedState=g}return[g,c]}function sy(n,r,i){var c=ot,f=pn(),g=wt;if(g){if(i===void 0)throw Error(a(407));i=i()}else i=r();var T=!fr((Ot||f).memoizedState,i);T&&(f.memoizedState=i,Dn=!0),f=f.queue;var E=ly.bind(null,c,f,n);if(Il(2048,8,E,[n]),f.getSnapshot!==r||T||gn!==null&&gn.memoizedState.tag&1){if(c.flags|=2048,uo(9,Nu(),oy.bind(null,c,f,i,r),null),Ht===null)throw Error(a(349));g||(us&124)!==0||iy(c,r,i)}return i}function iy(n,r,i){n.flags|=16384,n={getSnapshot:r,value:i},r=ot.updateQueue,r===null?(r=of(),ot.updateQueue=r,r.stores=[n]):(i=r.stores,i===null?r.stores=[n]:i.push(n))}function oy(n,r,i,c){r.value=i,r.getSnapshot=c,cy(r)&&uy(n)}function ly(n,r,i){return i(function(){cy(r)&&uy(n)})}function cy(n){var r=n.getSnapshot;n=n.value;try{var i=r();return!fr(n,i)}catch{return!0}}function uy(n){var r=to(n,2);r!==null&&xr(r,n,2)}function df(n){var r=ir();if(typeof n=="function"){var i=n;if(n=i(),yi){Yt(!0);try{i()}finally{Yt(!1)}}}return r.memoizedState=r.baseState=n,r.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Pa,lastRenderedState:n},r}function dy(n,r,i,c){return n.baseState=i,cf(n,Ot,typeof c=="function"?c:Pa)}function ek(n,r,i,c,f){if(Cu(n))throw Error(a(485));if(n=r.action,n!==null){var g={payload:f,action:n,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(T){g.listeners.push(T)}};q.T!==null?i(!0):g.isTransition=!1,c(g),i=r.pending,i===null?(g.next=r.pending=g,hy(r,g)):(g.next=i.next,r.pending=i.next=g)}}function hy(n,r){var i=r.action,c=r.payload,f=n.state;if(r.isTransition){var g=q.T,T={};q.T=T;try{var E=i(f,c),M=q.S;M!==null&&M(T,E),fy(n,r,E)}catch(Q){hf(n,r,Q)}finally{q.T=g}}else try{g=i(f,c),fy(n,r,g)}catch(Q){hf(n,r,Q)}}function fy(n,r,i){i!==null&&typeof i=="object"&&typeof i.then=="function"?i.then(function(c){my(n,r,c)},function(c){return hf(n,r,c)}):my(n,r,i)}function my(n,r,i){r.status="fulfilled",r.value=i,gy(r),n.state=i,r=n.pending,r!==null&&(i=r.next,i===r?n.pending=null:(i=i.next,r.next=i,hy(n,i)))}function hf(n,r,i){var c=n.pending;if(n.pending=null,c!==null){c=c.next;do r.status="rejected",r.reason=i,gy(r),r=r.next;while(r!==c)}n.action=null}function gy(n){n=n.listeners;for(var r=0;r<n.length;r++)(0,n[r])()}function py(n,r){return r}function yy(n,r){if(wt){var i=Ht.formState;if(i!==null){e:{var c=ot;if(wt){if(rn){t:{for(var f=rn,g=sa;f.nodeType!==8;){if(!g){f=null;break t}if(f=Lr(f.nextSibling),f===null){f=null;break t}}g=f.data,f=g==="F!"||g==="F"?f:null}if(f){rn=Lr(f.nextSibling),c=f.data==="F!";break e}}fi(c)}c=!1}c&&(r=i[0])}}return i=ir(),i.memoizedState=i.baseState=r,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:py,lastRenderedState:r},i.queue=c,i=Py.bind(null,ot,c),c.dispatch=i,c=df(!1),g=yf.bind(null,ot,!1,c.queue),c=ir(),f={state:r,dispatch:null,action:n,pending:null},c.queue=f,i=ek.bind(null,ot,f,g,i),f.dispatch=i,c.memoizedState=n,[r,i,!1]}function vy(n){var r=pn();return xy(r,Ot,n)}function xy(n,r,i){if(r=cf(n,r,py)[0],n=Au(Pa)[0],typeof r=="object"&&r!==null&&typeof r.then=="function")try{var c=Cl(r)}catch(T){throw T===El?_u:T}else c=r;r=pn();var f=r.queue,g=f.dispatch;return i!==r.memoizedState&&(ot.flags|=2048,uo(9,Nu(),tk.bind(null,f,i),null)),[c,g,n]}function tk(n,r){n.action=r}function by(n){var r=pn(),i=Ot;if(i!==null)return xy(r,i,n);pn(),r=r.memoizedState,i=pn();var c=i.queue.dispatch;return i.memoizedState=n,[r,c,!1]}function uo(n,r,i,c){return n={tag:n,create:i,deps:c,inst:r,next:null},r=ot.updateQueue,r===null&&(r=of(),ot.updateQueue=r),i=r.lastEffect,i===null?r.lastEffect=n.next=n:(c=i.next,i.next=n,n.next=c,r.lastEffect=n),n}function Nu(){return{destroy:void 0,resource:void 0}}function _y(){return pn().memoizedState}function Ru(n,r,i,c){var f=ir();c=c===void 0?null:c,ot.flags|=n,f.memoizedState=uo(1|r,Nu(),i,c)}function Il(n,r,i,c){var f=pn();c=c===void 0?null:c;var g=f.memoizedState.inst;Ot!==null&&c!==null&&tf(c,Ot.memoizedState.deps)?f.memoizedState=uo(r,g,i,c):(ot.flags|=n,f.memoizedState=uo(1|r,g,i,c))}function Ty(n,r){Ru(8390656,8,n,r)}function ky(n,r){Il(2048,8,n,r)}function Ey(n,r){return Il(4,2,n,r)}function Sy(n,r){return Il(4,4,n,r)}function wy(n,r){if(typeof r=="function"){n=n();var i=r(n);return function(){typeof i=="function"?i():r(null)}}if(r!=null)return n=n(),r.current=n,function(){r.current=null}}function Ay(n,r,i){i=i!=null?i.concat([n]):null,Il(4,4,wy.bind(null,r,n),i)}function ff(){}function Ny(n,r){var i=pn();r=r===void 0?null:r;var c=i.memoizedState;return r!==null&&tf(r,c[1])?c[0]:(i.memoizedState=[n,r],n)}function Ry(n,r){var i=pn();r=r===void 0?null:r;var c=i.memoizedState;if(r!==null&&tf(r,c[1]))return c[0];if(c=n(),yi){Yt(!0);try{n()}finally{Yt(!1)}}return i.memoizedState=[c,r],c}function mf(n,r,i){return i===void 0||(us&1073741824)!==0?n.memoizedState=r:(n.memoizedState=i,n=j0(),ot.lanes|=n,ys|=n,i)}function Cy(n,r,i,c){return fr(i,r)?i:oo.current!==null?(n=mf(n,i,c),fr(n,r)||(Dn=!0),n):(us&42)===0?(Dn=!0,n.memoizedState=i):(n=j0(),ot.lanes|=n,ys|=n,r)}function Iy(n,r,i,c,f){var g=he.p;he.p=g!==0&&8>g?g:8;var T=q.T,E={};q.T=E,yf(n,!1,r,i);try{var M=f(),Q=q.S;if(Q!==null&&Q(E,M),M!==null&&typeof M=="object"&&typeof M.then=="function"){var ae=Z1(M,c);jl(n,r,ae,vr(n))}else jl(n,r,c,vr(n))}catch(ue){jl(n,r,{then:function(){},status:"rejected",reason:ue},vr())}finally{he.p=g,q.T=T}}function nk(){}function gf(n,r,i,c){if(n.tag!==5)throw Error(a(476));var f=jy(n).queue;Iy(n,f,r,G,i===null?nk:function(){return Dy(n),i(c)})}function jy(n){var r=n.memoizedState;if(r!==null)return r;r={memoizedState:G,baseState:G,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Pa,lastRenderedState:G},next:null};var i={};return r.next={memoizedState:i,baseState:i,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Pa,lastRenderedState:i},next:null},n.memoizedState=r,n=n.alternate,n!==null&&(n.memoizedState=r),r}function Dy(n){var r=jy(n).next.queue;jl(n,r,{},vr())}function pf(){return Yn(Xl)}function My(){return pn().memoizedState}function Oy(){return pn().memoizedState}function rk(n){for(var r=n.return;r!==null;){switch(r.tag){case 24:case 3:var i=vr();n=ls(i);var c=cs(r,n,i);c!==null&&(xr(c,r,i),wl(c,r,i)),r={cache:qh()},n.payload=r;return}r=r.return}}function ak(n,r,i){var c=vr();i={lane:c,revertLane:0,action:i,hasEagerState:!1,eagerState:null,next:null},Cu(n)?Vy(r,i):(i=Oh(n,r,i,c),i!==null&&(xr(i,n,c),zy(i,r,c)))}function Py(n,r,i){var c=vr();jl(n,r,i,c)}function jl(n,r,i,c){var f={lane:c,revertLane:0,action:i,hasEagerState:!1,eagerState:null,next:null};if(Cu(n))Vy(r,f);else{var g=n.alternate;if(n.lanes===0&&(g===null||g.lanes===0)&&(g=r.lastRenderedReducer,g!==null))try{var T=r.lastRenderedState,E=g(T,i);if(f.hasEagerState=!0,f.eagerState=E,fr(E,T))return fu(n,r,f,0),Ht===null&&hu(),!1}catch{}finally{}if(i=Oh(n,r,f,c),i!==null)return xr(i,n,c),zy(i,r,c),!0}return!1}function yf(n,r,i,c){if(c={lane:2,revertLane:Qf(),action:c,hasEagerState:!1,eagerState:null,next:null},Cu(n)){if(r)throw Error(a(479))}else r=Oh(n,i,c,2),r!==null&&xr(r,n,2)}function Cu(n){var r=n.alternate;return n===ot||r!==null&&r===ot}function Vy(n,r){lo=Eu=!0;var i=n.pending;i===null?r.next=r:(r.next=i.next,i.next=r),n.pending=r}function zy(n,r,i){if((i&4194048)!==0){var c=r.lanes;c&=n.pendingLanes,i|=c,r.lanes=i,Lt(n,i)}}var Iu={readContext:Yn,use:wu,useCallback:un,useContext:un,useEffect:un,useImperativeHandle:un,useLayoutEffect:un,useInsertionEffect:un,useMemo:un,useReducer:un,useRef:un,useState:un,useDebugValue:un,useDeferredValue:un,useTransition:un,useSyncExternalStore:un,useId:un,useHostTransitionStatus:un,useFormState:un,useActionState:un,useOptimistic:un,useMemoCache:un,useCacheRefresh:un},Ly={readContext:Yn,use:wu,useCallback:function(n,r){return ir().memoizedState=[n,r===void 0?null:r],n},useContext:Yn,useEffect:Ty,useImperativeHandle:function(n,r,i){i=i!=null?i.concat([n]):null,Ru(4194308,4,wy.bind(null,r,n),i)},useLayoutEffect:function(n,r){return Ru(4194308,4,n,r)},useInsertionEffect:function(n,r){Ru(4,2,n,r)},useMemo:function(n,r){var i=ir();r=r===void 0?null:r;var c=n();if(yi){Yt(!0);try{n()}finally{Yt(!1)}}return i.memoizedState=[c,r],c},useReducer:function(n,r,i){var c=ir();if(i!==void 0){var f=i(r);if(yi){Yt(!0);try{i(r)}finally{Yt(!1)}}}else f=r;return c.memoizedState=c.baseState=f,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:f},c.queue=n,n=n.dispatch=ak.bind(null,ot,n),[c.memoizedState,n]},useRef:function(n){var r=ir();return n={current:n},r.memoizedState=n},useState:function(n){n=df(n);var r=n.queue,i=Py.bind(null,ot,r);return r.dispatch=i,[n.memoizedState,i]},useDebugValue:ff,useDeferredValue:function(n,r){var i=ir();return mf(i,n,r)},useTransition:function(){var n=df(!1);return n=Iy.bind(null,ot,n.queue,!0,!1),ir().memoizedState=n,[!1,n]},useSyncExternalStore:function(n,r,i){var c=ot,f=ir();if(wt){if(i===void 0)throw Error(a(407));i=i()}else{if(i=r(),Ht===null)throw Error(a(349));(bt&124)!==0||iy(c,r,i)}f.memoizedState=i;var g={value:i,getSnapshot:r};return f.queue=g,Ty(ly.bind(null,c,g,n),[n]),c.flags|=2048,uo(9,Nu(),oy.bind(null,c,g,i,r),null),i},useId:function(){var n=ir(),r=Ht.identifierPrefix;if(wt){var i=Da,c=ja;i=(c&~(1<<32-Qt(c)-1)).toString(32)+i,r="«"+r+"R"+i,i=Su++,0<i&&(r+="H"+i.toString(32)),r+="»"}else i=W1++,r="«"+r+"r"+i.toString(32)+"»";return n.memoizedState=r},useHostTransitionStatus:pf,useFormState:yy,useActionState:yy,useOptimistic:function(n){var r=ir();r.memoizedState=r.baseState=n;var i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return r.queue=i,r=yf.bind(null,ot,!0,i),i.dispatch=r,[n,r]},useMemoCache:lf,useCacheRefresh:function(){return ir().memoizedState=rk.bind(null,ot)}},Uy={readContext:Yn,use:wu,useCallback:Ny,useContext:Yn,useEffect:ky,useImperativeHandle:Ay,useInsertionEffect:Ey,useLayoutEffect:Sy,useMemo:Ry,useReducer:Au,useRef:_y,useState:function(){return Au(Pa)},useDebugValue:ff,useDeferredValue:function(n,r){var i=pn();return Cy(i,Ot.memoizedState,n,r)},useTransition:function(){var n=Au(Pa)[0],r=pn().memoizedState;return[typeof n=="boolean"?n:Cl(n),r]},useSyncExternalStore:sy,useId:My,useHostTransitionStatus:pf,useFormState:vy,useActionState:vy,useOptimistic:function(n,r){var i=pn();return dy(i,Ot,n,r)},useMemoCache:lf,useCacheRefresh:Oy},sk={readContext:Yn,use:wu,useCallback:Ny,useContext:Yn,useEffect:ky,useImperativeHandle:Ay,useInsertionEffect:Ey,useLayoutEffect:Sy,useMemo:Ry,useReducer:uf,useRef:_y,useState:function(){return uf(Pa)},useDebugValue:ff,useDeferredValue:function(n,r){var i=pn();return Ot===null?mf(i,n,r):Cy(i,Ot.memoizedState,n,r)},useTransition:function(){var n=uf(Pa)[0],r=pn().memoizedState;return[typeof n=="boolean"?n:Cl(n),r]},useSyncExternalStore:sy,useId:My,useHostTransitionStatus:pf,useFormState:by,useActionState:by,useOptimistic:function(n,r){var i=pn();return Ot!==null?dy(i,Ot,n,r):(i.baseState=n,[n,i.queue.dispatch])},useMemoCache:lf,useCacheRefresh:Oy},ho=null,Dl=0;function ju(n){var r=Dl;return Dl+=1,ho===null&&(ho=[]),Zp(ho,n,r)}function Ml(n,r){r=r.props.ref,n.ref=r!==void 0?r:null}function Du(n,r){throw r.$$typeof===_?Error(a(525)):(n=Object.prototype.toString.call(r),Error(a(31,n==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":n)))}function By(n){var r=n._init;return r(n._payload)}function Gy(n){function r(U,z){if(n){var K=U.deletions;K===null?(U.deletions=[z],U.flags|=16):K.push(z)}}function i(U,z){if(!n)return null;for(;z!==null;)r(U,z),z=z.sibling;return null}function c(U){for(var z=new Map;U!==null;)U.key!==null?z.set(U.key,U):z.set(U.index,U),U=U.sibling;return z}function f(U,z){return U=Ia(U,z),U.index=0,U.sibling=null,U}function g(U,z,K){return U.index=K,n?(K=U.alternate,K!==null?(K=K.index,K<z?(U.flags|=67108866,z):K):(U.flags|=67108866,z)):(U.flags|=1048576,z)}function T(U){return n&&U.alternate===null&&(U.flags|=67108866),U}function E(U,z,K,le){return z===null||z.tag!==6?(z=Vh(K,U.mode,le),z.return=U,z):(z=f(z,K),z.return=U,z)}function M(U,z,K,le){var je=K.type;return je===B?ae(U,z,K.props.children,le,K.key):z!==null&&(z.elementType===je||typeof je=="object"&&je!==null&&je.$$typeof===N&&By(je)===z.type)?(z=f(z,K.props),Ml(z,K),z.return=U,z):(z=gu(K.type,K.key,K.props,null,U.mode,le),Ml(z,K),z.return=U,z)}function Q(U,z,K,le){return z===null||z.tag!==4||z.stateNode.containerInfo!==K.containerInfo||z.stateNode.implementation!==K.implementation?(z=zh(K,U.mode,le),z.return=U,z):(z=f(z,K.children||[]),z.return=U,z)}function ae(U,z,K,le,je){return z===null||z.tag!==7?(z=ci(K,U.mode,le,je),z.return=U,z):(z=f(z,K),z.return=U,z)}function ue(U,z,K){if(typeof z=="string"&&z!==""||typeof z=="number"||typeof z=="bigint")return z=Vh(""+z,U.mode,K),z.return=U,z;if(typeof z=="object"&&z!==null){switch(z.$$typeof){case w:return K=gu(z.type,z.key,z.props,null,U.mode,K),Ml(K,z),K.return=U,K;case j:return z=zh(z,U.mode,K),z.return=U,z;case N:var le=z._init;return z=le(z._payload),ue(U,z,K)}if(se(z)||I(z))return z=ci(z,U.mode,K,null),z.return=U,z;if(typeof z.then=="function")return ue(U,ju(z),K);if(z.$$typeof===ne)return ue(U,xu(U,z),K);Du(U,z)}return null}function W(U,z,K,le){var je=z!==null?z.key:null;if(typeof K=="string"&&K!==""||typeof K=="number"||typeof K=="bigint")return je!==null?null:E(U,z,""+K,le);if(typeof K=="object"&&K!==null){switch(K.$$typeof){case w:return K.key===je?M(U,z,K,le):null;case j:return K.key===je?Q(U,z,K,le):null;case N:return je=K._init,K=je(K._payload),W(U,z,K,le)}if(se(K)||I(K))return je!==null?null:ae(U,z,K,le,null);if(typeof K.then=="function")return W(U,z,ju(K),le);if(K.$$typeof===ne)return W(U,z,xu(U,K),le);Du(U,K)}return null}function J(U,z,K,le,je){if(typeof le=="string"&&le!==""||typeof le=="number"||typeof le=="bigint")return U=U.get(K)||null,E(z,U,""+le,je);if(typeof le=="object"&&le!==null){switch(le.$$typeof){case w:return U=U.get(le.key===null?K:le.key)||null,M(z,U,le,je);case j:return U=U.get(le.key===null?K:le.key)||null,Q(z,U,le,je);case N:var ct=le._init;return le=ct(le._payload),J(U,z,K,le,je)}if(se(le)||I(le))return U=U.get(K)||null,ae(z,U,le,je,null);if(typeof le.then=="function")return J(U,z,K,ju(le),je);if(le.$$typeof===ne)return J(U,z,K,xu(z,le),je);Du(z,le)}return null}function qe(U,z,K,le){for(var je=null,ct=null,Oe=z,Ue=z=0,On=null;Oe!==null&&Ue<K.length;Ue++){Oe.index>Ue?(On=Oe,Oe=null):On=Oe.sibling;var Et=W(U,Oe,K[Ue],le);if(Et===null){Oe===null&&(Oe=On);break}n&&Oe&&Et.alternate===null&&r(U,Oe),z=g(Et,z,Ue),ct===null?je=Et:ct.sibling=Et,ct=Et,Oe=On}if(Ue===K.length)return i(U,Oe),wt&&di(U,Ue),je;if(Oe===null){for(;Ue<K.length;Ue++)Oe=ue(U,K[Ue],le),Oe!==null&&(z=g(Oe,z,Ue),ct===null?je=Oe:ct.sibling=Oe,ct=Oe);return wt&&di(U,Ue),je}for(Oe=c(Oe);Ue<K.length;Ue++)On=J(Oe,U,Ue,K[Ue],le),On!==null&&(n&&On.alternate!==null&&Oe.delete(On.key===null?Ue:On.key),z=g(On,z,Ue),ct===null?je=On:ct.sibling=On,ct=On);return n&&Oe.forEach(function(ws){return r(U,ws)}),wt&&di(U,Ue),je}function Le(U,z,K,le){if(K==null)throw Error(a(151));for(var je=null,ct=null,Oe=z,Ue=z=0,On=null,Et=K.next();Oe!==null&&!Et.done;Ue++,Et=K.next()){Oe.index>Ue?(On=Oe,Oe=null):On=Oe.sibling;var ws=W(U,Oe,Et.value,le);if(ws===null){Oe===null&&(Oe=On);break}n&&Oe&&ws.alternate===null&&r(U,Oe),z=g(ws,z,Ue),ct===null?je=ws:ct.sibling=ws,ct=ws,Oe=On}if(Et.done)return i(U,Oe),wt&&di(U,Ue),je;if(Oe===null){for(;!Et.done;Ue++,Et=K.next())Et=ue(U,Et.value,le),Et!==null&&(z=g(Et,z,Ue),ct===null?je=Et:ct.sibling=Et,ct=Et);return wt&&di(U,Ue),je}for(Oe=c(Oe);!Et.done;Ue++,Et=K.next())Et=J(Oe,U,Ue,Et.value,le),Et!==null&&(n&&Et.alternate!==null&&Oe.delete(Et.key===null?Ue:Et.key),z=g(Et,z,Ue),ct===null?je=Et:ct.sibling=Et,ct=Et);return n&&Oe.forEach(function(iE){return r(U,iE)}),wt&&di(U,Ue),je}function Vt(U,z,K,le){if(typeof K=="object"&&K!==null&&K.type===B&&K.key===null&&(K=K.props.children),typeof K=="object"&&K!==null){switch(K.$$typeof){case w:e:{for(var je=K.key;z!==null;){if(z.key===je){if(je=K.type,je===B){if(z.tag===7){i(U,z.sibling),le=f(z,K.props.children),le.return=U,U=le;break e}}else if(z.elementType===je||typeof je=="object"&&je!==null&&je.$$typeof===N&&By(je)===z.type){i(U,z.sibling),le=f(z,K.props),Ml(le,K),le.return=U,U=le;break e}i(U,z);break}else r(U,z);z=z.sibling}K.type===B?(le=ci(K.props.children,U.mode,le,K.key),le.return=U,U=le):(le=gu(K.type,K.key,K.props,null,U.mode,le),Ml(le,K),le.return=U,U=le)}return T(U);case j:e:{for(je=K.key;z!==null;){if(z.key===je)if(z.tag===4&&z.stateNode.containerInfo===K.containerInfo&&z.stateNode.implementation===K.implementation){i(U,z.sibling),le=f(z,K.children||[]),le.return=U,U=le;break e}else{i(U,z);break}else r(U,z);z=z.sibling}le=zh(K,U.mode,le),le.return=U,U=le}return T(U);case N:return je=K._init,K=je(K._payload),Vt(U,z,K,le)}if(se(K))return qe(U,z,K,le);if(I(K)){if(je=I(K),typeof je!="function")throw Error(a(150));return K=je.call(K),Le(U,z,K,le)}if(typeof K.then=="function")return Vt(U,z,ju(K),le);if(K.$$typeof===ne)return Vt(U,z,xu(U,K),le);Du(U,K)}return typeof K=="string"&&K!==""||typeof K=="number"||typeof K=="bigint"?(K=""+K,z!==null&&z.tag===6?(i(U,z.sibling),le=f(z,K),le.return=U,U=le):(i(U,z),le=Vh(K,U.mode,le),le.return=U,U=le),T(U)):i(U,z)}return function(U,z,K,le){try{Dl=0;var je=Vt(U,z,K,le);return ho=null,je}catch(Oe){if(Oe===El||Oe===_u)throw Oe;var ct=mr(29,Oe,null,U.mode);return ct.lanes=le,ct.return=U,ct}finally{}}}var fo=Gy(!0),Hy=Gy(!1),Rr=Z(null),ia=null;function ds(n){var r=n.alternate;Y(wn,wn.current&1),Y(Rr,n),ia===null&&(r===null||oo.current!==null||r.memoizedState!==null)&&(ia=n)}function Fy(n){if(n.tag===22){if(Y(wn,wn.current),Y(Rr,n),ia===null){var r=n.alternate;r!==null&&r.memoizedState!==null&&(ia=n)}}else hs()}function hs(){Y(wn,wn.current),Y(Rr,Rr.current)}function Va(n){H(Rr),ia===n&&(ia=null),H(wn)}var wn=Z(0);function Mu(n){for(var r=n;r!==null;){if(r.tag===13){var i=r.memoizedState;if(i!==null&&(i=i.dehydrated,i===null||i.data==="$?"||om(i)))return r}else if(r.tag===19&&r.memoizedProps.revealOrder!==void 0){if((r.flags&128)!==0)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===n)break;for(;r.sibling===null;){if(r.return===null||r.return===n)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}function vf(n,r,i,c){r=n.memoizedState,i=i(c,r),i=i==null?r:x({},r,i),n.memoizedState=i,n.lanes===0&&(n.updateQueue.baseState=i)}var xf={enqueueSetState:function(n,r,i){n=n._reactInternals;var c=vr(),f=ls(c);f.payload=r,i!=null&&(f.callback=i),r=cs(n,f,c),r!==null&&(xr(r,n,c),wl(r,n,c))},enqueueReplaceState:function(n,r,i){n=n._reactInternals;var c=vr(),f=ls(c);f.tag=1,f.payload=r,i!=null&&(f.callback=i),r=cs(n,f,c),r!==null&&(xr(r,n,c),wl(r,n,c))},enqueueForceUpdate:function(n,r){n=n._reactInternals;var i=vr(),c=ls(i);c.tag=2,r!=null&&(c.callback=r),r=cs(n,c,i),r!==null&&(xr(r,n,i),wl(r,n,i))}};function qy(n,r,i,c,f,g,T){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(c,g,T):r.prototype&&r.prototype.isPureReactComponent?!pl(i,c)||!pl(f,g):!0}function $y(n,r,i,c){n=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(i,c),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(i,c),r.state!==n&&xf.enqueueReplaceState(r,r.state,null)}function vi(n,r){var i=r;if("ref"in r){i={};for(var c in r)c!=="ref"&&(i[c]=r[c])}if(n=n.defaultProps){i===r&&(i=x({},i));for(var f in n)i[f]===void 0&&(i[f]=n[f])}return i}var Ou=typeof reportError=="function"?reportError:function(n){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var r=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof n=="object"&&n!==null&&typeof n.message=="string"?String(n.message):String(n),error:n});if(!window.dispatchEvent(r))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",n);return}console.error(n)};function Ky(n){Ou(n)}function Yy(n){console.error(n)}function Qy(n){Ou(n)}function Pu(n,r){try{var i=n.onUncaughtError;i(r.value,{componentStack:r.stack})}catch(c){setTimeout(function(){throw c})}}function Xy(n,r,i){try{var c=n.onCaughtError;c(i.value,{componentStack:i.stack,errorBoundary:r.tag===1?r.stateNode:null})}catch(f){setTimeout(function(){throw f})}}function bf(n,r,i){return i=ls(i),i.tag=3,i.payload={element:null},i.callback=function(){Pu(n,r)},i}function Zy(n){return n=ls(n),n.tag=3,n}function Wy(n,r,i,c){var f=i.type.getDerivedStateFromError;if(typeof f=="function"){var g=c.value;n.payload=function(){return f(g)},n.callback=function(){Xy(r,i,c)}}var T=i.stateNode;T!==null&&typeof T.componentDidCatch=="function"&&(n.callback=function(){Xy(r,i,c),typeof f!="function"&&(vs===null?vs=new Set([this]):vs.add(this));var E=c.stack;this.componentDidCatch(c.value,{componentStack:E!==null?E:""})})}function ik(n,r,i,c,f){if(i.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(r=i.alternate,r!==null&&_l(r,i,f,!0),i=Rr.current,i!==null){switch(i.tag){case 13:return ia===null?Ff():i.alternate===null&&an===0&&(an=3),i.flags&=-257,i.flags|=65536,i.lanes=f,c===Yh?i.flags|=16384:(r=i.updateQueue,r===null?i.updateQueue=new Set([c]):r.add(c),$f(n,c,f)),!1;case 22:return i.flags|=65536,c===Yh?i.flags|=16384:(r=i.updateQueue,r===null?(r={transitions:null,markerInstances:null,retryQueue:new Set([c])},i.updateQueue=r):(i=r.retryQueue,i===null?r.retryQueue=new Set([c]):i.add(c)),$f(n,c,f)),!1}throw Error(a(435,i.tag))}return $f(n,c,f),Ff(),!1}if(wt)return r=Rr.current,r!==null?((r.flags&65536)===0&&(r.flags|=256),r.flags|=65536,r.lanes=f,c!==Bh&&(n=Error(a(422),{cause:c}),bl(Sr(n,i)))):(c!==Bh&&(r=Error(a(423),{cause:c}),bl(Sr(r,i))),n=n.current.alternate,n.flags|=65536,f&=-f,n.lanes|=f,c=Sr(c,i),f=bf(n.stateNode,c,f),Zh(n,f),an!==4&&(an=2)),!1;var g=Error(a(520),{cause:c});if(g=Sr(g,i),Bl===null?Bl=[g]:Bl.push(g),an!==4&&(an=2),r===null)return!0;c=Sr(c,i),i=r;do{switch(i.tag){case 3:return i.flags|=65536,n=f&-f,i.lanes|=n,n=bf(i.stateNode,c,n),Zh(i,n),!1;case 1:if(r=i.type,g=i.stateNode,(i.flags&128)===0&&(typeof r.getDerivedStateFromError=="function"||g!==null&&typeof g.componentDidCatch=="function"&&(vs===null||!vs.has(g))))return i.flags|=65536,f&=-f,i.lanes|=f,f=Zy(f),Wy(f,n,i,c),Zh(i,f),!1}i=i.return}while(i!==null);return!1}var Jy=Error(a(461)),Dn=!1;function Bn(n,r,i,c){r.child=n===null?Hy(r,null,i,c):fo(r,n.child,i,c)}function e0(n,r,i,c,f){i=i.render;var g=r.ref;if("ref"in c){var T={};for(var E in c)E!=="ref"&&(T[E]=c[E])}else T=c;return gi(r),c=nf(n,r,i,T,g,f),E=rf(),n!==null&&!Dn?(af(n,r,f),za(n,r,f)):(wt&&E&&Lh(r),r.flags|=1,Bn(n,r,c,f),r.child)}function t0(n,r,i,c,f){if(n===null){var g=i.type;return typeof g=="function"&&!Ph(g)&&g.defaultProps===void 0&&i.compare===null?(r.tag=15,r.type=g,n0(n,r,g,c,f)):(n=gu(i.type,null,c,r,r.mode,f),n.ref=r.ref,n.return=r,r.child=n)}if(g=n.child,!Nf(n,f)){var T=g.memoizedProps;if(i=i.compare,i=i!==null?i:pl,i(T,c)&&n.ref===r.ref)return za(n,r,f)}return r.flags|=1,n=Ia(g,c),n.ref=r.ref,n.return=r,r.child=n}function n0(n,r,i,c,f){if(n!==null){var g=n.memoizedProps;if(pl(g,c)&&n.ref===r.ref)if(Dn=!1,r.pendingProps=c=g,Nf(n,f))(n.flags&131072)!==0&&(Dn=!0);else return r.lanes=n.lanes,za(n,r,f)}return _f(n,r,i,c,f)}function r0(n,r,i){var c=r.pendingProps,f=c.children,g=n!==null?n.memoizedState:null;if(c.mode==="hidden"){if((r.flags&128)!==0){if(c=g!==null?g.baseLanes|i:i,n!==null){for(f=r.child=n.child,g=0;f!==null;)g=g|f.lanes|f.childLanes,f=f.sibling;r.childLanes=g&~c}else r.childLanes=0,r.child=null;return a0(n,r,c,i)}if((i&536870912)!==0)r.memoizedState={baseLanes:0,cachePool:null},n!==null&&bu(r,g!==null?g.cachePool:null),g!==null?ny(r,g):Jh(),Fy(r);else return r.lanes=r.childLanes=536870912,a0(n,r,g!==null?g.baseLanes|i:i,i)}else g!==null?(bu(r,g.cachePool),ny(r,g),hs(),r.memoizedState=null):(n!==null&&bu(r,null),Jh(),hs());return Bn(n,r,f,i),r.child}function a0(n,r,i,c){var f=Kh();return f=f===null?null:{parent:Sn._currentValue,pool:f},r.memoizedState={baseLanes:i,cachePool:f},n!==null&&bu(r,null),Jh(),Fy(r),n!==null&&_l(n,r,c,!0),null}function Vu(n,r){var i=r.ref;if(i===null)n!==null&&n.ref!==null&&(r.flags|=4194816);else{if(typeof i!="function"&&typeof i!="object")throw Error(a(284));(n===null||n.ref!==i)&&(r.flags|=4194816)}}function _f(n,r,i,c,f){return gi(r),i=nf(n,r,i,c,void 0,f),c=rf(),n!==null&&!Dn?(af(n,r,f),za(n,r,f)):(wt&&c&&Lh(r),r.flags|=1,Bn(n,r,i,f),r.child)}function s0(n,r,i,c,f,g){return gi(r),r.updateQueue=null,i=ay(r,c,i,f),ry(n),c=rf(),n!==null&&!Dn?(af(n,r,g),za(n,r,g)):(wt&&c&&Lh(r),r.flags|=1,Bn(n,r,i,g),r.child)}function i0(n,r,i,c,f){if(gi(r),r.stateNode===null){var g=no,T=i.contextType;typeof T=="object"&&T!==null&&(g=Yn(T)),g=new i(c,g),r.memoizedState=g.state!==null&&g.state!==void 0?g.state:null,g.updater=xf,r.stateNode=g,g._reactInternals=r,g=r.stateNode,g.props=c,g.state=r.memoizedState,g.refs={},Qh(r),T=i.contextType,g.context=typeof T=="object"&&T!==null?Yn(T):no,g.state=r.memoizedState,T=i.getDerivedStateFromProps,typeof T=="function"&&(vf(r,i,T,c),g.state=r.memoizedState),typeof i.getDerivedStateFromProps=="function"||typeof g.getSnapshotBeforeUpdate=="function"||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(T=g.state,typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount(),T!==g.state&&xf.enqueueReplaceState(g,g.state,null),Nl(r,c,g,f),Al(),g.state=r.memoizedState),typeof g.componentDidMount=="function"&&(r.flags|=4194308),c=!0}else if(n===null){g=r.stateNode;var E=r.memoizedProps,M=vi(i,E);g.props=M;var Q=g.context,ae=i.contextType;T=no,typeof ae=="object"&&ae!==null&&(T=Yn(ae));var ue=i.getDerivedStateFromProps;ae=typeof ue=="function"||typeof g.getSnapshotBeforeUpdate=="function",E=r.pendingProps!==E,ae||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(E||Q!==T)&&$y(r,g,c,T),os=!1;var W=r.memoizedState;g.state=W,Nl(r,c,g,f),Al(),Q=r.memoizedState,E||W!==Q||os?(typeof ue=="function"&&(vf(r,i,ue,c),Q=r.memoizedState),(M=os||qy(r,i,M,c,W,Q,T))?(ae||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount()),typeof g.componentDidMount=="function"&&(r.flags|=4194308)):(typeof g.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=c,r.memoizedState=Q),g.props=c,g.state=Q,g.context=T,c=M):(typeof g.componentDidMount=="function"&&(r.flags|=4194308),c=!1)}else{g=r.stateNode,Xh(n,r),T=r.memoizedProps,ae=vi(i,T),g.props=ae,ue=r.pendingProps,W=g.context,Q=i.contextType,M=no,typeof Q=="object"&&Q!==null&&(M=Yn(Q)),E=i.getDerivedStateFromProps,(Q=typeof E=="function"||typeof g.getSnapshotBeforeUpdate=="function")||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(T!==ue||W!==M)&&$y(r,g,c,M),os=!1,W=r.memoizedState,g.state=W,Nl(r,c,g,f),Al();var J=r.memoizedState;T!==ue||W!==J||os||n!==null&&n.dependencies!==null&&vu(n.dependencies)?(typeof E=="function"&&(vf(r,i,E,c),J=r.memoizedState),(ae=os||qy(r,i,ae,c,W,J,M)||n!==null&&n.dependencies!==null&&vu(n.dependencies))?(Q||typeof g.UNSAFE_componentWillUpdate!="function"&&typeof g.componentWillUpdate!="function"||(typeof g.componentWillUpdate=="function"&&g.componentWillUpdate(c,J,M),typeof g.UNSAFE_componentWillUpdate=="function"&&g.UNSAFE_componentWillUpdate(c,J,M)),typeof g.componentDidUpdate=="function"&&(r.flags|=4),typeof g.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof g.componentDidUpdate!="function"||T===n.memoizedProps&&W===n.memoizedState||(r.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||T===n.memoizedProps&&W===n.memoizedState||(r.flags|=1024),r.memoizedProps=c,r.memoizedState=J),g.props=c,g.state=J,g.context=M,c=ae):(typeof g.componentDidUpdate!="function"||T===n.memoizedProps&&W===n.memoizedState||(r.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||T===n.memoizedProps&&W===n.memoizedState||(r.flags|=1024),c=!1)}return g=c,Vu(n,r),c=(r.flags&128)!==0,g||c?(g=r.stateNode,i=c&&typeof i.getDerivedStateFromError!="function"?null:g.render(),r.flags|=1,n!==null&&c?(r.child=fo(r,n.child,null,f),r.child=fo(r,null,i,f)):Bn(n,r,i,f),r.memoizedState=g.state,n=r.child):n=za(n,r,f),n}function o0(n,r,i,c){return xl(),r.flags|=256,Bn(n,r,i,c),r.child}var Tf={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function kf(n){return{baseLanes:n,cachePool:Yp()}}function Ef(n,r,i){return n=n!==null?n.childLanes&~i:0,r&&(n|=Cr),n}function l0(n,r,i){var c=r.pendingProps,f=!1,g=(r.flags&128)!==0,T;if((T=g)||(T=n!==null&&n.memoizedState===null?!1:(wn.current&2)!==0),T&&(f=!0,r.flags&=-129),T=(r.flags&32)!==0,r.flags&=-33,n===null){if(wt){if(f?ds(r):hs(),wt){var E=rn,M;if(M=E){e:{for(M=E,E=sa;M.nodeType!==8;){if(!E){E=null;break e}if(M=Lr(M.nextSibling),M===null){E=null;break e}}E=M}E!==null?(r.memoizedState={dehydrated:E,treeContext:ui!==null?{id:ja,overflow:Da}:null,retryLane:536870912,hydrationErrors:null},M=mr(18,null,null,0),M.stateNode=E,M.return=r,r.child=M,nr=r,rn=null,M=!0):M=!1}M||fi(r)}if(E=r.memoizedState,E!==null&&(E=E.dehydrated,E!==null))return om(E)?r.lanes=32:r.lanes=536870912,null;Va(r)}return E=c.children,c=c.fallback,f?(hs(),f=r.mode,E=zu({mode:"hidden",children:E},f),c=ci(c,f,i,null),E.return=r,c.return=r,E.sibling=c,r.child=E,f=r.child,f.memoizedState=kf(i),f.childLanes=Ef(n,T,i),r.memoizedState=Tf,c):(ds(r),Sf(r,E))}if(M=n.memoizedState,M!==null&&(E=M.dehydrated,E!==null)){if(g)r.flags&256?(ds(r),r.flags&=-257,r=wf(n,r,i)):r.memoizedState!==null?(hs(),r.child=n.child,r.flags|=128,r=null):(hs(),f=c.fallback,E=r.mode,c=zu({mode:"visible",children:c.children},E),f=ci(f,E,i,null),f.flags|=2,c.return=r,f.return=r,c.sibling=f,r.child=c,fo(r,n.child,null,i),c=r.child,c.memoizedState=kf(i),c.childLanes=Ef(n,T,i),r.memoizedState=Tf,r=f);else if(ds(r),om(E)){if(T=E.nextSibling&&E.nextSibling.dataset,T)var Q=T.dgst;T=Q,c=Error(a(419)),c.stack="",c.digest=T,bl({value:c,source:null,stack:null}),r=wf(n,r,i)}else if(Dn||_l(n,r,i,!1),T=(i&n.childLanes)!==0,Dn||T){if(T=Ht,T!==null&&(c=i&-i,c=(c&42)!==0?1:ee(c),c=(c&(T.suspendedLanes|i))!==0?0:c,c!==0&&c!==M.retryLane))throw M.retryLane=c,to(n,c),xr(T,n,c),Jy;E.data==="$?"||Ff(),r=wf(n,r,i)}else E.data==="$?"?(r.flags|=192,r.child=n.child,r=null):(n=M.treeContext,rn=Lr(E.nextSibling),nr=r,wt=!0,hi=null,sa=!1,n!==null&&(Ar[Nr++]=ja,Ar[Nr++]=Da,Ar[Nr++]=ui,ja=n.id,Da=n.overflow,ui=r),r=Sf(r,c.children),r.flags|=4096);return r}return f?(hs(),f=c.fallback,E=r.mode,M=n.child,Q=M.sibling,c=Ia(M,{mode:"hidden",children:c.children}),c.subtreeFlags=M.subtreeFlags&65011712,Q!==null?f=Ia(Q,f):(f=ci(f,E,i,null),f.flags|=2),f.return=r,c.return=r,c.sibling=f,r.child=c,c=f,f=r.child,E=n.child.memoizedState,E===null?E=kf(i):(M=E.cachePool,M!==null?(Q=Sn._currentValue,M=M.parent!==Q?{parent:Q,pool:Q}:M):M=Yp(),E={baseLanes:E.baseLanes|i,cachePool:M}),f.memoizedState=E,f.childLanes=Ef(n,T,i),r.memoizedState=Tf,c):(ds(r),i=n.child,n=i.sibling,i=Ia(i,{mode:"visible",children:c.children}),i.return=r,i.sibling=null,n!==null&&(T=r.deletions,T===null?(r.deletions=[n],r.flags|=16):T.push(n)),r.child=i,r.memoizedState=null,i)}function Sf(n,r){return r=zu({mode:"visible",children:r},n.mode),r.return=n,n.child=r}function zu(n,r){return n=mr(22,n,null,r),n.lanes=0,n.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},n}function wf(n,r,i){return fo(r,n.child,null,i),n=Sf(r,r.pendingProps.children),n.flags|=2,r.memoizedState=null,n}function c0(n,r,i){n.lanes|=r;var c=n.alternate;c!==null&&(c.lanes|=r),Hh(n.return,r,i)}function Af(n,r,i,c,f){var g=n.memoizedState;g===null?n.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:c,tail:i,tailMode:f}:(g.isBackwards=r,g.rendering=null,g.renderingStartTime=0,g.last=c,g.tail=i,g.tailMode=f)}function u0(n,r,i){var c=r.pendingProps,f=c.revealOrder,g=c.tail;if(Bn(n,r,c.children,i),c=wn.current,(c&2)!==0)c=c&1|2,r.flags|=128;else{if(n!==null&&(n.flags&128)!==0)e:for(n=r.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&c0(n,i,r);else if(n.tag===19)c0(n,i,r);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===r)break e;for(;n.sibling===null;){if(n.return===null||n.return===r)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}c&=1}switch(Y(wn,c),f){case"forwards":for(i=r.child,f=null;i!==null;)n=i.alternate,n!==null&&Mu(n)===null&&(f=i),i=i.sibling;i=f,i===null?(f=r.child,r.child=null):(f=i.sibling,i.sibling=null),Af(r,!1,f,i,g);break;case"backwards":for(i=null,f=r.child,r.child=null;f!==null;){if(n=f.alternate,n!==null&&Mu(n)===null){r.child=f;break}n=f.sibling,f.sibling=i,i=f,f=n}Af(r,!0,i,null,g);break;case"together":Af(r,!1,null,null,void 0);break;default:r.memoizedState=null}return r.child}function za(n,r,i){if(n!==null&&(r.dependencies=n.dependencies),ys|=r.lanes,(i&r.childLanes)===0)if(n!==null){if(_l(n,r,i,!1),(i&r.childLanes)===0)return null}else return null;if(n!==null&&r.child!==n.child)throw Error(a(153));if(r.child!==null){for(n=r.child,i=Ia(n,n.pendingProps),r.child=i,i.return=r;n.sibling!==null;)n=n.sibling,i=i.sibling=Ia(n,n.pendingProps),i.return=r;i.sibling=null}return r.child}function Nf(n,r){return(n.lanes&r)!==0?!0:(n=n.dependencies,!!(n!==null&&vu(n)))}function ok(n,r,i){switch(r.tag){case 3:We(r,r.stateNode.containerInfo),is(r,Sn,n.memoizedState.cache),xl();break;case 27:case 5:Re(r);break;case 4:We(r,r.stateNode.containerInfo);break;case 10:is(r,r.type,r.memoizedProps.value);break;case 13:var c=r.memoizedState;if(c!==null)return c.dehydrated!==null?(ds(r),r.flags|=128,null):(i&r.child.childLanes)!==0?l0(n,r,i):(ds(r),n=za(n,r,i),n!==null?n.sibling:null);ds(r);break;case 19:var f=(n.flags&128)!==0;if(c=(i&r.childLanes)!==0,c||(_l(n,r,i,!1),c=(i&r.childLanes)!==0),f){if(c)return u0(n,r,i);r.flags|=128}if(f=r.memoizedState,f!==null&&(f.rendering=null,f.tail=null,f.lastEffect=null),Y(wn,wn.current),c)break;return null;case 22:case 23:return r.lanes=0,r0(n,r,i);case 24:is(r,Sn,n.memoizedState.cache)}return za(n,r,i)}function d0(n,r,i){if(n!==null)if(n.memoizedProps!==r.pendingProps)Dn=!0;else{if(!Nf(n,i)&&(r.flags&128)===0)return Dn=!1,ok(n,r,i);Dn=(n.flags&131072)!==0}else Dn=!1,wt&&(r.flags&1048576)!==0&&Bp(r,yu,r.index);switch(r.lanes=0,r.tag){case 16:e:{n=r.pendingProps;var c=r.elementType,f=c._init;if(c=f(c._payload),r.type=c,typeof c=="function")Ph(c)?(n=vi(c,n),r.tag=1,r=i0(null,r,c,n,i)):(r.tag=0,r=_f(null,r,c,n,i));else{if(c!=null){if(f=c.$$typeof,f===ce){r.tag=11,r=e0(null,r,c,n,i);break e}else if(f===O){r.tag=14,r=t0(null,r,c,n,i);break e}}throw r=we(c)||c,Error(a(306,r,""))}}return r;case 0:return _f(n,r,r.type,r.pendingProps,i);case 1:return c=r.type,f=vi(c,r.pendingProps),i0(n,r,c,f,i);case 3:e:{if(We(r,r.stateNode.containerInfo),n===null)throw Error(a(387));c=r.pendingProps;var g=r.memoizedState;f=g.element,Xh(n,r),Nl(r,c,null,i);var T=r.memoizedState;if(c=T.cache,is(r,Sn,c),c!==g.cache&&Fh(r,[Sn],i,!0),Al(),c=T.element,g.isDehydrated)if(g={element:c,isDehydrated:!1,cache:T.cache},r.updateQueue.baseState=g,r.memoizedState=g,r.flags&256){r=o0(n,r,c,i);break e}else if(c!==f){f=Sr(Error(a(424)),r),bl(f),r=o0(n,r,c,i);break e}else{switch(n=r.stateNode.containerInfo,n.nodeType){case 9:n=n.body;break;default:n=n.nodeName==="HTML"?n.ownerDocument.body:n}for(rn=Lr(n.firstChild),nr=r,wt=!0,hi=null,sa=!0,i=Hy(r,null,c,i),r.child=i;i;)i.flags=i.flags&-3|4096,i=i.sibling}else{if(xl(),c===f){r=za(n,r,i);break e}Bn(n,r,c,i)}r=r.child}return r;case 26:return Vu(n,r),n===null?(i=gv(r.type,null,r.pendingProps,null))?r.memoizedState=i:wt||(i=r.type,n=r.pendingProps,c=Wu(be.current).createElement(i),c[ye]=r,c[Ae]=n,Hn(c,i,n),Ut(c),r.stateNode=c):r.memoizedState=gv(r.type,n.memoizedProps,r.pendingProps,n.memoizedState),null;case 27:return Re(r),n===null&&wt&&(c=r.stateNode=hv(r.type,r.pendingProps,be.current),nr=r,sa=!0,f=rn,_s(r.type)?(lm=f,rn=Lr(c.firstChild)):rn=f),Bn(n,r,r.pendingProps.children,i),Vu(n,r),n===null&&(r.flags|=4194304),r.child;case 5:return n===null&&wt&&((f=c=rn)&&(c=Ok(c,r.type,r.pendingProps,sa),c!==null?(r.stateNode=c,nr=r,rn=Lr(c.firstChild),sa=!1,f=!0):f=!1),f||fi(r)),Re(r),f=r.type,g=r.pendingProps,T=n!==null?n.memoizedProps:null,c=g.children,am(f,g)?c=null:T!==null&&am(f,T)&&(r.flags|=32),r.memoizedState!==null&&(f=nf(n,r,J1,null,null,i),Xl._currentValue=f),Vu(n,r),Bn(n,r,c,i),r.child;case 6:return n===null&&wt&&((n=i=rn)&&(i=Pk(i,r.pendingProps,sa),i!==null?(r.stateNode=i,nr=r,rn=null,n=!0):n=!1),n||fi(r)),null;case 13:return l0(n,r,i);case 4:return We(r,r.stateNode.containerInfo),c=r.pendingProps,n===null?r.child=fo(r,null,c,i):Bn(n,r,c,i),r.child;case 11:return e0(n,r,r.type,r.pendingProps,i);case 7:return Bn(n,r,r.pendingProps,i),r.child;case 8:return Bn(n,r,r.pendingProps.children,i),r.child;case 12:return Bn(n,r,r.pendingProps.children,i),r.child;case 10:return c=r.pendingProps,is(r,r.type,c.value),Bn(n,r,c.children,i),r.child;case 9:return f=r.type._context,c=r.pendingProps.children,gi(r),f=Yn(f),c=c(f),r.flags|=1,Bn(n,r,c,i),r.child;case 14:return t0(n,r,r.type,r.pendingProps,i);case 15:return n0(n,r,r.type,r.pendingProps,i);case 19:return u0(n,r,i);case 31:return c=r.pendingProps,i=r.mode,c={mode:c.mode,children:c.children},n===null?(i=zu(c,i),i.ref=r.ref,r.child=i,i.return=r,r=i):(i=Ia(n.child,c),i.ref=r.ref,r.child=i,i.return=r,r=i),r;case 22:return r0(n,r,i);case 24:return gi(r),c=Yn(Sn),n===null?(f=Kh(),f===null&&(f=Ht,g=qh(),f.pooledCache=g,g.refCount++,g!==null&&(f.pooledCacheLanes|=i),f=g),r.memoizedState={parent:c,cache:f},Qh(r),is(r,Sn,f)):((n.lanes&i)!==0&&(Xh(n,r),Nl(r,null,null,i),Al()),f=n.memoizedState,g=r.memoizedState,f.parent!==c?(f={parent:c,cache:c},r.memoizedState=f,r.lanes===0&&(r.memoizedState=r.updateQueue.baseState=f),is(r,Sn,c)):(c=g.cache,is(r,Sn,c),c!==f.cache&&Fh(r,[Sn],i,!0))),Bn(n,r,r.pendingProps.children,i),r.child;case 29:throw r.pendingProps}throw Error(a(156,r.tag))}function La(n){n.flags|=4}function h0(n,r){if(r.type!=="stylesheet"||(r.state.loading&4)!==0)n.flags&=-16777217;else if(n.flags|=16777216,!bv(r)){if(r=Rr.current,r!==null&&((bt&4194048)===bt?ia!==null:(bt&62914560)!==bt&&(bt&536870912)===0||r!==ia))throw Sl=Yh,Qp;n.flags|=8192}}function Lu(n,r){r!==null&&(n.flags|=4),n.flags&16384&&(r=n.tag!==22?pe():536870912,n.lanes|=r,yo|=r)}function Ol(n,r){if(!wt)switch(n.tailMode){case"hidden":r=n.tail;for(var i=null;r!==null;)r.alternate!==null&&(i=r),r=r.sibling;i===null?n.tail=null:i.sibling=null;break;case"collapsed":i=n.tail;for(var c=null;i!==null;)i.alternate!==null&&(c=i),i=i.sibling;c===null?r||n.tail===null?n.tail=null:n.tail.sibling=null:c.sibling=null}}function en(n){var r=n.alternate!==null&&n.alternate.child===n.child,i=0,c=0;if(r)for(var f=n.child;f!==null;)i|=f.lanes|f.childLanes,c|=f.subtreeFlags&65011712,c|=f.flags&65011712,f.return=n,f=f.sibling;else for(f=n.child;f!==null;)i|=f.lanes|f.childLanes,c|=f.subtreeFlags,c|=f.flags,f.return=n,f=f.sibling;return n.subtreeFlags|=c,n.childLanes=i,r}function lk(n,r,i){var c=r.pendingProps;switch(Uh(r),r.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return en(r),null;case 1:return en(r),null;case 3:return i=r.stateNode,c=null,n!==null&&(c=n.memoizedState.cache),r.memoizedState.cache!==c&&(r.flags|=2048),Oa(Sn),st(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(n===null||n.child===null)&&(vl(r)?La(r):n===null||n.memoizedState.isDehydrated&&(r.flags&256)===0||(r.flags|=1024,Fp())),en(r),null;case 26:return i=r.memoizedState,n===null?(La(r),i!==null?(en(r),h0(r,i)):(en(r),r.flags&=-16777217)):i?i!==n.memoizedState?(La(r),en(r),h0(r,i)):(en(r),r.flags&=-16777217):(n.memoizedProps!==c&&La(r),en(r),r.flags&=-16777217),null;case 27:Me(r),i=be.current;var f=r.type;if(n!==null&&r.stateNode!=null)n.memoizedProps!==c&&La(r);else{if(!c){if(r.stateNode===null)throw Error(a(166));return en(r),null}n=oe.current,vl(r)?Gp(r):(n=hv(f,c,i),r.stateNode=n,La(r))}return en(r),null;case 5:if(Me(r),i=r.type,n!==null&&r.stateNode!=null)n.memoizedProps!==c&&La(r);else{if(!c){if(r.stateNode===null)throw Error(a(166));return en(r),null}if(n=oe.current,vl(r))Gp(r);else{switch(f=Wu(be.current),n){case 1:n=f.createElementNS("http://www.w3.org/2000/svg",i);break;case 2:n=f.createElementNS("http://www.w3.org/1998/Math/MathML",i);break;default:switch(i){case"svg":n=f.createElementNS("http://www.w3.org/2000/svg",i);break;case"math":n=f.createElementNS("http://www.w3.org/1998/Math/MathML",i);break;case"script":n=f.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild);break;case"select":n=typeof c.is=="string"?f.createElement("select",{is:c.is}):f.createElement("select"),c.multiple?n.multiple=!0:c.size&&(n.size=c.size);break;default:n=typeof c.is=="string"?f.createElement(i,{is:c.is}):f.createElement(i)}}n[ye]=r,n[Ae]=c;e:for(f=r.child;f!==null;){if(f.tag===5||f.tag===6)n.appendChild(f.stateNode);else if(f.tag!==4&&f.tag!==27&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===r)break e;for(;f.sibling===null;){if(f.return===null||f.return===r)break e;f=f.return}f.sibling.return=f.return,f=f.sibling}r.stateNode=n;e:switch(Hn(n,i,c),i){case"button":case"input":case"select":case"textarea":n=!!c.autoFocus;break e;case"img":n=!0;break e;default:n=!1}n&&La(r)}}return en(r),r.flags&=-16777217,null;case 6:if(n&&r.stateNode!=null)n.memoizedProps!==c&&La(r);else{if(typeof c!="string"&&r.stateNode===null)throw Error(a(166));if(n=be.current,vl(r)){if(n=r.stateNode,i=r.memoizedProps,c=null,f=nr,f!==null)switch(f.tag){case 27:case 5:c=f.memoizedProps}n[ye]=r,n=!!(n.nodeValue===i||c!==null&&c.suppressHydrationWarning===!0||sv(n.nodeValue,i)),n||fi(r)}else n=Wu(n).createTextNode(c),n[ye]=r,r.stateNode=n}return en(r),null;case 13:if(c=r.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(f=vl(r),c!==null&&c.dehydrated!==null){if(n===null){if(!f)throw Error(a(318));if(f=r.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(a(317));f[ye]=r}else xl(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;en(r),f=!1}else f=Fp(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=f),f=!0;if(!f)return r.flags&256?(Va(r),r):(Va(r),null)}if(Va(r),(r.flags&128)!==0)return r.lanes=i,r;if(i=c!==null,n=n!==null&&n.memoizedState!==null,i){c=r.child,f=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(f=c.alternate.memoizedState.cachePool.pool);var g=null;c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(g=c.memoizedState.cachePool.pool),g!==f&&(c.flags|=2048)}return i!==n&&i&&(r.child.flags|=8192),Lu(r,r.updateQueue),en(r),null;case 4:return st(),n===null&&Jf(r.stateNode.containerInfo),en(r),null;case 10:return Oa(r.type),en(r),null;case 19:if(H(wn),f=r.memoizedState,f===null)return en(r),null;if(c=(r.flags&128)!==0,g=f.rendering,g===null)if(c)Ol(f,!1);else{if(an!==0||n!==null&&(n.flags&128)!==0)for(n=r.child;n!==null;){if(g=Mu(n),g!==null){for(r.flags|=128,Ol(f,!1),n=g.updateQueue,r.updateQueue=n,Lu(r,n),r.subtreeFlags=0,n=i,i=r.child;i!==null;)Up(i,n),i=i.sibling;return Y(wn,wn.current&1|2),r.child}n=n.sibling}f.tail!==null&&$e()>Gu&&(r.flags|=128,c=!0,Ol(f,!1),r.lanes=4194304)}else{if(!c)if(n=Mu(g),n!==null){if(r.flags|=128,c=!0,n=n.updateQueue,r.updateQueue=n,Lu(r,n),Ol(f,!0),f.tail===null&&f.tailMode==="hidden"&&!g.alternate&&!wt)return en(r),null}else 2*$e()-f.renderingStartTime>Gu&&i!==536870912&&(r.flags|=128,c=!0,Ol(f,!1),r.lanes=4194304);f.isBackwards?(g.sibling=r.child,r.child=g):(n=f.last,n!==null?n.sibling=g:r.child=g,f.last=g)}return f.tail!==null?(r=f.tail,f.rendering=r,f.tail=r.sibling,f.renderingStartTime=$e(),r.sibling=null,n=wn.current,Y(wn,c?n&1|2:n&1),r):(en(r),null);case 22:case 23:return Va(r),ef(),c=r.memoizedState!==null,n!==null?n.memoizedState!==null!==c&&(r.flags|=8192):c&&(r.flags|=8192),c?(i&536870912)!==0&&(r.flags&128)===0&&(en(r),r.subtreeFlags&6&&(r.flags|=8192)):en(r),i=r.updateQueue,i!==null&&Lu(r,i.retryQueue),i=null,n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(i=n.memoizedState.cachePool.pool),c=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(c=r.memoizedState.cachePool.pool),c!==i&&(r.flags|=2048),n!==null&&H(pi),null;case 24:return i=null,n!==null&&(i=n.memoizedState.cache),r.memoizedState.cache!==i&&(r.flags|=2048),Oa(Sn),en(r),null;case 25:return null;case 30:return null}throw Error(a(156,r.tag))}function ck(n,r){switch(Uh(r),r.tag){case 1:return n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 3:return Oa(Sn),st(),n=r.flags,(n&65536)!==0&&(n&128)===0?(r.flags=n&-65537|128,r):null;case 26:case 27:case 5:return Me(r),null;case 13:if(Va(r),n=r.memoizedState,n!==null&&n.dehydrated!==null){if(r.alternate===null)throw Error(a(340));xl()}return n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 19:return H(wn),null;case 4:return st(),null;case 10:return Oa(r.type),null;case 22:case 23:return Va(r),ef(),n!==null&&H(pi),n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 24:return Oa(Sn),null;case 25:return null;default:return null}}function f0(n,r){switch(Uh(r),r.tag){case 3:Oa(Sn),st();break;case 26:case 27:case 5:Me(r);break;case 4:st();break;case 13:Va(r);break;case 19:H(wn);break;case 10:Oa(r.type);break;case 22:case 23:Va(r),ef(),n!==null&&H(pi);break;case 24:Oa(Sn)}}function Pl(n,r){try{var i=r.updateQueue,c=i!==null?i.lastEffect:null;if(c!==null){var f=c.next;i=f;do{if((i.tag&n)===n){c=void 0;var g=i.create,T=i.inst;c=g(),T.destroy=c}i=i.next}while(i!==f)}}catch(E){Bt(r,r.return,E)}}function fs(n,r,i){try{var c=r.updateQueue,f=c!==null?c.lastEffect:null;if(f!==null){var g=f.next;c=g;do{if((c.tag&n)===n){var T=c.inst,E=T.destroy;if(E!==void 0){T.destroy=void 0,f=r;var M=i,Q=E;try{Q()}catch(ae){Bt(f,M,ae)}}}c=c.next}while(c!==g)}}catch(ae){Bt(r,r.return,ae)}}function m0(n){var r=n.updateQueue;if(r!==null){var i=n.stateNode;try{ty(r,i)}catch(c){Bt(n,n.return,c)}}}function g0(n,r,i){i.props=vi(n.type,n.memoizedProps),i.state=n.memoizedState;try{i.componentWillUnmount()}catch(c){Bt(n,r,c)}}function Vl(n,r){try{var i=n.ref;if(i!==null){switch(n.tag){case 26:case 27:case 5:var c=n.stateNode;break;case 30:c=n.stateNode;break;default:c=n.stateNode}typeof i=="function"?n.refCleanup=i(c):i.current=c}}catch(f){Bt(n,r,f)}}function oa(n,r){var i=n.ref,c=n.refCleanup;if(i!==null)if(typeof c=="function")try{c()}catch(f){Bt(n,r,f)}finally{n.refCleanup=null,n=n.alternate,n!=null&&(n.refCleanup=null)}else if(typeof i=="function")try{i(null)}catch(f){Bt(n,r,f)}else i.current=null}function p0(n){var r=n.type,i=n.memoizedProps,c=n.stateNode;try{e:switch(r){case"button":case"input":case"select":case"textarea":i.autoFocus&&c.focus();break e;case"img":i.src?c.src=i.src:i.srcSet&&(c.srcset=i.srcSet)}}catch(f){Bt(n,n.return,f)}}function Rf(n,r,i){try{var c=n.stateNode;Ck(c,n.type,i,r),c[Ae]=r}catch(f){Bt(n,n.return,f)}}function y0(n){return n.tag===5||n.tag===3||n.tag===26||n.tag===27&&_s(n.type)||n.tag===4}function Cf(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||y0(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.tag===27&&_s(n.type)||n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function If(n,r,i){var c=n.tag;if(c===5||c===6)n=n.stateNode,r?(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i).insertBefore(n,r):(r=i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,r.appendChild(n),i=i._reactRootContainer,i!=null||r.onclick!==null||(r.onclick=Zu));else if(c!==4&&(c===27&&_s(n.type)&&(i=n.stateNode,r=null),n=n.child,n!==null))for(If(n,r,i),n=n.sibling;n!==null;)If(n,r,i),n=n.sibling}function Uu(n,r,i){var c=n.tag;if(c===5||c===6)n=n.stateNode,r?i.insertBefore(n,r):i.appendChild(n);else if(c!==4&&(c===27&&_s(n.type)&&(i=n.stateNode),n=n.child,n!==null))for(Uu(n,r,i),n=n.sibling;n!==null;)Uu(n,r,i),n=n.sibling}function v0(n){var r=n.stateNode,i=n.memoizedProps;try{for(var c=n.type,f=r.attributes;f.length;)r.removeAttributeNode(f[0]);Hn(r,c,i),r[ye]=n,r[Ae]=i}catch(g){Bt(n,n.return,g)}}var Ua=!1,dn=!1,jf=!1,x0=typeof WeakSet=="function"?WeakSet:Set,Mn=null;function uk(n,r){if(n=n.containerInfo,nm=ad,n=Cp(n),Rh(n)){if("selectionStart"in n)var i={start:n.selectionStart,end:n.selectionEnd};else e:{i=(i=n.ownerDocument)&&i.defaultView||window;var c=i.getSelection&&i.getSelection();if(c&&c.rangeCount!==0){i=c.anchorNode;var f=c.anchorOffset,g=c.focusNode;c=c.focusOffset;try{i.nodeType,g.nodeType}catch{i=null;break e}var T=0,E=-1,M=-1,Q=0,ae=0,ue=n,W=null;t:for(;;){for(var J;ue!==i||f!==0&&ue.nodeType!==3||(E=T+f),ue!==g||c!==0&&ue.nodeType!==3||(M=T+c),ue.nodeType===3&&(T+=ue.nodeValue.length),(J=ue.firstChild)!==null;)W=ue,ue=J;for(;;){if(ue===n)break t;if(W===i&&++Q===f&&(E=T),W===g&&++ae===c&&(M=T),(J=ue.nextSibling)!==null)break;ue=W,W=ue.parentNode}ue=J}i=E===-1||M===-1?null:{start:E,end:M}}else i=null}i=i||{start:0,end:0}}else i=null;for(rm={focusedElem:n,selectionRange:i},ad=!1,Mn=r;Mn!==null;)if(r=Mn,n=r.child,(r.subtreeFlags&1024)!==0&&n!==null)n.return=r,Mn=n;else for(;Mn!==null;){switch(r=Mn,g=r.alternate,n=r.flags,r.tag){case 0:break;case 11:case 15:break;case 1:if((n&1024)!==0&&g!==null){n=void 0,i=r,f=g.memoizedProps,g=g.memoizedState,c=i.stateNode;try{var qe=vi(i.type,f,i.elementType===i.type);n=c.getSnapshotBeforeUpdate(qe,g),c.__reactInternalSnapshotBeforeUpdate=n}catch(Le){Bt(i,i.return,Le)}}break;case 3:if((n&1024)!==0){if(n=r.stateNode.containerInfo,i=n.nodeType,i===9)im(n);else if(i===1)switch(n.nodeName){case"HEAD":case"HTML":case"BODY":im(n);break;default:n.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((n&1024)!==0)throw Error(a(163))}if(n=r.sibling,n!==null){n.return=r.return,Mn=n;break}Mn=r.return}}function b0(n,r,i){var c=i.flags;switch(i.tag){case 0:case 11:case 15:ms(n,i),c&4&&Pl(5,i);break;case 1:if(ms(n,i),c&4)if(n=i.stateNode,r===null)try{n.componentDidMount()}catch(T){Bt(i,i.return,T)}else{var f=vi(i.type,r.memoizedProps);r=r.memoizedState;try{n.componentDidUpdate(f,r,n.__reactInternalSnapshotBeforeUpdate)}catch(T){Bt(i,i.return,T)}}c&64&&m0(i),c&512&&Vl(i,i.return);break;case 3:if(ms(n,i),c&64&&(n=i.updateQueue,n!==null)){if(r=null,i.child!==null)switch(i.child.tag){case 27:case 5:r=i.child.stateNode;break;case 1:r=i.child.stateNode}try{ty(n,r)}catch(T){Bt(i,i.return,T)}}break;case 27:r===null&&c&4&&v0(i);case 26:case 5:ms(n,i),r===null&&c&4&&p0(i),c&512&&Vl(i,i.return);break;case 12:ms(n,i);break;case 13:ms(n,i),c&4&&k0(n,i),c&64&&(n=i.memoizedState,n!==null&&(n=n.dehydrated,n!==null&&(i=xk.bind(null,i),Vk(n,i))));break;case 22:if(c=i.memoizedState!==null||Ua,!c){r=r!==null&&r.memoizedState!==null||dn,f=Ua;var g=dn;Ua=c,(dn=r)&&!g?gs(n,i,(i.subtreeFlags&8772)!==0):ms(n,i),Ua=f,dn=g}break;case 30:break;default:ms(n,i)}}function _0(n){var r=n.alternate;r!==null&&(n.alternate=null,_0(r)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(r=n.stateNode,r!==null&&on(r)),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}var Xt=null,or=!1;function Ba(n,r,i){for(i=i.child;i!==null;)T0(n,r,i),i=i.sibling}function T0(n,r,i){if(lt&&typeof lt.onCommitFiberUnmount=="function")try{lt.onCommitFiberUnmount(Je,i)}catch{}switch(i.tag){case 26:dn||oa(i,r),Ba(n,r,i),i.memoizedState?i.memoizedState.count--:i.stateNode&&(i=i.stateNode,i.parentNode.removeChild(i));break;case 27:dn||oa(i,r);var c=Xt,f=or;_s(i.type)&&(Xt=i.stateNode,or=!1),Ba(n,r,i),$l(i.stateNode),Xt=c,or=f;break;case 5:dn||oa(i,r);case 6:if(c=Xt,f=or,Xt=null,Ba(n,r,i),Xt=c,or=f,Xt!==null)if(or)try{(Xt.nodeType===9?Xt.body:Xt.nodeName==="HTML"?Xt.ownerDocument.body:Xt).removeChild(i.stateNode)}catch(g){Bt(i,r,g)}else try{Xt.removeChild(i.stateNode)}catch(g){Bt(i,r,g)}break;case 18:Xt!==null&&(or?(n=Xt,uv(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,i.stateNode),ec(n)):uv(Xt,i.stateNode));break;case 4:c=Xt,f=or,Xt=i.stateNode.containerInfo,or=!0,Ba(n,r,i),Xt=c,or=f;break;case 0:case 11:case 14:case 15:dn||fs(2,i,r),dn||fs(4,i,r),Ba(n,r,i);break;case 1:dn||(oa(i,r),c=i.stateNode,typeof c.componentWillUnmount=="function"&&g0(i,r,c)),Ba(n,r,i);break;case 21:Ba(n,r,i);break;case 22:dn=(c=dn)||i.memoizedState!==null,Ba(n,r,i),dn=c;break;default:Ba(n,r,i)}}function k0(n,r){if(r.memoizedState===null&&(n=r.alternate,n!==null&&(n=n.memoizedState,n!==null&&(n=n.dehydrated,n!==null))))try{ec(n)}catch(i){Bt(r,r.return,i)}}function dk(n){switch(n.tag){case 13:case 19:var r=n.stateNode;return r===null&&(r=n.stateNode=new x0),r;case 22:return n=n.stateNode,r=n._retryCache,r===null&&(r=n._retryCache=new x0),r;default:throw Error(a(435,n.tag))}}function Df(n,r){var i=dk(n);r.forEach(function(c){var f=bk.bind(null,n,c);i.has(c)||(i.add(c),c.then(f,f))})}function gr(n,r){var i=r.deletions;if(i!==null)for(var c=0;c<i.length;c++){var f=i[c],g=n,T=r,E=T;e:for(;E!==null;){switch(E.tag){case 27:if(_s(E.type)){Xt=E.stateNode,or=!1;break e}break;case 5:Xt=E.stateNode,or=!1;break e;case 3:case 4:Xt=E.stateNode.containerInfo,or=!0;break e}E=E.return}if(Xt===null)throw Error(a(160));T0(g,T,f),Xt=null,or=!1,g=f.alternate,g!==null&&(g.return=null),f.return=null}if(r.subtreeFlags&13878)for(r=r.child;r!==null;)E0(r,n),r=r.sibling}var zr=null;function E0(n,r){var i=n.alternate,c=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:gr(r,n),pr(n),c&4&&(fs(3,n,n.return),Pl(3,n),fs(5,n,n.return));break;case 1:gr(r,n),pr(n),c&512&&(dn||i===null||oa(i,i.return)),c&64&&Ua&&(n=n.updateQueue,n!==null&&(c=n.callbacks,c!==null&&(i=n.shared.hiddenCallbacks,n.shared.hiddenCallbacks=i===null?c:i.concat(c))));break;case 26:var f=zr;if(gr(r,n),pr(n),c&512&&(dn||i===null||oa(i,i.return)),c&4){var g=i!==null?i.memoizedState:null;if(c=n.memoizedState,i===null)if(c===null)if(n.stateNode===null){e:{c=n.type,i=n.memoizedProps,f=f.ownerDocument||f;t:switch(c){case"title":g=f.getElementsByTagName("title")[0],(!g||g[_n]||g[ye]||g.namespaceURI==="http://www.w3.org/2000/svg"||g.hasAttribute("itemprop"))&&(g=f.createElement(c),f.head.insertBefore(g,f.querySelector("head > title"))),Hn(g,c,i),g[ye]=n,Ut(g),c=g;break e;case"link":var T=vv("link","href",f).get(c+(i.href||""));if(T){for(var E=0;E<T.length;E++)if(g=T[E],g.getAttribute("href")===(i.href==null||i.href===""?null:i.href)&&g.getAttribute("rel")===(i.rel==null?null:i.rel)&&g.getAttribute("title")===(i.title==null?null:i.title)&&g.getAttribute("crossorigin")===(i.crossOrigin==null?null:i.crossOrigin)){T.splice(E,1);break t}}g=f.createElement(c),Hn(g,c,i),f.head.appendChild(g);break;case"meta":if(T=vv("meta","content",f).get(c+(i.content||""))){for(E=0;E<T.length;E++)if(g=T[E],g.getAttribute("content")===(i.content==null?null:""+i.content)&&g.getAttribute("name")===(i.name==null?null:i.name)&&g.getAttribute("property")===(i.property==null?null:i.property)&&g.getAttribute("http-equiv")===(i.httpEquiv==null?null:i.httpEquiv)&&g.getAttribute("charset")===(i.charSet==null?null:i.charSet)){T.splice(E,1);break t}}g=f.createElement(c),Hn(g,c,i),f.head.appendChild(g);break;default:throw Error(a(468,c))}g[ye]=n,Ut(g),c=g}n.stateNode=c}else xv(f,n.type,n.stateNode);else n.stateNode=yv(f,c,n.memoizedProps);else g!==c?(g===null?i.stateNode!==null&&(i=i.stateNode,i.parentNode.removeChild(i)):g.count--,c===null?xv(f,n.type,n.stateNode):yv(f,c,n.memoizedProps)):c===null&&n.stateNode!==null&&Rf(n,n.memoizedProps,i.memoizedProps)}break;case 27:gr(r,n),pr(n),c&512&&(dn||i===null||oa(i,i.return)),i!==null&&c&4&&Rf(n,n.memoizedProps,i.memoizedProps);break;case 5:if(gr(r,n),pr(n),c&512&&(dn||i===null||oa(i,i.return)),n.flags&32){f=n.stateNode;try{_r(f,"")}catch(J){Bt(n,n.return,J)}}c&4&&n.stateNode!=null&&(f=n.memoizedProps,Rf(n,f,i!==null?i.memoizedProps:f)),c&1024&&(jf=!0);break;case 6:if(gr(r,n),pr(n),c&4){if(n.stateNode===null)throw Error(a(162));c=n.memoizedProps,i=n.stateNode;try{i.nodeValue=c}catch(J){Bt(n,n.return,J)}}break;case 3:if(td=null,f=zr,zr=Ju(r.containerInfo),gr(r,n),zr=f,pr(n),c&4&&i!==null&&i.memoizedState.isDehydrated)try{ec(r.containerInfo)}catch(J){Bt(n,n.return,J)}jf&&(jf=!1,S0(n));break;case 4:c=zr,zr=Ju(n.stateNode.containerInfo),gr(r,n),pr(n),zr=c;break;case 12:gr(r,n),pr(n);break;case 13:gr(r,n),pr(n),n.child.flags&8192&&n.memoizedState!==null!=(i!==null&&i.memoizedState!==null)&&(Lf=$e()),c&4&&(c=n.updateQueue,c!==null&&(n.updateQueue=null,Df(n,c)));break;case 22:f=n.memoizedState!==null;var M=i!==null&&i.memoizedState!==null,Q=Ua,ae=dn;if(Ua=Q||f,dn=ae||M,gr(r,n),dn=ae,Ua=Q,pr(n),c&8192)e:for(r=n.stateNode,r._visibility=f?r._visibility&-2:r._visibility|1,f&&(i===null||M||Ua||dn||xi(n)),i=null,r=n;;){if(r.tag===5||r.tag===26){if(i===null){M=i=r;try{if(g=M.stateNode,f)T=g.style,typeof T.setProperty=="function"?T.setProperty("display","none","important"):T.display="none";else{E=M.stateNode;var ue=M.memoizedProps.style,W=ue!=null&&ue.hasOwnProperty("display")?ue.display:null;E.style.display=W==null||typeof W=="boolean"?"":(""+W).trim()}}catch(J){Bt(M,M.return,J)}}}else if(r.tag===6){if(i===null){M=r;try{M.stateNode.nodeValue=f?"":M.memoizedProps}catch(J){Bt(M,M.return,J)}}}else if((r.tag!==22&&r.tag!==23||r.memoizedState===null||r===n)&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===n)break e;for(;r.sibling===null;){if(r.return===null||r.return===n)break e;i===r&&(i=null),r=r.return}i===r&&(i=null),r.sibling.return=r.return,r=r.sibling}c&4&&(c=n.updateQueue,c!==null&&(i=c.retryQueue,i!==null&&(c.retryQueue=null,Df(n,i))));break;case 19:gr(r,n),pr(n),c&4&&(c=n.updateQueue,c!==null&&(n.updateQueue=null,Df(n,c)));break;case 30:break;case 21:break;default:gr(r,n),pr(n)}}function pr(n){var r=n.flags;if(r&2){try{for(var i,c=n.return;c!==null;){if(y0(c)){i=c;break}c=c.return}if(i==null)throw Error(a(160));switch(i.tag){case 27:var f=i.stateNode,g=Cf(n);Uu(n,g,f);break;case 5:var T=i.stateNode;i.flags&32&&(_r(T,""),i.flags&=-33);var E=Cf(n);Uu(n,E,T);break;case 3:case 4:var M=i.stateNode.containerInfo,Q=Cf(n);If(n,Q,M);break;default:throw Error(a(161))}}catch(ae){Bt(n,n.return,ae)}n.flags&=-3}r&4096&&(n.flags&=-4097)}function S0(n){if(n.subtreeFlags&1024)for(n=n.child;n!==null;){var r=n;S0(r),r.tag===5&&r.flags&1024&&r.stateNode.reset(),n=n.sibling}}function ms(n,r){if(r.subtreeFlags&8772)for(r=r.child;r!==null;)b0(n,r.alternate,r),r=r.sibling}function xi(n){for(n=n.child;n!==null;){var r=n;switch(r.tag){case 0:case 11:case 14:case 15:fs(4,r,r.return),xi(r);break;case 1:oa(r,r.return);var i=r.stateNode;typeof i.componentWillUnmount=="function"&&g0(r,r.return,i),xi(r);break;case 27:$l(r.stateNode);case 26:case 5:oa(r,r.return),xi(r);break;case 22:r.memoizedState===null&&xi(r);break;case 30:xi(r);break;default:xi(r)}n=n.sibling}}function gs(n,r,i){for(i=i&&(r.subtreeFlags&8772)!==0,r=r.child;r!==null;){var c=r.alternate,f=n,g=r,T=g.flags;switch(g.tag){case 0:case 11:case 15:gs(f,g,i),Pl(4,g);break;case 1:if(gs(f,g,i),c=g,f=c.stateNode,typeof f.componentDidMount=="function")try{f.componentDidMount()}catch(Q){Bt(c,c.return,Q)}if(c=g,f=c.updateQueue,f!==null){var E=c.stateNode;try{var M=f.shared.hiddenCallbacks;if(M!==null)for(f.shared.hiddenCallbacks=null,f=0;f<M.length;f++)ey(M[f],E)}catch(Q){Bt(c,c.return,Q)}}i&&T&64&&m0(g),Vl(g,g.return);break;case 27:v0(g);case 26:case 5:gs(f,g,i),i&&c===null&&T&4&&p0(g),Vl(g,g.return);break;case 12:gs(f,g,i);break;case 13:gs(f,g,i),i&&T&4&&k0(f,g);break;case 22:g.memoizedState===null&&gs(f,g,i),Vl(g,g.return);break;case 30:break;default:gs(f,g,i)}r=r.sibling}}function Mf(n,r){var i=null;n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(i=n.memoizedState.cachePool.pool),n=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(n=r.memoizedState.cachePool.pool),n!==i&&(n!=null&&n.refCount++,i!=null&&Tl(i))}function Of(n,r){n=null,r.alternate!==null&&(n=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==n&&(r.refCount++,n!=null&&Tl(n))}function la(n,r,i,c){if(r.subtreeFlags&10256)for(r=r.child;r!==null;)w0(n,r,i,c),r=r.sibling}function w0(n,r,i,c){var f=r.flags;switch(r.tag){case 0:case 11:case 15:la(n,r,i,c),f&2048&&Pl(9,r);break;case 1:la(n,r,i,c);break;case 3:la(n,r,i,c),f&2048&&(n=null,r.alternate!==null&&(n=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==n&&(r.refCount++,n!=null&&Tl(n)));break;case 12:if(f&2048){la(n,r,i,c),n=r.stateNode;try{var g=r.memoizedProps,T=g.id,E=g.onPostCommit;typeof E=="function"&&E(T,r.alternate===null?"mount":"update",n.passiveEffectDuration,-0)}catch(M){Bt(r,r.return,M)}}else la(n,r,i,c);break;case 13:la(n,r,i,c);break;case 23:break;case 22:g=r.stateNode,T=r.alternate,r.memoizedState!==null?g._visibility&2?la(n,r,i,c):zl(n,r):g._visibility&2?la(n,r,i,c):(g._visibility|=2,mo(n,r,i,c,(r.subtreeFlags&10256)!==0)),f&2048&&Mf(T,r);break;case 24:la(n,r,i,c),f&2048&&Of(r.alternate,r);break;default:la(n,r,i,c)}}function mo(n,r,i,c,f){for(f=f&&(r.subtreeFlags&10256)!==0,r=r.child;r!==null;){var g=n,T=r,E=i,M=c,Q=T.flags;switch(T.tag){case 0:case 11:case 15:mo(g,T,E,M,f),Pl(8,T);break;case 23:break;case 22:var ae=T.stateNode;T.memoizedState!==null?ae._visibility&2?mo(g,T,E,M,f):zl(g,T):(ae._visibility|=2,mo(g,T,E,M,f)),f&&Q&2048&&Mf(T.alternate,T);break;case 24:mo(g,T,E,M,f),f&&Q&2048&&Of(T.alternate,T);break;default:mo(g,T,E,M,f)}r=r.sibling}}function zl(n,r){if(r.subtreeFlags&10256)for(r=r.child;r!==null;){var i=n,c=r,f=c.flags;switch(c.tag){case 22:zl(i,c),f&2048&&Mf(c.alternate,c);break;case 24:zl(i,c),f&2048&&Of(c.alternate,c);break;default:zl(i,c)}r=r.sibling}}var Ll=8192;function go(n){if(n.subtreeFlags&Ll)for(n=n.child;n!==null;)A0(n),n=n.sibling}function A0(n){switch(n.tag){case 26:go(n),n.flags&Ll&&n.memoizedState!==null&&Xk(zr,n.memoizedState,n.memoizedProps);break;case 5:go(n);break;case 3:case 4:var r=zr;zr=Ju(n.stateNode.containerInfo),go(n),zr=r;break;case 22:n.memoizedState===null&&(r=n.alternate,r!==null&&r.memoizedState!==null?(r=Ll,Ll=16777216,go(n),Ll=r):go(n));break;default:go(n)}}function N0(n){var r=n.alternate;if(r!==null&&(n=r.child,n!==null)){r.child=null;do r=n.sibling,n.sibling=null,n=r;while(n!==null)}}function Ul(n){var r=n.deletions;if((n.flags&16)!==0){if(r!==null)for(var i=0;i<r.length;i++){var c=r[i];Mn=c,C0(c,n)}N0(n)}if(n.subtreeFlags&10256)for(n=n.child;n!==null;)R0(n),n=n.sibling}function R0(n){switch(n.tag){case 0:case 11:case 15:Ul(n),n.flags&2048&&fs(9,n,n.return);break;case 3:Ul(n);break;case 12:Ul(n);break;case 22:var r=n.stateNode;n.memoizedState!==null&&r._visibility&2&&(n.return===null||n.return.tag!==13)?(r._visibility&=-3,Bu(n)):Ul(n);break;default:Ul(n)}}function Bu(n){var r=n.deletions;if((n.flags&16)!==0){if(r!==null)for(var i=0;i<r.length;i++){var c=r[i];Mn=c,C0(c,n)}N0(n)}for(n=n.child;n!==null;){switch(r=n,r.tag){case 0:case 11:case 15:fs(8,r,r.return),Bu(r);break;case 22:i=r.stateNode,i._visibility&2&&(i._visibility&=-3,Bu(r));break;default:Bu(r)}n=n.sibling}}function C0(n,r){for(;Mn!==null;){var i=Mn;switch(i.tag){case 0:case 11:case 15:fs(8,i,r);break;case 23:case 22:if(i.memoizedState!==null&&i.memoizedState.cachePool!==null){var c=i.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:Tl(i.memoizedState.cache)}if(c=i.child,c!==null)c.return=i,Mn=c;else e:for(i=n;Mn!==null;){c=Mn;var f=c.sibling,g=c.return;if(_0(c),c===i){Mn=null;break e}if(f!==null){f.return=g,Mn=f;break e}Mn=g}}}var hk={getCacheForType:function(n){var r=Yn(Sn),i=r.data.get(n);return i===void 0&&(i=n(),r.data.set(n,i)),i}},fk=typeof WeakMap=="function"?WeakMap:Map,Ct=0,Ht=null,ht=null,bt=0,It=0,yr=null,ps=!1,po=!1,Pf=!1,Ga=0,an=0,ys=0,bi=0,Vf=0,Cr=0,yo=0,Bl=null,lr=null,zf=!1,Lf=0,Gu=1/0,Hu=null,vs=null,Gn=0,xs=null,vo=null,xo=0,Uf=0,Bf=null,I0=null,Gl=0,Gf=null;function vr(){if((Ct&2)!==0&&bt!==0)return bt&-bt;if(q.T!==null){var n=so;return n!==0?n:Qf()}return Ie()}function j0(){Cr===0&&(Cr=(bt&536870912)===0||wt?Dt():536870912);var n=Rr.current;return n!==null&&(n.flags|=32),Cr}function xr(n,r,i){(n===Ht&&(It===2||It===9)||n.cancelPendingCommit!==null)&&(bo(n,0),bs(n,bt,Cr,!1)),Ne(n,i),((Ct&2)===0||n!==Ht)&&(n===Ht&&((Ct&2)===0&&(bi|=i),an===4&&bs(n,bt,Cr,!1)),ca(n))}function D0(n,r,i){if((Ct&6)!==0)throw Error(a(327));var c=!i&&(r&124)===0&&(r&n.expiredLanes)===0||Fe(n,r),f=c?pk(n,r):qf(n,r,!0),g=c;do{if(f===0){po&&!c&&bs(n,r,0,!1);break}else{if(i=n.current.alternate,g&&!mk(i)){f=qf(n,r,!1),g=!1;continue}if(f===2){if(g=r,n.errorRecoveryDisabledLanes&g)var T=0;else T=n.pendingLanes&-536870913,T=T!==0?T:T&536870912?536870912:0;if(T!==0){r=T;e:{var E=n;f=Bl;var M=E.current.memoizedState.isDehydrated;if(M&&(bo(E,T).flags|=256),T=qf(E,T,!1),T!==2){if(Pf&&!M){E.errorRecoveryDisabledLanes|=g,bi|=g,f=4;break e}g=lr,lr=f,g!==null&&(lr===null?lr=g:lr.push.apply(lr,g))}f=T}if(g=!1,f!==2)continue}}if(f===1){bo(n,0),bs(n,r,0,!0);break}e:{switch(c=n,g=f,g){case 0:case 1:throw Error(a(345));case 4:if((r&4194048)!==r)break;case 6:bs(c,r,Cr,!ps);break e;case 2:lr=null;break;case 3:case 5:break;default:throw Error(a(329))}if((r&62914560)===r&&(f=Lf+300-$e(),10<f)){if(bs(c,r,Cr,!ps),Pe(c,0,!0)!==0)break e;c.timeoutHandle=lv(M0.bind(null,c,i,lr,Hu,zf,r,Cr,bi,yo,ps,g,2,-0,0),f);break e}M0(c,i,lr,Hu,zf,r,Cr,bi,yo,ps,g,0,-0,0)}}break}while(!0);ca(n)}function M0(n,r,i,c,f,g,T,E,M,Q,ae,ue,W,J){if(n.timeoutHandle=-1,ue=r.subtreeFlags,(ue&8192||(ue&16785408)===16785408)&&(Ql={stylesheets:null,count:0,unsuspend:Qk},A0(r),ue=Zk(),ue!==null)){n.cancelPendingCommit=ue(B0.bind(null,n,r,g,i,c,f,T,E,M,ae,1,W,J)),bs(n,g,T,!Q);return}B0(n,r,g,i,c,f,T,E,M)}function mk(n){for(var r=n;;){var i=r.tag;if((i===0||i===11||i===15)&&r.flags&16384&&(i=r.updateQueue,i!==null&&(i=i.stores,i!==null)))for(var c=0;c<i.length;c++){var f=i[c],g=f.getSnapshot;f=f.value;try{if(!fr(g(),f))return!1}catch{return!1}}if(i=r.child,r.subtreeFlags&16384&&i!==null)i.return=r,r=i;else{if(r===n)break;for(;r.sibling===null;){if(r.return===null||r.return===n)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function bs(n,r,i,c){r&=~Vf,r&=~bi,n.suspendedLanes|=r,n.pingedLanes&=~r,c&&(n.warmLanes|=r),c=n.expirationTimes;for(var f=r;0<f;){var g=31-Qt(f),T=1<<g;c[g]=-1,f&=~T}i!==0&&Ke(n,i,r)}function Fu(){return(Ct&6)===0?(Hl(0),!1):!0}function Hf(){if(ht!==null){if(It===0)var n=ht.return;else n=ht,Ma=mi=null,sf(n),ho=null,Dl=0,n=ht;for(;n!==null;)f0(n.alternate,n),n=n.return;ht=null}}function bo(n,r){var i=n.timeoutHandle;i!==-1&&(n.timeoutHandle=-1,jk(i)),i=n.cancelPendingCommit,i!==null&&(n.cancelPendingCommit=null,i()),Hf(),Ht=n,ht=i=Ia(n.current,null),bt=r,It=0,yr=null,ps=!1,po=Fe(n,r),Pf=!1,yo=Cr=Vf=bi=ys=an=0,lr=Bl=null,zf=!1,(r&8)!==0&&(r|=r&32);var c=n.entangledLanes;if(c!==0)for(n=n.entanglements,c&=r;0<c;){var f=31-Qt(c),g=1<<f;r|=n[f],c&=~g}return Ga=r,hu(),i}function O0(n,r){ot=null,q.H=Iu,r===El||r===_u?(r=Wp(),It=3):r===Qp?(r=Wp(),It=4):It=r===Jy?8:r!==null&&typeof r=="object"&&typeof r.then=="function"?6:1,yr=r,ht===null&&(an=1,Pu(n,Sr(r,n.current)))}function P0(){var n=q.H;return q.H=Iu,n===null?Iu:n}function V0(){var n=q.A;return q.A=hk,n}function Ff(){an=4,ps||(bt&4194048)!==bt&&Rr.current!==null||(po=!0),(ys&134217727)===0&&(bi&134217727)===0||Ht===null||bs(Ht,bt,Cr,!1)}function qf(n,r,i){var c=Ct;Ct|=2;var f=P0(),g=V0();(Ht!==n||bt!==r)&&(Hu=null,bo(n,r)),r=!1;var T=an;e:do try{if(It!==0&&ht!==null){var E=ht,M=yr;switch(It){case 8:Hf(),T=6;break e;case 3:case 2:case 9:case 6:Rr.current===null&&(r=!0);var Q=It;if(It=0,yr=null,_o(n,E,M,Q),i&&po){T=0;break e}break;default:Q=It,It=0,yr=null,_o(n,E,M,Q)}}gk(),T=an;break}catch(ae){O0(n,ae)}while(!0);return r&&n.shellSuspendCounter++,Ma=mi=null,Ct=c,q.H=f,q.A=g,ht===null&&(Ht=null,bt=0,hu()),T}function gk(){for(;ht!==null;)z0(ht)}function pk(n,r){var i=Ct;Ct|=2;var c=P0(),f=V0();Ht!==n||bt!==r?(Hu=null,Gu=$e()+500,bo(n,r)):po=Fe(n,r);e:do try{if(It!==0&&ht!==null){r=ht;var g=yr;t:switch(It){case 1:It=0,yr=null,_o(n,r,g,1);break;case 2:case 9:if(Xp(g)){It=0,yr=null,L0(r);break}r=function(){It!==2&&It!==9||Ht!==n||(It=7),ca(n)},g.then(r,r);break e;case 3:It=7;break e;case 4:It=5;break e;case 7:Xp(g)?(It=0,yr=null,L0(r)):(It=0,yr=null,_o(n,r,g,7));break;case 5:var T=null;switch(ht.tag){case 26:T=ht.memoizedState;case 5:case 27:var E=ht;if(!T||bv(T)){It=0,yr=null;var M=E.sibling;if(M!==null)ht=M;else{var Q=E.return;Q!==null?(ht=Q,qu(Q)):ht=null}break t}}It=0,yr=null,_o(n,r,g,5);break;case 6:It=0,yr=null,_o(n,r,g,6);break;case 8:Hf(),an=6;break e;default:throw Error(a(462))}}yk();break}catch(ae){O0(n,ae)}while(!0);return Ma=mi=null,q.H=c,q.A=f,Ct=i,ht!==null?0:(Ht=null,bt=0,hu(),an)}function yk(){for(;ht!==null&&!jt();)z0(ht)}function z0(n){var r=d0(n.alternate,n,Ga);n.memoizedProps=n.pendingProps,r===null?qu(n):ht=r}function L0(n){var r=n,i=r.alternate;switch(r.tag){case 15:case 0:r=s0(i,r,r.pendingProps,r.type,void 0,bt);break;case 11:r=s0(i,r,r.pendingProps,r.type.render,r.ref,bt);break;case 5:sf(r);default:f0(i,r),r=ht=Up(r,Ga),r=d0(i,r,Ga)}n.memoizedProps=n.pendingProps,r===null?qu(n):ht=r}function _o(n,r,i,c){Ma=mi=null,sf(r),ho=null,Dl=0;var f=r.return;try{if(ik(n,f,r,i,bt)){an=1,Pu(n,Sr(i,n.current)),ht=null;return}}catch(g){if(f!==null)throw ht=f,g;an=1,Pu(n,Sr(i,n.current)),ht=null;return}r.flags&32768?(wt||c===1?n=!0:po||(bt&536870912)!==0?n=!1:(ps=n=!0,(c===2||c===9||c===3||c===6)&&(c=Rr.current,c!==null&&c.tag===13&&(c.flags|=16384))),U0(r,n)):qu(r)}function qu(n){var r=n;do{if((r.flags&32768)!==0){U0(r,ps);return}n=r.return;var i=lk(r.alternate,r,Ga);if(i!==null){ht=i;return}if(r=r.sibling,r!==null){ht=r;return}ht=r=n}while(r!==null);an===0&&(an=5)}function U0(n,r){do{var i=ck(n.alternate,n);if(i!==null){i.flags&=32767,ht=i;return}if(i=n.return,i!==null&&(i.flags|=32768,i.subtreeFlags=0,i.deletions=null),!r&&(n=n.sibling,n!==null)){ht=n;return}ht=n=i}while(n!==null);an=6,ht=null}function B0(n,r,i,c,f,g,T,E,M){n.cancelPendingCommit=null;do $u();while(Gn!==0);if((Ct&6)!==0)throw Error(a(327));if(r!==null){if(r===n.current)throw Error(a(177));if(g=r.lanes|r.childLanes,g|=Mh,De(n,i,g,T,E,M),n===Ht&&(ht=Ht=null,bt=0),vo=r,xs=n,xo=i,Uf=g,Bf=f,I0=c,(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?(n.callbackNode=null,n.callbackPriority=0,_k(Wt,function(){return $0(),null})):(n.callbackNode=null,n.callbackPriority=0),c=(r.flags&13878)!==0,(r.subtreeFlags&13878)!==0||c){c=q.T,q.T=null,f=he.p,he.p=2,T=Ct,Ct|=4;try{uk(n,r,i)}finally{Ct=T,he.p=f,q.T=c}}Gn=1,G0(),H0(),F0()}}function G0(){if(Gn===1){Gn=0;var n=xs,r=vo,i=(r.flags&13878)!==0;if((r.subtreeFlags&13878)!==0||i){i=q.T,q.T=null;var c=he.p;he.p=2;var f=Ct;Ct|=4;try{E0(r,n);var g=rm,T=Cp(n.containerInfo),E=g.focusedElem,M=g.selectionRange;if(T!==E&&E&&E.ownerDocument&&Rp(E.ownerDocument.documentElement,E)){if(M!==null&&Rh(E)){var Q=M.start,ae=M.end;if(ae===void 0&&(ae=Q),"selectionStart"in E)E.selectionStart=Q,E.selectionEnd=Math.min(ae,E.value.length);else{var ue=E.ownerDocument||document,W=ue&&ue.defaultView||window;if(W.getSelection){var J=W.getSelection(),qe=E.textContent.length,Le=Math.min(M.start,qe),Vt=M.end===void 0?Le:Math.min(M.end,qe);!J.extend&&Le>Vt&&(T=Vt,Vt=Le,Le=T);var U=Np(E,Le),z=Np(E,Vt);if(U&&z&&(J.rangeCount!==1||J.anchorNode!==U.node||J.anchorOffset!==U.offset||J.focusNode!==z.node||J.focusOffset!==z.offset)){var K=ue.createRange();K.setStart(U.node,U.offset),J.removeAllRanges(),Le>Vt?(J.addRange(K),J.extend(z.node,z.offset)):(K.setEnd(z.node,z.offset),J.addRange(K))}}}}for(ue=[],J=E;J=J.parentNode;)J.nodeType===1&&ue.push({element:J,left:J.scrollLeft,top:J.scrollTop});for(typeof E.focus=="function"&&E.focus(),E=0;E<ue.length;E++){var le=ue[E];le.element.scrollLeft=le.left,le.element.scrollTop=le.top}}ad=!!nm,rm=nm=null}finally{Ct=f,he.p=c,q.T=i}}n.current=r,Gn=2}}function H0(){if(Gn===2){Gn=0;var n=xs,r=vo,i=(r.flags&8772)!==0;if((r.subtreeFlags&8772)!==0||i){i=q.T,q.T=null;var c=he.p;he.p=2;var f=Ct;Ct|=4;try{b0(n,r.alternate,r)}finally{Ct=f,he.p=c,q.T=i}}Gn=3}}function F0(){if(Gn===4||Gn===3){Gn=0,rt();var n=xs,r=vo,i=xo,c=I0;(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?Gn=5:(Gn=0,vo=xs=null,q0(n,n.pendingLanes));var f=n.pendingLanes;if(f===0&&(vs=null),Te(i),r=r.stateNode,lt&&typeof lt.onCommitFiberRoot=="function")try{lt.onCommitFiberRoot(Je,r,void 0,(r.current.flags&128)===128)}catch{}if(c!==null){r=q.T,f=he.p,he.p=2,q.T=null;try{for(var g=n.onRecoverableError,T=0;T<c.length;T++){var E=c[T];g(E.value,{componentStack:E.stack})}}finally{q.T=r,he.p=f}}(xo&3)!==0&&$u(),ca(n),f=n.pendingLanes,(i&4194090)!==0&&(f&42)!==0?n===Gf?Gl++:(Gl=0,Gf=n):Gl=0,Hl(0)}}function q0(n,r){(n.pooledCacheLanes&=r)===0&&(r=n.pooledCache,r!=null&&(n.pooledCache=null,Tl(r)))}function $u(n){return G0(),H0(),F0(),$0()}function $0(){if(Gn!==5)return!1;var n=xs,r=Uf;Uf=0;var i=Te(xo),c=q.T,f=he.p;try{he.p=32>i?32:i,q.T=null,i=Bf,Bf=null;var g=xs,T=xo;if(Gn=0,vo=xs=null,xo=0,(Ct&6)!==0)throw Error(a(331));var E=Ct;if(Ct|=4,R0(g.current),w0(g,g.current,T,i),Ct=E,Hl(0,!1),lt&&typeof lt.onPostCommitFiberRoot=="function")try{lt.onPostCommitFiberRoot(Je,g)}catch{}return!0}finally{he.p=f,q.T=c,q0(n,r)}}function K0(n,r,i){r=Sr(i,r),r=bf(n.stateNode,r,2),n=cs(n,r,2),n!==null&&(Ne(n,2),ca(n))}function Bt(n,r,i){if(n.tag===3)K0(n,n,i);else for(;r!==null;){if(r.tag===3){K0(r,n,i);break}else if(r.tag===1){var c=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(vs===null||!vs.has(c))){n=Sr(i,n),i=Zy(2),c=cs(r,i,2),c!==null&&(Wy(i,c,r,n),Ne(c,2),ca(c));break}}r=r.return}}function $f(n,r,i){var c=n.pingCache;if(c===null){c=n.pingCache=new fk;var f=new Set;c.set(r,f)}else f=c.get(r),f===void 0&&(f=new Set,c.set(r,f));f.has(i)||(Pf=!0,f.add(i),n=vk.bind(null,n,r,i),r.then(n,n))}function vk(n,r,i){var c=n.pingCache;c!==null&&c.delete(r),n.pingedLanes|=n.suspendedLanes&i,n.warmLanes&=~i,Ht===n&&(bt&i)===i&&(an===4||an===3&&(bt&62914560)===bt&&300>$e()-Lf?(Ct&2)===0&&bo(n,0):Vf|=i,yo===bt&&(yo=0)),ca(n)}function Y0(n,r){r===0&&(r=pe()),n=to(n,r),n!==null&&(Ne(n,r),ca(n))}function xk(n){var r=n.memoizedState,i=0;r!==null&&(i=r.retryLane),Y0(n,i)}function bk(n,r){var i=0;switch(n.tag){case 13:var c=n.stateNode,f=n.memoizedState;f!==null&&(i=f.retryLane);break;case 19:c=n.stateNode;break;case 22:c=n.stateNode._retryCache;break;default:throw Error(a(314))}c!==null&&c.delete(r),Y0(n,i)}function _k(n,r){return St(n,r)}var Ku=null,To=null,Kf=!1,Yu=!1,Yf=!1,_i=0;function ca(n){n!==To&&n.next===null&&(To===null?Ku=To=n:To=To.next=n),Yu=!0,Kf||(Kf=!0,kk())}function Hl(n,r){if(!Yf&&Yu){Yf=!0;do for(var i=!1,c=Ku;c!==null;){if(n!==0){var f=c.pendingLanes;if(f===0)var g=0;else{var T=c.suspendedLanes,E=c.pingedLanes;g=(1<<31-Qt(42|n)+1)-1,g&=f&~(T&~E),g=g&201326741?g&201326741|1:g?g|2:0}g!==0&&(i=!0,W0(c,g))}else g=bt,g=Pe(c,c===Ht?g:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),(g&3)===0||Fe(c,g)||(i=!0,W0(c,g));c=c.next}while(i);Yf=!1}}function Tk(){Q0()}function Q0(){Yu=Kf=!1;var n=0;_i!==0&&(Ik()&&(n=_i),_i=0);for(var r=$e(),i=null,c=Ku;c!==null;){var f=c.next,g=X0(c,r);g===0?(c.next=null,i===null?Ku=f:i.next=f,f===null&&(To=i)):(i=c,(n!==0||(g&3)!==0)&&(Yu=!0)),c=f}Hl(n)}function X0(n,r){for(var i=n.suspendedLanes,c=n.pingedLanes,f=n.expirationTimes,g=n.pendingLanes&-62914561;0<g;){var T=31-Qt(g),E=1<<T,M=f[T];M===-1?((E&i)===0||(E&c)!==0)&&(f[T]=yt(E,r)):M<=r&&(n.expiredLanes|=E),g&=~E}if(r=Ht,i=bt,i=Pe(n,n===r?i:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),c=n.callbackNode,i===0||n===r&&(It===2||It===9)||n.cancelPendingCommit!==null)return c!==null&&c!==null&&Qe(c),n.callbackNode=null,n.callbackPriority=0;if((i&3)===0||Fe(n,i)){if(r=i&-i,r===n.callbackPriority)return r;switch(c!==null&&Qe(c),Te(i)){case 2:case 8:i=zt;break;case 32:i=Wt;break;case 268435456:i=Jt;break;default:i=Wt}return c=Z0.bind(null,n),i=St(i,c),n.callbackPriority=r,n.callbackNode=i,r}return c!==null&&c!==null&&Qe(c),n.callbackPriority=2,n.callbackNode=null,2}function Z0(n,r){if(Gn!==0&&Gn!==5)return n.callbackNode=null,n.callbackPriority=0,null;var i=n.callbackNode;if($u()&&n.callbackNode!==i)return null;var c=bt;return c=Pe(n,n===Ht?c:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),c===0?null:(D0(n,c,r),X0(n,$e()),n.callbackNode!=null&&n.callbackNode===i?Z0.bind(null,n):null)}function W0(n,r){if($u())return null;D0(n,r,!0)}function kk(){Dk(function(){(Ct&6)!==0?St(at,Tk):Q0()})}function Qf(){return _i===0&&(_i=Dt()),_i}function J0(n){return n==null||typeof n=="symbol"||typeof n=="boolean"?null:typeof n=="function"?n:Hi(""+n)}function ev(n,r){var i=r.ownerDocument.createElement("input");return i.name=r.name,i.value=r.value,n.id&&i.setAttribute("form",n.id),r.parentNode.insertBefore(i,r),n=new FormData(n),i.parentNode.removeChild(i),n}function Ek(n,r,i,c,f){if(r==="submit"&&i&&i.stateNode===f){var g=J0((f[Ae]||null).action),T=c.submitter;T&&(r=(r=T[Ae]||null)?J0(r.formAction):T.getAttribute("formAction"),r!==null&&(g=r,T=null));var E=new Fi("action","action",null,c,f);n.push({event:E,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if(_i!==0){var M=T?ev(f,T):new FormData(f);gf(i,{pending:!0,data:M,method:f.method,action:g},null,M)}}else typeof g=="function"&&(E.preventDefault(),M=T?ev(f,T):new FormData(f),gf(i,{pending:!0,data:M,method:f.method,action:g},g,M))},currentTarget:f}]})}}for(var Xf=0;Xf<Dh.length;Xf++){var Zf=Dh[Xf],Sk=Zf.toLowerCase(),wk=Zf[0].toUpperCase()+Zf.slice(1);Vr(Sk,"on"+wk)}Vr(Dp,"onAnimationEnd"),Vr(Mp,"onAnimationIteration"),Vr(Op,"onAnimationStart"),Vr("dblclick","onDoubleClick"),Vr("focusin","onFocus"),Vr("focusout","onBlur"),Vr(H1,"onTransitionRun"),Vr(F1,"onTransitionStart"),Vr(q1,"onTransitionCancel"),Vr(Pp,"onTransitionEnd"),Kn("onMouseEnter",["mouseout","mouseover"]),Kn("onMouseLeave",["mouseout","mouseover"]),Kn("onPointerEnter",["pointerout","pointerover"]),Kn("onPointerLeave",["pointerout","pointerover"]),Xe("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Xe("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Xe("onBeforeInput",["compositionend","keypress","textInput","paste"]),Xe("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Xe("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Xe("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Fl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Ak=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Fl));function tv(n,r){r=(r&4)!==0;for(var i=0;i<n.length;i++){var c=n[i],f=c.event;c=c.listeners;e:{var g=void 0;if(r)for(var T=c.length-1;0<=T;T--){var E=c[T],M=E.instance,Q=E.currentTarget;if(E=E.listener,M!==g&&f.isPropagationStopped())break e;g=E,f.currentTarget=Q;try{g(f)}catch(ae){Ou(ae)}f.currentTarget=null,g=M}else for(T=0;T<c.length;T++){if(E=c[T],M=E.instance,Q=E.currentTarget,E=E.listener,M!==g&&f.isPropagationStopped())break e;g=E,f.currentTarget=Q;try{g(f)}catch(ae){Ou(ae)}f.currentTarget=null,g=M}}}}function ft(n,r){var i=r[it];i===void 0&&(i=r[it]=new Set);var c=n+"__bubble";i.has(c)||(nv(r,n,2,!1),i.add(c))}function Wf(n,r,i){var c=0;r&&(c|=4),nv(i,n,c,r)}var Qu="_reactListening"+Math.random().toString(36).slice(2);function Jf(n){if(!n[Qu]){n[Qu]=!0,ze.forEach(function(i){i!=="selectionchange"&&(Ak.has(i)||Wf(i,!1,n),Wf(i,!0,n))});var r=n.nodeType===9?n:n.ownerDocument;r===null||r[Qu]||(r[Qu]=!0,Wf("selectionchange",!1,r))}}function nv(n,r,i,c){switch(wv(r)){case 2:var f=eE;break;case 8:f=tE;break;default:f=fm}i=f.bind(null,r,i,n),f=void 0,!kr||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(f=!0),c?f!==void 0?n.addEventListener(r,i,{capture:!0,passive:f}):n.addEventListener(r,i,!0):f!==void 0?n.addEventListener(r,i,{passive:f}):n.addEventListener(r,i,!1)}function em(n,r,i,c,f){var g=c;if((r&1)===0&&(r&2)===0&&c!==null)e:for(;;){if(c===null)return;var T=c.tag;if(T===3||T===4){var E=c.stateNode.containerInfo;if(E===f)break;if(T===4)for(T=c.return;T!==null;){var M=T.tag;if((M===3||M===4)&&T.stateNode.containerInfo===f)return;T=T.return}for(;E!==null;){if(T=ln(E),T===null)return;if(M=T.tag,M===5||M===6||M===26||M===27){c=g=T;continue e}E=E.parentNode}}c=c.return}Zc(function(){var Q=g,ae=Tr(i),ue=[];e:{var W=Vp.get(n);if(W!==void 0){var J=Fi,qe=n;switch(n){case"keypress":if(ea(i)===0)break e;case"keydown":case"keyup":J=Xi;break;case"focusin":qe="focus",J=Ki;break;case"focusout":qe="blur",J=Ki;break;case"beforeblur":case"afterblur":J=Ki;break;case"click":if(i.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":J=Er;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":J=Sh;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":J=su;break;case Dp:case Mp:case Op:J=Yi;break;case Pp:J=ou;break;case"scroll":case"scrollend":J=Wc;break;case"wheel":J=Zi;break;case"copy":case"cut":case"paste":J=Qi;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":J=ml;break;case"toggle":case"beforetoggle":J=cu}var Le=(r&4)!==0,Vt=!Le&&(n==="scroll"||n==="scrollend"),U=Le?W!==null?W+"Capture":null:W;Le=[];for(var z=Q,K;z!==null;){var le=z;if(K=le.stateNode,le=le.tag,le!==5&&le!==26&&le!==27||K===null||U===null||(le=ei(z,U),le!=null&&Le.push(ql(z,le,K))),Vt)break;z=z.return}0<Le.length&&(W=new J(W,qe,null,i,ae),ue.push({event:W,listeners:Le}))}}if((r&7)===0){e:{if(W=n==="mouseover"||n==="pointerover",J=n==="mouseout"||n==="pointerout",W&&i!==Sa&&(qe=i.relatedTarget||i.fromElement)&&(ln(qe)||qe[ke]))break e;if((J||W)&&(W=ae.window===ae?ae:(W=ae.ownerDocument)?W.defaultView||W.parentWindow:window,J?(qe=i.relatedTarget||i.toElement,J=Q,qe=qe?ln(qe):null,qe!==null&&(Vt=l(qe),Le=qe.tag,qe!==Vt||Le!==5&&Le!==27&&Le!==6)&&(qe=null)):(J=null,qe=Q),J!==qe)){if(Le=Er,le="onMouseLeave",U="onMouseEnter",z="mouse",(n==="pointerout"||n==="pointerover")&&(Le=ml,le="onPointerLeave",U="onPointerEnter",z="pointer"),Vt=J==null?W:Cn(J),K=qe==null?W:Cn(qe),W=new Le(le,z+"leave",J,i,ae),W.target=Vt,W.relatedTarget=K,le=null,ln(ae)===Q&&(Le=new Le(U,z+"enter",qe,i,ae),Le.target=K,Le.relatedTarget=Vt,le=Le),Vt=le,J&&qe)t:{for(Le=J,U=qe,z=0,K=Le;K;K=ko(K))z++;for(K=0,le=U;le;le=ko(le))K++;for(;0<z-K;)Le=ko(Le),z--;for(;0<K-z;)U=ko(U),K--;for(;z--;){if(Le===U||U!==null&&Le===U.alternate)break t;Le=ko(Le),U=ko(U)}Le=null}else Le=null;J!==null&&rv(ue,W,J,Le,!1),qe!==null&&Vt!==null&&rv(ue,Vt,qe,Le,!0)}}e:{if(W=Q?Cn(Q):window,J=W.nodeName&&W.nodeName.toLowerCase(),J==="select"||J==="input"&&W.type==="file")var je=Tp;else if(En(W))if(kp)je=U1;else{je=z1;var ct=V1}else J=W.nodeName,!J||J.toLowerCase()!=="input"||W.type!=="checkbox"&&W.type!=="radio"?Q&&ol(Q.elementType)&&(je=Tp):je=L1;if(je&&(je=je(n,Q))){Ca(ue,je,i,ae);break e}ct&&ct(n,W,Q),n==="focusout"&&Q&&W.type==="number"&&Q.memoizedProps.value!=null&&as(W,"number",W.value)}switch(ct=Q?Cn(Q):window,n){case"focusin":(En(ct)||ct.contentEditable==="true")&&(Wi=ct,Ch=Q,yl=null);break;case"focusout":yl=Ch=Wi=null;break;case"mousedown":Ih=!0;break;case"contextmenu":case"mouseup":case"dragend":Ih=!1,Ip(ue,i,ae);break;case"selectionchange":if(G1)break;case"keydown":case"keyup":Ip(ue,i,ae)}var Oe;if(ra)e:{switch(n){case"compositionstart":var Ue="onCompositionStart";break e;case"compositionend":Ue="onCompositionEnd";break e;case"compositionupdate":Ue="onCompositionUpdate";break e}Ue=void 0}else vt?te(n,i)&&(Ue="onCompositionEnd"):n==="keydown"&&i.keyCode===229&&(Ue="onCompositionStart");Ue&&(b&&i.locale!=="ko"&&(vt||Ue!=="onCompositionStart"?Ue==="onCompositionEnd"&&vt&&(Oe=cl()):(Jr=ae,ss="value"in Jr?Jr.value:Jr.textContent,vt=!0)),ct=Xu(Q,Ue),0<ct.length&&(Ue=new hl(Ue,n,null,i,ae),ue.push({event:Ue,listeners:ct}),Oe?Ue.data=Oe:(Oe=xe(i),Oe!==null&&(Ue.data=Oe)))),(Oe=v?kn(n,i):xt(n,i))&&(Ue=Xu(Q,"onBeforeInput"),0<Ue.length&&(ct=new hl("onBeforeInput","beforeinput",null,i,ae),ue.push({event:ct,listeners:Ue}),ct.data=Oe)),Ek(ue,n,Q,i,ae)}tv(ue,r)})}function ql(n,r,i){return{instance:n,listener:r,currentTarget:i}}function Xu(n,r){for(var i=r+"Capture",c=[];n!==null;){var f=n,g=f.stateNode;if(f=f.tag,f!==5&&f!==26&&f!==27||g===null||(f=ei(n,i),f!=null&&c.unshift(ql(n,f,g)),f=ei(n,r),f!=null&&c.push(ql(n,f,g))),n.tag===3)return c;n=n.return}return[]}function ko(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5&&n.tag!==27);return n||null}function rv(n,r,i,c,f){for(var g=r._reactName,T=[];i!==null&&i!==c;){var E=i,M=E.alternate,Q=E.stateNode;if(E=E.tag,M!==null&&M===c)break;E!==5&&E!==26&&E!==27||Q===null||(M=Q,f?(Q=ei(i,g),Q!=null&&T.unshift(ql(i,Q,M))):f||(Q=ei(i,g),Q!=null&&T.push(ql(i,Q,M)))),i=i.return}T.length!==0&&n.push({event:r,listeners:T})}var Nk=/\r\n?/g,Rk=/\u0000|\uFFFD/g;function av(n){return(typeof n=="string"?n:""+n).replace(Nk,`
`).replace(Rk,"")}function sv(n,r){return r=av(r),av(n)===r}function Zu(){}function Pt(n,r,i,c,f,g){switch(i){case"children":typeof c=="string"?r==="body"||r==="textarea"&&c===""||_r(n,c):(typeof c=="number"||typeof c=="bigint")&&r!=="body"&&_r(n,""+c);break;case"className":Zr(n,"class",c);break;case"tabIndex":Zr(n,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":Zr(n,i,c);break;case"style":il(n,c,g);break;case"data":if(r!=="object"){Zr(n,"data",c);break}case"src":case"href":if(c===""&&(r!=="a"||i!=="href")){n.removeAttribute(i);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){n.removeAttribute(i);break}c=Hi(""+c),n.setAttribute(i,c);break;case"action":case"formAction":if(typeof c=="function"){n.setAttribute(i,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof g=="function"&&(i==="formAction"?(r!=="input"&&Pt(n,r,"name",f.name,f,null),Pt(n,r,"formEncType",f.formEncType,f,null),Pt(n,r,"formMethod",f.formMethod,f,null),Pt(n,r,"formTarget",f.formTarget,f,null)):(Pt(n,r,"encType",f.encType,f,null),Pt(n,r,"method",f.method,f,null),Pt(n,r,"target",f.target,f,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){n.removeAttribute(i);break}c=Hi(""+c),n.setAttribute(i,c);break;case"onClick":c!=null&&(n.onclick=Zu);break;case"onScroll":c!=null&&ft("scroll",n);break;case"onScrollEnd":c!=null&&ft("scrollend",n);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(a(61));if(i=c.__html,i!=null){if(f.children!=null)throw Error(a(60));n.innerHTML=i}}break;case"multiple":n.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":n.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){n.removeAttribute("xlink:href");break}i=Hi(""+c),n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",i);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?n.setAttribute(i,""+c):n.removeAttribute(i);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?n.setAttribute(i,""):n.removeAttribute(i);break;case"capture":case"download":c===!0?n.setAttribute(i,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?n.setAttribute(i,c):n.removeAttribute(i);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?n.setAttribute(i,c):n.removeAttribute(i);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?n.removeAttribute(i):n.setAttribute(i,c);break;case"popover":ft("beforetoggle",n),ft("toggle",n),rs(n,"popover",c);break;case"xlinkActuate":Ln(n,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":Ln(n,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":Ln(n,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":Ln(n,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":Ln(n,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":Ln(n,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":Ln(n,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":Ln(n,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":Ln(n,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":rs(n,"is",c);break;case"innerText":case"textContent":break;default:(!(2<i.length)||i[0]!=="o"&&i[0]!=="O"||i[1]!=="n"&&i[1]!=="N")&&(i=kh.get(i)||i,rs(n,i,c))}}function tm(n,r,i,c,f,g){switch(i){case"style":il(n,c,g);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(a(61));if(i=c.__html,i!=null){if(f.children!=null)throw Error(a(60));n.innerHTML=i}}break;case"children":typeof c=="string"?_r(n,c):(typeof c=="number"||typeof c=="bigint")&&_r(n,""+c);break;case"onScroll":c!=null&&ft("scroll",n);break;case"onScrollEnd":c!=null&&ft("scrollend",n);break;case"onClick":c!=null&&(n.onclick=Zu);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!ve.hasOwnProperty(i))e:{if(i[0]==="o"&&i[1]==="n"&&(f=i.endsWith("Capture"),r=i.slice(2,f?i.length-7:void 0),g=n[Ae]||null,g=g!=null?g[i]:null,typeof g=="function"&&n.removeEventListener(r,g,f),typeof c=="function")){typeof g!="function"&&g!==null&&(i in n?n[i]=null:n.hasAttribute(i)&&n.removeAttribute(i)),n.addEventListener(r,c,f);break e}i in n?n[i]=c:c===!0?n.setAttribute(i,""):rs(n,i,c)}}}function Hn(n,r,i){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":ft("error",n),ft("load",n);var c=!1,f=!1,g;for(g in i)if(i.hasOwnProperty(g)){var T=i[g];if(T!=null)switch(g){case"src":c=!0;break;case"srcSet":f=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(a(137,r));default:Pt(n,r,g,T,i,null)}}f&&Pt(n,r,"srcSet",i.srcSet,i,null),c&&Pt(n,r,"src",i.src,i,null);return;case"input":ft("invalid",n);var E=g=T=f=null,M=null,Q=null;for(c in i)if(i.hasOwnProperty(c)){var ae=i[c];if(ae!=null)switch(c){case"name":f=ae;break;case"type":T=ae;break;case"checked":M=ae;break;case"defaultChecked":Q=ae;break;case"value":g=ae;break;case"defaultValue":E=ae;break;case"children":case"dangerouslySetInnerHTML":if(ae!=null)throw Error(a(137,r));break;default:Pt(n,r,c,ae,i,null)}}Zs(n,g,E,M,Q,T,f,!1),Gi(n);return;case"select":ft("invalid",n),c=T=g=null;for(f in i)if(i.hasOwnProperty(f)&&(E=i[f],E!=null))switch(f){case"value":g=E;break;case"defaultValue":T=E;break;case"multiple":c=E;default:Pt(n,r,f,E,i,null)}r=g,i=T,n.multiple=!!c,r!=null?Ea(n,!!c,r,!1):i!=null&&Ea(n,!!c,i,!0);return;case"textarea":ft("invalid",n),g=f=c=null;for(T in i)if(i.hasOwnProperty(T)&&(E=i[T],E!=null))switch(T){case"value":c=E;break;case"defaultValue":f=E;break;case"children":g=E;break;case"dangerouslySetInnerHTML":if(E!=null)throw Error(a(91));break;default:Pt(n,r,T,E,i,null)}Ws(n,c,f,g),Gi(n);return;case"option":for(M in i)if(i.hasOwnProperty(M)&&(c=i[M],c!=null))switch(M){case"selected":n.selected=c&&typeof c!="function"&&typeof c!="symbol";break;default:Pt(n,r,M,c,i,null)}return;case"dialog":ft("beforetoggle",n),ft("toggle",n),ft("cancel",n),ft("close",n);break;case"iframe":case"object":ft("load",n);break;case"video":case"audio":for(c=0;c<Fl.length;c++)ft(Fl[c],n);break;case"image":ft("error",n),ft("load",n);break;case"details":ft("toggle",n);break;case"embed":case"source":case"link":ft("error",n),ft("load",n);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Q in i)if(i.hasOwnProperty(Q)&&(c=i[Q],c!=null))switch(Q){case"children":case"dangerouslySetInnerHTML":throw Error(a(137,r));default:Pt(n,r,Q,c,i,null)}return;default:if(ol(r)){for(ae in i)i.hasOwnProperty(ae)&&(c=i[ae],c!==void 0&&tm(n,r,ae,c,i,void 0));return}}for(E in i)i.hasOwnProperty(E)&&(c=i[E],c!=null&&Pt(n,r,E,c,i,null))}function Ck(n,r,i,c){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var f=null,g=null,T=null,E=null,M=null,Q=null,ae=null;for(J in i){var ue=i[J];if(i.hasOwnProperty(J)&&ue!=null)switch(J){case"checked":break;case"value":break;case"defaultValue":M=ue;default:c.hasOwnProperty(J)||Pt(n,r,J,null,c,ue)}}for(var W in c){var J=c[W];if(ue=i[W],c.hasOwnProperty(W)&&(J!=null||ue!=null))switch(W){case"type":g=J;break;case"name":f=J;break;case"checked":Q=J;break;case"defaultChecked":ae=J;break;case"value":T=J;break;case"defaultValue":E=J;break;case"children":case"dangerouslySetInnerHTML":if(J!=null)throw Error(a(137,r));break;default:J!==ue&&Pt(n,r,W,J,c,ue)}}hr(n,T,E,M,Q,ae,g,f);return;case"select":J=T=E=W=null;for(g in i)if(M=i[g],i.hasOwnProperty(g)&&M!=null)switch(g){case"value":break;case"multiple":J=M;default:c.hasOwnProperty(g)||Pt(n,r,g,null,c,M)}for(f in c)if(g=c[f],M=i[f],c.hasOwnProperty(f)&&(g!=null||M!=null))switch(f){case"value":W=g;break;case"defaultValue":E=g;break;case"multiple":T=g;default:g!==M&&Pt(n,r,f,g,c,M)}r=E,i=T,c=J,W!=null?Ea(n,!!i,W,!1):!!c!=!!i&&(r!=null?Ea(n,!!i,r,!0):Ea(n,!!i,i?[]:"",!1));return;case"textarea":J=W=null;for(E in i)if(f=i[E],i.hasOwnProperty(E)&&f!=null&&!c.hasOwnProperty(E))switch(E){case"value":break;case"children":break;default:Pt(n,r,E,null,c,f)}for(T in c)if(f=c[T],g=i[T],c.hasOwnProperty(T)&&(f!=null||g!=null))switch(T){case"value":W=f;break;case"defaultValue":J=f;break;case"children":break;case"dangerouslySetInnerHTML":if(f!=null)throw Error(a(91));break;default:f!==g&&Pt(n,r,T,f,c,g)}Mt(n,W,J);return;case"option":for(var qe in i)if(W=i[qe],i.hasOwnProperty(qe)&&W!=null&&!c.hasOwnProperty(qe))switch(qe){case"selected":n.selected=!1;break;default:Pt(n,r,qe,null,c,W)}for(M in c)if(W=c[M],J=i[M],c.hasOwnProperty(M)&&W!==J&&(W!=null||J!=null))switch(M){case"selected":n.selected=W&&typeof W!="function"&&typeof W!="symbol";break;default:Pt(n,r,M,W,c,J)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Le in i)W=i[Le],i.hasOwnProperty(Le)&&W!=null&&!c.hasOwnProperty(Le)&&Pt(n,r,Le,null,c,W);for(Q in c)if(W=c[Q],J=i[Q],c.hasOwnProperty(Q)&&W!==J&&(W!=null||J!=null))switch(Q){case"children":case"dangerouslySetInnerHTML":if(W!=null)throw Error(a(137,r));break;default:Pt(n,r,Q,W,c,J)}return;default:if(ol(r)){for(var Vt in i)W=i[Vt],i.hasOwnProperty(Vt)&&W!==void 0&&!c.hasOwnProperty(Vt)&&tm(n,r,Vt,void 0,c,W);for(ae in c)W=c[ae],J=i[ae],!c.hasOwnProperty(ae)||W===J||W===void 0&&J===void 0||tm(n,r,ae,W,c,J);return}}for(var U in i)W=i[U],i.hasOwnProperty(U)&&W!=null&&!c.hasOwnProperty(U)&&Pt(n,r,U,null,c,W);for(ue in c)W=c[ue],J=i[ue],!c.hasOwnProperty(ue)||W===J||W==null&&J==null||Pt(n,r,ue,W,c,J)}var nm=null,rm=null;function Wu(n){return n.nodeType===9?n:n.ownerDocument}function iv(n){switch(n){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function ov(n,r){if(n===0)switch(r){case"svg":return 1;case"math":return 2;default:return 0}return n===1&&r==="foreignObject"?0:n}function am(n,r){return n==="textarea"||n==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.children=="bigint"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var sm=null;function Ik(){var n=window.event;return n&&n.type==="popstate"?n===sm?!1:(sm=n,!0):(sm=null,!1)}var lv=typeof setTimeout=="function"?setTimeout:void 0,jk=typeof clearTimeout=="function"?clearTimeout:void 0,cv=typeof Promise=="function"?Promise:void 0,Dk=typeof queueMicrotask=="function"?queueMicrotask:typeof cv<"u"?function(n){return cv.resolve(null).then(n).catch(Mk)}:lv;function Mk(n){setTimeout(function(){throw n})}function _s(n){return n==="head"}function uv(n,r){var i=r,c=0,f=0;do{var g=i.nextSibling;if(n.removeChild(i),g&&g.nodeType===8)if(i=g.data,i==="/$"){if(0<c&&8>c){i=c;var T=n.ownerDocument;if(i&1&&$l(T.documentElement),i&2&&$l(T.body),i&4)for(i=T.head,$l(i),T=i.firstChild;T;){var E=T.nextSibling,M=T.nodeName;T[_n]||M==="SCRIPT"||M==="STYLE"||M==="LINK"&&T.rel.toLowerCase()==="stylesheet"||i.removeChild(T),T=E}}if(f===0){n.removeChild(g),ec(r);return}f--}else i==="$"||i==="$?"||i==="$!"?f++:c=i.charCodeAt(0)-48;else c=0;i=g}while(i);ec(r)}function im(n){var r=n.firstChild;for(r&&r.nodeType===10&&(r=r.nextSibling);r;){var i=r;switch(r=r.nextSibling,i.nodeName){case"HTML":case"HEAD":case"BODY":im(i),on(i);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(i.rel.toLowerCase()==="stylesheet")continue}n.removeChild(i)}}function Ok(n,r,i,c){for(;n.nodeType===1;){var f=i;if(n.nodeName.toLowerCase()!==r.toLowerCase()){if(!c&&(n.nodeName!=="INPUT"||n.type!=="hidden"))break}else if(c){if(!n[_n])switch(r){case"meta":if(!n.hasAttribute("itemprop"))break;return n;case"link":if(g=n.getAttribute("rel"),g==="stylesheet"&&n.hasAttribute("data-precedence"))break;if(g!==f.rel||n.getAttribute("href")!==(f.href==null||f.href===""?null:f.href)||n.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin)||n.getAttribute("title")!==(f.title==null?null:f.title))break;return n;case"style":if(n.hasAttribute("data-precedence"))break;return n;case"script":if(g=n.getAttribute("src"),(g!==(f.src==null?null:f.src)||n.getAttribute("type")!==(f.type==null?null:f.type)||n.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin))&&g&&n.hasAttribute("async")&&!n.hasAttribute("itemprop"))break;return n;default:return n}}else if(r==="input"&&n.type==="hidden"){var g=f.name==null?null:""+f.name;if(f.type==="hidden"&&n.getAttribute("name")===g)return n}else return n;if(n=Lr(n.nextSibling),n===null)break}return null}function Pk(n,r,i){if(r==="")return null;for(;n.nodeType!==3;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!i||(n=Lr(n.nextSibling),n===null))return null;return n}function om(n){return n.data==="$!"||n.data==="$?"&&n.ownerDocument.readyState==="complete"}function Vk(n,r){var i=n.ownerDocument;if(n.data!=="$?"||i.readyState==="complete")r();else{var c=function(){r(),i.removeEventListener("DOMContentLoaded",c)};i.addEventListener("DOMContentLoaded",c),n._reactRetry=c}}function Lr(n){for(;n!=null;n=n.nextSibling){var r=n.nodeType;if(r===1||r===3)break;if(r===8){if(r=n.data,r==="$"||r==="$!"||r==="$?"||r==="F!"||r==="F")break;if(r==="/$")return null}}return n}var lm=null;function dv(n){n=n.previousSibling;for(var r=0;n;){if(n.nodeType===8){var i=n.data;if(i==="$"||i==="$!"||i==="$?"){if(r===0)return n;r--}else i==="/$"&&r++}n=n.previousSibling}return null}function hv(n,r,i){switch(r=Wu(i),n){case"html":if(n=r.documentElement,!n)throw Error(a(452));return n;case"head":if(n=r.head,!n)throw Error(a(453));return n;case"body":if(n=r.body,!n)throw Error(a(454));return n;default:throw Error(a(451))}}function $l(n){for(var r=n.attributes;r.length;)n.removeAttributeNode(r[0]);on(n)}var Ir=new Map,fv=new Set;function Ju(n){return typeof n.getRootNode=="function"?n.getRootNode():n.nodeType===9?n:n.ownerDocument}var Ha=he.d;he.d={f:zk,r:Lk,D:Uk,C:Bk,L:Gk,m:Hk,X:qk,S:Fk,M:$k};function zk(){var n=Ha.f(),r=Fu();return n||r}function Lk(n){var r=Tn(n);r!==null&&r.tag===5&&r.type==="form"?Dy(r):Ha.r(n)}var Eo=typeof document>"u"?null:document;function mv(n,r,i){var c=Eo;if(c&&typeof r=="string"&&r){var f=mn(r);f='link[rel="'+n+'"][href="'+f+'"]',typeof i=="string"&&(f+='[crossorigin="'+i+'"]'),fv.has(f)||(fv.add(f),n={rel:n,crossOrigin:i,href:r},c.querySelector(f)===null&&(r=c.createElement("link"),Hn(r,"link",n),Ut(r),c.head.appendChild(r)))}}function Uk(n){Ha.D(n),mv("dns-prefetch",n,null)}function Bk(n,r){Ha.C(n,r),mv("preconnect",n,r)}function Gk(n,r,i){Ha.L(n,r,i);var c=Eo;if(c&&n&&r){var f='link[rel="preload"][as="'+mn(r)+'"]';r==="image"&&i&&i.imageSrcSet?(f+='[imagesrcset="'+mn(i.imageSrcSet)+'"]',typeof i.imageSizes=="string"&&(f+='[imagesizes="'+mn(i.imageSizes)+'"]')):f+='[href="'+mn(n)+'"]';var g=f;switch(r){case"style":g=So(n);break;case"script":g=wo(n)}Ir.has(g)||(n=x({rel:"preload",href:r==="image"&&i&&i.imageSrcSet?void 0:n,as:r},i),Ir.set(g,n),c.querySelector(f)!==null||r==="style"&&c.querySelector(Kl(g))||r==="script"&&c.querySelector(Yl(g))||(r=c.createElement("link"),Hn(r,"link",n),Ut(r),c.head.appendChild(r)))}}function Hk(n,r){Ha.m(n,r);var i=Eo;if(i&&n){var c=r&&typeof r.as=="string"?r.as:"script",f='link[rel="modulepreload"][as="'+mn(c)+'"][href="'+mn(n)+'"]',g=f;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":g=wo(n)}if(!Ir.has(g)&&(n=x({rel:"modulepreload",href:n},r),Ir.set(g,n),i.querySelector(f)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(i.querySelector(Yl(g)))return}c=i.createElement("link"),Hn(c,"link",n),Ut(c),i.head.appendChild(c)}}}function Fk(n,r,i){Ha.S(n,r,i);var c=Eo;if(c&&n){var f=cn(c).hoistableStyles,g=So(n);r=r||"default";var T=f.get(g);if(!T){var E={loading:0,preload:null};if(T=c.querySelector(Kl(g)))E.loading=5;else{n=x({rel:"stylesheet",href:n,"data-precedence":r},i),(i=Ir.get(g))&&cm(n,i);var M=T=c.createElement("link");Ut(M),Hn(M,"link",n),M._p=new Promise(function(Q,ae){M.onload=Q,M.onerror=ae}),M.addEventListener("load",function(){E.loading|=1}),M.addEventListener("error",function(){E.loading|=2}),E.loading|=4,ed(T,r,c)}T={type:"stylesheet",instance:T,count:1,state:E},f.set(g,T)}}}function qk(n,r){Ha.X(n,r);var i=Eo;if(i&&n){var c=cn(i).hoistableScripts,f=wo(n),g=c.get(f);g||(g=i.querySelector(Yl(f)),g||(n=x({src:n,async:!0},r),(r=Ir.get(f))&&um(n,r),g=i.createElement("script"),Ut(g),Hn(g,"link",n),i.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},c.set(f,g))}}function $k(n,r){Ha.M(n,r);var i=Eo;if(i&&n){var c=cn(i).hoistableScripts,f=wo(n),g=c.get(f);g||(g=i.querySelector(Yl(f)),g||(n=x({src:n,async:!0,type:"module"},r),(r=Ir.get(f))&&um(n,r),g=i.createElement("script"),Ut(g),Hn(g,"link",n),i.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},c.set(f,g))}}function gv(n,r,i,c){var f=(f=be.current)?Ju(f):null;if(!f)throw Error(a(446));switch(n){case"meta":case"title":return null;case"style":return typeof i.precedence=="string"&&typeof i.href=="string"?(r=So(i.href),i=cn(f).hoistableStyles,c=i.get(r),c||(c={type:"style",instance:null,count:0,state:null},i.set(r,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(i.rel==="stylesheet"&&typeof i.href=="string"&&typeof i.precedence=="string"){n=So(i.href);var g=cn(f).hoistableStyles,T=g.get(n);if(T||(f=f.ownerDocument||f,T={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},g.set(n,T),(g=f.querySelector(Kl(n)))&&!g._p&&(T.instance=g,T.state.loading=5),Ir.has(n)||(i={rel:"preload",as:"style",href:i.href,crossOrigin:i.crossOrigin,integrity:i.integrity,media:i.media,hrefLang:i.hrefLang,referrerPolicy:i.referrerPolicy},Ir.set(n,i),g||Kk(f,n,i,T.state))),r&&c===null)throw Error(a(528,""));return T}if(r&&c!==null)throw Error(a(529,""));return null;case"script":return r=i.async,i=i.src,typeof i=="string"&&r&&typeof r!="function"&&typeof r!="symbol"?(r=wo(i),i=cn(f).hoistableScripts,c=i.get(r),c||(c={type:"script",instance:null,count:0,state:null},i.set(r,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(a(444,n))}}function So(n){return'href="'+mn(n)+'"'}function Kl(n){return'link[rel="stylesheet"]['+n+"]"}function pv(n){return x({},n,{"data-precedence":n.precedence,precedence:null})}function Kk(n,r,i,c){n.querySelector('link[rel="preload"][as="style"]['+r+"]")?c.loading=1:(r=n.createElement("link"),c.preload=r,r.addEventListener("load",function(){return c.loading|=1}),r.addEventListener("error",function(){return c.loading|=2}),Hn(r,"link",i),Ut(r),n.head.appendChild(r))}function wo(n){return'[src="'+mn(n)+'"]'}function Yl(n){return"script[async]"+n}function yv(n,r,i){if(r.count++,r.instance===null)switch(r.type){case"style":var c=n.querySelector('style[data-href~="'+mn(i.href)+'"]');if(c)return r.instance=c,Ut(c),c;var f=x({},i,{"data-href":i.href,"data-precedence":i.precedence,href:null,precedence:null});return c=(n.ownerDocument||n).createElement("style"),Ut(c),Hn(c,"style",f),ed(c,i.precedence,n),r.instance=c;case"stylesheet":f=So(i.href);var g=n.querySelector(Kl(f));if(g)return r.state.loading|=4,r.instance=g,Ut(g),g;c=pv(i),(f=Ir.get(f))&&cm(c,f),g=(n.ownerDocument||n).createElement("link"),Ut(g);var T=g;return T._p=new Promise(function(E,M){T.onload=E,T.onerror=M}),Hn(g,"link",c),r.state.loading|=4,ed(g,i.precedence,n),r.instance=g;case"script":return g=wo(i.src),(f=n.querySelector(Yl(g)))?(r.instance=f,Ut(f),f):(c=i,(f=Ir.get(g))&&(c=x({},i),um(c,f)),n=n.ownerDocument||n,f=n.createElement("script"),Ut(f),Hn(f,"link",c),n.head.appendChild(f),r.instance=f);case"void":return null;default:throw Error(a(443,r.type))}else r.type==="stylesheet"&&(r.state.loading&4)===0&&(c=r.instance,r.state.loading|=4,ed(c,i.precedence,n));return r.instance}function ed(n,r,i){for(var c=i.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),f=c.length?c[c.length-1]:null,g=f,T=0;T<c.length;T++){var E=c[T];if(E.dataset.precedence===r)g=E;else if(g!==f)break}g?g.parentNode.insertBefore(n,g.nextSibling):(r=i.nodeType===9?i.head:i,r.insertBefore(n,r.firstChild))}function cm(n,r){n.crossOrigin==null&&(n.crossOrigin=r.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=r.referrerPolicy),n.title==null&&(n.title=r.title)}function um(n,r){n.crossOrigin==null&&(n.crossOrigin=r.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=r.referrerPolicy),n.integrity==null&&(n.integrity=r.integrity)}var td=null;function vv(n,r,i){if(td===null){var c=new Map,f=td=new Map;f.set(i,c)}else f=td,c=f.get(i),c||(c=new Map,f.set(i,c));if(c.has(n))return c;for(c.set(n,null),i=i.getElementsByTagName(n),f=0;f<i.length;f++){var g=i[f];if(!(g[_n]||g[ye]||n==="link"&&g.getAttribute("rel")==="stylesheet")&&g.namespaceURI!=="http://www.w3.org/2000/svg"){var T=g.getAttribute(r)||"";T=n+T;var E=c.get(T);E?E.push(g):c.set(T,[g])}}return c}function xv(n,r,i){n=n.ownerDocument||n,n.head.insertBefore(i,r==="title"?n.querySelector("head > title"):null)}function Yk(n,r,i){if(i===1||r.itemProp!=null)return!1;switch(n){case"meta":case"title":return!0;case"style":if(typeof r.precedence!="string"||typeof r.href!="string"||r.href==="")break;return!0;case"link":if(typeof r.rel!="string"||typeof r.href!="string"||r.href===""||r.onLoad||r.onError)break;switch(r.rel){case"stylesheet":return n=r.disabled,typeof r.precedence=="string"&&n==null;default:return!0}case"script":if(r.async&&typeof r.async!="function"&&typeof r.async!="symbol"&&!r.onLoad&&!r.onError&&r.src&&typeof r.src=="string")return!0}return!1}function bv(n){return!(n.type==="stylesheet"&&(n.state.loading&3)===0)}var Ql=null;function Qk(){}function Xk(n,r,i){if(Ql===null)throw Error(a(475));var c=Ql;if(r.type==="stylesheet"&&(typeof i.media!="string"||matchMedia(i.media).matches!==!1)&&(r.state.loading&4)===0){if(r.instance===null){var f=So(i.href),g=n.querySelector(Kl(f));if(g){n=g._p,n!==null&&typeof n=="object"&&typeof n.then=="function"&&(c.count++,c=nd.bind(c),n.then(c,c)),r.state.loading|=4,r.instance=g,Ut(g);return}g=n.ownerDocument||n,i=pv(i),(f=Ir.get(f))&&cm(i,f),g=g.createElement("link"),Ut(g);var T=g;T._p=new Promise(function(E,M){T.onload=E,T.onerror=M}),Hn(g,"link",i),r.instance=g}c.stylesheets===null&&(c.stylesheets=new Map),c.stylesheets.set(r,n),(n=r.state.preload)&&(r.state.loading&3)===0&&(c.count++,r=nd.bind(c),n.addEventListener("load",r),n.addEventListener("error",r))}}function Zk(){if(Ql===null)throw Error(a(475));var n=Ql;return n.stylesheets&&n.count===0&&dm(n,n.stylesheets),0<n.count?function(r){var i=setTimeout(function(){if(n.stylesheets&&dm(n,n.stylesheets),n.unsuspend){var c=n.unsuspend;n.unsuspend=null,c()}},6e4);return n.unsuspend=r,function(){n.unsuspend=null,clearTimeout(i)}}:null}function nd(){if(this.count--,this.count===0){if(this.stylesheets)dm(this,this.stylesheets);else if(this.unsuspend){var n=this.unsuspend;this.unsuspend=null,n()}}}var rd=null;function dm(n,r){n.stylesheets=null,n.unsuspend!==null&&(n.count++,rd=new Map,r.forEach(Wk,n),rd=null,nd.call(n))}function Wk(n,r){if(!(r.state.loading&4)){var i=rd.get(n);if(i)var c=i.get(null);else{i=new Map,rd.set(n,i);for(var f=n.querySelectorAll("link[data-precedence],style[data-precedence]"),g=0;g<f.length;g++){var T=f[g];(T.nodeName==="LINK"||T.getAttribute("media")!=="not all")&&(i.set(T.dataset.precedence,T),c=T)}c&&i.set(null,c)}f=r.instance,T=f.getAttribute("data-precedence"),g=i.get(T)||c,g===c&&i.set(null,f),i.set(T,f),this.count++,c=nd.bind(this),f.addEventListener("load",c),f.addEventListener("error",c),g?g.parentNode.insertBefore(f,g.nextSibling):(n=n.nodeType===9?n.head:n,n.insertBefore(f,n.firstChild)),r.state.loading|=4}}var Xl={$$typeof:ne,Provider:null,Consumer:null,_currentValue:G,_currentValue2:G,_threadCount:0};function Jk(n,r,i,c,f,g,T,E){this.tag=1,this.containerInfo=n,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=_e(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=_e(0),this.hiddenUpdates=_e(null),this.identifierPrefix=c,this.onUncaughtError=f,this.onCaughtError=g,this.onRecoverableError=T,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=E,this.incompleteTransitions=new Map}function _v(n,r,i,c,f,g,T,E,M,Q,ae,ue){return n=new Jk(n,r,i,T,E,M,Q,ue),r=1,g===!0&&(r|=24),g=mr(3,null,null,r),n.current=g,g.stateNode=n,r=qh(),r.refCount++,n.pooledCache=r,r.refCount++,g.memoizedState={element:c,isDehydrated:i,cache:r},Qh(g),n}function Tv(n){return n?(n=no,n):no}function kv(n,r,i,c,f,g){f=Tv(f),c.context===null?c.context=f:c.pendingContext=f,c=ls(r),c.payload={element:i},g=g===void 0?null:g,g!==null&&(c.callback=g),i=cs(n,c,r),i!==null&&(xr(i,n,r),wl(i,n,r))}function Ev(n,r){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var i=n.retryLane;n.retryLane=i!==0&&i<r?i:r}}function hm(n,r){Ev(n,r),(n=n.alternate)&&Ev(n,r)}function Sv(n){if(n.tag===13){var r=to(n,67108864);r!==null&&xr(r,n,67108864),hm(n,67108864)}}var ad=!0;function eE(n,r,i,c){var f=q.T;q.T=null;var g=he.p;try{he.p=2,fm(n,r,i,c)}finally{he.p=g,q.T=f}}function tE(n,r,i,c){var f=q.T;q.T=null;var g=he.p;try{he.p=8,fm(n,r,i,c)}finally{he.p=g,q.T=f}}function fm(n,r,i,c){if(ad){var f=mm(c);if(f===null)em(n,r,c,sd,i),Av(n,c);else if(rE(f,n,r,i,c))c.stopPropagation();else if(Av(n,c),r&4&&-1<nE.indexOf(n)){for(;f!==null;){var g=Tn(f);if(g!==null)switch(g.tag){case 3:if(g=g.stateNode,g.current.memoizedState.isDehydrated){var T=Nn(g.pendingLanes);if(T!==0){var E=g;for(E.pendingLanes|=2,E.entangledLanes|=2;T;){var M=1<<31-Qt(T);E.entanglements[1]|=M,T&=~M}ca(g),(Ct&6)===0&&(Gu=$e()+500,Hl(0))}}break;case 13:E=to(g,2),E!==null&&xr(E,g,2),Fu(),hm(g,2)}if(g=mm(c),g===null&&em(n,r,c,sd,i),g===f)break;f=g}f!==null&&c.stopPropagation()}else em(n,r,c,null,i)}}function mm(n){return n=Tr(n),gm(n)}var sd=null;function gm(n){if(sd=null,n=ln(n),n!==null){var r=l(n);if(r===null)n=null;else{var i=r.tag;if(i===13){if(n=d(r),n!==null)return n;n=null}else if(i===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;n=null}else r!==n&&(n=null)}}return sd=n,null}function wv(n){switch(n){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch($t()){case at:return 2;case zt:return 8;case Wt:case fn:return 32;case Jt:return 268435456;default:return 32}default:return 32}}var pm=!1,Ts=null,ks=null,Es=null,Zl=new Map,Wl=new Map,Ss=[],nE="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Av(n,r){switch(n){case"focusin":case"focusout":Ts=null;break;case"dragenter":case"dragleave":ks=null;break;case"mouseover":case"mouseout":Es=null;break;case"pointerover":case"pointerout":Zl.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":Wl.delete(r.pointerId)}}function Jl(n,r,i,c,f,g){return n===null||n.nativeEvent!==g?(n={blockedOn:r,domEventName:i,eventSystemFlags:c,nativeEvent:g,targetContainers:[f]},r!==null&&(r=Tn(r),r!==null&&Sv(r)),n):(n.eventSystemFlags|=c,r=n.targetContainers,f!==null&&r.indexOf(f)===-1&&r.push(f),n)}function rE(n,r,i,c,f){switch(r){case"focusin":return Ts=Jl(Ts,n,r,i,c,f),!0;case"dragenter":return ks=Jl(ks,n,r,i,c,f),!0;case"mouseover":return Es=Jl(Es,n,r,i,c,f),!0;case"pointerover":var g=f.pointerId;return Zl.set(g,Jl(Zl.get(g)||null,n,r,i,c,f)),!0;case"gotpointercapture":return g=f.pointerId,Wl.set(g,Jl(Wl.get(g)||null,n,r,i,c,f)),!0}return!1}function Nv(n){var r=ln(n.target);if(r!==null){var i=l(r);if(i!==null){if(r=i.tag,r===13){if(r=d(i),r!==null){n.blockedOn=r,Be(n.priority,function(){if(i.tag===13){var c=vr();c=ee(c);var f=to(i,c);f!==null&&xr(f,i,c),hm(i,c)}});return}}else if(r===3&&i.stateNode.current.memoizedState.isDehydrated){n.blockedOn=i.tag===3?i.stateNode.containerInfo:null;return}}}n.blockedOn=null}function id(n){if(n.blockedOn!==null)return!1;for(var r=n.targetContainers;0<r.length;){var i=mm(n.nativeEvent);if(i===null){i=n.nativeEvent;var c=new i.constructor(i.type,i);Sa=c,i.target.dispatchEvent(c),Sa=null}else return r=Tn(i),r!==null&&Sv(r),n.blockedOn=i,!1;r.shift()}return!0}function Rv(n,r,i){id(n)&&i.delete(r)}function aE(){pm=!1,Ts!==null&&id(Ts)&&(Ts=null),ks!==null&&id(ks)&&(ks=null),Es!==null&&id(Es)&&(Es=null),Zl.forEach(Rv),Wl.forEach(Rv)}function od(n,r){n.blockedOn===r&&(n.blockedOn=null,pm||(pm=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,aE)))}var ld=null;function Cv(n){ld!==n&&(ld=n,s.unstable_scheduleCallback(s.unstable_NormalPriority,function(){ld===n&&(ld=null);for(var r=0;r<n.length;r+=3){var i=n[r],c=n[r+1],f=n[r+2];if(typeof c!="function"){if(gm(c||i)===null)continue;break}var g=Tn(i);g!==null&&(n.splice(r,3),r-=3,gf(g,{pending:!0,data:f,method:i.method,action:c},c,f))}}))}function ec(n){function r(M){return od(M,n)}Ts!==null&&od(Ts,n),ks!==null&&od(ks,n),Es!==null&&od(Es,n),Zl.forEach(r),Wl.forEach(r);for(var i=0;i<Ss.length;i++){var c=Ss[i];c.blockedOn===n&&(c.blockedOn=null)}for(;0<Ss.length&&(i=Ss[0],i.blockedOn===null);)Nv(i),i.blockedOn===null&&Ss.shift();if(i=(n.ownerDocument||n).$$reactFormReplay,i!=null)for(c=0;c<i.length;c+=3){var f=i[c],g=i[c+1],T=f[Ae]||null;if(typeof g=="function")T||Cv(i);else if(T){var E=null;if(g&&g.hasAttribute("formAction")){if(f=g,T=g[Ae]||null)E=T.formAction;else if(gm(f)!==null)continue}else E=T.action;typeof E=="function"?i[c+1]=E:(i.splice(c,3),c-=3),Cv(i)}}}function ym(n){this._internalRoot=n}cd.prototype.render=ym.prototype.render=function(n){var r=this._internalRoot;if(r===null)throw Error(a(409));var i=r.current,c=vr();kv(i,c,n,r,null,null)},cd.prototype.unmount=ym.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var r=n.containerInfo;kv(n.current,2,null,n,null,null),Fu(),r[ke]=null}};function cd(n){this._internalRoot=n}cd.prototype.unstable_scheduleHydration=function(n){if(n){var r=Ie();n={blockedOn:null,target:n,priority:r};for(var i=0;i<Ss.length&&r!==0&&r<Ss[i].priority;i++);Ss.splice(i,0,n),i===0&&Nv(n)}};var Iv=e.version;if(Iv!=="19.1.1")throw Error(a(527,Iv,"19.1.1"));he.findDOMNode=function(n){var r=n._reactInternals;if(r===void 0)throw typeof n.render=="function"?Error(a(188)):(n=Object.keys(n).join(","),Error(a(268,n)));return n=p(r),n=n!==null?y(n):null,n=n===null?null:n.stateNode,n};var sE={bundleType:0,version:"19.1.1",rendererPackageName:"react-dom",currentDispatcherRef:q,reconcilerVersion:"19.1.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ud=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ud.isDisabled&&ud.supportsFiber)try{Je=ud.inject(sE),lt=ud}catch{}}return nc.createRoot=function(n,r){if(!o(n))throw Error(a(299));var i=!1,c="",f=Ky,g=Yy,T=Qy,E=null;return r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(c=r.identifierPrefix),r.onUncaughtError!==void 0&&(f=r.onUncaughtError),r.onCaughtError!==void 0&&(g=r.onCaughtError),r.onRecoverableError!==void 0&&(T=r.onRecoverableError),r.unstable_transitionCallbacks!==void 0&&(E=r.unstable_transitionCallbacks)),r=_v(n,1,!1,null,null,i,c,f,g,T,E,null),n[ke]=r.current,Jf(n),new ym(r)},nc.hydrateRoot=function(n,r,i){if(!o(n))throw Error(a(299));var c=!1,f="",g=Ky,T=Yy,E=Qy,M=null,Q=null;return i!=null&&(i.unstable_strictMode===!0&&(c=!0),i.identifierPrefix!==void 0&&(f=i.identifierPrefix),i.onUncaughtError!==void 0&&(g=i.onUncaughtError),i.onCaughtError!==void 0&&(T=i.onCaughtError),i.onRecoverableError!==void 0&&(E=i.onRecoverableError),i.unstable_transitionCallbacks!==void 0&&(M=i.unstable_transitionCallbacks),i.formState!==void 0&&(Q=i.formState)),r=_v(n,1,!0,r,i??null,c,f,g,T,E,M,Q),r.context=Tv(null),i=r.current,c=vr(),c=ee(c),f=ls(c),f.callback=null,cs(i,f,c),i=c,r.current.lanes=i,Ne(r,i),ca(r),n[ke]=r.current,Jf(n),new cd(r)},nc.version="19.1.1",nc}var Bv;function pE(){if(Bv)return xm.exports;Bv=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),xm.exports=gE(),xm.exports}var yE=pE();const vE=oE(yE);var k=mg();/**
 * react-router v7.9.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var Gv="popstate";function xE(s={}){function e(a,o){let{pathname:l,search:d,hash:m}=a.location;return Lm("",{pathname:l,search:d,hash:m},o.state&&o.state.usr||null,o.state&&o.state.key||"default")}function t(a,o){return typeof o=="string"?o:pc(o)}return _E(e,t,null,s)}function Zt(s,e){if(s===!1||s===null||typeof s>"u")throw new Error(e)}function Hr(s,e){if(!s){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function bE(){return Math.random().toString(36).substring(2,10)}function Hv(s,e){return{usr:s.state,key:s.key,idx:e}}function Lm(s,e,t=null,a){return{pathname:typeof s=="string"?s:s.pathname,search:"",hash:"",...typeof e=="string"?$o(e):e,state:t,key:e&&e.key||a||bE()}}function pc({pathname:s="/",search:e="",hash:t=""}){return e&&e!=="?"&&(s+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(s+=t.charAt(0)==="#"?t:"#"+t),s}function $o(s){let e={};if(s){let t=s.indexOf("#");t>=0&&(e.hash=s.substring(t),s=s.substring(0,t));let a=s.indexOf("?");a>=0&&(e.search=s.substring(a),s=s.substring(0,a)),s&&(e.pathname=s)}return e}function _E(s,e,t,a={}){let{window:o=document.defaultView,v5Compat:l=!1}=a,d=o.history,m="POP",p=null,y=x();y==null&&(y=0,d.replaceState({...d.state,idx:y},""));function x(){return(d.state||{idx:null}).idx}function _(){m="POP";let D=x(),$=D==null?null:D-y;y=D,p&&p({action:m,location:L.location,delta:$})}function w(D,$){m="PUSH";let X=Lm(L.location,D,$);y=x()+1;let ne=Hv(X,y),ce=L.createHref(X);try{d.pushState(ne,"",ce)}catch(de){if(de instanceof DOMException&&de.name==="DataCloneError")throw de;o.location.assign(ce)}l&&p&&p({action:m,location:L.location,delta:1})}function j(D,$){m="REPLACE";let X=Lm(L.location,D,$);y=x();let ne=Hv(X,y),ce=L.createHref(X);d.replaceState(ne,"",ce),l&&p&&p({action:m,location:L.location,delta:0})}function B(D){return TE(D)}let L={get action(){return m},get location(){return s(o,d)},listen(D){if(p)throw new Error("A history only accepts one active listener");return o.addEventListener(Gv,_),p=D,()=>{o.removeEventListener(Gv,_),p=null}},createHref(D){return e(o,D)},createURL:B,encodeLocation(D){let $=B(D);return{pathname:$.pathname,search:$.search,hash:$.hash}},push:w,replace:j,go(D){return d.go(D)}};return L}function TE(s,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),Zt(t,"No window.location.(origin|href) available to create URL");let a=typeof s=="string"?s:pc(s);return a=a.replace(/ $/,"%20"),!e&&a.startsWith("//")&&(a=t+a),new URL(a,t)}function Ib(s,e,t="/"){return kE(s,e,t,!1)}function kE(s,e,t,a){let o=typeof e=="string"?$o(e):e,l=Xa(o.pathname||"/",t);if(l==null)return null;let d=jb(s);EE(d);let m=null;for(let p=0;m==null&&p<d.length;++p){let y=OE(l);m=DE(d[p],y,a)}return m}function jb(s,e=[],t=[],a="",o=!1){let l=(d,m,p=o,y)=>{let x={relativePath:y===void 0?d.path||"":y,caseSensitive:d.caseSensitive===!0,childrenIndex:m,route:d};if(x.relativePath.startsWith("/")){if(!x.relativePath.startsWith(a)&&p)return;Zt(x.relativePath.startsWith(a),`Absolute route path "${x.relativePath}" nested under path "${a}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),x.relativePath=x.relativePath.slice(a.length)}let _=Ka([a,x.relativePath]),w=t.concat(x);d.children&&d.children.length>0&&(Zt(d.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${_}".`),jb(d.children,e,w,_,p)),!(d.path==null&&!d.index)&&e.push({path:_,score:IE(_,d.index),routesMeta:w})};return s.forEach((d,m)=>{if(d.path===""||!d.path?.includes("?"))l(d,m);else for(let p of Db(d.path))l(d,m,!0,p)}),e}function Db(s){let e=s.split("/");if(e.length===0)return[];let[t,...a]=e,o=t.endsWith("?"),l=t.replace(/\?$/,"");if(a.length===0)return o?[l,""]:[l];let d=Db(a.join("/")),m=[];return m.push(...d.map(p=>p===""?l:[l,p].join("/"))),o&&m.push(...d),m.map(p=>s.startsWith("/")&&p===""?"/":p)}function EE(s){s.sort((e,t)=>e.score!==t.score?t.score-e.score:jE(e.routesMeta.map(a=>a.childrenIndex),t.routesMeta.map(a=>a.childrenIndex)))}var SE=/^:[\w-]+$/,wE=3,AE=2,NE=1,RE=10,CE=-2,Fv=s=>s==="*";function IE(s,e){let t=s.split("/"),a=t.length;return t.some(Fv)&&(a+=CE),e&&(a+=AE),t.filter(o=>!Fv(o)).reduce((o,l)=>o+(SE.test(l)?wE:l===""?NE:RE),a)}function jE(s,e){return s.length===e.length&&s.slice(0,-1).every((a,o)=>a===e[o])?s[s.length-1]-e[e.length-1]:0}function DE(s,e,t=!1){let{routesMeta:a}=s,o={},l="/",d=[];for(let m=0;m<a.length;++m){let p=a[m],y=m===a.length-1,x=l==="/"?e:e.slice(l.length)||"/",_=Id({path:p.relativePath,caseSensitive:p.caseSensitive,end:y},x),w=p.route;if(!_&&y&&t&&!a[a.length-1].route.index&&(_=Id({path:p.relativePath,caseSensitive:p.caseSensitive,end:!1},x)),!_)return null;Object.assign(o,_.params),d.push({params:o,pathname:Ka([l,_.pathname]),pathnameBase:LE(Ka([l,_.pathnameBase])),route:w}),_.pathnameBase!=="/"&&(l=Ka([l,_.pathnameBase]))}return d}function Id(s,e){typeof s=="string"&&(s={path:s,caseSensitive:!1,end:!0});let[t,a]=ME(s.path,s.caseSensitive,s.end),o=e.match(t);if(!o)return null;let l=o[0],d=l.replace(/(.)\/+$/,"$1"),m=o.slice(1);return{params:a.reduce((y,{paramName:x,isOptional:_},w)=>{if(x==="*"){let B=m[w]||"";d=l.slice(0,l.length-B.length).replace(/(.)\/+$/,"$1")}const j=m[w];return _&&!j?y[x]=void 0:y[x]=(j||"").replace(/%2F/g,"/"),y},{}),pathname:l,pathnameBase:d,pattern:s}}function ME(s,e=!1,t=!0){Hr(s==="*"||!s.endsWith("*")||s.endsWith("/*"),`Route path "${s}" will be treated as if it were "${s.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${s.replace(/\*$/,"/*")}".`);let a=[],o="^"+s.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(d,m,p)=>(a.push({paramName:m,isOptional:p!=null}),p?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return s.endsWith("*")?(a.push({paramName:"*"}),o+=s==="*"||s==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?o+="\\/*$":s!==""&&s!=="/"&&(o+="(?:(?=\\/|$))"),[new RegExp(o,e?void 0:"i"),a]}function OE(s){try{return s.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Hr(!1,`The URL path "${s}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),s}}function Xa(s,e){if(e==="/")return s;if(!s.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,a=s.charAt(t);return a&&a!=="/"?null:s.slice(t)||"/"}function PE(s,e="/"){let{pathname:t,search:a="",hash:o=""}=typeof s=="string"?$o(s):s;return{pathname:t?t.startsWith("/")?t:VE(t,e):e,search:UE(a),hash:BE(o)}}function VE(s,e){let t=e.replace(/\/+$/,"").split("/");return s.split("/").forEach(o=>{o===".."?t.length>1&&t.pop():o!=="."&&t.push(o)}),t.length>1?t.join("/"):"/"}function Em(s,e,t,a){return`Cannot include a '${s}' character in a manually specified \`to.${e}\` field [${JSON.stringify(a)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function zE(s){return s.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function gg(s){let e=zE(s);return e.map((t,a)=>a===e.length-1?t.pathname:t.pathnameBase)}function pg(s,e,t,a=!1){let o;typeof s=="string"?o=$o(s):(o={...s},Zt(!o.pathname||!o.pathname.includes("?"),Em("?","pathname","search",o)),Zt(!o.pathname||!o.pathname.includes("#"),Em("#","pathname","hash",o)),Zt(!o.search||!o.search.includes("#"),Em("#","search","hash",o)));let l=s===""||o.pathname==="",d=l?"/":o.pathname,m;if(d==null)m=t;else{let _=e.length-1;if(!a&&d.startsWith("..")){let w=d.split("/");for(;w[0]==="..";)w.shift(),_-=1;o.pathname=w.join("/")}m=_>=0?e[_]:"/"}let p=PE(o,m),y=d&&d!=="/"&&d.endsWith("/"),x=(l||d===".")&&t.endsWith("/");return!p.pathname.endsWith("/")&&(y||x)&&(p.pathname+="/"),p}var Ka=s=>s.join("/").replace(/\/\/+/g,"/"),LE=s=>s.replace(/\/+$/,"").replace(/^\/*/,"/"),UE=s=>!s||s==="?"?"":s.startsWith("?")?s:"?"+s,BE=s=>!s||s==="#"?"":s.startsWith("#")?s:"#"+s;function GE(s){return s!=null&&typeof s.status=="number"&&typeof s.statusText=="string"&&typeof s.internal=="boolean"&&"data"in s}var Mb=["POST","PUT","PATCH","DELETE"];new Set(Mb);var HE=["GET",...Mb];new Set(HE);var Ko=k.createContext(null);Ko.displayName="DataRouter";var Zd=k.createContext(null);Zd.displayName="DataRouterState";k.createContext(!1);var Ob=k.createContext({isTransitioning:!1});Ob.displayName="ViewTransition";var FE=k.createContext(new Map);FE.displayName="Fetchers";var qE=k.createContext(null);qE.displayName="Await";var $r=k.createContext(null);$r.displayName="Navigation";var jc=k.createContext(null);jc.displayName="Location";var ba=k.createContext({outlet:null,matches:[],isDataRoute:!1});ba.displayName="Route";var yg=k.createContext(null);yg.displayName="RouteError";function $E(s,{relative:e}={}){Zt(Yo(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:a}=k.useContext($r),{hash:o,pathname:l,search:d}=Dc(s,{relative:e}),m=l;return t!=="/"&&(m=l==="/"?t:Ka([t,l])),a.createHref({pathname:m,search:d,hash:o})}function Yo(){return k.useContext(jc)!=null}function qs(){return Zt(Yo(),"useLocation() may be used only in the context of a <Router> component."),k.useContext(jc).location}var Pb="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Vb(s){k.useContext($r).static||k.useLayoutEffect(s)}function zb(){let{isDataRoute:s}=k.useContext(ba);return s?sS():KE()}function KE(){Zt(Yo(),"useNavigate() may be used only in the context of a <Router> component.");let s=k.useContext(Ko),{basename:e,navigator:t}=k.useContext($r),{matches:a}=k.useContext(ba),{pathname:o}=qs(),l=JSON.stringify(gg(a)),d=k.useRef(!1);return Vb(()=>{d.current=!0}),k.useCallback((p,y={})=>{if(Hr(d.current,Pb),!d.current)return;if(typeof p=="number"){t.go(p);return}let x=pg(p,JSON.parse(l),o,y.relative==="path");s==null&&e!=="/"&&(x.pathname=x.pathname==="/"?e:Ka([e,x.pathname])),(y.replace?t.replace:t.push)(x,y.state,y)},[e,t,l,o,s])}k.createContext(null);function Dc(s,{relative:e}={}){let{matches:t}=k.useContext(ba),{pathname:a}=qs(),o=JSON.stringify(gg(t));return k.useMemo(()=>pg(s,JSON.parse(o),a,e==="path"),[s,o,a,e])}function YE(s,e){return Lb(s,e)}function Lb(s,e,t,a,o){Zt(Yo(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:l}=k.useContext($r),{matches:d}=k.useContext(ba),m=d[d.length-1],p=m?m.params:{},y=m?m.pathname:"/",x=m?m.pathnameBase:"/",_=m&&m.route;{let X=_&&_.path||"";Ub(y,!_||X.endsWith("*")||X.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${y}" (under <Route path="${X}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${X}"> to <Route path="${X==="/"?"*":`${X}/*`}">.`)}let w=qs(),j;if(e){let X=typeof e=="string"?$o(e):e;Zt(x==="/"||X.pathname?.startsWith(x),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${x}" but pathname "${X.pathname}" was given in the \`location\` prop.`),j=X}else j=w;let B=j.pathname||"/",L=B;if(x!=="/"){let X=x.replace(/^\//,"").split("/");L="/"+B.replace(/^\//,"").split("/").slice(X.length).join("/")}let D=Ib(s,{pathname:L});Hr(_||D!=null,`No routes matched location "${j.pathname}${j.search}${j.hash}" `),Hr(D==null||D[D.length-1].route.element!==void 0||D[D.length-1].route.Component!==void 0||D[D.length-1].route.lazy!==void 0,`Matched leaf route at location "${j.pathname}${j.search}${j.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let $=JE(D&&D.map(X=>Object.assign({},X,{params:Object.assign({},p,X.params),pathname:Ka([x,l.encodeLocation?l.encodeLocation(X.pathname).pathname:X.pathname]),pathnameBase:X.pathnameBase==="/"?x:Ka([x,l.encodeLocation?l.encodeLocation(X.pathnameBase).pathname:X.pathnameBase])})),d,t,a,o);return e&&$?k.createElement(jc.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...j},navigationType:"POP"}},$):$}function QE(){let s=aS(),e=GE(s)?`${s.status} ${s.statusText}`:s instanceof Error?s.message:JSON.stringify(s),t=s instanceof Error?s.stack:null,a="rgba(200,200,200, 0.5)",o={padding:"0.5rem",backgroundColor:a},l={padding:"2px 4px",backgroundColor:a},d=null;return console.error("Error handled by React Router default ErrorBoundary:",s),d=k.createElement(k.Fragment,null,k.createElement("p",null,"💿 Hey developer 👋"),k.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",k.createElement("code",{style:l},"ErrorBoundary")," or"," ",k.createElement("code",{style:l},"errorElement")," prop on your route.")),k.createElement(k.Fragment,null,k.createElement("h2",null,"Unexpected Application Error!"),k.createElement("h3",{style:{fontStyle:"italic"}},e),t?k.createElement("pre",{style:o},t):null,d)}var XE=k.createElement(QE,null),ZE=class extends k.Component{constructor(s){super(s),this.state={location:s.location,revalidation:s.revalidation,error:s.error}}static getDerivedStateFromError(s){return{error:s}}static getDerivedStateFromProps(s,e){return e.location!==s.location||e.revalidation!=="idle"&&s.revalidation==="idle"?{error:s.error,location:s.location,revalidation:s.revalidation}:{error:s.error!==void 0?s.error:e.error,location:e.location,revalidation:s.revalidation||e.revalidation}}componentDidCatch(s,e){this.props.unstable_onError?this.props.unstable_onError(s,e):console.error("React Router caught the following error during render",s)}render(){return this.state.error!==void 0?k.createElement(ba.Provider,{value:this.props.routeContext},k.createElement(yg.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function WE({routeContext:s,match:e,children:t}){let a=k.useContext(Ko);return a&&a.static&&a.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=e.route.id),k.createElement(ba.Provider,{value:s},t)}function JE(s,e=[],t=null,a=null,o=null){if(s==null){if(!t)return null;if(t.errors)s=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)s=t.matches;else return null}let l=s,d=t?.errors;if(d!=null){let y=l.findIndex(x=>x.route.id&&d?.[x.route.id]!==void 0);Zt(y>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(d).join(",")}`),l=l.slice(0,Math.min(l.length,y+1))}let m=!1,p=-1;if(t)for(let y=0;y<l.length;y++){let x=l[y];if((x.route.HydrateFallback||x.route.hydrateFallbackElement)&&(p=y),x.route.id){let{loaderData:_,errors:w}=t,j=x.route.loader&&!_.hasOwnProperty(x.route.id)&&(!w||w[x.route.id]===void 0);if(x.route.lazy||j){m=!0,p>=0?l=l.slice(0,p+1):l=[l[0]];break}}}return l.reduceRight((y,x,_)=>{let w,j=!1,B=null,L=null;t&&(w=d&&x.route.id?d[x.route.id]:void 0,B=x.route.errorElement||XE,m&&(p<0&&_===0?(Ub("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),j=!0,L=null):p===_&&(j=!0,L=x.route.hydrateFallbackElement||null)));let D=e.concat(l.slice(0,_+1)),$=()=>{let X;return w?X=B:j?X=L:x.route.Component?X=k.createElement(x.route.Component,null):x.route.element?X=x.route.element:X=y,k.createElement(WE,{match:x,routeContext:{outlet:y,matches:D,isDataRoute:t!=null},children:X})};return t&&(x.route.ErrorBoundary||x.route.errorElement||_===0)?k.createElement(ZE,{location:t.location,revalidation:t.revalidation,component:B,error:w,children:$(),routeContext:{outlet:null,matches:D,isDataRoute:!0},unstable_onError:a}):$()},null)}function vg(s){return`${s} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function eS(s){let e=k.useContext(Ko);return Zt(e,vg(s)),e}function tS(s){let e=k.useContext(Zd);return Zt(e,vg(s)),e}function nS(s){let e=k.useContext(ba);return Zt(e,vg(s)),e}function xg(s){let e=nS(s),t=e.matches[e.matches.length-1];return Zt(t.route.id,`${s} can only be used on routes that contain a unique "id"`),t.route.id}function rS(){return xg("useRouteId")}function aS(){let s=k.useContext(yg),e=tS("useRouteError"),t=xg("useRouteError");return s!==void 0?s:e.errors?.[t]}function sS(){let{router:s}=eS("useNavigate"),e=xg("useNavigate"),t=k.useRef(!1);return Vb(()=>{t.current=!0}),k.useCallback(async(o,l={})=>{Hr(t.current,Pb),t.current&&(typeof o=="number"?s.navigate(o):await s.navigate(o,{fromRouteId:e,...l}))},[s,e])}var qv={};function Ub(s,e,t){!e&&!qv[s]&&(qv[s]=!0,Hr(!1,t))}k.memo(iS);function iS({routes:s,future:e,state:t,unstable_onError:a}){return Lb(s,void 0,t,a,e)}function yc({to:s,replace:e,state:t,relative:a}){Zt(Yo(),"<Navigate> may be used only in the context of a <Router> component.");let{static:o}=k.useContext($r);Hr(!o,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:l}=k.useContext(ba),{pathname:d}=qs(),m=zb(),p=pg(s,gg(l),d,a==="path"),y=JSON.stringify(p);return k.useEffect(()=>{m(JSON.parse(y),{replace:e,state:t,relative:a})},[m,y,a,e,t]),null}function Ao(s){Zt(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function oS({basename:s="/",children:e=null,location:t,navigationType:a="POP",navigator:o,static:l=!1}){Zt(!Yo(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let d=s.replace(/^\/*/,"/"),m=k.useMemo(()=>({basename:d,navigator:o,static:l,future:{}}),[d,o,l]);typeof t=="string"&&(t=$o(t));let{pathname:p="/",search:y="",hash:x="",state:_=null,key:w="default"}=t,j=k.useMemo(()=>{let B=Xa(p,d);return B==null?null:{location:{pathname:B,search:y,hash:x,state:_,key:w},navigationType:a}},[d,p,y,x,_,w,a]);return Hr(j!=null,`<Router basename="${d}"> is not able to match the URL "${p}${y}${x}" because it does not start with the basename, so the <Router> won't render anything.`),j==null?null:k.createElement($r.Provider,{value:m},k.createElement(jc.Provider,{children:e,value:j}))}function lS({children:s,location:e}){return YE(Um(s),e)}function Um(s,e=[]){let t=[];return k.Children.forEach(s,(a,o)=>{if(!k.isValidElement(a))return;let l=[...e,o];if(a.type===k.Fragment){t.push.apply(t,Um(a.props.children,l));return}Zt(a.type===Ao,`[${typeof a.type=="string"?a.type:a.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Zt(!a.props.index||!a.props.children,"An index route cannot have child routes.");let d={id:a.props.id||l.join("-"),caseSensitive:a.props.caseSensitive,element:a.props.element,Component:a.props.Component,index:a.props.index,path:a.props.path,loader:a.props.loader,action:a.props.action,hydrateFallbackElement:a.props.hydrateFallbackElement,HydrateFallback:a.props.HydrateFallback,errorElement:a.props.errorElement,ErrorBoundary:a.props.ErrorBoundary,hasErrorBoundary:a.props.hasErrorBoundary===!0||a.props.ErrorBoundary!=null||a.props.errorElement!=null,shouldRevalidate:a.props.shouldRevalidate,handle:a.props.handle,lazy:a.props.lazy};a.props.children&&(d.children=Um(a.props.children,l)),t.push(d)}),t}var xd="get",bd="application/x-www-form-urlencoded";function Wd(s){return s!=null&&typeof s.tagName=="string"}function cS(s){return Wd(s)&&s.tagName.toLowerCase()==="button"}function uS(s){return Wd(s)&&s.tagName.toLowerCase()==="form"}function dS(s){return Wd(s)&&s.tagName.toLowerCase()==="input"}function hS(s){return!!(s.metaKey||s.altKey||s.ctrlKey||s.shiftKey)}function fS(s,e){return s.button===0&&(!e||e==="_self")&&!hS(s)}var dd=null;function mS(){if(dd===null)try{new FormData(document.createElement("form"),0),dd=!1}catch{dd=!0}return dd}var gS=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Sm(s){return s!=null&&!gS.has(s)?(Hr(!1,`"${s}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${bd}"`),null):s}function pS(s,e){let t,a,o,l,d;if(uS(s)){let m=s.getAttribute("action");a=m?Xa(m,e):null,t=s.getAttribute("method")||xd,o=Sm(s.getAttribute("enctype"))||bd,l=new FormData(s)}else if(cS(s)||dS(s)&&(s.type==="submit"||s.type==="image")){let m=s.form;if(m==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let p=s.getAttribute("formaction")||m.getAttribute("action");if(a=p?Xa(p,e):null,t=s.getAttribute("formmethod")||m.getAttribute("method")||xd,o=Sm(s.getAttribute("formenctype"))||Sm(m.getAttribute("enctype"))||bd,l=new FormData(m,s),!mS()){let{name:y,type:x,value:_}=s;if(x==="image"){let w=y?`${y}.`:"";l.append(`${w}x`,"0"),l.append(`${w}y`,"0")}else y&&l.append(y,_)}}else{if(Wd(s))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=xd,a=null,o=bd,d=s}return l&&o==="text/plain"&&(d=l,l=void 0),{action:a,method:t.toLowerCase(),encType:o,formData:l,body:d}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function bg(s,e){if(s===!1||s===null||typeof s>"u")throw new Error(e)}function yS(s,e,t){let a=typeof s=="string"?new URL(s,typeof window>"u"?"server://singlefetch/":window.location.origin):s;return a.pathname==="/"?a.pathname=`_root.${t}`:e&&Xa(a.pathname,e)==="/"?a.pathname=`${e.replace(/\/$/,"")}/_root.${t}`:a.pathname=`${a.pathname.replace(/\/$/,"")}.${t}`,a}async function vS(s,e){if(s.id in e)return e[s.id];try{let t=await import(s.module);return e[s.id]=t,t}catch(t){return console.error(`Error loading route module \`${s.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function xS(s){return s==null?!1:s.href==null?s.rel==="preload"&&typeof s.imageSrcSet=="string"&&typeof s.imageSizes=="string":typeof s.rel=="string"&&typeof s.href=="string"}async function bS(s,e,t){let a=await Promise.all(s.map(async o=>{let l=e.routes[o.route.id];if(l){let d=await vS(l,t);return d.links?d.links():[]}return[]}));return ES(a.flat(1).filter(xS).filter(o=>o.rel==="stylesheet"||o.rel==="preload").map(o=>o.rel==="stylesheet"?{...o,rel:"prefetch",as:"style"}:{...o,rel:"prefetch"}))}function $v(s,e,t,a,o,l){let d=(p,y)=>t[y]?p.route.id!==t[y].route.id:!0,m=(p,y)=>t[y].pathname!==p.pathname||t[y].route.path?.endsWith("*")&&t[y].params["*"]!==p.params["*"];return l==="assets"?e.filter((p,y)=>d(p,y)||m(p,y)):l==="data"?e.filter((p,y)=>{let x=a.routes[p.route.id];if(!x||!x.hasLoader)return!1;if(d(p,y)||m(p,y))return!0;if(p.route.shouldRevalidate){let _=p.route.shouldRevalidate({currentUrl:new URL(o.pathname+o.search+o.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(s,window.origin),nextParams:p.params,defaultShouldRevalidate:!0});if(typeof _=="boolean")return _}return!0}):[]}function _S(s,e,{includeHydrateFallback:t}={}){return TS(s.map(a=>{let o=e.routes[a.route.id];if(!o)return[];let l=[o.module];return o.clientActionModule&&(l=l.concat(o.clientActionModule)),o.clientLoaderModule&&(l=l.concat(o.clientLoaderModule)),t&&o.hydrateFallbackModule&&(l=l.concat(o.hydrateFallbackModule)),o.imports&&(l=l.concat(o.imports)),l}).flat(1))}function TS(s){return[...new Set(s)]}function kS(s){let e={},t=Object.keys(s).sort();for(let a of t)e[a]=s[a];return e}function ES(s,e){let t=new Set;return new Set(e),s.reduce((a,o)=>{let l=JSON.stringify(kS(o));return t.has(l)||(t.add(l),a.push({key:l,link:o})),a},[])}function Bb(){let s=k.useContext(Ko);return bg(s,"You must render this element inside a <DataRouterContext.Provider> element"),s}function SS(){let s=k.useContext(Zd);return bg(s,"You must render this element inside a <DataRouterStateContext.Provider> element"),s}var _g=k.createContext(void 0);_g.displayName="FrameworkContext";function Gb(){let s=k.useContext(_g);return bg(s,"You must render this element inside a <HydratedRouter> element"),s}function wS(s,e){let t=k.useContext(_g),[a,o]=k.useState(!1),[l,d]=k.useState(!1),{onFocus:m,onBlur:p,onMouseEnter:y,onMouseLeave:x,onTouchStart:_}=e,w=k.useRef(null);k.useEffect(()=>{if(s==="render"&&d(!0),s==="viewport"){let L=$=>{$.forEach(X=>{d(X.isIntersecting)})},D=new IntersectionObserver(L,{threshold:.5});return w.current&&D.observe(w.current),()=>{D.disconnect()}}},[s]),k.useEffect(()=>{if(a){let L=setTimeout(()=>{d(!0)},100);return()=>{clearTimeout(L)}}},[a]);let j=()=>{o(!0)},B=()=>{o(!1),d(!1)};return t?s!=="intent"?[l,w,{}]:[l,w,{onFocus:rc(m,j),onBlur:rc(p,B),onMouseEnter:rc(y,j),onMouseLeave:rc(x,B),onTouchStart:rc(_,j)}]:[!1,w,{}]}function rc(s,e){return t=>{s&&s(t),t.defaultPrevented||e(t)}}function AS({page:s,...e}){let{router:t}=Bb(),a=k.useMemo(()=>Ib(t.routes,s,t.basename),[t.routes,s,t.basename]);return a?k.createElement(RS,{page:s,matches:a,...e}):null}function NS(s){let{manifest:e,routeModules:t}=Gb(),[a,o]=k.useState([]);return k.useEffect(()=>{let l=!1;return bS(s,e,t).then(d=>{l||o(d)}),()=>{l=!0}},[s,e,t]),a}function RS({page:s,matches:e,...t}){let a=qs(),{manifest:o,routeModules:l}=Gb(),{basename:d}=Bb(),{loaderData:m,matches:p}=SS(),y=k.useMemo(()=>$v(s,e,p,o,a,"data"),[s,e,p,o,a]),x=k.useMemo(()=>$v(s,e,p,o,a,"assets"),[s,e,p,o,a]),_=k.useMemo(()=>{if(s===a.pathname+a.search+a.hash)return[];let B=new Set,L=!1;if(e.forEach($=>{let X=o.routes[$.route.id];!X||!X.hasLoader||(!y.some(ne=>ne.route.id===$.route.id)&&$.route.id in m&&l[$.route.id]?.shouldRevalidate||X.hasClientLoader?L=!0:B.add($.route.id))}),B.size===0)return[];let D=yS(s,d,"data");return L&&B.size>0&&D.searchParams.set("_routes",e.filter($=>B.has($.route.id)).map($=>$.route.id).join(",")),[D.pathname+D.search]},[d,m,a,o,y,e,s,l]),w=k.useMemo(()=>_S(x,o),[x,o]),j=NS(x);return k.createElement(k.Fragment,null,_.map(B=>k.createElement("link",{key:B,rel:"prefetch",as:"fetch",href:B,...t})),w.map(B=>k.createElement("link",{key:B,rel:"modulepreload",href:B,...t})),j.map(({key:B,link:L})=>k.createElement("link",{key:B,nonce:t.nonce,...L})))}function CS(...s){return e=>{s.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var Hb=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{Hb&&(window.__reactRouterVersion="7.9.1")}catch{}function IS({basename:s,children:e,window:t}){let a=k.useRef();a.current==null&&(a.current=xE({window:t,v5Compat:!0}));let o=a.current,[l,d]=k.useState({action:o.action,location:o.location}),m=k.useCallback(p=>{k.startTransition(()=>d(p))},[d]);return k.useLayoutEffect(()=>o.listen(m),[o,m]),k.createElement(oS,{basename:s,children:e,location:l.location,navigationType:l.action,navigator:o})}var Fb=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,qb=k.forwardRef(function({onClick:e,discover:t="render",prefetch:a="none",relative:o,reloadDocument:l,replace:d,state:m,target:p,to:y,preventScrollReset:x,viewTransition:_,...w},j){let{basename:B}=k.useContext($r),L=typeof y=="string"&&Fb.test(y),D,$=!1;if(typeof y=="string"&&L&&(D=y,Hb))try{let R=new URL(window.location.href),P=y.startsWith("//")?new URL(R.protocol+y):new URL(y),V=Xa(P.pathname,B);P.origin===R.origin&&V!=null?y=V+P.search+P.hash:$=!0}catch{Hr(!1,`<Link to="${y}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let X=$E(y,{relative:o}),[ne,ce,de]=wS(a,w),me=OS(y,{replace:d,state:m,target:p,preventScrollReset:x,relative:o,viewTransition:_});function O(R){e&&e(R),R.defaultPrevented||me(R)}let N=k.createElement("a",{...w,...de,href:D||X,onClick:$||l?e:O,ref:CS(j,ce),target:p,"data-discover":!L&&t==="render"?"true":void 0});return ne&&!L?k.createElement(k.Fragment,null,N,k.createElement(AS,{page:X})):N});qb.displayName="Link";var jS=k.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:a="",end:o=!1,style:l,to:d,viewTransition:m,children:p,...y},x){let _=Dc(d,{relative:y.relative}),w=qs(),j=k.useContext(Zd),{navigator:B,basename:L}=k.useContext($r),D=j!=null&&US(_)&&m===!0,$=B.encodeLocation?B.encodeLocation(_).pathname:_.pathname,X=w.pathname,ne=j&&j.navigation&&j.navigation.location?j.navigation.location.pathname:null;t||(X=X.toLowerCase(),ne=ne?ne.toLowerCase():null,$=$.toLowerCase()),ne&&L&&(ne=Xa(ne,L)||ne);const ce=$!=="/"&&$.endsWith("/")?$.length-1:$.length;let de=X===$||!o&&X.startsWith($)&&X.charAt(ce)==="/",me=ne!=null&&(ne===$||!o&&ne.startsWith($)&&ne.charAt($.length)==="/"),O={isActive:de,isPending:me,isTransitioning:D},N=de?e:void 0,R;typeof a=="function"?R=a(O):R=[a,de?"active":null,me?"pending":null,D?"transitioning":null].filter(Boolean).join(" ");let P=typeof l=="function"?l(O):l;return k.createElement(qb,{...y,"aria-current":N,className:R,ref:x,style:P,to:d,viewTransition:m},typeof p=="function"?p(O):p)});jS.displayName="NavLink";var DS=k.forwardRef(({discover:s="render",fetcherKey:e,navigate:t,reloadDocument:a,replace:o,state:l,method:d=xd,action:m,onSubmit:p,relative:y,preventScrollReset:x,viewTransition:_,...w},j)=>{let B=zS(),L=LS(m,{relative:y}),D=d.toLowerCase()==="get"?"get":"post",$=typeof m=="string"&&Fb.test(m),X=ne=>{if(p&&p(ne),ne.defaultPrevented)return;ne.preventDefault();let ce=ne.nativeEvent.submitter,de=ce?.getAttribute("formmethod")||d;B(ce||ne.currentTarget,{fetcherKey:e,method:de,navigate:t,replace:o,state:l,relative:y,preventScrollReset:x,viewTransition:_})};return k.createElement("form",{ref:j,method:D,action:L,onSubmit:a?p:X,...w,"data-discover":!$&&s==="render"?"true":void 0})});DS.displayName="Form";function MS(s){return`${s} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function $b(s){let e=k.useContext(Ko);return Zt(e,MS(s)),e}function OS(s,{target:e,replace:t,state:a,preventScrollReset:o,relative:l,viewTransition:d}={}){let m=zb(),p=qs(),y=Dc(s,{relative:l});return k.useCallback(x=>{if(fS(x,e)){x.preventDefault();let _=t!==void 0?t:pc(p)===pc(y);m(s,{replace:_,state:a,preventScrollReset:o,relative:l,viewTransition:d})}},[p,m,y,t,a,e,s,o,l,d])}var PS=0,VS=()=>`__${String(++PS)}__`;function zS(){let{router:s}=$b("useSubmit"),{basename:e}=k.useContext($r),t=rS();return k.useCallback(async(a,o={})=>{let{action:l,method:d,encType:m,formData:p,body:y}=pS(a,e);if(o.navigate===!1){let x=o.fetcherKey||VS();await s.fetch(x,t,o.action||l,{preventScrollReset:o.preventScrollReset,formData:p,body:y,formMethod:o.method||d,formEncType:o.encType||m,flushSync:o.flushSync})}else await s.navigate(o.action||l,{preventScrollReset:o.preventScrollReset,formData:p,body:y,formMethod:o.method||d,formEncType:o.encType||m,replace:o.replace,state:o.state,fromRouteId:t,flushSync:o.flushSync,viewTransition:o.viewTransition})},[s,e,t])}function LS(s,{relative:e}={}){let{basename:t}=k.useContext($r),a=k.useContext(ba);Zt(a,"useFormAction must be used inside a RouteContext");let[o]=a.matches.slice(-1),l={...Dc(s||".",{relative:e})},d=qs();if(s==null){l.search=d.search;let m=new URLSearchParams(l.search),p=m.getAll("index");if(p.some(x=>x==="")){m.delete("index"),p.filter(_=>_).forEach(_=>m.append("index",_));let x=m.toString();l.search=x?`?${x}`:""}}return(!s||s===".")&&o.route.index&&(l.search=l.search?l.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(l.pathname=l.pathname==="/"?t:Ka([t,l.pathname])),pc(l)}function US(s,{relative:e}={}){let t=k.useContext(Ob);Zt(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:a}=$b("useViewTransitionState"),o=Dc(s,{relative:e});if(!t.isTransitioning)return!1;let l=Xa(t.currentLocation.pathname,a)||t.currentLocation.pathname,d=Xa(t.nextLocation.pathname,a)||t.nextLocation.pathname;return Id(o.pathname,d)!=null||Id(o.pathname,l)!=null}const BS=()=>{};var Kv={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kb=function(s){const e=[];let t=0;for(let a=0;a<s.length;a++){let o=s.charCodeAt(a);o<128?e[t++]=o:o<2048?(e[t++]=o>>6|192,e[t++]=o&63|128):(o&64512)===55296&&a+1<s.length&&(s.charCodeAt(a+1)&64512)===56320?(o=65536+((o&1023)<<10)+(s.charCodeAt(++a)&1023),e[t++]=o>>18|240,e[t++]=o>>12&63|128,e[t++]=o>>6&63|128,e[t++]=o&63|128):(e[t++]=o>>12|224,e[t++]=o>>6&63|128,e[t++]=o&63|128)}return e},GS=function(s){const e=[];let t=0,a=0;for(;t<s.length;){const o=s[t++];if(o<128)e[a++]=String.fromCharCode(o);else if(o>191&&o<224){const l=s[t++];e[a++]=String.fromCharCode((o&31)<<6|l&63)}else if(o>239&&o<365){const l=s[t++],d=s[t++],m=s[t++],p=((o&7)<<18|(l&63)<<12|(d&63)<<6|m&63)-65536;e[a++]=String.fromCharCode(55296+(p>>10)),e[a++]=String.fromCharCode(56320+(p&1023))}else{const l=s[t++],d=s[t++];e[a++]=String.fromCharCode((o&15)<<12|(l&63)<<6|d&63)}}return e.join("")},Yb={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(s,e){if(!Array.isArray(s))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,a=[];for(let o=0;o<s.length;o+=3){const l=s[o],d=o+1<s.length,m=d?s[o+1]:0,p=o+2<s.length,y=p?s[o+2]:0,x=l>>2,_=(l&3)<<4|m>>4;let w=(m&15)<<2|y>>6,j=y&63;p||(j=64,d||(w=64)),a.push(t[x],t[_],t[w],t[j])}return a.join("")},encodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(s):this.encodeByteArray(Kb(s),e)},decodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(s):GS(this.decodeStringToByteArray(s,e))},decodeStringToByteArray(s,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,a=[];for(let o=0;o<s.length;){const l=t[s.charAt(o++)],m=o<s.length?t[s.charAt(o)]:0;++o;const y=o<s.length?t[s.charAt(o)]:64;++o;const _=o<s.length?t[s.charAt(o)]:64;if(++o,l==null||m==null||y==null||_==null)throw new HS;const w=l<<2|m>>4;if(a.push(w),y!==64){const j=m<<4&240|y>>2;if(a.push(j),_!==64){const B=y<<6&192|_;a.push(B)}}}return a},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let s=0;s<this.ENCODED_VALS.length;s++)this.byteToCharMap_[s]=this.ENCODED_VALS.charAt(s),this.charToByteMap_[this.byteToCharMap_[s]]=s,this.byteToCharMapWebSafe_[s]=this.ENCODED_VALS_WEBSAFE.charAt(s),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[s]]=s,s>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(s)]=s,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(s)]=s)}}};class HS extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const FS=function(s){const e=Kb(s);return Yb.encodeByteArray(e,!0)},Qb=function(s){return FS(s).replace(/\./g,"")},Xb=function(s){try{return Yb.decodeString(s,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qS(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $S=()=>qS().__FIREBASE_DEFAULTS__,KS=()=>{if(typeof process>"u"||typeof Kv>"u")return;const s=Kv.__FIREBASE_DEFAULTS__;if(s)return JSON.parse(s)},YS=()=>{if(typeof document>"u")return;let s;try{s=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=s&&Xb(s[1]);return e&&JSON.parse(e)},Jd=()=>{try{return BS()||$S()||KS()||YS()}catch(s){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${s}`);return}},QS=s=>Jd()?.emulatorHosts?.[s],Zb=()=>Jd()?.config,Wb=s=>Jd()?.[`_${s}`];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XS{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,a)=>{t?this.reject(t):this.resolve(a),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,a))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qo(s){try{return(s.startsWith("http://")||s.startsWith("https://")?new URL(s).hostname:s).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Jb(s){return(await fetch(s,{credentials:"include"})).ok}const uc={};function ZS(){const s={prod:[],emulator:[]};for(const e of Object.keys(uc))uc[e]?s.emulator.push(e):s.prod.push(e);return s}function WS(s){let e=document.getElementById(s),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",s),t=!0),{created:t,element:e}}let Yv=!1;function JS(s,e){if(typeof window>"u"||typeof document>"u"||!Qo(window.location.host)||uc[s]===e||uc[s]||Yv)return;uc[s]=e;function t(w){return`__firebase__banner__${w}`}const a="__firebase__banner",l=ZS().prod.length>0;function d(){const w=document.getElementById(a);w&&w.remove()}function m(w){w.style.display="flex",w.style.background="#7faaf0",w.style.position="fixed",w.style.bottom="5px",w.style.left="5px",w.style.padding=".5em",w.style.borderRadius="5px",w.style.alignItems="center"}function p(w,j){w.setAttribute("width","24"),w.setAttribute("id",j),w.setAttribute("height","24"),w.setAttribute("viewBox","0 0 24 24"),w.setAttribute("fill","none"),w.style.marginLeft="-6px"}function y(){const w=document.createElement("span");return w.style.cursor="pointer",w.style.marginLeft="16px",w.style.fontSize="24px",w.innerHTML=" &times;",w.onclick=()=>{Yv=!0,d()},w}function x(w,j){w.setAttribute("id",j),w.innerText="Learn more",w.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",w.setAttribute("target","__blank"),w.style.paddingLeft="5px",w.style.textDecoration="underline"}function _(){const w=WS(a),j=t("text"),B=document.getElementById(j)||document.createElement("span"),L=t("learnmore"),D=document.getElementById(L)||document.createElement("a"),$=t("preprendIcon"),X=document.getElementById($)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(w.created){const ne=w.element;m(ne),x(D,L);const ce=y();p(X,$),ne.append(X,B,D,ce),document.body.appendChild(ne)}l?(B.innerText="Preview backend disconnected.",X.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(X.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,B.innerText="Preview backend running in this workspace."),B.setAttribute("id",j)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",_):_()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function ew(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Jn())}function tw(){const s=Jd()?.forceEnvironment;if(s==="node")return!0;if(s==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function nw(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function rw(){const s=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof s=="object"&&s.id!==void 0}function aw(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function sw(){const s=Jn();return s.indexOf("MSIE ")>=0||s.indexOf("Trident/")>=0}function iw(){return!tw()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function ow(){try{return typeof indexedDB=="object"}catch{return!1}}function lw(){return new Promise((s,e)=>{try{let t=!0;const a="validate-browser-context-for-indexeddb-analytics-module",o=self.indexedDB.open(a);o.onsuccess=()=>{o.result.close(),t||self.indexedDB.deleteDatabase(a),s(!0)},o.onupgradeneeded=()=>{t=!1},o.onerror=()=>{e(o.error?.message||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cw="FirebaseError";class ns extends Error{constructor(e,t,a){super(t),this.code=e,this.customData=a,this.name=cw,Object.setPrototypeOf(this,ns.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Mc.prototype.create)}}class Mc{constructor(e,t,a){this.service=e,this.serviceName=t,this.errors=a}create(e,...t){const a=t[0]||{},o=`${this.service}/${e}`,l=this.errors[e],d=l?uw(l,a):"Error",m=`${this.serviceName}: ${d} (${o}).`;return new ns(o,m,a)}}function uw(s,e){return s.replace(dw,(t,a)=>{const o=e[a];return o!=null?String(o):`<${a}?>`})}const dw=/\{\$([^}]+)}/g;function hw(s){for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e))return!1;return!0}function Si(s,e){if(s===e)return!0;const t=Object.keys(s),a=Object.keys(e);for(const o of t){if(!a.includes(o))return!1;const l=s[o],d=e[o];if(Qv(l)&&Qv(d)){if(!Si(l,d))return!1}else if(l!==d)return!1}for(const o of a)if(!t.includes(o))return!1;return!0}function Qv(s){return s!==null&&typeof s=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oc(s){const e=[];for(const[t,a]of Object.entries(s))Array.isArray(a)?a.forEach(o=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(o))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(a));return e.length?"&"+e.join("&"):""}function ac(s){const e={};return s.replace(/^\?/,"").split("&").forEach(a=>{if(a){const[o,l]=a.split("=");e[decodeURIComponent(o)]=decodeURIComponent(l)}}),e}function sc(s){const e=s.indexOf("?");if(!e)return"";const t=s.indexOf("#",e);return s.substring(e,t>0?t:void 0)}function fw(s,e){const t=new mw(s,e);return t.subscribe.bind(t)}class mw{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(a=>{this.error(a)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,a){let o;if(e===void 0&&t===void 0&&a===void 0)throw new Error("Missing Observer.");gw(e,["next","error","complete"])?o=e:o={next:e,error:t,complete:a},o.next===void 0&&(o.next=wm),o.error===void 0&&(o.error=wm),o.complete===void 0&&(o.complete=wm);const l=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?o.error(this.finalError):o.complete()}catch{}}),this.observers.push(o),l}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(a){typeof console<"u"&&console.error&&console.error(a)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function gw(s,e){if(typeof s!="object"||s===null)return!1;for(const t of e)if(t in s&&typeof s[t]=="function")return!0;return!1}function wm(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rr(s){return s&&s._delegate?s._delegate:s}class wi{constructor(e,t,a){this.name=e,this.instanceFactory=t,this.type=a,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ti="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pw{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const a=new XS;if(this.instancesDeferred.set(t,a),this.isInitialized(t)||this.shouldAutoInitialize())try{const o=this.getOrInitializeService({instanceIdentifier:t});o&&a.resolve(o)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),a=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(o){if(a)return null;throw o}else{if(a)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(vw(e))try{this.getOrInitializeService({instanceIdentifier:Ti})}catch{}for(const[t,a]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(t);try{const l=this.getOrInitializeService({instanceIdentifier:o});a.resolve(l)}catch{}}}}clearInstance(e=Ti){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ti){return this.instances.has(e)}getOptions(e=Ti){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,a=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(a))throw Error(`${this.name}(${a}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const o=this.getOrInitializeService({instanceIdentifier:a,options:t});for(const[l,d]of this.instancesDeferred.entries()){const m=this.normalizeInstanceIdentifier(l);a===m&&d.resolve(o)}return o}onInit(e,t){const a=this.normalizeInstanceIdentifier(t),o=this.onInitCallbacks.get(a)??new Set;o.add(e),this.onInitCallbacks.set(a,o);const l=this.instances.get(a);return l&&e(l,a),()=>{o.delete(e)}}invokeOnInitCallbacks(e,t){const a=this.onInitCallbacks.get(t);if(a)for(const o of a)try{o(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let a=this.instances.get(e);if(!a&&this.component&&(a=this.component.instanceFactory(this.container,{instanceIdentifier:yw(e),options:t}),this.instances.set(e,a),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(a,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,a)}catch{}return a||null}normalizeInstanceIdentifier(e=Ti){return this.component?this.component.multipleInstances?e:Ti:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function yw(s){return s===Ti?void 0:s}function vw(s){return s.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xw{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new pw(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var mt;(function(s){s[s.DEBUG=0]="DEBUG",s[s.VERBOSE=1]="VERBOSE",s[s.INFO=2]="INFO",s[s.WARN=3]="WARN",s[s.ERROR=4]="ERROR",s[s.SILENT=5]="SILENT"})(mt||(mt={}));const bw={debug:mt.DEBUG,verbose:mt.VERBOSE,info:mt.INFO,warn:mt.WARN,error:mt.ERROR,silent:mt.SILENT},_w=mt.INFO,Tw={[mt.DEBUG]:"log",[mt.VERBOSE]:"log",[mt.INFO]:"info",[mt.WARN]:"warn",[mt.ERROR]:"error"},kw=(s,e,...t)=>{if(e<s.logLevel)return;const a=new Date().toISOString(),o=Tw[e];if(o)console[o](`[${a}]  ${s.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Tg{constructor(e){this.name=e,this._logLevel=_w,this._logHandler=kw,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in mt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?bw[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,mt.DEBUG,...e),this._logHandler(this,mt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,mt.VERBOSE,...e),this._logHandler(this,mt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,mt.INFO,...e),this._logHandler(this,mt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,mt.WARN,...e),this._logHandler(this,mt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,mt.ERROR,...e),this._logHandler(this,mt.ERROR,...e)}}const Ew=(s,e)=>e.some(t=>s instanceof t);let Xv,Zv;function Sw(){return Xv||(Xv=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function ww(){return Zv||(Zv=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const e_=new WeakMap,Bm=new WeakMap,t_=new WeakMap,Am=new WeakMap,kg=new WeakMap;function Aw(s){const e=new Promise((t,a)=>{const o=()=>{s.removeEventListener("success",l),s.removeEventListener("error",d)},l=()=>{t(Ms(s.result)),o()},d=()=>{a(s.error),o()};s.addEventListener("success",l),s.addEventListener("error",d)});return e.then(t=>{t instanceof IDBCursor&&e_.set(t,s)}).catch(()=>{}),kg.set(e,s),e}function Nw(s){if(Bm.has(s))return;const e=new Promise((t,a)=>{const o=()=>{s.removeEventListener("complete",l),s.removeEventListener("error",d),s.removeEventListener("abort",d)},l=()=>{t(),o()},d=()=>{a(s.error||new DOMException("AbortError","AbortError")),o()};s.addEventListener("complete",l),s.addEventListener("error",d),s.addEventListener("abort",d)});Bm.set(s,e)}let Gm={get(s,e,t){if(s instanceof IDBTransaction){if(e==="done")return Bm.get(s);if(e==="objectStoreNames")return s.objectStoreNames||t_.get(s);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Ms(s[e])},set(s,e,t){return s[e]=t,!0},has(s,e){return s instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in s}};function Rw(s){Gm=s(Gm)}function Cw(s){return s===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const a=s.call(Nm(this),e,...t);return t_.set(a,e.sort?e.sort():[e]),Ms(a)}:ww().includes(s)?function(...e){return s.apply(Nm(this),e),Ms(e_.get(this))}:function(...e){return Ms(s.apply(Nm(this),e))}}function Iw(s){return typeof s=="function"?Cw(s):(s instanceof IDBTransaction&&Nw(s),Ew(s,Sw())?new Proxy(s,Gm):s)}function Ms(s){if(s instanceof IDBRequest)return Aw(s);if(Am.has(s))return Am.get(s);const e=Iw(s);return e!==s&&(Am.set(s,e),kg.set(e,s)),e}const Nm=s=>kg.get(s);function jw(s,e,{blocked:t,upgrade:a,blocking:o,terminated:l}={}){const d=indexedDB.open(s,e),m=Ms(d);return a&&d.addEventListener("upgradeneeded",p=>{a(Ms(d.result),p.oldVersion,p.newVersion,Ms(d.transaction),p)}),t&&d.addEventListener("blocked",p=>t(p.oldVersion,p.newVersion,p)),m.then(p=>{l&&p.addEventListener("close",()=>l()),o&&p.addEventListener("versionchange",y=>o(y.oldVersion,y.newVersion,y))}).catch(()=>{}),m}const Dw=["get","getKey","getAll","getAllKeys","count"],Mw=["put","add","delete","clear"],Rm=new Map;function Wv(s,e){if(!(s instanceof IDBDatabase&&!(e in s)&&typeof e=="string"))return;if(Rm.get(e))return Rm.get(e);const t=e.replace(/FromIndex$/,""),a=e!==t,o=Mw.includes(t);if(!(t in(a?IDBIndex:IDBObjectStore).prototype)||!(o||Dw.includes(t)))return;const l=async function(d,...m){const p=this.transaction(d,o?"readwrite":"readonly");let y=p.store;return a&&(y=y.index(m.shift())),(await Promise.all([y[t](...m),o&&p.done]))[0]};return Rm.set(e,l),l}Rw(s=>({...s,get:(e,t,a)=>Wv(e,t)||s.get(e,t,a),has:(e,t)=>!!Wv(e,t)||s.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ow{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(Pw(t)){const a=t.getImmediate();return`${a.library}/${a.version}`}else return null}).filter(t=>t).join(" ")}}function Pw(s){return s.getComponent()?.type==="VERSION"}const Hm="@firebase/app",Jv="0.14.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Za=new Tg("@firebase/app"),Vw="@firebase/app-compat",zw="@firebase/analytics-compat",Lw="@firebase/analytics",Uw="@firebase/app-check-compat",Bw="@firebase/app-check",Gw="@firebase/auth",Hw="@firebase/auth-compat",Fw="@firebase/database",qw="@firebase/data-connect",$w="@firebase/database-compat",Kw="@firebase/functions",Yw="@firebase/functions-compat",Qw="@firebase/installations",Xw="@firebase/installations-compat",Zw="@firebase/messaging",Ww="@firebase/messaging-compat",Jw="@firebase/performance",eA="@firebase/performance-compat",tA="@firebase/remote-config",nA="@firebase/remote-config-compat",rA="@firebase/storage",aA="@firebase/storage-compat",sA="@firebase/firestore",iA="@firebase/ai",oA="@firebase/firestore-compat",lA="firebase",cA="12.2.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fm="[DEFAULT]",uA={[Hm]:"fire-core",[Vw]:"fire-core-compat",[Lw]:"fire-analytics",[zw]:"fire-analytics-compat",[Bw]:"fire-app-check",[Uw]:"fire-app-check-compat",[Gw]:"fire-auth",[Hw]:"fire-auth-compat",[Fw]:"fire-rtdb",[qw]:"fire-data-connect",[$w]:"fire-rtdb-compat",[Kw]:"fire-fn",[Yw]:"fire-fn-compat",[Qw]:"fire-iid",[Xw]:"fire-iid-compat",[Zw]:"fire-fcm",[Ww]:"fire-fcm-compat",[Jw]:"fire-perf",[eA]:"fire-perf-compat",[tA]:"fire-rc",[nA]:"fire-rc-compat",[rA]:"fire-gcs",[aA]:"fire-gcs-compat",[sA]:"fire-fst",[oA]:"fire-fst-compat",[iA]:"fire-vertex","fire-js":"fire-js",[lA]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vc=new Map,dA=new Map,qm=new Map;function ex(s,e){try{s.container.addComponent(e)}catch(t){Za.debug(`Component ${e.name} failed to register with FirebaseApp ${s.name}`,t)}}function zo(s){const e=s.name;if(qm.has(e))return Za.debug(`There were multiple attempts to register component ${e}.`),!1;qm.set(e,s);for(const t of vc.values())ex(t,s);for(const t of dA.values())ex(t,s);return!0}function Eg(s,e){const t=s.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),s.container.getProvider(e)}function Dr(s){return s==null?!1:s.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hA={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Os=new Mc("app","Firebase",hA);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fA{constructor(e,t,a){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=a,this.container.addComponent(new wi("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Os.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xo=cA;function n_(s,e={}){let t=s;typeof e!="object"&&(e={name:e});const a={name:Fm,automaticDataCollectionEnabled:!0,...e},o=a.name;if(typeof o!="string"||!o)throw Os.create("bad-app-name",{appName:String(o)});if(t||(t=Zb()),!t)throw Os.create("no-options");const l=vc.get(o);if(l){if(Si(t,l.options)&&Si(a,l.config))return l;throw Os.create("duplicate-app",{appName:o})}const d=new xw(o);for(const p of qm.values())d.addComponent(p);const m=new fA(t,a,d);return vc.set(o,m),m}function r_(s=Fm){const e=vc.get(s);if(!e&&s===Fm&&Zb())return n_();if(!e)throw Os.create("no-app",{appName:s});return e}function mA(){return Array.from(vc.values())}function Ps(s,e,t){let a=uA[s]??s;t&&(a+=`-${t}`);const o=a.match(/\s|\//),l=e.match(/\s|\//);if(o||l){const d=[`Unable to register library "${a}" with version "${e}":`];o&&d.push(`library name "${a}" contains illegal characters (whitespace or "/")`),o&&l&&d.push("and"),l&&d.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Za.warn(d.join(" "));return}zo(new wi(`${a}-version`,()=>({library:a,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gA="firebase-heartbeat-database",pA=1,xc="firebase-heartbeat-store";let Cm=null;function a_(){return Cm||(Cm=jw(gA,pA,{upgrade:(s,e)=>{switch(e){case 0:try{s.createObjectStore(xc)}catch(t){console.warn(t)}}}}).catch(s=>{throw Os.create("idb-open",{originalErrorMessage:s.message})})),Cm}async function yA(s){try{const t=(await a_()).transaction(xc),a=await t.objectStore(xc).get(s_(s));return await t.done,a}catch(e){if(e instanceof ns)Za.warn(e.message);else{const t=Os.create("idb-get",{originalErrorMessage:e?.message});Za.warn(t.message)}}}async function tx(s,e){try{const a=(await a_()).transaction(xc,"readwrite");await a.objectStore(xc).put(e,s_(s)),await a.done}catch(t){if(t instanceof ns)Za.warn(t.message);else{const a=Os.create("idb-set",{originalErrorMessage:t?.message});Za.warn(a.message)}}}function s_(s){return`${s.name}!${s.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vA=1024,xA=30;class bA{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new TA(t),this._heartbeatsCachePromise=this._storage.read().then(a=>(this._heartbeatsCache=a,a))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),a=nx();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===a||this._heartbeatsCache.heartbeats.some(o=>o.date===a))return;if(this._heartbeatsCache.heartbeats.push({date:a,agent:t}),this._heartbeatsCache.heartbeats.length>xA){const o=kA(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Za.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=nx(),{heartbeatsToSend:t,unsentEntries:a}=_A(this._heartbeatsCache.heartbeats),o=Qb(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,a.length>0?(this._heartbeatsCache.heartbeats=a,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(e){return Za.warn(e),""}}}function nx(){return new Date().toISOString().substring(0,10)}function _A(s,e=vA){const t=[];let a=s.slice();for(const o of s){const l=t.find(d=>d.agent===o.agent);if(l){if(l.dates.push(o.date),rx(t)>e){l.dates.pop();break}}else if(t.push({agent:o.agent,dates:[o.date]}),rx(t)>e){t.pop();break}a=a.slice(1)}return{heartbeatsToSend:t,unsentEntries:a}}class TA{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return ow()?lw().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await yA(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const a=await this.read();return tx(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??a.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const a=await this.read();return tx(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??a.lastSentHeartbeatDate,heartbeats:[...a.heartbeats,...e.heartbeats]})}else return}}function rx(s){return Qb(JSON.stringify({version:2,heartbeats:s})).length}function kA(s){if(s.length===0)return-1;let e=0,t=s[0].date;for(let a=1;a<s.length;a++)s[a].date<t&&(t=s[a].date,e=a);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EA(s){zo(new wi("platform-logger",e=>new Ow(e),"PRIVATE")),zo(new wi("heartbeat",e=>new bA(e),"PRIVATE")),Ps(Hm,Jv,s),Ps(Hm,Jv,"esm2020"),Ps("fire-js","")}EA("");function i_(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const SA=i_,o_=new Mc("auth","Firebase",i_());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jd=new Tg("@firebase/auth");function wA(s,...e){jd.logLevel<=mt.WARN&&jd.warn(`Auth (${Xo}): ${s}`,...e)}function _d(s,...e){jd.logLevel<=mt.ERROR&&jd.error(`Auth (${Xo}): ${s}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fr(s,...e){throw Sg(s,...e)}function da(s,...e){return Sg(s,...e)}function l_(s,e,t){const a={...SA(),[e]:t};return new Mc("auth","Firebase",a).create(e,{appName:s.name})}function Ya(s){return l_(s,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Sg(s,...e){if(typeof s!="string"){const t=e[0],a=[...e.slice(1)];return a[0]&&(a[0].appName=s.name),s._errorFactory.create(t,...a)}return o_.create(s,...e)}function Ge(s,e,...t){if(!s)throw Sg(e,...t)}function qa(s){const e="INTERNAL ASSERTION FAILED: "+s;throw _d(e),new Error(e)}function Wa(s,e){s||qa(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $m(){return typeof self<"u"&&self.location?.href||""}function AA(){return ax()==="http:"||ax()==="https:"}function ax(){return typeof self<"u"&&self.location?.protocol||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NA(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(AA()||rw()||"connection"in navigator)?navigator.onLine:!0}function RA(){if(typeof navigator>"u")return null;const s=navigator;return s.languages&&s.languages[0]||s.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pc{constructor(e,t){this.shortDelay=e,this.longDelay=t,Wa(t>e,"Short delay should be less than long delay!"),this.isMobile=ew()||aw()}get(){return NA()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wg(s,e){Wa(s.emulator,"Emulator should always be set here");const{url:t}=s.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c_{static initialize(e,t,a){this.fetchImpl=e,t&&(this.headersImpl=t),a&&(this.responseImpl=a)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;qa("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;qa("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;qa("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CA={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IA=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],jA=new Pc(3e4,6e4);function $s(s,e){return s.tenantId&&!e.tenantId?{...e,tenantId:s.tenantId}:e}async function Ks(s,e,t,a,o={}){return u_(s,o,async()=>{let l={},d={};a&&(e==="GET"?d=a:l={body:JSON.stringify(a)});const m=Oc({key:s.config.apiKey,...d}).slice(1),p=await s._getAdditionalHeaders();p["Content-Type"]="application/json",s.languageCode&&(p["X-Firebase-Locale"]=s.languageCode);const y={method:e,headers:p,...l};return nw()||(y.referrerPolicy="no-referrer"),s.emulatorConfig&&Qo(s.emulatorConfig.host)&&(y.credentials="include"),c_.fetch()(await d_(s,s.config.apiHost,t,m),y)})}async function u_(s,e,t){s._canInitEmulator=!1;const a={...CA,...e};try{const o=new MA(s),l=await Promise.race([t(),o.promise]);o.clearNetworkTimeout();const d=await l.json();if("needConfirmation"in d)throw hd(s,"account-exists-with-different-credential",d);if(l.ok&&!("errorMessage"in d))return d;{const m=l.ok?d.errorMessage:d.error.message,[p,y]=m.split(" : ");if(p==="FEDERATED_USER_ID_ALREADY_LINKED")throw hd(s,"credential-already-in-use",d);if(p==="EMAIL_EXISTS")throw hd(s,"email-already-in-use",d);if(p==="USER_DISABLED")throw hd(s,"user-disabled",d);const x=a[p]||p.toLowerCase().replace(/[_\s]+/g,"-");if(y)throw l_(s,x,y);Fr(s,x)}}catch(o){if(o instanceof ns)throw o;Fr(s,"network-request-failed",{message:String(o)})}}async function Vc(s,e,t,a,o={}){const l=await Ks(s,e,t,a,o);return"mfaPendingCredential"in l&&Fr(s,"multi-factor-auth-required",{_serverResponse:l}),l}async function d_(s,e,t,a){const o=`${e}${t}?${a}`,l=s,d=l.config.emulator?wg(s.config,o):`${s.config.apiScheme}://${o}`;return IA.includes(t)&&(await l._persistenceManagerAvailable,l._getPersistenceType()==="COOKIE")?l._getPersistence()._getFinalTarget(d).toString():d}function DA(s){switch(s){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class MA{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,a)=>{this.timer=setTimeout(()=>a(da(this.auth,"network-request-failed")),jA.get())})}}function hd(s,e,t){const a={appName:s.name};t.email&&(a.email=t.email),t.phoneNumber&&(a.phoneNumber=t.phoneNumber);const o=da(s,e,a);return o.customData._tokenResponse=t,o}function sx(s){return s!==void 0&&s.enterprise!==void 0}class OA{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return DA(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function PA(s,e){return Ks(s,"GET","/v2/recaptchaConfig",$s(s,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function VA(s,e){return Ks(s,"POST","/v1/accounts:delete",e)}async function Dd(s,e){return Ks(s,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dc(s){if(s)try{const e=new Date(Number(s));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function zA(s,e=!1){const t=rr(s),a=await t.getIdToken(e),o=Ag(a);Ge(o&&o.exp&&o.auth_time&&o.iat,t.auth,"internal-error");const l=typeof o.firebase=="object"?o.firebase:void 0,d=l?.sign_in_provider;return{claims:o,token:a,authTime:dc(Im(o.auth_time)),issuedAtTime:dc(Im(o.iat)),expirationTime:dc(Im(o.exp)),signInProvider:d||null,signInSecondFactor:l?.sign_in_second_factor||null}}function Im(s){return Number(s)*1e3}function Ag(s){const[e,t,a]=s.split(".");if(e===void 0||t===void 0||a===void 0)return _d("JWT malformed, contained fewer than 3 sections"),null;try{const o=Xb(t);return o?JSON.parse(o):(_d("Failed to decode base64 JWT payload"),null)}catch(o){return _d("Caught error parsing JWT payload as JSON",o?.toString()),null}}function ix(s){const e=Ag(s);return Ge(e,"internal-error"),Ge(typeof e.exp<"u","internal-error"),Ge(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bc(s,e,t=!1){if(t)return e;try{return await e}catch(a){throw a instanceof ns&&LA(a)&&s.auth.currentUser===s&&await s.auth.signOut(),a}}function LA({code:s}){return s==="auth/user-disabled"||s==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UA{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const a=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,a)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Km{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=dc(this.lastLoginAt),this.creationTime=dc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Md(s){const e=s.auth,t=await s.getIdToken(),a=await bc(s,Dd(e,{idToken:t}));Ge(a?.users.length,e,"internal-error");const o=a.users[0];s._notifyReloadListener(o);const l=o.providerUserInfo?.length?h_(o.providerUserInfo):[],d=GA(s.providerData,l),m=s.isAnonymous,p=!(s.email&&o.passwordHash)&&!d?.length,y=m?p:!1,x={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:d,metadata:new Km(o.createdAt,o.lastLoginAt),isAnonymous:y};Object.assign(s,x)}async function BA(s){const e=rr(s);await Md(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function GA(s,e){return[...s.filter(a=>!e.some(o=>o.providerId===a.providerId)),...e]}function h_(s){return s.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function HA(s,e){const t=await u_(s,{},async()=>{const a=Oc({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:o,apiKey:l}=s.config,d=await d_(s,o,"/v1/token",`key=${l}`),m=await s._getAdditionalHeaders();m["Content-Type"]="application/x-www-form-urlencoded";const p={method:"POST",headers:m,body:a};return s.emulatorConfig&&Qo(s.emulatorConfig.host)&&(p.credentials="include"),c_.fetch()(d,p)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function FA(s,e){return Ks(s,"POST","/v2/accounts:revokeToken",$s(s,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Do{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ge(e.idToken,"internal-error"),Ge(typeof e.idToken<"u","internal-error"),Ge(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):ix(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Ge(e.length!==0,"internal-error");const t=ix(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Ge(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:a,refreshToken:o,expiresIn:l}=await HA(e,t);this.updateTokensAndExpiration(a,o,Number(l))}updateTokensAndExpiration(e,t,a){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+a*1e3}static fromJSON(e,t){const{refreshToken:a,accessToken:o,expirationTime:l}=t,d=new Do;return a&&(Ge(typeof a=="string","internal-error",{appName:e}),d.refreshToken=a),o&&(Ge(typeof o=="string","internal-error",{appName:e}),d.accessToken=o),l&&(Ge(typeof l=="number","internal-error",{appName:e}),d.expirationTime=l),d}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Do,this.toJSON())}_performRefresh(){return qa("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function As(s,e){Ge(typeof s=="string"||typeof s>"u","internal-error",{appName:e})}class Ur{constructor({uid:e,auth:t,stsTokenManager:a,...o}){this.providerId="firebase",this.proactiveRefresh=new UA(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=a,this.accessToken=a.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new Km(o.createdAt||void 0,o.lastLoginAt||void 0)}async getIdToken(e){const t=await bc(this,this.stsTokenManager.getToken(this.auth,e));return Ge(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return zA(this,e)}reload(){return BA(this)}_assign(e){this!==e&&(Ge(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Ur({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Ge(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let a=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),a=!0),t&&await Md(this),await this.auth._persistUserIfCurrent(this),a&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Dr(this.auth.app))return Promise.reject(Ya(this.auth));const e=await this.getIdToken();return await bc(this,VA(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const a=t.displayName??void 0,o=t.email??void 0,l=t.phoneNumber??void 0,d=t.photoURL??void 0,m=t.tenantId??void 0,p=t._redirectEventId??void 0,y=t.createdAt??void 0,x=t.lastLoginAt??void 0,{uid:_,emailVerified:w,isAnonymous:j,providerData:B,stsTokenManager:L}=t;Ge(_&&L,e,"internal-error");const D=Do.fromJSON(this.name,L);Ge(typeof _=="string",e,"internal-error"),As(a,e.name),As(o,e.name),Ge(typeof w=="boolean",e,"internal-error"),Ge(typeof j=="boolean",e,"internal-error"),As(l,e.name),As(d,e.name),As(m,e.name),As(p,e.name),As(y,e.name),As(x,e.name);const $=new Ur({uid:_,auth:e,email:o,emailVerified:w,displayName:a,isAnonymous:j,photoURL:d,phoneNumber:l,tenantId:m,stsTokenManager:D,createdAt:y,lastLoginAt:x});return B&&Array.isArray(B)&&($.providerData=B.map(X=>({...X}))),p&&($._redirectEventId=p),$}static async _fromIdTokenResponse(e,t,a=!1){const o=new Do;o.updateFromServerResponse(t);const l=new Ur({uid:t.localId,auth:e,stsTokenManager:o,isAnonymous:a});return await Md(l),l}static async _fromGetAccountInfoResponse(e,t,a){const o=t.users[0];Ge(o.localId!==void 0,"internal-error");const l=o.providerUserInfo!==void 0?h_(o.providerUserInfo):[],d=!(o.email&&o.passwordHash)&&!l?.length,m=new Do;m.updateFromIdToken(a);const p=new Ur({uid:o.localId,auth:e,stsTokenManager:m,isAnonymous:d}),y={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:l,metadata:new Km(o.createdAt,o.lastLoginAt),isAnonymous:!(o.email&&o.passwordHash)&&!l?.length};return Object.assign(p,y),p}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ox=new Map;function $a(s){Wa(s instanceof Function,"Expected a class definition");let e=ox.get(s);return e?(Wa(e instanceof s,"Instance stored in cache mismatched with class"),e):(e=new s,ox.set(s,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f_{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}f_.type="NONE";const lx=f_;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Td(s,e,t){return`firebase:${s}:${e}:${t}`}class Mo{constructor(e,t,a){this.persistence=e,this.auth=t,this.userKey=a;const{config:o,name:l}=this.auth;this.fullUserKey=Td(this.userKey,o.apiKey,l),this.fullPersistenceKey=Td("persistence",o.apiKey,l),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Dd(this.auth,{idToken:e}).catch(()=>{});return t?Ur._fromGetAccountInfoResponse(this.auth,t,e):null}return Ur._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,a="authUser"){if(!t.length)return new Mo($a(lx),e,a);const o=(await Promise.all(t.map(async y=>{if(await y._isAvailable())return y}))).filter(y=>y);let l=o[0]||$a(lx);const d=Td(a,e.config.apiKey,e.name);let m=null;for(const y of t)try{const x=await y._get(d);if(x){let _;if(typeof x=="string"){const w=await Dd(e,{idToken:x}).catch(()=>{});if(!w)break;_=await Ur._fromGetAccountInfoResponse(e,w,x)}else _=Ur._fromJSON(e,x);y!==l&&(m=_),l=y;break}}catch{}const p=o.filter(y=>y._shouldAllowMigration);return!l._shouldAllowMigration||!p.length?new Mo(l,e,a):(l=p[0],m&&await l._set(d,m.toJSON()),await Promise.all(t.map(async y=>{if(y!==l)try{await y._remove(d)}catch{}})),new Mo(l,e,a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cx(s){const e=s.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(y_(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(m_(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(x_(e))return"Blackberry";if(b_(e))return"Webos";if(g_(e))return"Safari";if((e.includes("chrome/")||p_(e))&&!e.includes("edge/"))return"Chrome";if(v_(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,a=s.match(t);if(a?.length===2)return a[1]}return"Other"}function m_(s=Jn()){return/firefox\//i.test(s)}function g_(s=Jn()){const e=s.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function p_(s=Jn()){return/crios\//i.test(s)}function y_(s=Jn()){return/iemobile/i.test(s)}function v_(s=Jn()){return/android/i.test(s)}function x_(s=Jn()){return/blackberry/i.test(s)}function b_(s=Jn()){return/webos/i.test(s)}function Ng(s=Jn()){return/iphone|ipad|ipod/i.test(s)||/macintosh/i.test(s)&&/mobile/i.test(s)}function qA(s=Jn()){return Ng(s)&&!!window.navigator?.standalone}function $A(){return sw()&&document.documentMode===10}function __(s=Jn()){return Ng(s)||v_(s)||b_(s)||x_(s)||/windows phone/i.test(s)||y_(s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T_(s,e=[]){let t;switch(s){case"Browser":t=cx(Jn());break;case"Worker":t=`${cx(Jn())}-${s}`;break;default:t=s}const a=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Xo}/${a}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KA{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const a=l=>new Promise((d,m)=>{try{const p=e(l);d(p)}catch(p){m(p)}});a.onAbort=t,this.queue.push(a);const o=this.queue.length-1;return()=>{this.queue[o]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const a of this.queue)await a(e),a.onAbort&&t.push(a.onAbort)}catch(a){t.reverse();for(const o of t)try{o()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:a?.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function YA(s,e={}){return Ks(s,"GET","/v2/passwordPolicy",$s(s,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QA=6;class XA{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??QA,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const a=this.customStrengthOptions.minPasswordLength,o=this.customStrengthOptions.maxPasswordLength;a&&(t.meetsMinPasswordLength=e.length>=a),o&&(t.meetsMaxPasswordLength=e.length<=o)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let a;for(let o=0;o<e.length;o++)a=e.charAt(o),this.updatePasswordCharacterOptionsStatuses(t,a>="a"&&a<="z",a>="A"&&a<="Z",a>="0"&&a<="9",this.allowedNonAlphanumericCharacters.includes(a))}updatePasswordCharacterOptionsStatuses(e,t,a,o,l){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=a)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=o)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZA{constructor(e,t,a,o){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=a,this.config=o,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new ux(this),this.idTokenSubscription=new ux(this),this.beforeStateQueue=new KA(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=o_,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=o.sdkClientVersion,this._persistenceManagerAvailable=new Promise(l=>this._resolvePersistenceManagerAvailable=l)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=$a(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Mo.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Dd(this,{idToken:e}),a=await Ur._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(a)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Dr(this.app)){const l=this.app.settings.authIdToken;return l?new Promise(d=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(l).then(d,d))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let a=t,o=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const l=this.redirectUser?._redirectEventId,d=a?._redirectEventId,m=await this.tryRedirectSignIn(e);(!l||l===d)&&m?.user&&(a=m.user,o=!0)}if(!a)return this.directlySetCurrentUser(null);if(!a._redirectEventId){if(o)try{await this.beforeStateQueue.runMiddleware(a)}catch(l){a=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(l))}return a?this.reloadAndSetCurrentUserOrClear(a):this.directlySetCurrentUser(null)}return Ge(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===a._redirectEventId?this.directlySetCurrentUser(a):this.reloadAndSetCurrentUserOrClear(a)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Md(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=RA()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Dr(this.app))return Promise.reject(Ya(this));const t=e?rr(e):null;return t&&Ge(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Ge(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Dr(this.app)?Promise.reject(Ya(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Dr(this.app)?Promise.reject(Ya(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence($a(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await YA(this),t=new XA(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Mc("auth","Firebase",e())}onAuthStateChanged(e,t,a){return this.registerStateListener(this.authStateSubscription,e,t,a)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,a){return this.registerStateListener(this.idTokenSubscription,e,t,a)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const a=this.onAuthStateChanged(()=>{a(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),a={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(a.tenantId=this.tenantId),await FA(this,a)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const a=await this.getOrInitRedirectPersistenceManager(t);return e===null?a.removeCurrentUser():a.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&$a(e)||this._popupRedirectResolver;Ge(t,this,"argument-error"),this.redirectPersistenceManager=await Mo.create(this,[$a(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,a,o){if(this._deleted)return()=>{};const l=typeof t=="function"?t:t.next.bind(t);let d=!1;const m=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ge(m,this,"internal-error"),m.then(()=>{d||l(this.currentUser)}),typeof t=="function"){const p=e.addObserver(t,a,o);return()=>{d=!0,p()}}else{const p=e.addObserver(t);return()=>{d=!0,p()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ge(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=T_(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const a=await this._getAppCheckToken();return a&&(e["X-Firebase-AppCheck"]=a),e}async _getAppCheckToken(){if(Dr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&wA(`Error while retrieving App Check token: ${e.error}`),e?.token}}function ji(s){return rr(s)}class ux{constructor(e){this.auth=e,this.observer=null,this.addObserver=fw(t=>this.observer=t)}get next(){return Ge(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let eh={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function WA(s){eh=s}function k_(s){return eh.loadJS(s)}function JA(){return eh.recaptchaEnterpriseScript}function eN(){return eh.gapiScript}function tN(s){return`__${s}${Math.floor(Math.random()*1e6)}`}class nN{constructor(){this.enterprise=new rN}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class rN{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const aN="recaptcha-enterprise",E_="NO_RECAPTCHA";class sN{constructor(e){this.type=aN,this.auth=ji(e)}async verify(e="verify",t=!1){async function a(l){if(!t){if(l.tenantId==null&&l._agentRecaptchaConfig!=null)return l._agentRecaptchaConfig.siteKey;if(l.tenantId!=null&&l._tenantRecaptchaConfigs[l.tenantId]!==void 0)return l._tenantRecaptchaConfigs[l.tenantId].siteKey}return new Promise(async(d,m)=>{PA(l,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(p=>{if(p.recaptchaKey===void 0)m(new Error("recaptcha Enterprise site key undefined"));else{const y=new OA(p);return l.tenantId==null?l._agentRecaptchaConfig=y:l._tenantRecaptchaConfigs[l.tenantId]=y,d(y.siteKey)}}).catch(p=>{m(p)})})}function o(l,d,m){const p=window.grecaptcha;sx(p)?p.enterprise.ready(()=>{p.enterprise.execute(l,{action:e}).then(y=>{d(y)}).catch(()=>{d(E_)})}):m(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new nN().execute("siteKey",{action:"verify"}):new Promise((l,d)=>{a(this.auth).then(m=>{if(!t&&sx(window.grecaptcha))o(m,l,d);else{if(typeof window>"u"){d(new Error("RecaptchaVerifier is only supported in browser"));return}let p=JA();p.length!==0&&(p+=m),k_(p).then(()=>{o(m,l,d)}).catch(y=>{d(y)})}}).catch(m=>{d(m)})})}}async function dx(s,e,t,a=!1,o=!1){const l=new sN(s);let d;if(o)d=E_;else try{d=await l.verify(t)}catch{d=await l.verify(t,!0)}const m={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in m){const p=m.phoneEnrollmentInfo.phoneNumber,y=m.phoneEnrollmentInfo.recaptchaToken;Object.assign(m,{phoneEnrollmentInfo:{phoneNumber:p,recaptchaToken:y,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in m){const p=m.phoneSignInInfo.recaptchaToken;Object.assign(m,{phoneSignInInfo:{recaptchaToken:p,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return m}return a?Object.assign(m,{captchaResp:d}):Object.assign(m,{captchaResponse:d}),Object.assign(m,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(m,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),m}async function Ym(s,e,t,a,o){if(s._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const l=await dx(s,e,t,t==="getOobCode");return a(s,l)}else return a(s,e).catch(async l=>{if(l.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const d=await dx(s,e,t,t==="getOobCode");return a(s,d)}else return Promise.reject(l)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iN(s,e){const t=Eg(s,"auth");if(t.isInitialized()){const o=t.getImmediate(),l=t.getOptions();if(Si(l,e??{}))return o;Fr(o,"already-initialized")}return t.initialize({options:e})}function oN(s,e){const t=e?.persistence||[],a=(Array.isArray(t)?t:[t]).map($a);e?.errorMap&&s._updateErrorMap(e.errorMap),s._initializeWithPersistence(a,e?.popupRedirectResolver)}function lN(s,e,t){const a=ji(s);Ge(/^https?:\/\//.test(e),a,"invalid-emulator-scheme");const o=!1,l=S_(e),{host:d,port:m}=cN(e),p=m===null?"":`:${m}`,y={url:`${l}//${d}${p}/`},x=Object.freeze({host:d,port:m,protocol:l.replace(":",""),options:Object.freeze({disableWarnings:o})});if(!a._canInitEmulator){Ge(a.config.emulator&&a.emulatorConfig,a,"emulator-config-failed"),Ge(Si(y,a.config.emulator)&&Si(x,a.emulatorConfig),a,"emulator-config-failed");return}a.config.emulator=y,a.emulatorConfig=x,a.settings.appVerificationDisabledForTesting=!0,Qo(d)?(Jb(`${l}//${d}${p}`),JS("Auth",!0)):uN()}function S_(s){const e=s.indexOf(":");return e<0?"":s.substr(0,e+1)}function cN(s){const e=S_(s),t=/(\/\/)?([^?#/]+)/.exec(s.substr(e.length));if(!t)return{host:"",port:null};const a=t[2].split("@").pop()||"",o=/^(\[[^\]]+\])(:|$)/.exec(a);if(o){const l=o[1];return{host:l,port:hx(a.substr(l.length+1))}}else{const[l,d]=a.split(":");return{host:l,port:hx(d)}}}function hx(s){if(!s)return null;const e=Number(s);return isNaN(e)?null:e}function uN(){function s(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",s):s())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rg{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return qa("not implemented")}_getIdTokenResponse(e){return qa("not implemented")}_linkToIdToken(e,t){return qa("not implemented")}_getReauthenticationResolver(e){return qa("not implemented")}}async function dN(s,e){return Ks(s,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hN(s,e){return Vc(s,"POST","/v1/accounts:signInWithPassword",$s(s,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fN(s,e){return Vc(s,"POST","/v1/accounts:signInWithEmailLink",$s(s,e))}async function mN(s,e){return Vc(s,"POST","/v1/accounts:signInWithEmailLink",$s(s,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _c extends Rg{constructor(e,t,a,o=null){super("password",a),this._email=e,this._password=t,this._tenantId=o}static _fromEmailAndPassword(e,t){return new _c(e,t,"password")}static _fromEmailAndCode(e,t,a=null){return new _c(e,t,"emailLink",a)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Ym(e,t,"signInWithPassword",hN);case"emailLink":return fN(e,{email:this._email,oobCode:this._password});default:Fr(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const a={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Ym(e,a,"signUpPassword",dN);case"emailLink":return mN(e,{idToken:t,email:this._email,oobCode:this._password});default:Fr(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Oo(s,e){return Vc(s,"POST","/v1/accounts:signInWithIdp",$s(s,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gN="http://localhost";class Ai extends Rg{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Ai(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Fr("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:a,signInMethod:o,...l}=t;if(!a||!o)return null;const d=new Ai(a,o);return d.idToken=l.idToken||void 0,d.accessToken=l.accessToken||void 0,d.secret=l.secret,d.nonce=l.nonce,d.pendingToken=l.pendingToken||null,d}_getIdTokenResponse(e){const t=this.buildRequest();return Oo(e,t)}_linkToIdToken(e,t){const a=this.buildRequest();return a.idToken=t,Oo(e,a)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Oo(e,t)}buildRequest(){const e={requestUri:gN,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Oc(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pN(s){switch(s){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function yN(s){const e=ac(sc(s)).link,t=e?ac(sc(e)).deep_link_id:null,a=ac(sc(s)).deep_link_id;return(a?ac(sc(a)).link:null)||a||t||e||s}class Cg{constructor(e){const t=ac(sc(e)),a=t.apiKey??null,o=t.oobCode??null,l=pN(t.mode??null);Ge(a&&o&&l,"argument-error"),this.apiKey=a,this.operation=l,this.code=o,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=yN(e);try{return new Cg(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zo{constructor(){this.providerId=Zo.PROVIDER_ID}static credential(e,t){return _c._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const a=Cg.parseLink(t);return Ge(a,"argument-error"),_c._fromEmailAndCode(e,a.code,a.tenantId)}}Zo.PROVIDER_ID="password";Zo.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Zo.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w_{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zc extends w_{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rs extends zc{constructor(){super("facebook.com")}static credential(e){return Ai._fromParams({providerId:Rs.PROVIDER_ID,signInMethod:Rs.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Rs.credentialFromTaggedObject(e)}static credentialFromError(e){return Rs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Rs.credential(e.oauthAccessToken)}catch{return null}}}Rs.FACEBOOK_SIGN_IN_METHOD="facebook.com";Rs.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cs extends zc{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Ai._fromParams({providerId:Cs.PROVIDER_ID,signInMethod:Cs.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Cs.credentialFromTaggedObject(e)}static credentialFromError(e){return Cs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:a}=e;if(!t&&!a)return null;try{return Cs.credential(t,a)}catch{return null}}}Cs.GOOGLE_SIGN_IN_METHOD="google.com";Cs.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Is extends zc{constructor(){super("github.com")}static credential(e){return Ai._fromParams({providerId:Is.PROVIDER_ID,signInMethod:Is.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Is.credentialFromTaggedObject(e)}static credentialFromError(e){return Is.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Is.credential(e.oauthAccessToken)}catch{return null}}}Is.GITHUB_SIGN_IN_METHOD="github.com";Is.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class js extends zc{constructor(){super("twitter.com")}static credential(e,t){return Ai._fromParams({providerId:js.PROVIDER_ID,signInMethod:js.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return js.credentialFromTaggedObject(e)}static credentialFromError(e){return js.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:a}=e;if(!t||!a)return null;try{return js.credential(t,a)}catch{return null}}}js.TWITTER_SIGN_IN_METHOD="twitter.com";js.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vN(s,e){return Vc(s,"POST","/v1/accounts:signUp",$s(s,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ni{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,a,o=!1){const l=await Ur._fromIdTokenResponse(e,a,o),d=fx(a);return new Ni({user:l,providerId:d,_tokenResponse:a,operationType:t})}static async _forOperation(e,t,a){await e._updateTokensIfNecessary(a,!0);const o=fx(a);return new Ni({user:e,providerId:o,_tokenResponse:a,operationType:t})}}function fx(s){return s.providerId?s.providerId:"phoneNumber"in s?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Od extends ns{constructor(e,t,a,o){super(t.code,t.message),this.operationType=a,this.user=o,Object.setPrototypeOf(this,Od.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:a}}static _fromErrorAndOperation(e,t,a,o){return new Od(e,t,a,o)}}function A_(s,e,t,a){return(e==="reauthenticate"?t._getReauthenticationResolver(s):t._getIdTokenResponse(s)).catch(l=>{throw l.code==="auth/multi-factor-auth-required"?Od._fromErrorAndOperation(s,l,e,a):l})}async function xN(s,e,t=!1){const a=await bc(s,e._linkToIdToken(s.auth,await s.getIdToken()),t);return Ni._forOperation(s,"link",a)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bN(s,e,t=!1){const{auth:a}=s;if(Dr(a.app))return Promise.reject(Ya(a));const o="reauthenticate";try{const l=await bc(s,A_(a,o,e,s),t);Ge(l.idToken,a,"internal-error");const d=Ag(l.idToken);Ge(d,a,"internal-error");const{sub:m}=d;return Ge(s.uid===m,a,"user-mismatch"),Ni._forOperation(s,o,l)}catch(l){throw l?.code==="auth/user-not-found"&&Fr(a,"user-mismatch"),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function N_(s,e,t=!1){if(Dr(s.app))return Promise.reject(Ya(s));const a="signIn",o=await A_(s,a,e),l=await Ni._fromIdTokenResponse(s,a,o);return t||await s._updateCurrentUser(l.user),l}async function _N(s,e){return N_(ji(s),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function R_(s){const e=ji(s);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function TN(s,e,t){if(Dr(s.app))return Promise.reject(Ya(s));const a=ji(s),d=await Ym(a,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",vN).catch(p=>{throw p.code==="auth/password-does-not-meet-requirements"&&R_(s),p}),m=await Ni._fromIdTokenResponse(a,"signIn",d);return await a._updateCurrentUser(m.user),m}function kN(s,e,t){return Dr(s.app)?Promise.reject(Ya(s)):_N(rr(s),Zo.credential(e,t)).catch(async a=>{throw a.code==="auth/password-does-not-meet-requirements"&&R_(s),a})}function EN(s,e,t,a){return rr(s).onIdTokenChanged(e,t,a)}function SN(s,e,t){return rr(s).beforeAuthStateChanged(e,t)}function wN(s,e,t,a){return rr(s).onAuthStateChanged(e,t,a)}function AN(s){return rr(s).signOut()}const Pd="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C_{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Pd,"1"),this.storage.removeItem(Pd),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NN=1e3,RN=10;class I_ extends C_{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=__(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const a=this.storage.getItem(t),o=this.localCache[t];a!==o&&e(t,o,a)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((d,m,p)=>{this.notifyListeners(d,p)});return}const a=e.key;t?this.detachListener():this.stopPolling();const o=()=>{const d=this.storage.getItem(a);!t&&this.localCache[a]===d||this.notifyListeners(a,d)},l=this.storage.getItem(a);$A()&&l!==e.newValue&&e.newValue!==e.oldValue?setTimeout(o,RN):o()}notifyListeners(e,t){this.localCache[e]=t;const a=this.listeners[e];if(a)for(const o of Array.from(a))o(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,a)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:a}),!0)})},NN)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}I_.type="LOCAL";const CN=I_;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j_ extends C_{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}j_.type="SESSION";const D_=j_;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IN(s){return Promise.all(s.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class th{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(o=>o.isListeningto(e));if(t)return t;const a=new th(e);return this.receivers.push(a),a}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:a,eventType:o,data:l}=t.data,d=this.handlersMap[o];if(!d?.size)return;t.ports[0].postMessage({status:"ack",eventId:a,eventType:o});const m=Array.from(d).map(async y=>y(t.origin,l)),p=await IN(m);t.ports[0].postMessage({status:"done",eventId:a,eventType:o,response:p})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}th.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ig(s="",e=10){let t="";for(let a=0;a<e;a++)t+=Math.floor(Math.random()*10);return s+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jN{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,a=50){const o=typeof MessageChannel<"u"?new MessageChannel:null;if(!o)throw new Error("connection_unavailable");let l,d;return new Promise((m,p)=>{const y=Ig("",20);o.port1.start();const x=setTimeout(()=>{p(new Error("unsupported_event"))},a);d={messageChannel:o,onMessage(_){const w=_;if(w.data.eventId===y)switch(w.data.status){case"ack":clearTimeout(x),l=setTimeout(()=>{p(new Error("timeout"))},3e3);break;case"done":clearTimeout(l),m(w.data.response);break;default:clearTimeout(x),clearTimeout(l),p(new Error("invalid_response"));break}}},this.handlers.add(d),o.port1.addEventListener("message",d.onMessage),this.target.postMessage({eventType:e,eventId:y,data:t},[o.port2])}).finally(()=>{d&&this.removeMessageHandler(d)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ha(){return window}function DN(s){ha().location.href=s}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M_(){return typeof ha().WorkerGlobalScope<"u"&&typeof ha().importScripts=="function"}async function MN(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function ON(){return navigator?.serviceWorker?.controller||null}function PN(){return M_()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O_="firebaseLocalStorageDb",VN=1,Vd="firebaseLocalStorage",P_="fbase_key";class Lc{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function nh(s,e){return s.transaction([Vd],e?"readwrite":"readonly").objectStore(Vd)}function zN(){const s=indexedDB.deleteDatabase(O_);return new Lc(s).toPromise()}function Qm(){const s=indexedDB.open(O_,VN);return new Promise((e,t)=>{s.addEventListener("error",()=>{t(s.error)}),s.addEventListener("upgradeneeded",()=>{const a=s.result;try{a.createObjectStore(Vd,{keyPath:P_})}catch(o){t(o)}}),s.addEventListener("success",async()=>{const a=s.result;a.objectStoreNames.contains(Vd)?e(a):(a.close(),await zN(),e(await Qm()))})})}async function mx(s,e,t){const a=nh(s,!0).put({[P_]:e,value:t});return new Lc(a).toPromise()}async function LN(s,e){const t=nh(s,!1).get(e),a=await new Lc(t).toPromise();return a===void 0?null:a.value}function gx(s,e){const t=nh(s,!0).delete(e);return new Lc(t).toPromise()}const UN=800,BN=3;class V_{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Qm(),this.db)}async _withRetries(e){let t=0;for(;;)try{const a=await this._openDb();return await e(a)}catch(a){if(t++>BN)throw a;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return M_()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=th._getInstance(PN()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await MN(),!this.activeServiceWorker)return;this.sender=new jN(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||ON()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Qm();return await mx(e,Pd,"1"),await gx(e,Pd),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(a=>mx(a,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(a=>LN(a,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>gx(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(o=>{const l=nh(o,!1).getAll();return new Lc(l).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],a=new Set;if(e.length!==0)for(const{fbase_key:o,value:l}of e)a.add(o),JSON.stringify(this.localCache[o])!==JSON.stringify(l)&&(this.notifyListeners(o,l),t.push(o));for(const o of Object.keys(this.localCache))this.localCache[o]&&!a.has(o)&&(this.notifyListeners(o,null),t.push(o));return t}notifyListeners(e,t){this.localCache[e]=t;const a=this.listeners[e];if(a)for(const o of Array.from(a))o(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),UN)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}V_.type="LOCAL";const GN=V_;new Pc(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HN(s,e){return e?$a(e):(Ge(s._popupRedirectResolver,s,"argument-error"),s._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jg extends Rg{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Oo(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Oo(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Oo(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function FN(s){return N_(s.auth,new jg(s),s.bypassAuthState)}function qN(s){const{auth:e,user:t}=s;return Ge(t,e,"internal-error"),bN(t,new jg(s),s.bypassAuthState)}async function $N(s){const{auth:e,user:t}=s;return Ge(t,e,"internal-error"),xN(t,new jg(s),s.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z_{constructor(e,t,a,o,l=!1){this.auth=e,this.resolver=a,this.user=o,this.bypassAuthState=l,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(a){this.reject(a)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:a,postBody:o,tenantId:l,error:d,type:m}=e;if(d){this.reject(d);return}const p={auth:this.auth,requestUri:t,sessionId:a,tenantId:l||void 0,postBody:o||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(m)(p))}catch(y){this.reject(y)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return FN;case"linkViaPopup":case"linkViaRedirect":return $N;case"reauthViaPopup":case"reauthViaRedirect":return qN;default:Fr(this.auth,"internal-error")}}resolve(e){Wa(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Wa(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KN=new Pc(2e3,1e4);class jo extends z_{constructor(e,t,a,o,l){super(e,t,o,l),this.provider=a,this.authWindow=null,this.pollId=null,jo.currentPopupAction&&jo.currentPopupAction.cancel(),jo.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Ge(e,this.auth,"internal-error"),e}async onExecution(){Wa(this.filter.length===1,"Popup operations only handle one event");const e=Ig();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(da(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(da(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,jo.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(da(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,KN.get())};e()}}jo.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YN="pendingRedirect",kd=new Map;class QN extends z_{constructor(e,t,a=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,a),this.eventId=null}async execute(){let e=kd.get(this.auth._key());if(!e){try{const a=await XN(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(a)}catch(t){e=()=>Promise.reject(t)}kd.set(this.auth._key(),e)}return this.bypassAuthState||kd.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function XN(s,e){const t=JN(e),a=WN(s);if(!await a._isAvailable())return!1;const o=await a._get(t)==="true";return await a._remove(t),o}function ZN(s,e){kd.set(s._key(),e)}function WN(s){return $a(s._redirectPersistence)}function JN(s){return Td(YN,s.config.apiKey,s.name)}async function e2(s,e,t=!1){if(Dr(s.app))return Promise.reject(Ya(s));const a=ji(s),o=HN(a,e),d=await new QN(a,o,t).execute();return d&&!t&&(delete d.user._redirectEventId,await a._persistUserIfCurrent(d.user),await a._setRedirectUser(null,e)),d}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t2=600*1e3;class n2{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(a=>{this.isEventForConsumer(e,a)&&(t=!0,this.sendToConsumer(e,a),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!r2(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!L_(e)){const a=e.error.code?.split("auth/")[1]||"internal-error";t.onError(da(this.auth,a))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const a=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&a}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=t2&&this.cachedEventUids.clear(),this.cachedEventUids.has(px(e))}saveEventToCache(e){this.cachedEventUids.add(px(e)),this.lastProcessedEventTime=Date.now()}}function px(s){return[s.type,s.eventId,s.sessionId,s.tenantId].filter(e=>e).join("-")}function L_({type:s,error:e}){return s==="unknown"&&e?.code==="auth/no-auth-event"}function r2(s){switch(s.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return L_(s);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function a2(s,e={}){return Ks(s,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s2=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,i2=/^https?/;async function o2(s){if(s.config.emulator)return;const{authorizedDomains:e}=await a2(s);for(const t of e)try{if(l2(t))return}catch{}Fr(s,"unauthorized-domain")}function l2(s){const e=$m(),{protocol:t,hostname:a}=new URL(e);if(s.startsWith("chrome-extension://")){const d=new URL(s);return d.hostname===""&&a===""?t==="chrome-extension:"&&s.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&d.hostname===a}if(!i2.test(t))return!1;if(s2.test(s))return a===s;const o=s.replace(/\./g,"\\.");return new RegExp("^(.+\\."+o+"|"+o+")$","i").test(a)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c2=new Pc(3e4,6e4);function yx(){const s=ha().___jsl;if(s?.H){for(const e of Object.keys(s.H))if(s.H[e].r=s.H[e].r||[],s.H[e].L=s.H[e].L||[],s.H[e].r=[...s.H[e].L],s.CP)for(let t=0;t<s.CP.length;t++)s.CP[t]=null}}function u2(s){return new Promise((e,t)=>{function a(){yx(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{yx(),t(da(s,"network-request-failed"))},timeout:c2.get()})}if(ha().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(ha().gapi?.load)a();else{const o=tN("iframefcb");return ha()[o]=()=>{gapi.load?a():t(da(s,"network-request-failed"))},k_(`${eN()}?onload=${o}`).catch(l=>t(l))}}).catch(e=>{throw Ed=null,e})}let Ed=null;function d2(s){return Ed=Ed||u2(s),Ed}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h2=new Pc(5e3,15e3),f2="__/auth/iframe",m2="emulator/auth/iframe",g2={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},p2=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function y2(s){const e=s.config;Ge(e.authDomain,s,"auth-domain-config-required");const t=e.emulator?wg(e,m2):`https://${s.config.authDomain}/${f2}`,a={apiKey:e.apiKey,appName:s.name,v:Xo},o=p2.get(s.config.apiHost);o&&(a.eid=o);const l=s._getFrameworks();return l.length&&(a.fw=l.join(",")),`${t}?${Oc(a).slice(1)}`}async function v2(s){const e=await d2(s),t=ha().gapi;return Ge(t,s,"internal-error"),e.open({where:document.body,url:y2(s),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:g2,dontclear:!0},a=>new Promise(async(o,l)=>{await a.restyle({setHideOnLeave:!1});const d=da(s,"network-request-failed"),m=ha().setTimeout(()=>{l(d)},h2.get());function p(){ha().clearTimeout(m),o(a)}a.ping(p).then(p,()=>{l(d)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x2={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},b2=500,_2=600,T2="_blank",k2="http://localhost";class vx{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function E2(s,e,t,a=b2,o=_2){const l=Math.max((window.screen.availHeight-o)/2,0).toString(),d=Math.max((window.screen.availWidth-a)/2,0).toString();let m="";const p={...x2,width:a.toString(),height:o.toString(),top:l,left:d},y=Jn().toLowerCase();t&&(m=p_(y)?T2:t),m_(y)&&(e=e||k2,p.scrollbars="yes");const x=Object.entries(p).reduce((w,[j,B])=>`${w}${j}=${B},`,"");if(qA(y)&&m!=="_self")return S2(e||"",m),new vx(null);const _=window.open(e||"",m,x);Ge(_,s,"popup-blocked");try{_.focus()}catch{}return new vx(_)}function S2(s,e){const t=document.createElement("a");t.href=s,t.target=e;const a=document.createEvent("MouseEvent");a.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(a)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w2="__/auth/handler",A2="emulator/auth/handler",N2=encodeURIComponent("fac");async function xx(s,e,t,a,o,l){Ge(s.config.authDomain,s,"auth-domain-config-required"),Ge(s.config.apiKey,s,"invalid-api-key");const d={apiKey:s.config.apiKey,appName:s.name,authType:t,redirectUrl:a,v:Xo,eventId:o};if(e instanceof w_){e.setDefaultLanguage(s.languageCode),d.providerId=e.providerId||"",hw(e.getCustomParameters())||(d.customParameters=JSON.stringify(e.getCustomParameters()));for(const[x,_]of Object.entries({}))d[x]=_}if(e instanceof zc){const x=e.getScopes().filter(_=>_!=="");x.length>0&&(d.scopes=x.join(","))}s.tenantId&&(d.tid=s.tenantId);const m=d;for(const x of Object.keys(m))m[x]===void 0&&delete m[x];const p=await s._getAppCheckToken(),y=p?`#${N2}=${encodeURIComponent(p)}`:"";return`${R2(s)}?${Oc(m).slice(1)}${y}`}function R2({config:s}){return s.emulator?wg(s,A2):`https://${s.authDomain}/${w2}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jm="webStorageSupport";class C2{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=D_,this._completeRedirectFn=e2,this._overrideRedirectResult=ZN}async _openPopup(e,t,a,o){Wa(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const l=await xx(e,t,a,$m(),o);return E2(e,l,Ig())}async _openRedirect(e,t,a,o){await this._originValidation(e);const l=await xx(e,t,a,$m(),o);return DN(l),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:o,promise:l}=this.eventManagers[t];return o?Promise.resolve(o):(Wa(l,"If manager is not set, promise should be"),l)}const a=this.initAndGetManager(e);return this.eventManagers[t]={promise:a},a.catch(()=>{delete this.eventManagers[t]}),a}async initAndGetManager(e){const t=await v2(e),a=new n2(e);return t.register("authEvent",o=>(Ge(o?.authEvent,e,"invalid-auth-event"),{status:a.onEvent(o.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:a},this.iframes[e._key()]=t,a}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(jm,{type:jm},o=>{const l=o?.[0]?.[jm];l!==void 0&&t(!!l),Fr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=o2(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return __()||g_()||Ng()}}const I2=C2;var bx="@firebase/auth",_x="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j2{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(a=>{e(a?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Ge(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function D2(s){switch(s){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function M2(s){zo(new wi("auth",(e,{options:t})=>{const a=e.getProvider("app").getImmediate(),o=e.getProvider("heartbeat"),l=e.getProvider("app-check-internal"),{apiKey:d,authDomain:m}=a.options;Ge(d&&!d.includes(":"),"invalid-api-key",{appName:a.name});const p={apiKey:d,authDomain:m,clientPlatform:s,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:T_(s)},y=new ZA(a,o,l,p);return oN(y,t),y},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,a)=>{e.getProvider("auth-internal").initialize()})),zo(new wi("auth-internal",e=>{const t=ji(e.getProvider("auth").getImmediate());return(a=>new j2(a))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Ps(bx,_x,D2(s)),Ps(bx,_x,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O2=300,P2=Wb("authIdTokenMaxAge")||O2;let Tx=null;const V2=s=>async e=>{const t=e&&await e.getIdTokenResult(),a=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(a&&a>P2)return;const o=t?.token;Tx!==o&&(Tx=o,await fetch(s,{method:o?"POST":"DELETE",headers:o?{Authorization:`Bearer ${o}`}:{}}))};function z2(s=r_()){const e=Eg(s,"auth");if(e.isInitialized())return e.getImmediate();const t=iN(s,{popupRedirectResolver:I2,persistence:[GN,CN,D_]}),a=Wb("authTokenSyncURL");if(a&&typeof isSecureContext=="boolean"&&isSecureContext){const l=new URL(a,location.origin);if(location.origin===l.origin){const d=V2(l.toString());SN(t,d,()=>d(t.currentUser)),EN(t,m=>d(m))}}const o=QS("auth");return o&&lN(t,`http://${o}`),t}function L2(){return document.getElementsByTagName("head")?.[0]??document}WA({loadJS(s){return new Promise((e,t)=>{const a=document.createElement("script");a.setAttribute("src",s),a.onload=e,a.onerror=o=>{const l=da("internal-error");l.customData=o,t(l)},a.type="text/javascript",a.charset="UTF-8",L2().appendChild(a)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});M2("Browser");var U2="firebase",B2="12.2.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ps(U2,B2,"app");var kx=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Vs,U_;(function(){var s;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(O,N){function R(){}R.prototype=N.prototype,O.D=N.prototype,O.prototype=new R,O.prototype.constructor=O,O.C=function(P,V,I){for(var A=Array(arguments.length-2),we=2;we<arguments.length;we++)A[we-2]=arguments[we];return N.prototype[V].apply(P,A)}}function t(){this.blockSize=-1}function a(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(a,t),a.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function o(O,N,R){R||(R=0);var P=Array(16);if(typeof N=="string")for(var V=0;16>V;++V)P[V]=N.charCodeAt(R++)|N.charCodeAt(R++)<<8|N.charCodeAt(R++)<<16|N.charCodeAt(R++)<<24;else for(V=0;16>V;++V)P[V]=N[R++]|N[R++]<<8|N[R++]<<16|N[R++]<<24;N=O.g[0],R=O.g[1],V=O.g[2];var I=O.g[3],A=N+(I^R&(V^I))+P[0]+3614090360&4294967295;N=R+(A<<7&4294967295|A>>>25),A=I+(V^N&(R^V))+P[1]+3905402710&4294967295,I=N+(A<<12&4294967295|A>>>20),A=V+(R^I&(N^R))+P[2]+606105819&4294967295,V=I+(A<<17&4294967295|A>>>15),A=R+(N^V&(I^N))+P[3]+3250441966&4294967295,R=V+(A<<22&4294967295|A>>>10),A=N+(I^R&(V^I))+P[4]+4118548399&4294967295,N=R+(A<<7&4294967295|A>>>25),A=I+(V^N&(R^V))+P[5]+1200080426&4294967295,I=N+(A<<12&4294967295|A>>>20),A=V+(R^I&(N^R))+P[6]+2821735955&4294967295,V=I+(A<<17&4294967295|A>>>15),A=R+(N^V&(I^N))+P[7]+4249261313&4294967295,R=V+(A<<22&4294967295|A>>>10),A=N+(I^R&(V^I))+P[8]+1770035416&4294967295,N=R+(A<<7&4294967295|A>>>25),A=I+(V^N&(R^V))+P[9]+2336552879&4294967295,I=N+(A<<12&4294967295|A>>>20),A=V+(R^I&(N^R))+P[10]+4294925233&4294967295,V=I+(A<<17&4294967295|A>>>15),A=R+(N^V&(I^N))+P[11]+2304563134&4294967295,R=V+(A<<22&4294967295|A>>>10),A=N+(I^R&(V^I))+P[12]+1804603682&4294967295,N=R+(A<<7&4294967295|A>>>25),A=I+(V^N&(R^V))+P[13]+4254626195&4294967295,I=N+(A<<12&4294967295|A>>>20),A=V+(R^I&(N^R))+P[14]+2792965006&4294967295,V=I+(A<<17&4294967295|A>>>15),A=R+(N^V&(I^N))+P[15]+1236535329&4294967295,R=V+(A<<22&4294967295|A>>>10),A=N+(V^I&(R^V))+P[1]+4129170786&4294967295,N=R+(A<<5&4294967295|A>>>27),A=I+(R^V&(N^R))+P[6]+3225465664&4294967295,I=N+(A<<9&4294967295|A>>>23),A=V+(N^R&(I^N))+P[11]+643717713&4294967295,V=I+(A<<14&4294967295|A>>>18),A=R+(I^N&(V^I))+P[0]+3921069994&4294967295,R=V+(A<<20&4294967295|A>>>12),A=N+(V^I&(R^V))+P[5]+3593408605&4294967295,N=R+(A<<5&4294967295|A>>>27),A=I+(R^V&(N^R))+P[10]+38016083&4294967295,I=N+(A<<9&4294967295|A>>>23),A=V+(N^R&(I^N))+P[15]+3634488961&4294967295,V=I+(A<<14&4294967295|A>>>18),A=R+(I^N&(V^I))+P[4]+3889429448&4294967295,R=V+(A<<20&4294967295|A>>>12),A=N+(V^I&(R^V))+P[9]+568446438&4294967295,N=R+(A<<5&4294967295|A>>>27),A=I+(R^V&(N^R))+P[14]+3275163606&4294967295,I=N+(A<<9&4294967295|A>>>23),A=V+(N^R&(I^N))+P[3]+4107603335&4294967295,V=I+(A<<14&4294967295|A>>>18),A=R+(I^N&(V^I))+P[8]+1163531501&4294967295,R=V+(A<<20&4294967295|A>>>12),A=N+(V^I&(R^V))+P[13]+2850285829&4294967295,N=R+(A<<5&4294967295|A>>>27),A=I+(R^V&(N^R))+P[2]+4243563512&4294967295,I=N+(A<<9&4294967295|A>>>23),A=V+(N^R&(I^N))+P[7]+1735328473&4294967295,V=I+(A<<14&4294967295|A>>>18),A=R+(I^N&(V^I))+P[12]+2368359562&4294967295,R=V+(A<<20&4294967295|A>>>12),A=N+(R^V^I)+P[5]+4294588738&4294967295,N=R+(A<<4&4294967295|A>>>28),A=I+(N^R^V)+P[8]+2272392833&4294967295,I=N+(A<<11&4294967295|A>>>21),A=V+(I^N^R)+P[11]+1839030562&4294967295,V=I+(A<<16&4294967295|A>>>16),A=R+(V^I^N)+P[14]+4259657740&4294967295,R=V+(A<<23&4294967295|A>>>9),A=N+(R^V^I)+P[1]+2763975236&4294967295,N=R+(A<<4&4294967295|A>>>28),A=I+(N^R^V)+P[4]+1272893353&4294967295,I=N+(A<<11&4294967295|A>>>21),A=V+(I^N^R)+P[7]+4139469664&4294967295,V=I+(A<<16&4294967295|A>>>16),A=R+(V^I^N)+P[10]+3200236656&4294967295,R=V+(A<<23&4294967295|A>>>9),A=N+(R^V^I)+P[13]+681279174&4294967295,N=R+(A<<4&4294967295|A>>>28),A=I+(N^R^V)+P[0]+3936430074&4294967295,I=N+(A<<11&4294967295|A>>>21),A=V+(I^N^R)+P[3]+3572445317&4294967295,V=I+(A<<16&4294967295|A>>>16),A=R+(V^I^N)+P[6]+76029189&4294967295,R=V+(A<<23&4294967295|A>>>9),A=N+(R^V^I)+P[9]+3654602809&4294967295,N=R+(A<<4&4294967295|A>>>28),A=I+(N^R^V)+P[12]+3873151461&4294967295,I=N+(A<<11&4294967295|A>>>21),A=V+(I^N^R)+P[15]+530742520&4294967295,V=I+(A<<16&4294967295|A>>>16),A=R+(V^I^N)+P[2]+3299628645&4294967295,R=V+(A<<23&4294967295|A>>>9),A=N+(V^(R|~I))+P[0]+4096336452&4294967295,N=R+(A<<6&4294967295|A>>>26),A=I+(R^(N|~V))+P[7]+1126891415&4294967295,I=N+(A<<10&4294967295|A>>>22),A=V+(N^(I|~R))+P[14]+2878612391&4294967295,V=I+(A<<15&4294967295|A>>>17),A=R+(I^(V|~N))+P[5]+4237533241&4294967295,R=V+(A<<21&4294967295|A>>>11),A=N+(V^(R|~I))+P[12]+1700485571&4294967295,N=R+(A<<6&4294967295|A>>>26),A=I+(R^(N|~V))+P[3]+2399980690&4294967295,I=N+(A<<10&4294967295|A>>>22),A=V+(N^(I|~R))+P[10]+4293915773&4294967295,V=I+(A<<15&4294967295|A>>>17),A=R+(I^(V|~N))+P[1]+2240044497&4294967295,R=V+(A<<21&4294967295|A>>>11),A=N+(V^(R|~I))+P[8]+1873313359&4294967295,N=R+(A<<6&4294967295|A>>>26),A=I+(R^(N|~V))+P[15]+4264355552&4294967295,I=N+(A<<10&4294967295|A>>>22),A=V+(N^(I|~R))+P[6]+2734768916&4294967295,V=I+(A<<15&4294967295|A>>>17),A=R+(I^(V|~N))+P[13]+1309151649&4294967295,R=V+(A<<21&4294967295|A>>>11),A=N+(V^(R|~I))+P[4]+4149444226&4294967295,N=R+(A<<6&4294967295|A>>>26),A=I+(R^(N|~V))+P[11]+3174756917&4294967295,I=N+(A<<10&4294967295|A>>>22),A=V+(N^(I|~R))+P[2]+718787259&4294967295,V=I+(A<<15&4294967295|A>>>17),A=R+(I^(V|~N))+P[9]+3951481745&4294967295,O.g[0]=O.g[0]+N&4294967295,O.g[1]=O.g[1]+(V+(A<<21&4294967295|A>>>11))&4294967295,O.g[2]=O.g[2]+V&4294967295,O.g[3]=O.g[3]+I&4294967295}a.prototype.u=function(O,N){N===void 0&&(N=O.length);for(var R=N-this.blockSize,P=this.B,V=this.h,I=0;I<N;){if(V==0)for(;I<=R;)o(this,O,I),I+=this.blockSize;if(typeof O=="string"){for(;I<N;)if(P[V++]=O.charCodeAt(I++),V==this.blockSize){o(this,P),V=0;break}}else for(;I<N;)if(P[V++]=O[I++],V==this.blockSize){o(this,P),V=0;break}}this.h=V,this.o+=N},a.prototype.v=function(){var O=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);O[0]=128;for(var N=1;N<O.length-8;++N)O[N]=0;var R=8*this.o;for(N=O.length-8;N<O.length;++N)O[N]=R&255,R/=256;for(this.u(O),O=Array(16),N=R=0;4>N;++N)for(var P=0;32>P;P+=8)O[R++]=this.g[N]>>>P&255;return O};function l(O,N){var R=m;return Object.prototype.hasOwnProperty.call(R,O)?R[O]:R[O]=N(O)}function d(O,N){this.h=N;for(var R=[],P=!0,V=O.length-1;0<=V;V--){var I=O[V]|0;P&&I==N||(R[V]=I,P=!1)}this.g=R}var m={};function p(O){return-128<=O&&128>O?l(O,function(N){return new d([N|0],0>N?-1:0)}):new d([O|0],0>O?-1:0)}function y(O){if(isNaN(O)||!isFinite(O))return _;if(0>O)return D(y(-O));for(var N=[],R=1,P=0;O>=R;P++)N[P]=O/R|0,R*=4294967296;return new d(N,0)}function x(O,N){if(O.length==0)throw Error("number format error: empty string");if(N=N||10,2>N||36<N)throw Error("radix out of range: "+N);if(O.charAt(0)=="-")return D(x(O.substring(1),N));if(0<=O.indexOf("-"))throw Error('number format error: interior "-" character');for(var R=y(Math.pow(N,8)),P=_,V=0;V<O.length;V+=8){var I=Math.min(8,O.length-V),A=parseInt(O.substring(V,V+I),N);8>I?(I=y(Math.pow(N,I)),P=P.j(I).add(y(A))):(P=P.j(R),P=P.add(y(A)))}return P}var _=p(0),w=p(1),j=p(16777216);s=d.prototype,s.m=function(){if(L(this))return-D(this).m();for(var O=0,N=1,R=0;R<this.g.length;R++){var P=this.i(R);O+=(0<=P?P:4294967296+P)*N,N*=4294967296}return O},s.toString=function(O){if(O=O||10,2>O||36<O)throw Error("radix out of range: "+O);if(B(this))return"0";if(L(this))return"-"+D(this).toString(O);for(var N=y(Math.pow(O,6)),R=this,P="";;){var V=ce(R,N).g;R=$(R,V.j(N));var I=((0<R.g.length?R.g[0]:R.h)>>>0).toString(O);if(R=V,B(R))return I+P;for(;6>I.length;)I="0"+I;P=I+P}},s.i=function(O){return 0>O?0:O<this.g.length?this.g[O]:this.h};function B(O){if(O.h!=0)return!1;for(var N=0;N<O.g.length;N++)if(O.g[N]!=0)return!1;return!0}function L(O){return O.h==-1}s.l=function(O){return O=$(this,O),L(O)?-1:B(O)?0:1};function D(O){for(var N=O.g.length,R=[],P=0;P<N;P++)R[P]=~O.g[P];return new d(R,~O.h).add(w)}s.abs=function(){return L(this)?D(this):this},s.add=function(O){for(var N=Math.max(this.g.length,O.g.length),R=[],P=0,V=0;V<=N;V++){var I=P+(this.i(V)&65535)+(O.i(V)&65535),A=(I>>>16)+(this.i(V)>>>16)+(O.i(V)>>>16);P=A>>>16,I&=65535,A&=65535,R[V]=A<<16|I}return new d(R,R[R.length-1]&-2147483648?-1:0)};function $(O,N){return O.add(D(N))}s.j=function(O){if(B(this)||B(O))return _;if(L(this))return L(O)?D(this).j(D(O)):D(D(this).j(O));if(L(O))return D(this.j(D(O)));if(0>this.l(j)&&0>O.l(j))return y(this.m()*O.m());for(var N=this.g.length+O.g.length,R=[],P=0;P<2*N;P++)R[P]=0;for(P=0;P<this.g.length;P++)for(var V=0;V<O.g.length;V++){var I=this.i(P)>>>16,A=this.i(P)&65535,we=O.i(V)>>>16,se=O.i(V)&65535;R[2*P+2*V]+=A*se,X(R,2*P+2*V),R[2*P+2*V+1]+=I*se,X(R,2*P+2*V+1),R[2*P+2*V+1]+=A*we,X(R,2*P+2*V+1),R[2*P+2*V+2]+=I*we,X(R,2*P+2*V+2)}for(P=0;P<N;P++)R[P]=R[2*P+1]<<16|R[2*P];for(P=N;P<2*N;P++)R[P]=0;return new d(R,0)};function X(O,N){for(;(O[N]&65535)!=O[N];)O[N+1]+=O[N]>>>16,O[N]&=65535,N++}function ne(O,N){this.g=O,this.h=N}function ce(O,N){if(B(N))throw Error("division by zero");if(B(O))return new ne(_,_);if(L(O))return N=ce(D(O),N),new ne(D(N.g),D(N.h));if(L(N))return N=ce(O,D(N)),new ne(D(N.g),N.h);if(30<O.g.length){if(L(O)||L(N))throw Error("slowDivide_ only works with positive integers.");for(var R=w,P=N;0>=P.l(O);)R=de(R),P=de(P);var V=me(R,1),I=me(P,1);for(P=me(P,2),R=me(R,2);!B(P);){var A=I.add(P);0>=A.l(O)&&(V=V.add(R),I=A),P=me(P,1),R=me(R,1)}return N=$(O,V.j(N)),new ne(V,N)}for(V=_;0<=O.l(N);){for(R=Math.max(1,Math.floor(O.m()/N.m())),P=Math.ceil(Math.log(R)/Math.LN2),P=48>=P?1:Math.pow(2,P-48),I=y(R),A=I.j(N);L(A)||0<A.l(O);)R-=P,I=y(R),A=I.j(N);B(I)&&(I=w),V=V.add(I),O=$(O,A)}return new ne(V,O)}s.A=function(O){return ce(this,O).h},s.and=function(O){for(var N=Math.max(this.g.length,O.g.length),R=[],P=0;P<N;P++)R[P]=this.i(P)&O.i(P);return new d(R,this.h&O.h)},s.or=function(O){for(var N=Math.max(this.g.length,O.g.length),R=[],P=0;P<N;P++)R[P]=this.i(P)|O.i(P);return new d(R,this.h|O.h)},s.xor=function(O){for(var N=Math.max(this.g.length,O.g.length),R=[],P=0;P<N;P++)R[P]=this.i(P)^O.i(P);return new d(R,this.h^O.h)};function de(O){for(var N=O.g.length+1,R=[],P=0;P<N;P++)R[P]=O.i(P)<<1|O.i(P-1)>>>31;return new d(R,O.h)}function me(O,N){var R=N>>5;N%=32;for(var P=O.g.length-R,V=[],I=0;I<P;I++)V[I]=0<N?O.i(I+R)>>>N|O.i(I+R+1)<<32-N:O.i(I+R);return new d(V,O.h)}a.prototype.digest=a.prototype.v,a.prototype.reset=a.prototype.s,a.prototype.update=a.prototype.u,U_=a,d.prototype.add=d.prototype.add,d.prototype.multiply=d.prototype.j,d.prototype.modulo=d.prototype.A,d.prototype.compare=d.prototype.l,d.prototype.toNumber=d.prototype.m,d.prototype.toString=d.prototype.toString,d.prototype.getBits=d.prototype.i,d.fromNumber=y,d.fromString=x,Vs=d}).apply(typeof kx<"u"?kx:typeof self<"u"?self:typeof window<"u"?window:{});var fd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var B_,ic,G_,Sd,Xm,H_,F_,q_;(function(){var s,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(h,v,b){return h==Array.prototype||h==Object.prototype||(h[v]=b.value),h};function t(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof fd=="object"&&fd];for(var v=0;v<h.length;++v){var b=h[v];if(b&&b.Math==Math)return b}throw Error("Cannot find global object")}var a=t(this);function o(h,v){if(v)e:{var b=a;h=h.split(".");for(var S=0;S<h.length-1;S++){var F=h[S];if(!(F in b))break e;b=b[F]}h=h[h.length-1],S=b[h],v=v(S),v!=S&&v!=null&&e(b,h,{configurable:!0,writable:!0,value:v})}}function l(h,v){h instanceof String&&(h+="");var b=0,S=!1,F={next:function(){if(!S&&b<h.length){var te=b++;return{value:v(te,h[te]),done:!1}}return S=!0,{done:!0,value:void 0}}};return F[Symbol.iterator]=function(){return F},F}o("Array.prototype.values",function(h){return h||function(){return l(this,function(v,b){return b})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var d=d||{},m=this||self;function p(h){var v=typeof h;return v=v!="object"?v:h?Array.isArray(h)?"array":v:"null",v=="array"||v=="object"&&typeof h.length=="number"}function y(h){var v=typeof h;return v=="object"&&h!=null||v=="function"}function x(h,v,b){return h.call.apply(h.bind,arguments)}function _(h,v,b){if(!h)throw Error();if(2<arguments.length){var S=Array.prototype.slice.call(arguments,2);return function(){var F=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(F,S),h.apply(v,F)}}return function(){return h.apply(v,arguments)}}function w(h,v,b){return w=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?x:_,w.apply(null,arguments)}function j(h,v){var b=Array.prototype.slice.call(arguments,1);return function(){var S=b.slice();return S.push.apply(S,arguments),h.apply(this,S)}}function B(h,v){function b(){}b.prototype=v.prototype,h.aa=v.prototype,h.prototype=new b,h.prototype.constructor=h,h.Qb=function(S,F,te){for(var xe=Array(arguments.length-2),vt=2;vt<arguments.length;vt++)xe[vt-2]=arguments[vt];return v.prototype[F].apply(S,xe)}}function L(h){const v=h.length;if(0<v){const b=Array(v);for(let S=0;S<v;S++)b[S]=h[S];return b}return[]}function D(h,v){for(let b=1;b<arguments.length;b++){const S=arguments[b];if(p(S)){const F=h.length||0,te=S.length||0;h.length=F+te;for(let xe=0;xe<te;xe++)h[F+xe]=S[xe]}else h.push(S)}}class ${constructor(v,b){this.i=v,this.j=b,this.h=0,this.g=null}get(){let v;return 0<this.h?(this.h--,v=this.g,this.g=v.next,v.next=null):v=this.i(),v}}function X(h){return/^[\s\xa0]*$/.test(h)}function ne(){var h=m.navigator;return h&&(h=h.userAgent)?h:""}function ce(h){return ce[" "](h),h}ce[" "]=function(){};var de=ne().indexOf("Gecko")!=-1&&!(ne().toLowerCase().indexOf("webkit")!=-1&&ne().indexOf("Edge")==-1)&&!(ne().indexOf("Trident")!=-1||ne().indexOf("MSIE")!=-1)&&ne().indexOf("Edge")==-1;function me(h,v,b){for(const S in h)v.call(b,h[S],S,h)}function O(h,v){for(const b in h)v.call(void 0,h[b],b,h)}function N(h){const v={};for(const b in h)v[b]=h[b];return v}const R="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function P(h,v){let b,S;for(let F=1;F<arguments.length;F++){S=arguments[F];for(b in S)h[b]=S[b];for(let te=0;te<R.length;te++)b=R[te],Object.prototype.hasOwnProperty.call(S,b)&&(h[b]=S[b])}}function V(h){var v=1;h=h.split(":");const b=[];for(;0<v&&h.length;)b.push(h.shift()),v--;return h.length&&b.push(h.join(":")),b}function I(h){m.setTimeout(()=>{throw h},0)}function A(){var h=re;let v=null;return h.g&&(v=h.g,h.g=h.g.next,h.g||(h.h=null),v.next=null),v}class we{constructor(){this.h=this.g=null}add(v,b){const S=se.get();S.set(v,b),this.h?this.h.next=S:this.g=S,this.h=S}}var se=new $(()=>new q,h=>h.reset());class q{constructor(){this.next=this.g=this.h=null}set(v,b){this.h=v,this.g=b,this.next=null}reset(){this.next=this.g=this.h=null}}let he,G=!1,re=new we,C=()=>{const h=m.Promise.resolve(void 0);he=()=>{h.then(Z)}};var Z=()=>{for(var h;h=A();){try{h.h.call(h.g)}catch(b){I(b)}var v=se;v.j(h),100>v.h&&(v.h++,h.next=v.g,v.g=h)}G=!1};function H(){this.s=this.s,this.C=this.C}H.prototype.s=!1,H.prototype.ma=function(){this.s||(this.s=!0,this.N())},H.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Y(h,v){this.type=h,this.g=this.target=v,this.defaultPrevented=!1}Y.prototype.h=function(){this.defaultPrevented=!0};var oe=(function(){if(!m.addEventListener||!Object.defineProperty)return!1;var h=!1,v=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const b=()=>{};m.addEventListener("test",b,v),m.removeEventListener("test",b,v)}catch{}return h})();function ge(h,v){if(Y.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h){var b=this.type=h.type,S=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;if(this.target=h.target||h.srcElement,this.g=v,v=h.relatedTarget){if(de){e:{try{ce(v.nodeName);var F=!0;break e}catch{}F=!1}F||(v=null)}}else b=="mouseover"?v=h.fromElement:b=="mouseout"&&(v=h.toElement);this.relatedTarget=v,S?(this.clientX=S.clientX!==void 0?S.clientX:S.pageX,this.clientY=S.clientY!==void 0?S.clientY:S.pageY,this.screenX=S.screenX||0,this.screenY=S.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=typeof h.pointerType=="string"?h.pointerType:be[h.pointerType]||"",this.state=h.state,this.i=h,h.defaultPrevented&&ge.aa.h.call(this)}}B(ge,Y);var be={2:"touch",3:"pen",4:"mouse"};ge.prototype.h=function(){ge.aa.h.call(this);var h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var nt="closure_listenable_"+(1e6*Math.random()|0),We=0;function st(h,v,b,S,F){this.listener=h,this.proxy=null,this.src=v,this.type=b,this.capture=!!S,this.ha=F,this.key=++We,this.da=this.fa=!1}function Re(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function Me(h){this.src=h,this.g={},this.h=0}Me.prototype.add=function(h,v,b,S,F){var te=h.toString();h=this.g[te],h||(h=this.g[te]=[],this.h++);var xe=St(h,v,S,F);return-1<xe?(v=h[xe],b||(v.fa=!1)):(v=new st(v,this.src,te,!!S,F),v.fa=b,h.push(v)),v};function kt(h,v){var b=v.type;if(b in h.g){var S=h.g[b],F=Array.prototype.indexOf.call(S,v,void 0),te;(te=0<=F)&&Array.prototype.splice.call(S,F,1),te&&(Re(v),h.g[b].length==0&&(delete h.g[b],h.h--))}}function St(h,v,b,S){for(var F=0;F<h.length;++F){var te=h[F];if(!te.da&&te.listener==v&&te.capture==!!b&&te.ha==S)return F}return-1}var Qe="closure_lm_"+(1e6*Math.random()|0),jt={};function rt(h,v,b,S,F){if(Array.isArray(v)){for(var te=0;te<v.length;te++)rt(h,v[te],b,S,F);return null}return b=ar(b),h&&h[nt]?h.K(v,b,y(S)?!!S.capture:!1,F):$e(h,v,b,!1,S,F)}function $e(h,v,b,S,F,te){if(!v)throw Error("Invalid event type");var xe=y(F)?!!F.capture:!!F,vt=Jt(h);if(vt||(h[Qe]=vt=new Me(h)),b=vt.add(v,b,S,xe,te),b.proxy)return b;if(S=$t(),b.proxy=S,S.src=h,S.listener=b,h.addEventListener)oe||(F=xe),F===void 0&&(F=!1),h.addEventListener(v.toString(),S,F);else if(h.attachEvent)h.attachEvent(Wt(v.toString()),S);else if(h.addListener&&h.removeListener)h.addListener(S);else throw Error("addEventListener and attachEvent are unavailable.");return b}function $t(){function h(b){return v.call(h.src,h.listener,b)}const v=fn;return h}function at(h,v,b,S,F){if(Array.isArray(v))for(var te=0;te<v.length;te++)at(h,v[te],b,S,F);else S=y(S)?!!S.capture:!!S,b=ar(b),h&&h[nt]?(h=h.i,v=String(v).toString(),v in h.g&&(te=h.g[v],b=St(te,b,S,F),-1<b&&(Re(te[b]),Array.prototype.splice.call(te,b,1),te.length==0&&(delete h.g[v],h.h--)))):h&&(h=Jt(h))&&(v=h.g[v.toString()],h=-1,v&&(h=St(v,b,S,F)),(b=-1<h?v[h]:null)&&zt(b))}function zt(h){if(typeof h!="number"&&h&&!h.da){var v=h.src;if(v&&v[nt])kt(v.i,h);else{var b=h.type,S=h.proxy;v.removeEventListener?v.removeEventListener(b,S,h.capture):v.detachEvent?v.detachEvent(Wt(b),S):v.addListener&&v.removeListener&&v.removeListener(S),(b=Jt(v))?(kt(b,h),b.h==0&&(b.src=null,v[Qe]=null)):Re(h)}}}function Wt(h){return h in jt?jt[h]:jt[h]="on"+h}function fn(h,v){if(h.da)h=!0;else{v=new ge(v,this);var b=h.listener,S=h.ha||h.src;h.fa&&zt(h),h=b.call(S,v)}return h}function Jt(h){return h=h[Qe],h instanceof Me?h:null}var Vn="__closure_events_fn_"+(1e9*Math.random()>>>0);function ar(h){return typeof h=="function"?h:(h[Vn]||(h[Vn]=function(v){return h.handleEvent(v)}),h[Vn])}function Je(){H.call(this),this.i=new Me(this),this.M=this,this.F=null}B(Je,H),Je.prototype[nt]=!0,Je.prototype.removeEventListener=function(h,v,b,S){at(this,h,v,b,S)};function lt(h,v){var b,S=h.F;if(S)for(b=[];S;S=S.F)b.push(S);if(h=h.M,S=v.type||v,typeof v=="string")v=new Y(v,h);else if(v instanceof Y)v.target=v.target||h;else{var F=v;v=new Y(S,h),P(v,F)}if(F=!0,b)for(var te=b.length-1;0<=te;te--){var xe=v.g=b[te];F=Yt(xe,S,!0,v)&&F}if(xe=v.g=h,F=Yt(xe,S,!0,v)&&F,F=Yt(xe,S,!1,v)&&F,b)for(te=0;te<b.length;te++)xe=v.g=b[te],F=Yt(xe,S,!1,v)&&F}Je.prototype.N=function(){if(Je.aa.N.call(this),this.i){var h=this.i,v;for(v in h.g){for(var b=h.g[v],S=0;S<b.length;S++)Re(b[S]);delete h.g[v],h.h--}}this.F=null},Je.prototype.K=function(h,v,b,S){return this.i.add(String(h),v,!1,b,S)},Je.prototype.L=function(h,v,b,S){return this.i.add(String(h),v,!0,b,S)};function Yt(h,v,b,S){if(v=h.i.g[String(v)],!v)return!0;v=v.concat();for(var F=!0,te=0;te<v.length;++te){var xe=v[te];if(xe&&!xe.da&&xe.capture==b){var vt=xe.listener,kn=xe.ha||xe.src;xe.fa&&kt(h.i,xe),F=vt.call(kn,S)!==!1&&F}}return F&&!S.defaultPrevented}function Qt(h,v,b){if(typeof h=="function")b&&(h=w(h,b));else if(h&&typeof h.handleEvent=="function")h=w(h.handleEvent,h);else throw Error("Invalid listener argument");return 2147483647<Number(v)?-1:m.setTimeout(h,v||0)}function Kr(h){h.g=Qt(()=>{h.g=null,h.i&&(h.i=!1,Kr(h))},h.l);const v=h.h;h.h=null,h.m.apply(null,v)}class Yr extends H{constructor(v,b){super(),this.m=v,this.l=b,this.h=null,this.i=!1,this.g=null}j(v){this.h=arguments,this.g?this.i=!0:Kr(this)}N(){super.N(),this.g&&(m.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function dr(h){H.call(this),this.h=h,this.g={}}B(dr,H);var zn=[];function sr(h){me(h.g,function(v,b){this.g.hasOwnProperty(b)&&zt(v)},h),h.g={}}dr.prototype.N=function(){dr.aa.N.call(this),sr(this)},dr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Nn=m.JSON.stringify,Pe=m.JSON.parse,Fe=class{stringify(h){return m.JSON.stringify(h,void 0)}parse(h){return m.JSON.parse(h,void 0)}};function yt(){}yt.prototype.h=null;function Dt(h){return h.h||(h.h=h.i())}function pe(){}var _e={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Ne(){Y.call(this,"d")}B(Ne,Y);function De(){Y.call(this,"c")}B(De,Y);var Ke={},Lt=null;function ee(){return Lt=Lt||new Je}Ke.La="serverreachability";function Te(h){Y.call(this,Ke.La,h)}B(Te,Y);function Ie(h){const v=ee();lt(v,new Te(v))}Ke.STAT_EVENT="statevent";function Be(h,v){Y.call(this,Ke.STAT_EVENT,h),this.stat=v}B(Be,Y);function Ee(h){const v=ee();lt(v,new Be(v,h))}Ke.Ma="timingevent";function ye(h,v){Y.call(this,Ke.Ma,h),this.size=v}B(ye,Y);function Ae(h,v){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return m.setTimeout(function(){h()},v)}function ke(){this.g=!0}ke.prototype.xa=function(){this.g=!1};function it(h,v,b,S,F,te){h.info(function(){if(h.g)if(te)for(var xe="",vt=te.split("&"),kn=0;kn<vt.length;kn++){var xt=vt[kn].split("=");if(1<xt.length){var jn=xt[0];xt=xt[1];var En=jn.split("_");xe=2<=En.length&&En[1]=="type"?xe+(jn+"="+xt+"&"):xe+(jn+"=redacted&")}}else xe=null;else xe=te;return"XMLHTTP REQ ("+S+") [attempt "+F+"]: "+v+`
`+b+`
`+xe})}function nn(h,v,b,S,F,te,xe){h.info(function(){return"XMLHTTP RESP ("+S+") [ attempt "+F+"]: "+v+`
`+b+`
`+te+" "+xe})}function Kt(h,v,b,S){h.info(function(){return"XMLHTTP TEXT ("+v+"): "+_n(h,b)+(S?" "+S:"")})}function Rn(h,v){h.info(function(){return"TIMEOUT: "+v})}ke.prototype.info=function(){};function _n(h,v){if(!h.g)return v;if(!v)return null;try{var b=JSON.parse(v);if(b){for(h=0;h<b.length;h++)if(Array.isArray(b[h])){var S=b[h];if(!(2>S.length)){var F=S[1];if(Array.isArray(F)&&!(1>F.length)){var te=F[0];if(te!="noop"&&te!="stop"&&te!="close")for(var xe=1;xe<F.length;xe++)F[xe]=""}}}}return Nn(b)}catch{return v}}var on={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},ln={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Tn;function Cn(){}B(Cn,yt),Cn.prototype.g=function(){return new XMLHttpRequest},Cn.prototype.i=function(){return{}},Tn=new Cn;function cn(h,v,b,S){this.j=h,this.i=v,this.l=b,this.R=S||1,this.U=new dr(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Ut}function Ut(){this.i=null,this.g="",this.h=!1}var ze={},ve={};function Xe(h,v,b){h.L=1,h.v=Ws(hr(v)),h.m=b,h.P=!0,Kn(h,null)}function Kn(h,v){h.F=Date.now(),Xr(h),h.A=hr(h.v);var b=h.A,S=h.R;Array.isArray(S)||(S=[String(S)]),ll(b.i,"t",S),h.C=0,b=h.j.J,h.h=new Ut,h.g=ou(h.j,b?v:null,!h.m),0<h.O&&(h.M=new Yr(w(h.Y,h,h.g),h.O)),v=h.U,b=h.g,S=h.ca;var F="readystatechange";Array.isArray(F)||(F&&(zn[0]=F.toString()),F=zn);for(var te=0;te<F.length;te++){var xe=rt(b,F[te],S||v.handleEvent,!1,v.h||v);if(!xe)break;v.g[xe.key]=xe}v=h.H?N(h.H):{},h.m?(h.u||(h.u="POST"),v["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.A,h.u,h.m,v)):(h.u="GET",h.g.ea(h.A,h.u,null,v)),Ie(),it(h.i,h.u,h.A,h.l,h.R,h.m)}cn.prototype.ca=function(h){h=h.target;const v=this.M;v&&Er(h)==3?v.j():this.Y(h)},cn.prototype.Y=function(h){try{if(h==this.g)e:{const En=Er(this.g);var v=this.g.Ba();const Ca=this.g.Z();if(!(3>En)&&(En!=3||this.g&&(this.h.h||this.g.oa()||Jc(this.g)))){this.J||En!=4||v==7||(v==8||0>=Ca?Ie(3):Ie(2)),rs(this);var b=this.g.Z();this.X=b;t:if(Qr(this)){var S=Jc(this.g);h="";var F=S.length,te=Er(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Ln(this),Zr(this);var xe="";break t}this.h.i=new m.TextDecoder}for(v=0;v<F;v++)this.h.h=!0,h+=this.h.i.decode(S[v],{stream:!(te&&v==F-1)});S.length=0,this.h.g+=h,this.C=0,xe=this.h.g}else xe=this.g.oa();if(this.o=b==200,nn(this.i,this.u,this.A,this.l,this.R,En,b),this.o){if(this.T&&!this.K){t:{if(this.g){var vt,kn=this.g;if((vt=kn.g?kn.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!X(vt)){var xt=vt;break t}}xt=null}if(b=xt)Kt(this.i,this.l,b,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Qs(this,b);else{this.o=!1,this.s=3,Ee(12),Ln(this),Zr(this);break e}}if(this.P){b=!0;let Un;for(;!this.J&&this.C<xe.length;)if(Un=Ta(this,xe),Un==ve){En==4&&(this.s=4,Ee(14),b=!1),Kt(this.i,this.l,null,"[Incomplete Response]");break}else if(Un==ze){this.s=4,Ee(15),Kt(this.i,this.l,xe,"[Invalid Chunk]"),b=!1;break}else Kt(this.i,this.l,Un,null),Qs(this,Un);if(Qr(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),En!=4||xe.length!=0||this.h.h||(this.s=1,Ee(16),b=!1),this.o=this.o&&b,!b)Kt(this.i,this.l,xe,"[Invalid Chunked Response]"),Ln(this),Zr(this);else if(0<xe.length&&!this.W){this.W=!0;var jn=this.j;jn.g==this&&jn.ba&&!jn.M&&(jn.j.info("Great, no buffering proxy detected. Bytes received: "+xe.length),ii(jn),jn.M=!0,Ee(11))}}else Kt(this.i,this.l,xe,null),Qs(this,xe);En==4&&Ln(this),this.o&&!this.J&&(En==4?au(this.j,this):(this.o=!1,Xr(this)))}else Sh(this.g),b==400&&0<xe.indexOf("Unknown SID")?(this.s=3,Ee(12)):(this.s=0,Ee(13)),Ln(this),Zr(this)}}}catch{}finally{}};function Qr(h){return h.g?h.u=="GET"&&h.L!=2&&h.j.Ca:!1}function Ta(h,v){var b=h.C,S=v.indexOf(`
`,b);return S==-1?ve:(b=Number(v.substring(b,S)),isNaN(b)?ze:(S+=1,S+b>v.length?ve:(v=v.slice(S,S+b),h.C=S+b,v)))}cn.prototype.cancel=function(){this.J=!0,Ln(this)};function Xr(h){h.S=Date.now()+h.I,Yc(h,h.I)}function Yc(h,v){if(h.B!=null)throw Error("WatchDog timer not null");h.B=Ae(w(h.ba,h),v)}function rs(h){h.B&&(m.clearTimeout(h.B),h.B=null)}cn.prototype.ba=function(){this.B=null;const h=Date.now();0<=h-this.S?(Rn(this.i,this.A),this.L!=2&&(Ie(),Ee(17)),Ln(this),this.s=2,Zr(this)):Yc(this,this.S-h)};function Zr(h){h.j.G==0||h.J||au(h.j,h)}function Ln(h){rs(h);var v=h.M;v&&typeof v.ma=="function"&&v.ma(),h.M=null,sr(h.U),h.g&&(v=h.g,h.g=null,v.abort(),v.ma())}function Qs(h,v){try{var b=h.j;if(b.G!=0&&(b.g==h||rl(b.h,h))){if(!h.K&&rl(b.h,h)&&b.G==3){try{var S=b.Da.g.parse(v)}catch{S=null}if(Array.isArray(S)&&S.length==3){var F=S;if(F[0]==0){e:if(!b.u){if(b.g)if(b.g.F+3e3<h.F)Xi(b),Yi(b);else break e;fl(b),Ee(18)}}else b.za=F[1],0<b.za-b.T&&37500>F[2]&&b.F&&b.v==0&&!b.C&&(b.C=Ae(w(b.Za,b),6e3));if(1>=Ui(b.h)&&b.ca){try{b.ca()}catch{}b.ca=void 0}}else Ra(b,11)}else if((h.K||b.g==h)&&Xi(b),!X(v))for(F=b.Da.g.parse(v),v=0;v<F.length;v++){let xt=F[v];if(b.T=xt[0],xt=xt[1],b.G==2)if(xt[0]=="c"){b.K=xt[1],b.ia=xt[2];const jn=xt[3];jn!=null&&(b.la=jn,b.j.info("VER="+b.la));const En=xt[4];En!=null&&(b.Aa=En,b.j.info("SVER="+b.Aa));const Ca=xt[5];Ca!=null&&typeof Ca=="number"&&0<Ca&&(S=1.5*Ca,b.L=S,b.j.info("backChannelRequestTimeoutMs_="+S)),S=b;const Un=h.g;if(Un){const aa=Un.g?Un.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(aa){var te=S.h;te.g||aa.indexOf("spdy")==-1&&aa.indexOf("quic")==-1&&aa.indexOf("h2")==-1||(te.j=te.l,te.g=new Set,te.h&&(Bi(te,te.h),te.h=null))}if(S.D){const gl=Un.g?Un.g.getResponseHeader("X-HTTP-Session-Id"):null;gl&&(S.ya=gl,Mt(S.I,S.D,gl))}}b.G=3,b.l&&b.l.ua(),b.ba&&(b.R=Date.now()-h.F,b.j.info("Handshake RTT: "+b.R+"ms")),S=b;var xe=h;if(S.qa=iu(S,S.J?S.ia:null,S.W),xe.K){er(S.h,xe);var vt=xe,kn=S.L;kn&&(vt.I=kn),vt.B&&(rs(vt),Xr(vt)),S.g=xe}else nu(S);0<b.i.length&&Qi(b)}else xt[0]!="stop"&&xt[0]!="close"||Ra(b,7);else b.G==3&&(xt[0]=="stop"||xt[0]=="close"?xt[0]=="stop"?Ra(b,7):dl(b):xt[0]!="noop"&&b.l&&b.l.ta(xt),b.v=0)}}Ie(4)}catch{}}var Qc=class{constructor(h,v){this.g=h,this.map=v}};function ka(h){this.l=h||10,m.PerformanceNavigationTiming?(h=m.performance.getEntriesByType("navigation"),h=0<h.length&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(m.chrome&&m.chrome.loadTimes&&m.chrome.loadTimes()&&m.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Li(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function Ui(h){return h.h?1:h.g?h.g.size:0}function rl(h,v){return h.h?h.h==v:h.g?h.g.has(v):!1}function Bi(h,v){h.g?h.g.add(v):h.h=v}function er(h,v){h.h&&h.h==v?h.h=null:h.g&&h.g.has(v)&&h.g.delete(v)}ka.prototype.cancel=function(){if(this.i=al(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function al(h){if(h.h!=null)return h.i.concat(h.h.D);if(h.g!=null&&h.g.size!==0){let v=h.i;for(const b of h.g.values())v=v.concat(b.D);return v}return L(h.i)}function _h(h){if(h.V&&typeof h.V=="function")return h.V();if(typeof Map<"u"&&h instanceof Map||typeof Set<"u"&&h instanceof Set)return Array.from(h.values());if(typeof h=="string")return h.split("");if(p(h)){for(var v=[],b=h.length,S=0;S<b;S++)v.push(h[S]);return v}v=[],b=0;for(S in h)v[b++]=h[S];return v}function Gi(h){if(h.na&&typeof h.na=="function")return h.na();if(!h.V||typeof h.V!="function"){if(typeof Map<"u"&&h instanceof Map)return Array.from(h.keys());if(!(typeof Set<"u"&&h instanceof Set)){if(p(h)||typeof h=="string"){var v=[];h=h.length;for(var b=0;b<h;b++)v.push(b);return v}v=[],b=0;for(const S in h)v[b++]=S;return v}}}function sl(h,v){if(h.forEach&&typeof h.forEach=="function")h.forEach(v,void 0);else if(p(h)||typeof h=="string")Array.prototype.forEach.call(h,v,void 0);else for(var b=Gi(h),S=_h(h),F=S.length,te=0;te<F;te++)v.call(void 0,S[te],b&&b[te],h)}var Xs=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Th(h,v){if(h){h=h.split("&");for(var b=0;b<h.length;b++){var S=h[b].indexOf("="),F=null;if(0<=S){var te=h[b].substring(0,S);F=h[b].substring(S+1)}else te=h[b];v(te,F?decodeURIComponent(F.replace(/\+/g," ")):"")}}}function mn(h){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,h instanceof mn){this.h=h.h,Zs(this,h.j),this.o=h.o,this.g=h.g,as(this,h.s),this.l=h.l;var v=h.i,b=new Sa;b.i=v.i,v.g&&(b.g=new Map(v.g),b.h=v.h),Ea(this,b),this.m=h.m}else h&&(v=String(h).match(Xs))?(this.h=!1,Zs(this,v[1]||"",!0),this.o=_r(v[2]||""),this.g=_r(v[3]||"",!0),as(this,v[4]),this.l=_r(v[5]||"",!0),Ea(this,v[6]||"",!0),this.m=_r(v[7]||"")):(this.h=!1,this.i=new Sa(null,this.h))}mn.prototype.toString=function(){var h=[],v=this.j;v&&h.push(Js(v,il,!0),":");var b=this.g;return(b||v=="file")&&(h.push("//"),(v=this.o)&&h.push(Js(v,il,!0),"@"),h.push(encodeURIComponent(String(b)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),b=this.s,b!=null&&h.push(":",String(b))),(b=this.l)&&(this.g&&b.charAt(0)!="/"&&h.push("/"),h.push(Js(b,b.charAt(0)=="/"?kh:ol,!0))),(b=this.i.toString())&&h.push("?",b),(b=this.m)&&h.push("#",Js(b,Hi)),h.join("")};function hr(h){return new mn(h)}function Zs(h,v,b){h.j=b?_r(v,!0):v,h.j&&(h.j=h.j.replace(/:$/,""))}function as(h,v){if(v){if(v=Number(v),isNaN(v)||0>v)throw Error("Bad port number "+v);h.s=v}else h.s=null}function Ea(h,v,b){v instanceof Sa?(h.i=v,Zc(h.i,h.h)):(b||(v=Js(v,Eh)),h.i=new Sa(v,h.h))}function Mt(h,v,b){h.i.set(v,b)}function Ws(h){return Mt(h,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),h}function _r(h,v){return h?v?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function Js(h,v,b){return typeof h=="string"?(h=encodeURI(h).replace(v,Xc),b&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function Xc(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var il=/[#\/\?@]/g,ol=/[#\?:]/g,kh=/[#\?]/g,Eh=/[#\?@]/g,Hi=/#/g;function Sa(h,v){this.h=this.g=null,this.i=h||null,this.j=!!v}function Tr(h){h.g||(h.g=new Map,h.h=0,h.i&&Th(h.i,function(v,b){h.add(decodeURIComponent(v.replace(/\+/g," ")),b)}))}s=Sa.prototype,s.add=function(h,v){Tr(this),this.i=null,h=Wr(this,h);var b=this.g.get(h);return b||this.g.set(h,b=[]),b.push(v),this.h+=1,this};function wa(h,v){Tr(h),v=Wr(h,v),h.g.has(v)&&(h.i=null,h.h-=h.g.get(v).length,h.g.delete(v))}function Aa(h,v){return Tr(h),v=Wr(h,v),h.g.has(v)}s.forEach=function(h,v){Tr(this),this.g.forEach(function(b,S){b.forEach(function(F){h.call(v,F,S,this)},this)},this)},s.na=function(){Tr(this);const h=Array.from(this.g.values()),v=Array.from(this.g.keys()),b=[];for(let S=0;S<v.length;S++){const F=h[S];for(let te=0;te<F.length;te++)b.push(v[S])}return b},s.V=function(h){Tr(this);let v=[];if(typeof h=="string")Aa(this,h)&&(v=v.concat(this.g.get(Wr(this,h))));else{h=Array.from(this.g.values());for(let b=0;b<h.length;b++)v=v.concat(h[b])}return v},s.set=function(h,v){return Tr(this),this.i=null,h=Wr(this,h),Aa(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[v]),this.h+=1,this},s.get=function(h,v){return h?(h=this.V(h),0<h.length?String(h[0]):v):v};function ll(h,v,b){wa(h,v),0<b.length&&(h.i=null,h.g.set(Wr(h,v),L(b)),h.h+=b.length)}s.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],v=Array.from(this.g.keys());for(var b=0;b<v.length;b++){var S=v[b];const te=encodeURIComponent(String(S)),xe=this.V(S);for(S=0;S<xe.length;S++){var F=te;xe[S]!==""&&(F+="="+encodeURIComponent(String(xe[S]))),h.push(F)}}return this.i=h.join("&")};function Wr(h,v){return v=String(v),h.j&&(v=v.toLowerCase()),v}function Zc(h,v){v&&!h.j&&(Tr(h),h.i=null,h.g.forEach(function(b,S){var F=S.toLowerCase();S!=F&&(wa(this,S),ll(this,F,b))},h)),h.j=v}function ei(h,v){const b=new ke;if(m.Image){const S=new Image;S.onload=j(kr,b,"TestLoadImage: loaded",!0,v,S),S.onerror=j(kr,b,"TestLoadImage: error",!1,v,S),S.onabort=j(kr,b,"TestLoadImage: abort",!1,v,S),S.ontimeout=j(kr,b,"TestLoadImage: timeout",!1,v,S),m.setTimeout(function(){S.ontimeout&&S.ontimeout()},1e4),S.src=h}else v(!1)}function Pr(h,v){const b=new ke,S=new AbortController,F=setTimeout(()=>{S.abort(),kr(b,"TestPingServer: timeout",!1,v)},1e4);fetch(h,{signal:S.signal}).then(te=>{clearTimeout(F),te.ok?kr(b,"TestPingServer: ok",!0,v):kr(b,"TestPingServer: server error",!1,v)}).catch(()=>{clearTimeout(F),kr(b,"TestPingServer: error",!1,v)})}function kr(h,v,b,S,F){try{F&&(F.onload=null,F.onerror=null,F.onabort=null,F.ontimeout=null),S(b)}catch{}}function ti(){this.g=new Fe}function Jr(h,v,b){const S=b||"";try{sl(h,function(F,te){let xe=F;y(F)&&(xe=Nn(F)),v.push(S+te+"="+encodeURIComponent(xe))})}catch(F){throw v.push(S+"type="+encodeURIComponent("_badmap")),F}}function ss(h){this.l=h.Ub||null,this.j=h.eb||!1}B(ss,yt),ss.prototype.g=function(){return new Na(this.l,this.j)},ss.prototype.i=(function(h){return function(){return h}})({});function Na(h,v){Je.call(this),this.D=h,this.o=v,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}B(Na,Je),s=Na.prototype,s.open=function(h,v){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=h,this.A=v,this.readyState=1,ta(this)},s.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const v={headers:this.u,method:this.B,credentials:this.m,cache:void 0};h&&(v.body=h),(this.D||m).fetch(new Request(this.A,v)).then(this.Sa.bind(this),this.ga.bind(this))},s.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,ea(this)),this.readyState=0},s.Sa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,ta(this)),this.g&&(this.readyState=3,ta(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof m.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;cl(this)}else h.text().then(this.Ra.bind(this),this.ga.bind(this))};function cl(h){h.j.read().then(h.Pa.bind(h)).catch(h.ga.bind(h))}s.Pa=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var v=h.value?h.value:new Uint8Array(0);(v=this.v.decode(v,{stream:!h.done}))&&(this.response=this.responseText+=v)}h.done?ea(this):ta(this),this.readyState==3&&cl(this)}},s.Ra=function(h){this.g&&(this.response=this.responseText=h,ea(this))},s.Qa=function(h){this.g&&(this.response=h,ea(this))},s.ga=function(){this.g&&ea(this)};function ea(h){h.readyState=4,h.l=null,h.j=null,h.v=null,ta(h)}s.setRequestHeader=function(h,v){this.u.append(h,v)},s.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},s.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],v=this.h.entries();for(var b=v.next();!b.done;)b=b.value,h.push(b[0]+": "+b[1]),b=v.next();return h.join(`\r
`)};function ta(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(Na.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function ul(h){let v="";return me(h,function(b,S){v+=S,v+=":",v+=b,v+=`\r
`}),v}function In(h,v,b){e:{for(S in b){var S=!1;break e}S=!0}S||(b=ul(b),typeof h=="string"?b!=null&&encodeURIComponent(String(b)):Mt(h,v,b))}function At(h){Je.call(this),this.headers=new Map,this.o=h||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}B(At,Je);var Fi=/^https?$/i,ni=["POST","PUT"];s=At.prototype,s.Ha=function(h){this.J=h},s.ea=function(h,v,b,S){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);v=v?v.toUpperCase():"GET",this.D=h,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Tn.g(),this.v=this.o?Dt(this.o):Dt(Tn),this.g.onreadystatechange=w(this.Ea,this);try{this.B=!0,this.g.open(v,String(h),!0),this.B=!1}catch(te){Wc(this,te);return}if(h=b||"",b=new Map(this.headers),S)if(Object.getPrototypeOf(S)===Object.prototype)for(var F in S)b.set(F,S[F]);else if(typeof S.keys=="function"&&typeof S.get=="function")for(const te of S.keys())b.set(te,S.get(te));else throw Error("Unknown input type for opt_headers: "+String(S));S=Array.from(b.keys()).find(te=>te.toLowerCase()=="content-type"),F=m.FormData&&h instanceof m.FormData,!(0<=Array.prototype.indexOf.call(ni,v,void 0))||S||F||b.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[te,xe]of b)this.g.setRequestHeader(te,xe);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{ri(this),this.u=!0,this.g.send(h),this.u=!1}catch(te){Wc(this,te)}};function Wc(h,v){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=v,h.m=5,qi(h),na(h)}function qi(h){h.A||(h.A=!0,lt(h,"complete"),lt(h,"error"))}s.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=h||7,lt(this,"complete"),lt(this,"abort"),na(this))},s.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),na(this,!0)),At.aa.N.call(this)},s.Ea=function(){this.s||(this.B||this.u||this.j?$i(this):this.bb())},s.bb=function(){$i(this)};function $i(h){if(h.h&&typeof d<"u"&&(!h.v[1]||Er(h)!=4||h.Z()!=2)){if(h.u&&Er(h)==4)Qt(h.Ea,0,h);else if(lt(h,"readystatechange"),Er(h)==4){h.h=!1;try{const xe=h.Z();e:switch(xe){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var v=!0;break e;default:v=!1}var b;if(!(b=v)){var S;if(S=xe===0){var F=String(h.D).match(Xs)[1]||null;!F&&m.self&&m.self.location&&(F=m.self.location.protocol.slice(0,-1)),S=!Fi.test(F?F.toLowerCase():"")}b=S}if(b)lt(h,"complete"),lt(h,"success");else{h.m=6;try{var te=2<Er(h)?h.g.statusText:""}catch{te=""}h.l=te+" ["+h.Z()+"]",qi(h)}}finally{na(h)}}}}function na(h,v){if(h.g){ri(h);const b=h.g,S=h.v[0]?()=>{}:null;h.g=null,h.v=null,v||lt(h,"ready");try{b.onreadystatechange=S}catch{}}}function ri(h){h.I&&(m.clearTimeout(h.I),h.I=null)}s.isActive=function(){return!!this.g};function Er(h){return h.g?h.g.readyState:0}s.Z=function(){try{return 2<Er(this)?this.g.status:-1}catch{return-1}},s.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},s.Oa=function(h){if(this.g){var v=this.g.responseText;return h&&v.indexOf(h)==0&&(v=v.substring(h.length)),Pe(v)}};function Jc(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.H){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function Sh(h){const v={};h=(h.g&&2<=Er(h)&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let S=0;S<h.length;S++){if(X(h[S]))continue;var b=V(h[S]);const F=b[0];if(b=b[1],typeof b!="string")continue;b=b.trim();const te=v[F]||[];v[F]=te,te.push(b)}O(v,function(S){return S.join(", ")})}s.Ba=function(){return this.m},s.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function ai(h,v,b){return b&&b.internalChannelParams&&b.internalChannelParams[h]||v}function Ki(h){this.Aa=0,this.i=[],this.j=new ke,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=ai("failFast",!1,h),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=ai("baseRetryDelayMs",5e3,h),this.cb=ai("retryDelaySeedMs",1e4,h),this.Wa=ai("forwardChannelMaxRetries",2,h),this.wa=ai("forwardChannelRequestTimeoutMs",2e4,h),this.pa=h&&h.xmlHttpFactory||void 0,this.Xa=h&&h.Tb||void 0,this.Ca=h&&h.useFetchStreams||!1,this.L=void 0,this.J=h&&h.supportsCrossDomainXhr||!1,this.K="",this.h=new ka(h&&h.concurrentRequestLimit),this.Da=new ti,this.P=h&&h.fastHandshake||!1,this.O=h&&h.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=h&&h.Rb||!1,h&&h.xa&&this.j.xa(),h&&h.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&h&&h.detectBufferingProxy||!1,this.ja=void 0,h&&h.longPollingTimeout&&0<h.longPollingTimeout&&(this.ja=h.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}s=Ki.prototype,s.la=8,s.G=1,s.connect=function(h,v,b,S){Ee(0),this.W=h,this.H=v||{},b&&S!==void 0&&(this.H.OSID=b,this.H.OAID=S),this.F=this.X,this.I=iu(this,null,this.W),Qi(this)};function dl(h){if(eu(h),h.G==3){var v=h.U++,b=hr(h.I);if(Mt(b,"SID",h.K),Mt(b,"RID",v),Mt(b,"TYPE","terminate"),si(h,b),v=new cn(h,h.j,v),v.L=2,v.v=Ws(hr(b)),b=!1,m.navigator&&m.navigator.sendBeacon)try{b=m.navigator.sendBeacon(v.v.toString(),"")}catch{}!b&&m.Image&&(new Image().src=v.v,b=!0),b||(v.g=ou(v.j,null),v.g.ea(v.v)),v.F=Date.now(),Xr(v)}su(h)}function Yi(h){h.g&&(ii(h),h.g.cancel(),h.g=null)}function eu(h){Yi(h),h.u&&(m.clearTimeout(h.u),h.u=null),Xi(h),h.h.cancel(),h.s&&(typeof h.s=="number"&&m.clearTimeout(h.s),h.s=null)}function Qi(h){if(!Li(h.h)&&!h.s){h.s=!0;var v=h.Ga;he||C(),G||(he(),G=!0),re.add(v,h),h.B=0}}function wh(h,v){return Ui(h.h)>=h.h.j-(h.s?1:0)?!1:h.s?(h.i=v.D.concat(h.i),!0):h.G==1||h.G==2||h.B>=(h.Va?0:h.Wa)?!1:(h.s=Ae(w(h.Ga,h,v),ml(h,h.B)),h.B++,!0)}s.Ga=function(h){if(this.s)if(this.s=null,this.G==1){if(!h){this.U=Math.floor(1e5*Math.random()),h=this.U++;const F=new cn(this,this.j,h);let te=this.o;if(this.S&&(te?(te=N(te),P(te,this.S)):te=this.S),this.m!==null||this.O||(F.H=te,te=null),this.P)e:{for(var v=0,b=0;b<this.i.length;b++){t:{var S=this.i[b];if("__data__"in S.map&&(S=S.map.__data__,typeof S=="string")){S=S.length;break t}S=void 0}if(S===void 0)break;if(v+=S,4096<v){v=b;break e}if(v===4096||b===this.i.length-1){v=b+1;break e}}v=1e3}else v=1e3;v=tu(this,F,v),b=hr(this.I),Mt(b,"RID",h),Mt(b,"CVER",22),this.D&&Mt(b,"X-HTTP-Session-Id",this.D),si(this,b),te&&(this.O?v="headers="+encodeURIComponent(String(ul(te)))+"&"+v:this.m&&In(b,this.m,te)),Bi(this.h,F),this.Ua&&Mt(b,"TYPE","init"),this.P?(Mt(b,"$req",v),Mt(b,"SID","null"),F.T=!0,Xe(F,b,null)):Xe(F,b,v),this.G=2}}else this.G==3&&(h?hl(this,h):this.i.length==0||Li(this.h)||hl(this))};function hl(h,v){var b;v?b=v.l:b=h.U++;const S=hr(h.I);Mt(S,"SID",h.K),Mt(S,"RID",b),Mt(S,"AID",h.T),si(h,S),h.m&&h.o&&In(S,h.m,h.o),b=new cn(h,h.j,b,h.B+1),h.m===null&&(b.H=h.o),v&&(h.i=v.D.concat(h.i)),v=tu(h,b,1e3),b.I=Math.round(.5*h.wa)+Math.round(.5*h.wa*Math.random()),Bi(h.h,b),Xe(b,S,v)}function si(h,v){h.H&&me(h.H,function(b,S){Mt(v,S,b)}),h.l&&sl({},function(b,S){Mt(v,S,b)})}function tu(h,v,b){b=Math.min(h.i.length,b);var S=h.l?w(h.l.Na,h.l,h):null;e:{var F=h.i;let te=-1;for(;;){const xe=["count="+b];te==-1?0<b?(te=F[0].g,xe.push("ofs="+te)):te=0:xe.push("ofs="+te);let vt=!0;for(let kn=0;kn<b;kn++){let xt=F[kn].g;const jn=F[kn].map;if(xt-=te,0>xt)te=Math.max(0,F[kn].g-100),vt=!1;else try{Jr(jn,xe,"req"+xt+"_")}catch{S&&S(jn)}}if(vt){S=xe.join("&");break e}}}return h=h.i.splice(0,b),v.D=h,S}function nu(h){if(!h.g&&!h.u){h.Y=1;var v=h.Fa;he||C(),G||(he(),G=!0),re.add(v,h),h.v=0}}function fl(h){return h.g||h.u||3<=h.v?!1:(h.Y++,h.u=Ae(w(h.Fa,h),ml(h,h.v)),h.v++,!0)}s.Fa=function(){if(this.u=null,ru(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var h=2*this.R;this.j.info("BP detection timer enabled: "+h),this.A=Ae(w(this.ab,this),h)}},s.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Ee(10),Yi(this),ru(this))};function ii(h){h.A!=null&&(m.clearTimeout(h.A),h.A=null)}function ru(h){h.g=new cn(h,h.j,"rpc",h.Y),h.m===null&&(h.g.H=h.o),h.g.O=0;var v=hr(h.qa);Mt(v,"RID","rpc"),Mt(v,"SID",h.K),Mt(v,"AID",h.T),Mt(v,"CI",h.F?"0":"1"),!h.F&&h.ja&&Mt(v,"TO",h.ja),Mt(v,"TYPE","xmlhttp"),si(h,v),h.m&&h.o&&In(v,h.m,h.o),h.L&&(h.g.I=h.L);var b=h.g;h=h.ia,b.L=1,b.v=Ws(hr(v)),b.m=null,b.P=!0,Kn(b,h)}s.Za=function(){this.C!=null&&(this.C=null,Yi(this),fl(this),Ee(19))};function Xi(h){h.C!=null&&(m.clearTimeout(h.C),h.C=null)}function au(h,v){var b=null;if(h.g==v){Xi(h),ii(h),h.g=null;var S=2}else if(rl(h.h,v))b=v.D,er(h.h,v),S=1;else return;if(h.G!=0){if(v.o)if(S==1){b=v.m?v.m.length:0,v=Date.now()-v.F;var F=h.B;S=ee(),lt(S,new ye(S,b)),Qi(h)}else nu(h);else if(F=v.s,F==3||F==0&&0<v.X||!(S==1&&wh(h,v)||S==2&&fl(h)))switch(b&&0<b.length&&(v=h.h,v.i=v.i.concat(b)),F){case 1:Ra(h,5);break;case 4:Ra(h,10);break;case 3:Ra(h,6);break;default:Ra(h,2)}}}function ml(h,v){let b=h.Ta+Math.floor(Math.random()*h.cb);return h.isActive()||(b*=2),b*v}function Ra(h,v){if(h.j.info("Error code "+v),v==2){var b=w(h.fb,h),S=h.Xa;const F=!S;S=new mn(S||"//www.google.com/images/cleardot.gif"),m.location&&m.location.protocol=="http"||Zs(S,"https"),Ws(S),F?ei(S.toString(),b):Pr(S.toString(),b)}else Ee(2);h.G=0,h.l&&h.l.sa(v),su(h),eu(h)}s.fb=function(h){h?(this.j.info("Successfully pinged google.com"),Ee(2)):(this.j.info("Failed to ping google.com"),Ee(1))};function su(h){if(h.G=0,h.ka=[],h.l){const v=al(h.h);(v.length!=0||h.i.length!=0)&&(D(h.ka,v),D(h.ka,h.i),h.h.i.length=0,L(h.i),h.i.length=0),h.l.ra()}}function iu(h,v,b){var S=b instanceof mn?hr(b):new mn(b);if(S.g!="")v&&(S.g=v+"."+S.g),as(S,S.s);else{var F=m.location;S=F.protocol,v=v?v+"."+F.hostname:F.hostname,F=+F.port;var te=new mn(null);S&&Zs(te,S),v&&(te.g=v),F&&as(te,F),b&&(te.l=b),S=te}return b=h.D,v=h.ya,b&&v&&Mt(S,b,v),Mt(S,"VER",h.la),si(h,S),S}function ou(h,v,b){if(v&&!h.J)throw Error("Can't create secondary domain capable XhrIo object.");return v=h.Ca&&!h.pa?new At(new ss({eb:b})):new At(h.pa),v.Ha(h.J),v}s.isActive=function(){return!!this.l&&this.l.isActive(this)};function lu(){}s=lu.prototype,s.ua=function(){},s.ta=function(){},s.sa=function(){},s.ra=function(){},s.isActive=function(){return!0},s.Na=function(){};function Zi(){}Zi.prototype.g=function(h,v){return new tr(h,v)};function tr(h,v){Je.call(this),this.g=new Ki(v),this.l=h,this.h=v&&v.messageUrlParams||null,h=v&&v.messageHeaders||null,v&&v.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=v&&v.initMessageHeaders||null,v&&v.messageContentType&&(h?h["X-WebChannel-Content-Type"]=v.messageContentType:h={"X-WebChannel-Content-Type":v.messageContentType}),v&&v.va&&(h?h["X-WebChannel-Client-Profile"]=v.va:h={"X-WebChannel-Client-Profile":v.va}),this.g.S=h,(h=v&&v.Sb)&&!X(h)&&(this.g.m=h),this.v=v&&v.supportsCrossDomainXhr||!1,this.u=v&&v.sendRawJson||!1,(v=v&&v.httpSessionIdParam)&&!X(v)&&(this.g.D=v,h=this.h,h!==null&&v in h&&(h=this.h,v in h&&delete h[v])),this.j=new ra(this)}B(tr,Je),tr.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},tr.prototype.close=function(){dl(this.g)},tr.prototype.o=function(h){var v=this.g;if(typeof h=="string"){var b={};b.__data__=h,h=b}else this.u&&(b={},b.__data__=Nn(h),h=b);v.i.push(new Qc(v.Ya++,h)),v.G==3&&Qi(v)},tr.prototype.N=function(){this.g.l=null,delete this.j,dl(this.g),delete this.g,tr.aa.N.call(this)};function cu(h){Ne.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var v=h.__sm__;if(v){e:{for(const b in v){h=b;break e}h=void 0}(this.i=h)&&(h=this.i,v=v!==null&&h in v?v[h]:void 0),this.data=v}else this.data=h}B(cu,Ne);function uu(){De.call(this),this.status=1}B(uu,De);function ra(h){this.g=h}B(ra,lu),ra.prototype.ua=function(){lt(this.g,"a")},ra.prototype.ta=function(h){lt(this.g,new cu(h))},ra.prototype.sa=function(h){lt(this.g,new uu)},ra.prototype.ra=function(){lt(this.g,"b")},Zi.prototype.createWebChannel=Zi.prototype.g,tr.prototype.send=tr.prototype.o,tr.prototype.open=tr.prototype.m,tr.prototype.close=tr.prototype.close,q_=function(){return new Zi},F_=function(){return ee()},H_=Ke,Xm={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},on.NO_ERROR=0,on.TIMEOUT=8,on.HTTP_ERROR=6,Sd=on,ln.COMPLETE="complete",G_=ln,pe.EventType=_e,_e.OPEN="a",_e.CLOSE="b",_e.ERROR="c",_e.MESSAGE="d",Je.prototype.listen=Je.prototype.K,ic=pe,At.prototype.listenOnce=At.prototype.L,At.prototype.getLastError=At.prototype.Ka,At.prototype.getLastErrorCode=At.prototype.Ba,At.prototype.getStatus=At.prototype.Z,At.prototype.getResponseJson=At.prototype.Oa,At.prototype.getResponseText=At.prototype.oa,At.prototype.send=At.prototype.ea,At.prototype.setWithCredentials=At.prototype.Ha,B_=At}).apply(typeof fd<"u"?fd:typeof self<"u"?self:typeof window<"u"?window:{});const Ex="@firebase/firestore",Sx="4.9.1";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let cr=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};cr.UNAUTHENTICATED=new cr(null),cr.GOOGLE_CREDENTIALS=new cr("google-credentials-uid"),cr.FIRST_PARTY=new cr("first-party-uid"),cr.MOCK_USER=new cr("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Wo="12.2.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ri=new Tg("@firebase/firestore");function No(){return Ri.logLevel}function Ce(s,...e){if(Ri.logLevel<=mt.DEBUG){const t=e.map(Dg);Ri.debug(`Firestore (${Wo}): ${s}`,...t)}}function Ja(s,...e){if(Ri.logLevel<=mt.ERROR){const t=e.map(Dg);Ri.error(`Firestore (${Wo}): ${s}`,...t)}}function Tc(s,...e){if(Ri.logLevel<=mt.WARN){const t=e.map(Dg);Ri.warn(`Firestore (${Wo}): ${s}`,...t)}}function Dg(s){if(typeof s=="string")return s;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return(function(t){return JSON.stringify(t)})(s)}catch{return s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function He(s,e,t){let a="Unexpected state";typeof e=="string"?a=e:t=e,$_(s,a,t)}function $_(s,e,t){let a=`FIRESTORE (${Wo}) INTERNAL ASSERTION FAILED: ${e} (ID: ${s.toString(16)})`;if(t!==void 0)try{a+=" CONTEXT: "+JSON.stringify(t)}catch{a+=" CONTEXT: "+t}throw Ja(a),new Error(a)}function Rt(s,e,t,a){let o="Unexpected state";typeof t=="string"?o=t:a=t,s||$_(e,o,a)}function Ze(s,e){return s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ie={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Se extends ns{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qa{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G2{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class H2{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(cr.UNAUTHENTICATED)))}shutdown(){}}class F2{constructor(e){this.t=e,this.currentUser=cr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Rt(this.o===void 0,42304);let a=this.i;const o=p=>this.i!==a?(a=this.i,t(p)):Promise.resolve();let l=new Qa;this.o=()=>{this.i++,this.currentUser=this.u(),l.resolve(),l=new Qa,e.enqueueRetryable((()=>o(this.currentUser)))};const d=()=>{const p=l;e.enqueueRetryable((async()=>{await p.promise,await o(this.currentUser)}))},m=p=>{Ce("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=p,this.o&&(this.auth.addAuthTokenListener(this.o),d())};this.t.onInit((p=>m(p))),setTimeout((()=>{if(!this.auth){const p=this.t.getImmediate({optional:!0});p?m(p):(Ce("FirebaseAuthCredentialsProvider","Auth not yet detected"),l.resolve(),l=new Qa)}}),0),d()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((a=>this.i!==e?(Ce("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):a?(Rt(typeof a.accessToken=="string",31837,{l:a}),new G2(a.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Rt(e===null||typeof e=="string",2055,{h:e}),new cr(e)}}class q2{constructor(e,t,a){this.P=e,this.T=t,this.I=a,this.type="FirstParty",this.user=cr.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class $2{constructor(e,t,a){this.P=e,this.T=t,this.I=a}getToken(){return Promise.resolve(new q2(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(cr.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class wx{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class K2{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Dr(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Rt(this.o===void 0,3512);const a=l=>{l.error!=null&&Ce("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${l.error.message}`);const d=l.token!==this.m;return this.m=l.token,Ce("FirebaseAppCheckTokenProvider",`Received ${d?"new":"existing"} token.`),d?t(l.token):Promise.resolve()};this.o=l=>{e.enqueueRetryable((()=>a(l)))};const o=l=>{Ce("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=l,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((l=>o(l))),setTimeout((()=>{if(!this.appCheck){const l=this.V.getImmediate({optional:!0});l?o(l):Ce("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new wx(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Rt(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new wx(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y2(s){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(s);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let a=0;a<s;a++)t[a]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mg{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let a="";for(;a.length<20;){const o=Y2(40);for(let l=0;l<o.length;++l)a.length<20&&o[l]<t&&(a+=e.charAt(o[l]%62))}return a}}function gt(s,e){return s<e?-1:s>e?1:0}function Zm(s,e){const t=Math.min(s.length,e.length);for(let a=0;a<t;a++){const o=s.charAt(a),l=e.charAt(a);if(o!==l)return Dm(o)===Dm(l)?gt(o,l):Dm(o)?1:-1}return gt(s.length,e.length)}const Q2=55296,X2=57343;function Dm(s){const e=s.charCodeAt(0);return e>=Q2&&e<=X2}function Lo(s,e,t){return s.length===e.length&&s.every(((a,o)=>t(a,e[o])))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ax="__name__";class ua{constructor(e,t,a){t===void 0?t=0:t>e.length&&He(637,{offset:t,range:e.length}),a===void 0?a=e.length-t:a>e.length-t&&He(1746,{length:a,range:e.length-t}),this.segments=e,this.offset=t,this.len=a}get length(){return this.len}isEqual(e){return ua.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof ua?e.forEach((a=>{t.push(a)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,a=this.limit();t<a;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const a=Math.min(e.length,t.length);for(let o=0;o<a;o++){const l=ua.compareSegments(e.get(o),t.get(o));if(l!==0)return l}return gt(e.length,t.length)}static compareSegments(e,t){const a=ua.isNumericId(e),o=ua.isNumericId(t);return a&&!o?-1:!a&&o?1:a&&o?ua.extractNumericId(e).compare(ua.extractNumericId(t)):Zm(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Vs.fromString(e.substring(4,e.length-2))}}class qt extends ua{construct(e,t,a){return new qt(e,t,a)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const a of e){if(a.indexOf("//")>=0)throw new Se(ie.INVALID_ARGUMENT,`Invalid segment (${a}). Paths must not contain // in them.`);t.push(...a.split("/").filter((o=>o.length>0)))}return new qt(t)}static emptyPath(){return new qt([])}}const Z2=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class qn extends ua{construct(e,t,a){return new qn(e,t,a)}static isValidIdentifier(e){return Z2.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),qn.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Ax}static keyField(){return new qn([Ax])}static fromServerFormat(e){const t=[];let a="",o=0;const l=()=>{if(a.length===0)throw new Se(ie.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(a),a=""};let d=!1;for(;o<e.length;){const m=e[o];if(m==="\\"){if(o+1===e.length)throw new Se(ie.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const p=e[o+1];if(p!=="\\"&&p!=="."&&p!=="`")throw new Se(ie.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);a+=p,o+=2}else m==="`"?(d=!d,o++):m!=="."||d?(a+=m,o++):(l(),o++)}if(l(),d)throw new Se(ie.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new qn(t)}static emptyPath(){return new qn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ve{constructor(e){this.path=e}static fromPath(e){return new Ve(qt.fromString(e))}static fromName(e){return new Ve(qt.fromString(e).popFirst(5))}static empty(){return new Ve(qt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&qt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return qt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ve(new qt(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function K_(s,e,t){if(!t)throw new Se(ie.INVALID_ARGUMENT,`Function ${s}() cannot be called with an empty ${e}.`)}function W2(s,e,t,a){if(e===!0&&a===!0)throw new Se(ie.INVALID_ARGUMENT,`${s} and ${t} cannot be used together.`)}function Nx(s){if(!Ve.isDocumentKey(s))throw new Se(ie.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${s} has ${s.length}.`)}function Rx(s){if(Ve.isDocumentKey(s))throw new Se(ie.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${s} has ${s.length}.`)}function Y_(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}function rh(s){if(s===void 0)return"undefined";if(s===null)return"null";if(typeof s=="string")return s.length>20&&(s=`${s.substring(0,20)}...`),JSON.stringify(s);if(typeof s=="number"||typeof s=="boolean")return""+s;if(typeof s=="object"){if(s instanceof Array)return"an array";{const e=(function(a){return a.constructor?a.constructor.name:null})(s);return e?`a custom ${e} object`:"an object"}}return typeof s=="function"?"a function":He(12329,{type:typeof s})}function Ci(s,e){if("_delegate"in s&&(s=s._delegate),!(s instanceof e)){if(e.name===s.constructor.name)throw new Se(ie.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=rh(s);throw new Se(ie.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return s}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xn(s,e){const t={typeString:s};return e&&(t.value=e),t}function Uc(s,e){if(!Y_(s))throw new Se(ie.INVALID_ARGUMENT,"JSON must be an object");let t;for(const a in e)if(e[a]){const o=e[a].typeString,l="value"in e[a]?{value:e[a].value}:void 0;if(!(a in s)){t=`JSON missing required field: '${a}'`;break}const d=s[a];if(o&&typeof d!==o){t=`JSON field '${a}' must be a ${o}.`;break}if(l!==void 0&&d!==l.value){t=`Expected '${a}' field to equal '${l.value}'`;break}}if(t)throw new Se(ie.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cx=-62135596800,Ix=1e6;class Gt{static now(){return Gt.fromMillis(Date.now())}static fromDate(e){return Gt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),a=Math.floor((e-1e3*t)*Ix);return new Gt(t,a)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Se(ie.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Se(ie.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<Cx)throw new Se(ie.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Se(ie.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Ix}_compareTo(e){return this.seconds===e.seconds?gt(this.nanoseconds,e.nanoseconds):gt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Gt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Uc(e,Gt._jsonSchema))return new Gt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-Cx;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Gt._jsonSchemaVersion="firestore/timestamp/1.0",Gt._jsonSchema={type:xn("string",Gt._jsonSchemaVersion),seconds:xn("number"),nanoseconds:xn("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ye{static fromTimestamp(e){return new Ye(e)}static min(){return new Ye(new Gt(0,0))}static max(){return new Ye(new Gt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kc=-1;function J2(s,e){const t=s.toTimestamp().seconds,a=s.toTimestamp().nanoseconds+1,o=Ye.fromTimestamp(a===1e9?new Gt(t+1,0):new Gt(t,a));return new Ls(o,Ve.empty(),e)}function eR(s){return new Ls(s.readTime,s.key,kc)}class Ls{constructor(e,t,a){this.readTime=e,this.documentKey=t,this.largestBatchId=a}static min(){return new Ls(Ye.min(),Ve.empty(),kc)}static max(){return new Ls(Ye.max(),Ve.empty(),kc)}}function tR(s,e){let t=s.readTime.compareTo(e.readTime);return t!==0?t:(t=Ve.comparator(s.documentKey,e.documentKey),t!==0?t:gt(s.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nR="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class rR{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Jo(s){if(s.code!==ie.FAILED_PRECONDITION||s.message!==nR)throw s;Ce("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fe{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&He(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new fe(((a,o)=>{this.nextCallback=l=>{this.wrapSuccess(e,l).next(a,o)},this.catchCallback=l=>{this.wrapFailure(t,l).next(a,o)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof fe?t:fe.resolve(t)}catch(t){return fe.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):fe.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):fe.reject(t)}static resolve(e){return new fe(((t,a)=>{t(e)}))}static reject(e){return new fe(((t,a)=>{a(e)}))}static waitFor(e){return new fe(((t,a)=>{let o=0,l=0,d=!1;e.forEach((m=>{++o,m.next((()=>{++l,d&&l===o&&t()}),(p=>a(p)))})),d=!0,l===o&&t()}))}static or(e){let t=fe.resolve(!1);for(const a of e)t=t.next((o=>o?fe.resolve(o):a()));return t}static forEach(e,t){const a=[];return e.forEach(((o,l)=>{a.push(t.call(this,o,l))})),this.waitFor(a)}static mapArray(e,t){return new fe(((a,o)=>{const l=e.length,d=new Array(l);let m=0;for(let p=0;p<l;p++){const y=p;t(e[y]).next((x=>{d[y]=x,++m,m===l&&a(d)}),(x=>o(x)))}}))}static doWhile(e,t){return new fe(((a,o)=>{const l=()=>{e()===!0?t().next((()=>{l()}),o):a()};l()}))}}function aR(s){const e=s.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function el(s){return s.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ah{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=a=>this.ae(a),this.ue=a=>t.writeSequenceNumber(a))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}ah.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Og=-1;function sh(s){return s==null}function zd(s){return s===0&&1/s==-1/0}function sR(s){return typeof s=="number"&&Number.isInteger(s)&&!zd(s)&&s<=Number.MAX_SAFE_INTEGER&&s>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q_="";function iR(s){let e="";for(let t=0;t<s.length;t++)e.length>0&&(e=jx(e)),e=oR(s.get(t),e);return jx(e)}function oR(s,e){let t=e;const a=s.length;for(let o=0;o<a;o++){const l=s.charAt(o);switch(l){case"\0":t+="";break;case Q_:t+="";break;default:t+=l}}return t}function jx(s){return s+Q_+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dx(s){let e=0;for(const t in s)Object.prototype.hasOwnProperty.call(s,t)&&e++;return e}function Di(s,e){for(const t in s)Object.prototype.hasOwnProperty.call(s,t)&&e(t,s[t])}function X_(s){for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tn{constructor(e,t){this.comparator=e,this.root=t||Fn.EMPTY}insert(e,t){return new tn(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Fn.BLACK,null,null))}remove(e){return new tn(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Fn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const a=this.comparator(e,t.key);if(a===0)return t.value;a<0?t=t.left:a>0&&(t=t.right)}return null}indexOf(e){let t=0,a=this.root;for(;!a.isEmpty();){const o=this.comparator(e,a.key);if(o===0)return t+a.left.size;o<0?a=a.left:(t+=a.left.size+1,a=a.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,a)=>(e(t,a),!1)))}toString(){const e=[];return this.inorderTraversal(((t,a)=>(e.push(`${t}:${a}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new md(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new md(this.root,e,this.comparator,!1)}getReverseIterator(){return new md(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new md(this.root,e,this.comparator,!0)}}class md{constructor(e,t,a,o){this.isReverse=o,this.nodeStack=[];let l=1;for(;!e.isEmpty();)if(l=t?a(e.key,t):1,t&&o&&(l*=-1),l<0)e=this.isReverse?e.left:e.right;else{if(l===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Fn{constructor(e,t,a,o,l){this.key=e,this.value=t,this.color=a??Fn.RED,this.left=o??Fn.EMPTY,this.right=l??Fn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,a,o,l){return new Fn(e??this.key,t??this.value,a??this.color,o??this.left,l??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,a){let o=this;const l=a(e,o.key);return o=l<0?o.copy(null,null,null,o.left.insert(e,t,a),null):l===0?o.copy(null,t,null,null,null):o.copy(null,null,null,null,o.right.insert(e,t,a)),o.fixUp()}removeMin(){if(this.left.isEmpty())return Fn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let a,o=this;if(t(e,o.key)<0)o.left.isEmpty()||o.left.isRed()||o.left.left.isRed()||(o=o.moveRedLeft()),o=o.copy(null,null,null,o.left.remove(e,t),null);else{if(o.left.isRed()&&(o=o.rotateRight()),o.right.isEmpty()||o.right.isRed()||o.right.left.isRed()||(o=o.moveRedRight()),t(e,o.key)===0){if(o.right.isEmpty())return Fn.EMPTY;a=o.right.min(),o=o.copy(a.key,a.value,null,null,o.right.removeMin())}o=o.copy(null,null,null,null,o.right.remove(e,t))}return o.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Fn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Fn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw He(43730,{key:this.key,value:this.value});if(this.right.isRed())throw He(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw He(27949);return e+(this.isRed()?0:1)}}Fn.EMPTY=null,Fn.RED=!0,Fn.BLACK=!1;Fn.EMPTY=new class{constructor(){this.size=0}get key(){throw He(57766)}get value(){throw He(16141)}get color(){throw He(16727)}get left(){throw He(29726)}get right(){throw He(36894)}copy(e,t,a,o,l){return this}insert(e,t,a){return new Fn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class An{constructor(e){this.comparator=e,this.data=new tn(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,a)=>(e(t),!1)))}forEachInRange(e,t){const a=this.data.getIteratorFrom(e[0]);for(;a.hasNext();){const o=a.getNext();if(this.comparator(o.key,e[1])>=0)return;t(o.key)}}forEachWhile(e,t){let a;for(a=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();a.hasNext();)if(!e(a.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Mx(this.data.getIterator())}getIteratorFrom(e){return new Mx(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((a=>{t=t.add(a)})),t}isEqual(e){if(!(e instanceof An)||this.size!==e.size)return!1;const t=this.data.getIterator(),a=e.data.getIterator();for(;t.hasNext();){const o=t.getNext().key,l=a.getNext().key;if(this.comparator(o,l)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new An(this.comparator);return t.data=e,t}}class Mx{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Br{constructor(e){this.fields=e,e.sort(qn.comparator)}static empty(){return new Br([])}unionWith(e){let t=new An(qn.comparator);for(const a of this.fields)t=t.add(a);for(const a of e)t=t.add(a);return new Br(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Lo(this.fields,e.fields,((t,a)=>t.isEqual(a)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z_ extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $n{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(o){try{return atob(o)}catch(l){throw typeof DOMException<"u"&&l instanceof DOMException?new Z_("Invalid base64 string: "+l):l}})(e);return new $n(t)}static fromUint8Array(e){const t=(function(o){let l="";for(let d=0;d<o.length;++d)l+=String.fromCharCode(o[d]);return l})(e);return new $n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const a=new Uint8Array(t.length);for(let o=0;o<t.length;o++)a[o]=t.charCodeAt(o);return a})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return gt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}$n.EMPTY_BYTE_STRING=new $n("");const lR=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Us(s){if(Rt(!!s,39018),typeof s=="string"){let e=0;const t=lR.exec(s);if(Rt(!!t,46558,{timestamp:s}),t[1]){let o=t[1];o=(o+"000000000").substr(0,9),e=Number(o)}const a=new Date(s);return{seconds:Math.floor(a.getTime()/1e3),nanos:e}}return{seconds:hn(s.seconds),nanos:hn(s.nanos)}}function hn(s){return typeof s=="number"?s:typeof s=="string"?Number(s):0}function Bs(s){return typeof s=="string"?$n.fromBase64String(s):$n.fromUint8Array(s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W_="server_timestamp",J_="__type__",eT="__previous_value__",tT="__local_write_time__";function Pg(s){return(s?.mapValue?.fields||{})[J_]?.stringValue===W_}function ih(s){const e=s.mapValue.fields[eT];return Pg(e)?ih(e):e}function Ec(s){const e=Us(s.mapValue.fields[tT].timestampValue);return new Gt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cR{constructor(e,t,a,o,l,d,m,p,y,x){this.databaseId=e,this.appId=t,this.persistenceKey=a,this.host=o,this.ssl=l,this.forceLongPolling=d,this.autoDetectLongPolling=m,this.longPollingOptions=p,this.useFetchStreams=y,this.isUsingEmulator=x}}const Ld="(default)";class Sc{constructor(e,t){this.projectId=e,this.database=t||Ld}static empty(){return new Sc("","")}get isDefaultDatabase(){return this.database===Ld}isEqual(e){return e instanceof Sc&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nT="__type__",uR="__max__",gd={mapValue:{}},rT="__vector__",Ud="value";function Gs(s){return"nullValue"in s?0:"booleanValue"in s?1:"integerValue"in s||"doubleValue"in s?2:"timestampValue"in s?3:"stringValue"in s?5:"bytesValue"in s?6:"referenceValue"in s?7:"geoPointValue"in s?8:"arrayValue"in s?9:"mapValue"in s?Pg(s)?4:hR(s)?9007199254740991:dR(s)?10:11:He(28295,{value:s})}function xa(s,e){if(s===e)return!0;const t=Gs(s);if(t!==Gs(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return s.booleanValue===e.booleanValue;case 4:return Ec(s).isEqual(Ec(e));case 3:return(function(o,l){if(typeof o.timestampValue=="string"&&typeof l.timestampValue=="string"&&o.timestampValue.length===l.timestampValue.length)return o.timestampValue===l.timestampValue;const d=Us(o.timestampValue),m=Us(l.timestampValue);return d.seconds===m.seconds&&d.nanos===m.nanos})(s,e);case 5:return s.stringValue===e.stringValue;case 6:return(function(o,l){return Bs(o.bytesValue).isEqual(Bs(l.bytesValue))})(s,e);case 7:return s.referenceValue===e.referenceValue;case 8:return(function(o,l){return hn(o.geoPointValue.latitude)===hn(l.geoPointValue.latitude)&&hn(o.geoPointValue.longitude)===hn(l.geoPointValue.longitude)})(s,e);case 2:return(function(o,l){if("integerValue"in o&&"integerValue"in l)return hn(o.integerValue)===hn(l.integerValue);if("doubleValue"in o&&"doubleValue"in l){const d=hn(o.doubleValue),m=hn(l.doubleValue);return d===m?zd(d)===zd(m):isNaN(d)&&isNaN(m)}return!1})(s,e);case 9:return Lo(s.arrayValue.values||[],e.arrayValue.values||[],xa);case 10:case 11:return(function(o,l){const d=o.mapValue.fields||{},m=l.mapValue.fields||{};if(Dx(d)!==Dx(m))return!1;for(const p in d)if(d.hasOwnProperty(p)&&(m[p]===void 0||!xa(d[p],m[p])))return!1;return!0})(s,e);default:return He(52216,{left:s})}}function wc(s,e){return(s.values||[]).find((t=>xa(t,e)))!==void 0}function Uo(s,e){if(s===e)return 0;const t=Gs(s),a=Gs(e);if(t!==a)return gt(t,a);switch(t){case 0:case 9007199254740991:return 0;case 1:return gt(s.booleanValue,e.booleanValue);case 2:return(function(l,d){const m=hn(l.integerValue||l.doubleValue),p=hn(d.integerValue||d.doubleValue);return m<p?-1:m>p?1:m===p?0:isNaN(m)?isNaN(p)?0:-1:1})(s,e);case 3:return Ox(s.timestampValue,e.timestampValue);case 4:return Ox(Ec(s),Ec(e));case 5:return Zm(s.stringValue,e.stringValue);case 6:return(function(l,d){const m=Bs(l),p=Bs(d);return m.compareTo(p)})(s.bytesValue,e.bytesValue);case 7:return(function(l,d){const m=l.split("/"),p=d.split("/");for(let y=0;y<m.length&&y<p.length;y++){const x=gt(m[y],p[y]);if(x!==0)return x}return gt(m.length,p.length)})(s.referenceValue,e.referenceValue);case 8:return(function(l,d){const m=gt(hn(l.latitude),hn(d.latitude));return m!==0?m:gt(hn(l.longitude),hn(d.longitude))})(s.geoPointValue,e.geoPointValue);case 9:return Px(s.arrayValue,e.arrayValue);case 10:return(function(l,d){const m=l.fields||{},p=d.fields||{},y=m[Ud]?.arrayValue,x=p[Ud]?.arrayValue,_=gt(y?.values?.length||0,x?.values?.length||0);return _!==0?_:Px(y,x)})(s.mapValue,e.mapValue);case 11:return(function(l,d){if(l===gd.mapValue&&d===gd.mapValue)return 0;if(l===gd.mapValue)return 1;if(d===gd.mapValue)return-1;const m=l.fields||{},p=Object.keys(m),y=d.fields||{},x=Object.keys(y);p.sort(),x.sort();for(let _=0;_<p.length&&_<x.length;++_){const w=Zm(p[_],x[_]);if(w!==0)return w;const j=Uo(m[p[_]],y[x[_]]);if(j!==0)return j}return gt(p.length,x.length)})(s.mapValue,e.mapValue);default:throw He(23264,{he:t})}}function Ox(s,e){if(typeof s=="string"&&typeof e=="string"&&s.length===e.length)return gt(s,e);const t=Us(s),a=Us(e),o=gt(t.seconds,a.seconds);return o!==0?o:gt(t.nanos,a.nanos)}function Px(s,e){const t=s.values||[],a=e.values||[];for(let o=0;o<t.length&&o<a.length;++o){const l=Uo(t[o],a[o]);if(l)return l}return gt(t.length,a.length)}function Bo(s){return Wm(s)}function Wm(s){return"nullValue"in s?"null":"booleanValue"in s?""+s.booleanValue:"integerValue"in s?""+s.integerValue:"doubleValue"in s?""+s.doubleValue:"timestampValue"in s?(function(t){const a=Us(t);return`time(${a.seconds},${a.nanos})`})(s.timestampValue):"stringValue"in s?s.stringValue:"bytesValue"in s?(function(t){return Bs(t).toBase64()})(s.bytesValue):"referenceValue"in s?(function(t){return Ve.fromName(t).toString()})(s.referenceValue):"geoPointValue"in s?(function(t){return`geo(${t.latitude},${t.longitude})`})(s.geoPointValue):"arrayValue"in s?(function(t){let a="[",o=!0;for(const l of t.values||[])o?o=!1:a+=",",a+=Wm(l);return a+"]"})(s.arrayValue):"mapValue"in s?(function(t){const a=Object.keys(t.fields||{}).sort();let o="{",l=!0;for(const d of a)l?l=!1:o+=",",o+=`${d}:${Wm(t.fields[d])}`;return o+"}"})(s.mapValue):He(61005,{value:s})}function wd(s){switch(Gs(s)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=ih(s);return e?16+wd(e):16;case 5:return 2*s.stringValue.length;case 6:return Bs(s.bytesValue).approximateByteSize();case 7:return s.referenceValue.length;case 9:return(function(a){return(a.values||[]).reduce(((o,l)=>o+wd(l)),0)})(s.arrayValue);case 10:case 11:return(function(a){let o=0;return Di(a.fields,((l,d)=>{o+=l.length+wd(d)})),o})(s.mapValue);default:throw He(13486,{value:s})}}function Vx(s,e){return{referenceValue:`projects/${s.projectId}/databases/${s.database}/documents/${e.path.canonicalString()}`}}function Jm(s){return!!s&&"integerValue"in s}function Vg(s){return!!s&&"arrayValue"in s}function zx(s){return!!s&&"nullValue"in s}function Lx(s){return!!s&&"doubleValue"in s&&isNaN(Number(s.doubleValue))}function Ad(s){return!!s&&"mapValue"in s}function dR(s){return(s?.mapValue?.fields||{})[nT]?.stringValue===rT}function hc(s){if(s.geoPointValue)return{geoPointValue:{...s.geoPointValue}};if(s.timestampValue&&typeof s.timestampValue=="object")return{timestampValue:{...s.timestampValue}};if(s.mapValue){const e={mapValue:{fields:{}}};return Di(s.mapValue.fields,((t,a)=>e.mapValue.fields[t]=hc(a))),e}if(s.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(s.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=hc(s.arrayValue.values[t]);return e}return{...s}}function hR(s){return(((s.mapValue||{}).fields||{}).__type__||{}).stringValue===uR}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mr{constructor(e){this.value=e}static empty(){return new Mr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let a=0;a<e.length-1;++a)if(t=(t.mapValue.fields||{})[e.get(a)],!Ad(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=hc(t)}setAll(e){let t=qn.emptyPath(),a={},o=[];e.forEach(((d,m)=>{if(!t.isImmediateParentOf(m)){const p=this.getFieldsMap(t);this.applyChanges(p,a,o),a={},o=[],t=m.popLast()}d?a[m.lastSegment()]=hc(d):o.push(m.lastSegment())}));const l=this.getFieldsMap(t);this.applyChanges(l,a,o)}delete(e){const t=this.field(e.popLast());Ad(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return xa(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let a=0;a<e.length;++a){let o=t.mapValue.fields[e.get(a)];Ad(o)&&o.mapValue.fields||(o={mapValue:{fields:{}}},t.mapValue.fields[e.get(a)]=o),t=o}return t.mapValue.fields}applyChanges(e,t,a){Di(t,((o,l)=>e[o]=l));for(const o of a)delete e[o]}clone(){return new Mr(hc(this.value))}}function aT(s){const e=[];return Di(s.fields,((t,a)=>{const o=new qn([t]);if(Ad(a)){const l=aT(a.mapValue).fields;if(l.length===0)e.push(o);else for(const d of l)e.push(o.child(d))}else e.push(o)})),new Br(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zn{constructor(e,t,a,o,l,d,m){this.key=e,this.documentType=t,this.version=a,this.readTime=o,this.createTime=l,this.data=d,this.documentState=m}static newInvalidDocument(e){return new Zn(e,0,Ye.min(),Ye.min(),Ye.min(),Mr.empty(),0)}static newFoundDocument(e,t,a,o){return new Zn(e,1,t,Ye.min(),a,o,0)}static newNoDocument(e,t){return new Zn(e,2,t,Ye.min(),Ye.min(),Mr.empty(),0)}static newUnknownDocument(e,t){return new Zn(e,3,t,Ye.min(),Ye.min(),Mr.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Ye.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Mr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Mr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ye.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Zn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Zn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bd{constructor(e,t){this.position=e,this.inclusive=t}}function Ux(s,e,t){let a=0;for(let o=0;o<s.position.length;o++){const l=e[o],d=s.position[o];if(l.field.isKeyField()?a=Ve.comparator(Ve.fromName(d.referenceValue),t.key):a=Uo(d,t.data.field(l.field)),l.dir==="desc"&&(a*=-1),a!==0)break}return a}function Bx(s,e){if(s===null)return e===null;if(e===null||s.inclusive!==e.inclusive||s.position.length!==e.position.length)return!1;for(let t=0;t<s.position.length;t++)if(!xa(s.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ac{constructor(e,t="asc"){this.field=e,this.dir=t}}function fR(s,e){return s.dir===e.dir&&s.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sT{}class vn extends sT{constructor(e,t,a){super(),this.field=e,this.op=t,this.value=a}static create(e,t,a){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,a):new gR(e,t,a):t==="array-contains"?new vR(e,a):t==="in"?new xR(e,a):t==="not-in"?new bR(e,a):t==="array-contains-any"?new _R(e,a):new vn(e,t,a)}static createKeyFieldInFilter(e,t,a){return t==="in"?new pR(e,a):new yR(e,a)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Uo(t,this.value)):t!==null&&Gs(this.value)===Gs(t)&&this.matchesComparison(Uo(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return He(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class qr extends sT{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new qr(e,t)}matches(e){return iT(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function iT(s){return s.op==="and"}function oT(s){return mR(s)&&iT(s)}function mR(s){for(const e of s.filters)if(e instanceof qr)return!1;return!0}function eg(s){if(s instanceof vn)return s.field.canonicalString()+s.op.toString()+Bo(s.value);if(oT(s))return s.filters.map((e=>eg(e))).join(",");{const e=s.filters.map((t=>eg(t))).join(",");return`${s.op}(${e})`}}function lT(s,e){return s instanceof vn?(function(a,o){return o instanceof vn&&a.op===o.op&&a.field.isEqual(o.field)&&xa(a.value,o.value)})(s,e):s instanceof qr?(function(a,o){return o instanceof qr&&a.op===o.op&&a.filters.length===o.filters.length?a.filters.reduce(((l,d,m)=>l&&lT(d,o.filters[m])),!0):!1})(s,e):void He(19439)}function cT(s){return s instanceof vn?(function(t){return`${t.field.canonicalString()} ${t.op} ${Bo(t.value)}`})(s):s instanceof qr?(function(t){return t.op.toString()+" {"+t.getFilters().map(cT).join(" ,")+"}"})(s):"Filter"}class gR extends vn{constructor(e,t,a){super(e,t,a),this.key=Ve.fromName(a.referenceValue)}matches(e){const t=Ve.comparator(e.key,this.key);return this.matchesComparison(t)}}class pR extends vn{constructor(e,t){super(e,"in",t),this.keys=uT("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class yR extends vn{constructor(e,t){super(e,"not-in",t),this.keys=uT("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function uT(s,e){return(e.arrayValue?.values||[]).map((t=>Ve.fromName(t.referenceValue)))}class vR extends vn{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Vg(t)&&wc(t.arrayValue,this.value)}}class xR extends vn{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&wc(this.value.arrayValue,t)}}class bR extends vn{constructor(e,t){super(e,"not-in",t)}matches(e){if(wc(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!wc(this.value.arrayValue,t)}}class _R extends vn{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Vg(t)||!t.arrayValue.values)&&t.arrayValue.values.some((a=>wc(this.value.arrayValue,a)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TR{constructor(e,t=null,a=[],o=[],l=null,d=null,m=null){this.path=e,this.collectionGroup=t,this.orderBy=a,this.filters=o,this.limit=l,this.startAt=d,this.endAt=m,this.Te=null}}function Gx(s,e=null,t=[],a=[],o=null,l=null,d=null){return new TR(s,e,t,a,o,l,d)}function zg(s){const e=Ze(s);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((a=>eg(a))).join(","),t+="|ob:",t+=e.orderBy.map((a=>(function(l){return l.field.canonicalString()+l.dir})(a))).join(","),sh(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((a=>Bo(a))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((a=>Bo(a))).join(",")),e.Te=t}return e.Te}function Lg(s,e){if(s.limit!==e.limit||s.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<s.orderBy.length;t++)if(!fR(s.orderBy[t],e.orderBy[t]))return!1;if(s.filters.length!==e.filters.length)return!1;for(let t=0;t<s.filters.length;t++)if(!lT(s.filters[t],e.filters[t]))return!1;return s.collectionGroup===e.collectionGroup&&!!s.path.isEqual(e.path)&&!!Bx(s.startAt,e.startAt)&&Bx(s.endAt,e.endAt)}function tg(s){return Ve.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tl{constructor(e,t=null,a=[],o=[],l=null,d="F",m=null,p=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=a,this.filters=o,this.limit=l,this.limitType=d,this.startAt=m,this.endAt=p,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function kR(s,e,t,a,o,l,d,m){return new tl(s,e,t,a,o,l,d,m)}function Ug(s){return new tl(s)}function Hx(s){return s.filters.length===0&&s.limit===null&&s.startAt==null&&s.endAt==null&&(s.explicitOrderBy.length===0||s.explicitOrderBy.length===1&&s.explicitOrderBy[0].field.isKeyField())}function dT(s){return s.collectionGroup!==null}function fc(s){const e=Ze(s);if(e.Ie===null){e.Ie=[];const t=new Set;for(const l of e.explicitOrderBy)e.Ie.push(l),t.add(l.field.canonicalString());const a=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(d){let m=new An(qn.comparator);return d.filters.forEach((p=>{p.getFlattenedFilters().forEach((y=>{y.isInequality()&&(m=m.add(y.field))}))})),m})(e).forEach((l=>{t.has(l.canonicalString())||l.isKeyField()||e.Ie.push(new Ac(l,a))})),t.has(qn.keyField().canonicalString())||e.Ie.push(new Ac(qn.keyField(),a))}return e.Ie}function fa(s){const e=Ze(s);return e.Ee||(e.Ee=ER(e,fc(s))),e.Ee}function ER(s,e){if(s.limitType==="F")return Gx(s.path,s.collectionGroup,e,s.filters,s.limit,s.startAt,s.endAt);{e=e.map((o=>{const l=o.dir==="desc"?"asc":"desc";return new Ac(o.field,l)}));const t=s.endAt?new Bd(s.endAt.position,s.endAt.inclusive):null,a=s.startAt?new Bd(s.startAt.position,s.startAt.inclusive):null;return Gx(s.path,s.collectionGroup,e,s.filters,s.limit,t,a)}}function ng(s,e){const t=s.filters.concat([e]);return new tl(s.path,s.collectionGroup,s.explicitOrderBy.slice(),t,s.limit,s.limitType,s.startAt,s.endAt)}function rg(s,e,t){return new tl(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),e,t,s.startAt,s.endAt)}function oh(s,e){return Lg(fa(s),fa(e))&&s.limitType===e.limitType}function hT(s){return`${zg(fa(s))}|lt:${s.limitType}`}function Ro(s){return`Query(target=${(function(t){let a=t.path.canonicalString();return t.collectionGroup!==null&&(a+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(a+=`, filters: [${t.filters.map((o=>cT(o))).join(", ")}]`),sh(t.limit)||(a+=", limit: "+t.limit),t.orderBy.length>0&&(a+=`, orderBy: [${t.orderBy.map((o=>(function(d){return`${d.field.canonicalString()} (${d.dir})`})(o))).join(", ")}]`),t.startAt&&(a+=", startAt: ",a+=t.startAt.inclusive?"b:":"a:",a+=t.startAt.position.map((o=>Bo(o))).join(",")),t.endAt&&(a+=", endAt: ",a+=t.endAt.inclusive?"a:":"b:",a+=t.endAt.position.map((o=>Bo(o))).join(",")),`Target(${a})`})(fa(s))}; limitType=${s.limitType})`}function lh(s,e){return e.isFoundDocument()&&(function(a,o){const l=o.key.path;return a.collectionGroup!==null?o.key.hasCollectionId(a.collectionGroup)&&a.path.isPrefixOf(l):Ve.isDocumentKey(a.path)?a.path.isEqual(l):a.path.isImmediateParentOf(l)})(s,e)&&(function(a,o){for(const l of fc(a))if(!l.field.isKeyField()&&o.data.field(l.field)===null)return!1;return!0})(s,e)&&(function(a,o){for(const l of a.filters)if(!l.matches(o))return!1;return!0})(s,e)&&(function(a,o){return!(a.startAt&&!(function(d,m,p){const y=Ux(d,m,p);return d.inclusive?y<=0:y<0})(a.startAt,fc(a),o)||a.endAt&&!(function(d,m,p){const y=Ux(d,m,p);return d.inclusive?y>=0:y>0})(a.endAt,fc(a),o))})(s,e)}function SR(s){return s.collectionGroup||(s.path.length%2==1?s.path.lastSegment():s.path.get(s.path.length-2))}function fT(s){return(e,t)=>{let a=!1;for(const o of fc(s)){const l=wR(o,e,t);if(l!==0)return l;a=a||o.field.isKeyField()}return 0}}function wR(s,e,t){const a=s.field.isKeyField()?Ve.comparator(e.key,t.key):(function(l,d,m){const p=d.data.field(l),y=m.data.field(l);return p!==null&&y!==null?Uo(p,y):He(42886)})(s.field,e,t);switch(s.dir){case"asc":return a;case"desc":return-1*a;default:return He(19790,{direction:s.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mi{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),a=this.inner[t];if(a!==void 0){for(const[o,l]of a)if(this.equalsFn(o,e))return l}}has(e){return this.get(e)!==void 0}set(e,t){const a=this.mapKeyFn(e),o=this.inner[a];if(o===void 0)return this.inner[a]=[[e,t]],void this.innerSize++;for(let l=0;l<o.length;l++)if(this.equalsFn(o[l][0],e))return void(o[l]=[e,t]);o.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),a=this.inner[t];if(a===void 0)return!1;for(let o=0;o<a.length;o++)if(this.equalsFn(a[o][0],e))return a.length===1?delete this.inner[t]:a.splice(o,1),this.innerSize--,!0;return!1}forEach(e){Di(this.inner,((t,a)=>{for(const[o,l]of a)e(o,l)}))}isEmpty(){return X_(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AR=new tn(Ve.comparator);function es(){return AR}const mT=new tn(Ve.comparator);function oc(...s){let e=mT;for(const t of s)e=e.insert(t.key,t);return e}function gT(s){let e=mT;return s.forEach(((t,a)=>e=e.insert(t,a.overlayedDocument))),e}function ki(){return mc()}function pT(){return mc()}function mc(){return new Mi((s=>s.toString()),((s,e)=>s.isEqual(e)))}const NR=new tn(Ve.comparator),RR=new An(Ve.comparator);function pt(...s){let e=RR;for(const t of s)e=e.add(t);return e}const CR=new An(gt);function IR(){return CR}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bg(s,e){if(s.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:zd(e)?"-0":e}}function yT(s){return{integerValue:""+s}}function jR(s,e){return sR(e)?yT(e):Bg(s,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ch{constructor(){this._=void 0}}function DR(s,e,t){return s instanceof Nc?(function(o,l){const d={fields:{[J_]:{stringValue:W_},[tT]:{timestampValue:{seconds:o.seconds,nanos:o.nanoseconds}}}};return l&&Pg(l)&&(l=ih(l)),l&&(d.fields[eT]=l),{mapValue:d}})(t,e):s instanceof Rc?xT(s,e):s instanceof Cc?bT(s,e):(function(o,l){const d=vT(o,l),m=Fx(d)+Fx(o.Ae);return Jm(d)&&Jm(o.Ae)?yT(m):Bg(o.serializer,m)})(s,e)}function MR(s,e,t){return s instanceof Rc?xT(s,e):s instanceof Cc?bT(s,e):t}function vT(s,e){return s instanceof Gd?(function(a){return Jm(a)||(function(l){return!!l&&"doubleValue"in l})(a)})(e)?e:{integerValue:0}:null}class Nc extends ch{}class Rc extends ch{constructor(e){super(),this.elements=e}}function xT(s,e){const t=_T(e);for(const a of s.elements)t.some((o=>xa(o,a)))||t.push(a);return{arrayValue:{values:t}}}class Cc extends ch{constructor(e){super(),this.elements=e}}function bT(s,e){let t=_T(e);for(const a of s.elements)t=t.filter((o=>!xa(o,a)));return{arrayValue:{values:t}}}class Gd extends ch{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function Fx(s){return hn(s.integerValue||s.doubleValue)}function _T(s){return Vg(s)&&s.arrayValue.values?s.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OR{constructor(e,t){this.field=e,this.transform=t}}function PR(s,e){return s.field.isEqual(e.field)&&(function(a,o){return a instanceof Rc&&o instanceof Rc||a instanceof Cc&&o instanceof Cc?Lo(a.elements,o.elements,xa):a instanceof Gd&&o instanceof Gd?xa(a.Ae,o.Ae):a instanceof Nc&&o instanceof Nc})(s.transform,e.transform)}class VR{constructor(e,t){this.version=e,this.transformResults=t}}class ma{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new ma}static exists(e){return new ma(void 0,e)}static updateTime(e){return new ma(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Nd(s,e){return s.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(s.updateTime):s.exists===void 0||s.exists===e.isFoundDocument()}class uh{}function TT(s,e){if(!s.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return s.isNoDocument()?new ET(s.key,ma.none()):new Bc(s.key,s.data,ma.none());{const t=s.data,a=Mr.empty();let o=new An(qn.comparator);for(let l of e.fields)if(!o.has(l)){let d=t.field(l);d===null&&l.length>1&&(l=l.popLast(),d=t.field(l)),d===null?a.delete(l):a.set(l,d),o=o.add(l)}return new Oi(s.key,a,new Br(o.toArray()),ma.none())}}function zR(s,e,t){s instanceof Bc?(function(o,l,d){const m=o.value.clone(),p=$x(o.fieldTransforms,l,d.transformResults);m.setAll(p),l.convertToFoundDocument(d.version,m).setHasCommittedMutations()})(s,e,t):s instanceof Oi?(function(o,l,d){if(!Nd(o.precondition,l))return void l.convertToUnknownDocument(d.version);const m=$x(o.fieldTransforms,l,d.transformResults),p=l.data;p.setAll(kT(o)),p.setAll(m),l.convertToFoundDocument(d.version,p).setHasCommittedMutations()})(s,e,t):(function(o,l,d){l.convertToNoDocument(d.version).setHasCommittedMutations()})(0,e,t)}function gc(s,e,t,a){return s instanceof Bc?(function(l,d,m,p){if(!Nd(l.precondition,d))return m;const y=l.value.clone(),x=Kx(l.fieldTransforms,p,d);return y.setAll(x),d.convertToFoundDocument(d.version,y).setHasLocalMutations(),null})(s,e,t,a):s instanceof Oi?(function(l,d,m,p){if(!Nd(l.precondition,d))return m;const y=Kx(l.fieldTransforms,p,d),x=d.data;return x.setAll(kT(l)),x.setAll(y),d.convertToFoundDocument(d.version,x).setHasLocalMutations(),m===null?null:m.unionWith(l.fieldMask.fields).unionWith(l.fieldTransforms.map((_=>_.field)))})(s,e,t,a):(function(l,d,m){return Nd(l.precondition,d)?(d.convertToNoDocument(d.version).setHasLocalMutations(),null):m})(s,e,t)}function LR(s,e){let t=null;for(const a of s.fieldTransforms){const o=e.data.field(a.field),l=vT(a.transform,o||null);l!=null&&(t===null&&(t=Mr.empty()),t.set(a.field,l))}return t||null}function qx(s,e){return s.type===e.type&&!!s.key.isEqual(e.key)&&!!s.precondition.isEqual(e.precondition)&&!!(function(a,o){return a===void 0&&o===void 0||!(!a||!o)&&Lo(a,o,((l,d)=>PR(l,d)))})(s.fieldTransforms,e.fieldTransforms)&&(s.type===0?s.value.isEqual(e.value):s.type!==1||s.data.isEqual(e.data)&&s.fieldMask.isEqual(e.fieldMask))}class Bc extends uh{constructor(e,t,a,o=[]){super(),this.key=e,this.value=t,this.precondition=a,this.fieldTransforms=o,this.type=0}getFieldMask(){return null}}class Oi extends uh{constructor(e,t,a,o,l=[]){super(),this.key=e,this.data=t,this.fieldMask=a,this.precondition=o,this.fieldTransforms=l,this.type=1}getFieldMask(){return this.fieldMask}}function kT(s){const e=new Map;return s.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const a=s.data.field(t);e.set(t,a)}})),e}function $x(s,e,t){const a=new Map;Rt(s.length===t.length,32656,{Re:t.length,Ve:s.length});for(let o=0;o<t.length;o++){const l=s[o],d=l.transform,m=e.data.field(l.field);a.set(l.field,MR(d,m,t[o]))}return a}function Kx(s,e,t){const a=new Map;for(const o of s){const l=o.transform,d=t.data.field(o.field);a.set(o.field,DR(l,d,e))}return a}class ET extends uh{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class UR extends uh{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BR{constructor(e,t,a,o){this.batchId=e,this.localWriteTime=t,this.baseMutations=a,this.mutations=o}applyToRemoteDocument(e,t){const a=t.mutationResults;for(let o=0;o<this.mutations.length;o++){const l=this.mutations[o];l.key.isEqual(e.key)&&zR(l,e,a[o])}}applyToLocalView(e,t){for(const a of this.baseMutations)a.key.isEqual(e.key)&&(t=gc(a,e,t,this.localWriteTime));for(const a of this.mutations)a.key.isEqual(e.key)&&(t=gc(a,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const a=pT();return this.mutations.forEach((o=>{const l=e.get(o.key),d=l.overlayedDocument;let m=this.applyToLocalView(d,l.mutatedFields);m=t.has(o.key)?null:m;const p=TT(d,m);p!==null&&a.set(o.key,p),d.isValidDocument()||d.convertToNoDocument(Ye.min())})),a}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),pt())}isEqual(e){return this.batchId===e.batchId&&Lo(this.mutations,e.mutations,((t,a)=>qx(t,a)))&&Lo(this.baseMutations,e.baseMutations,((t,a)=>qx(t,a)))}}class Gg{constructor(e,t,a,o){this.batch=e,this.commitVersion=t,this.mutationResults=a,this.docVersions=o}static from(e,t,a){Rt(e.mutations.length===a.length,58842,{me:e.mutations.length,fe:a.length});let o=(function(){return NR})();const l=e.mutations;for(let d=0;d<l.length;d++)o=o.insert(l[d].key,a[d].version);return new Gg(e,t,a,o)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GR{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HR{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var yn,_t;function FR(s){switch(s){case ie.OK:return He(64938);case ie.CANCELLED:case ie.UNKNOWN:case ie.DEADLINE_EXCEEDED:case ie.RESOURCE_EXHAUSTED:case ie.INTERNAL:case ie.UNAVAILABLE:case ie.UNAUTHENTICATED:return!1;case ie.INVALID_ARGUMENT:case ie.NOT_FOUND:case ie.ALREADY_EXISTS:case ie.PERMISSION_DENIED:case ie.FAILED_PRECONDITION:case ie.ABORTED:case ie.OUT_OF_RANGE:case ie.UNIMPLEMENTED:case ie.DATA_LOSS:return!0;default:return He(15467,{code:s})}}function ST(s){if(s===void 0)return Ja("GRPC error has no .code"),ie.UNKNOWN;switch(s){case yn.OK:return ie.OK;case yn.CANCELLED:return ie.CANCELLED;case yn.UNKNOWN:return ie.UNKNOWN;case yn.DEADLINE_EXCEEDED:return ie.DEADLINE_EXCEEDED;case yn.RESOURCE_EXHAUSTED:return ie.RESOURCE_EXHAUSTED;case yn.INTERNAL:return ie.INTERNAL;case yn.UNAVAILABLE:return ie.UNAVAILABLE;case yn.UNAUTHENTICATED:return ie.UNAUTHENTICATED;case yn.INVALID_ARGUMENT:return ie.INVALID_ARGUMENT;case yn.NOT_FOUND:return ie.NOT_FOUND;case yn.ALREADY_EXISTS:return ie.ALREADY_EXISTS;case yn.PERMISSION_DENIED:return ie.PERMISSION_DENIED;case yn.FAILED_PRECONDITION:return ie.FAILED_PRECONDITION;case yn.ABORTED:return ie.ABORTED;case yn.OUT_OF_RANGE:return ie.OUT_OF_RANGE;case yn.UNIMPLEMENTED:return ie.UNIMPLEMENTED;case yn.DATA_LOSS:return ie.DATA_LOSS;default:return He(39323,{code:s})}}(_t=yn||(yn={}))[_t.OK=0]="OK",_t[_t.CANCELLED=1]="CANCELLED",_t[_t.UNKNOWN=2]="UNKNOWN",_t[_t.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",_t[_t.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",_t[_t.NOT_FOUND=5]="NOT_FOUND",_t[_t.ALREADY_EXISTS=6]="ALREADY_EXISTS",_t[_t.PERMISSION_DENIED=7]="PERMISSION_DENIED",_t[_t.UNAUTHENTICATED=16]="UNAUTHENTICATED",_t[_t.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",_t[_t.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",_t[_t.ABORTED=10]="ABORTED",_t[_t.OUT_OF_RANGE=11]="OUT_OF_RANGE",_t[_t.UNIMPLEMENTED=12]="UNIMPLEMENTED",_t[_t.INTERNAL=13]="INTERNAL",_t[_t.UNAVAILABLE=14]="UNAVAILABLE",_t[_t.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qR(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $R=new Vs([4294967295,4294967295],0);function Yx(s){const e=qR().encode(s),t=new U_;return t.update(e),new Uint8Array(t.digest())}function Qx(s){const e=new DataView(s.buffer),t=e.getUint32(0,!0),a=e.getUint32(4,!0),o=e.getUint32(8,!0),l=e.getUint32(12,!0);return[new Vs([t,a],0),new Vs([o,l],0)]}class Hg{constructor(e,t,a){if(this.bitmap=e,this.padding=t,this.hashCount=a,t<0||t>=8)throw new lc(`Invalid padding: ${t}`);if(a<0)throw new lc(`Invalid hash count: ${a}`);if(e.length>0&&this.hashCount===0)throw new lc(`Invalid hash count: ${a}`);if(e.length===0&&t!==0)throw new lc(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Vs.fromNumber(this.ge)}ye(e,t,a){let o=e.add(t.multiply(Vs.fromNumber(a)));return o.compare($R)===1&&(o=new Vs([o.getBits(0),o.getBits(1)],0)),o.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=Yx(e),[a,o]=Qx(t);for(let l=0;l<this.hashCount;l++){const d=this.ye(a,o,l);if(!this.we(d))return!1}return!0}static create(e,t,a){const o=e%8==0?0:8-e%8,l=new Uint8Array(Math.ceil(e/8)),d=new Hg(l,o,t);return a.forEach((m=>d.insert(m))),d}insert(e){if(this.ge===0)return;const t=Yx(e),[a,o]=Qx(t);for(let l=0;l<this.hashCount;l++){const d=this.ye(a,o,l);this.Se(d)}}Se(e){const t=Math.floor(e/8),a=e%8;this.bitmap[t]|=1<<a}}class lc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dh{constructor(e,t,a,o,l){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=a,this.documentUpdates=o,this.resolvedLimboDocuments=l}static createSynthesizedRemoteEventForCurrentChange(e,t,a){const o=new Map;return o.set(e,Gc.createSynthesizedTargetChangeForCurrentChange(e,t,a)),new dh(Ye.min(),o,new tn(gt),es(),pt())}}class Gc{constructor(e,t,a,o,l){this.resumeToken=e,this.current=t,this.addedDocuments=a,this.modifiedDocuments=o,this.removedDocuments=l}static createSynthesizedTargetChangeForCurrentChange(e,t,a){return new Gc(a,t,pt(),pt(),pt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rd{constructor(e,t,a,o){this.be=e,this.removedTargetIds=t,this.key=a,this.De=o}}class wT{constructor(e,t){this.targetId=e,this.Ce=t}}class AT{constructor(e,t,a=$n.EMPTY_BYTE_STRING,o=null){this.state=e,this.targetIds=t,this.resumeToken=a,this.cause=o}}class Xx{constructor(){this.ve=0,this.Fe=Zx(),this.Me=$n.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=pt(),t=pt(),a=pt();return this.Fe.forEach(((o,l)=>{switch(l){case 0:e=e.add(o);break;case 2:t=t.add(o);break;case 1:a=a.add(o);break;default:He(38017,{changeType:l})}})),new Gc(this.Me,this.xe,e,t,a)}qe(){this.Oe=!1,this.Fe=Zx()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Rt(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class KR{constructor(e){this.Ge=e,this.ze=new Map,this.je=es(),this.Je=pd(),this.He=pd(),this.Ye=new tn(gt)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const a=this.nt(t);switch(e.state){case 0:this.rt(t)&&a.Le(e.resumeToken);break;case 1:a.Ke(),a.Ne||a.qe(),a.Le(e.resumeToken);break;case 2:a.Ke(),a.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(a.We(),a.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),a.Le(e.resumeToken));break;default:He(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((a,o)=>{this.rt(o)&&t(o)}))}st(e){const t=e.targetId,a=e.Ce.count,o=this.ot(t);if(o){const l=o.target;if(tg(l))if(a===0){const d=new Ve(l.path);this.et(t,d,Zn.newNoDocument(d,Ye.min()))}else Rt(a===1,20013,{expectedCount:a});else{const d=this._t(t);if(d!==a){const m=this.ut(e),p=m?this.ct(m,e,d):1;if(p!==0){this.it(t);const y=p===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,y)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:a="",padding:o=0},hashCount:l=0}=t;let d,m;try{d=Bs(a).toUint8Array()}catch(p){if(p instanceof Z_)return Tc("Decoding the base64 bloom filter in existence filter failed ("+p.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw p}try{m=new Hg(d,o,l)}catch(p){return Tc(p instanceof lc?"BloomFilter error: ":"Applying bloom filter failed: ",p),null}return m.ge===0?null:m}ct(e,t,a){return t.Ce.count===a-this.Pt(e,t.targetId)?0:2}Pt(e,t){const a=this.Ge.getRemoteKeysForTarget(t);let o=0;return a.forEach((l=>{const d=this.Ge.ht(),m=`projects/${d.projectId}/databases/${d.database}/documents/${l.path.canonicalString()}`;e.mightContain(m)||(this.et(t,l,null),o++)})),o}Tt(e){const t=new Map;this.ze.forEach(((l,d)=>{const m=this.ot(d);if(m){if(l.current&&tg(m.target)){const p=new Ve(m.target.path);this.It(p).has(d)||this.Et(d,p)||this.et(d,p,Zn.newNoDocument(p,e))}l.Be&&(t.set(d,l.ke()),l.qe())}}));let a=pt();this.He.forEach(((l,d)=>{let m=!0;d.forEachWhile((p=>{const y=this.ot(p);return!y||y.purpose==="TargetPurposeLimboResolution"||(m=!1,!1)})),m&&(a=a.add(l))})),this.je.forEach(((l,d)=>d.setReadTime(e)));const o=new dh(e,t,this.Ye,this.je,a);return this.je=es(),this.Je=pd(),this.He=pd(),this.Ye=new tn(gt),o}Xe(e,t){if(!this.rt(e))return;const a=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,a),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,a){if(!this.rt(e))return;const o=this.nt(e);this.Et(e,t)?o.Qe(t,1):o.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),a&&(this.je=this.je.insert(t,a))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new Xx,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new An(gt),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new An(gt),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||Ce("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Xx),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function pd(){return new tn(Ve.comparator)}function Zx(){return new tn(Ve.comparator)}const YR={asc:"ASCENDING",desc:"DESCENDING"},QR={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},XR={and:"AND",or:"OR"};class ZR{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function ag(s,e){return s.useProto3Json||sh(e)?e:{value:e}}function Hd(s,e){return s.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function NT(s,e){return s.useProto3Json?e.toBase64():e.toUint8Array()}function WR(s,e){return Hd(s,e.toTimestamp())}function ga(s){return Rt(!!s,49232),Ye.fromTimestamp((function(t){const a=Us(t);return new Gt(a.seconds,a.nanos)})(s))}function Fg(s,e){return sg(s,e).canonicalString()}function sg(s,e){const t=(function(o){return new qt(["projects",o.projectId,"databases",o.database])})(s).child("documents");return e===void 0?t:t.child(e)}function RT(s){const e=qt.fromString(s);return Rt(MT(e),10190,{key:e.toString()}),e}function ig(s,e){return Fg(s.databaseId,e.path)}function Mm(s,e){const t=RT(e);if(t.get(1)!==s.databaseId.projectId)throw new Se(ie.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+s.databaseId.projectId);if(t.get(3)!==s.databaseId.database)throw new Se(ie.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+s.databaseId.database);return new Ve(IT(t))}function CT(s,e){return Fg(s.databaseId,e)}function JR(s){const e=RT(s);return e.length===4?qt.emptyPath():IT(e)}function og(s){return new qt(["projects",s.databaseId.projectId,"databases",s.databaseId.database]).canonicalString()}function IT(s){return Rt(s.length>4&&s.get(4)==="documents",29091,{key:s.toString()}),s.popFirst(5)}function Wx(s,e,t){return{name:ig(s,e),fields:t.value.mapValue.fields}}function eC(s,e){let t;if("targetChange"in e){e.targetChange;const a=(function(y){return y==="NO_CHANGE"?0:y==="ADD"?1:y==="REMOVE"?2:y==="CURRENT"?3:y==="RESET"?4:He(39313,{state:y})})(e.targetChange.targetChangeType||"NO_CHANGE"),o=e.targetChange.targetIds||[],l=(function(y,x){return y.useProto3Json?(Rt(x===void 0||typeof x=="string",58123),$n.fromBase64String(x||"")):(Rt(x===void 0||x instanceof Buffer||x instanceof Uint8Array,16193),$n.fromUint8Array(x||new Uint8Array))})(s,e.targetChange.resumeToken),d=e.targetChange.cause,m=d&&(function(y){const x=y.code===void 0?ie.UNKNOWN:ST(y.code);return new Se(x,y.message||"")})(d);t=new AT(a,o,l,m||null)}else if("documentChange"in e){e.documentChange;const a=e.documentChange;a.document,a.document.name,a.document.updateTime;const o=Mm(s,a.document.name),l=ga(a.document.updateTime),d=a.document.createTime?ga(a.document.createTime):Ye.min(),m=new Mr({mapValue:{fields:a.document.fields}}),p=Zn.newFoundDocument(o,l,d,m),y=a.targetIds||[],x=a.removedTargetIds||[];t=new Rd(y,x,p.key,p)}else if("documentDelete"in e){e.documentDelete;const a=e.documentDelete;a.document;const o=Mm(s,a.document),l=a.readTime?ga(a.readTime):Ye.min(),d=Zn.newNoDocument(o,l),m=a.removedTargetIds||[];t=new Rd([],m,d.key,d)}else if("documentRemove"in e){e.documentRemove;const a=e.documentRemove;a.document;const o=Mm(s,a.document),l=a.removedTargetIds||[];t=new Rd([],l,o,null)}else{if(!("filter"in e))return He(11601,{Rt:e});{e.filter;const a=e.filter;a.targetId;const{count:o=0,unchangedNames:l}=a,d=new HR(o,l),m=a.targetId;t=new wT(m,d)}}return t}function tC(s,e){let t;if(e instanceof Bc)t={update:Wx(s,e.key,e.value)};else if(e instanceof ET)t={delete:ig(s,e.key)};else if(e instanceof Oi)t={update:Wx(s,e.key,e.data),updateMask:uC(e.fieldMask)};else{if(!(e instanceof UR))return He(16599,{Vt:e.type});t={verify:ig(s,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((a=>(function(l,d){const m=d.transform;if(m instanceof Nc)return{fieldPath:d.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(m instanceof Rc)return{fieldPath:d.field.canonicalString(),appendMissingElements:{values:m.elements}};if(m instanceof Cc)return{fieldPath:d.field.canonicalString(),removeAllFromArray:{values:m.elements}};if(m instanceof Gd)return{fieldPath:d.field.canonicalString(),increment:m.Ae};throw He(20930,{transform:d.transform})})(0,a)))),e.precondition.isNone||(t.currentDocument=(function(o,l){return l.updateTime!==void 0?{updateTime:WR(o,l.updateTime)}:l.exists!==void 0?{exists:l.exists}:He(27497)})(s,e.precondition)),t}function nC(s,e){return s&&s.length>0?(Rt(e!==void 0,14353),s.map((t=>(function(o,l){let d=o.updateTime?ga(o.updateTime):ga(l);return d.isEqual(Ye.min())&&(d=ga(l)),new VR(d,o.transformResults||[])})(t,e)))):[]}function rC(s,e){return{documents:[CT(s,e.path)]}}function aC(s,e){const t={structuredQuery:{}},a=e.path;let o;e.collectionGroup!==null?(o=a,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(o=a.popLast(),t.structuredQuery.from=[{collectionId:a.lastSegment()}]),t.parent=CT(s,o);const l=(function(y){if(y.length!==0)return DT(qr.create(y,"and"))})(e.filters);l&&(t.structuredQuery.where=l);const d=(function(y){if(y.length!==0)return y.map((x=>(function(w){return{field:Co(w.field),direction:oC(w.dir)}})(x)))})(e.orderBy);d&&(t.structuredQuery.orderBy=d);const m=ag(s,e.limit);return m!==null&&(t.structuredQuery.limit=m),e.startAt&&(t.structuredQuery.startAt=(function(y){return{before:y.inclusive,values:y.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(y){return{before:!y.inclusive,values:y.position}})(e.endAt)),{ft:t,parent:o}}function sC(s){let e=JR(s.parent);const t=s.structuredQuery,a=t.from?t.from.length:0;let o=null;if(a>0){Rt(a===1,65062);const x=t.from[0];x.allDescendants?o=x.collectionId:e=e.child(x.collectionId)}let l=[];t.where&&(l=(function(_){const w=jT(_);return w instanceof qr&&oT(w)?w.getFilters():[w]})(t.where));let d=[];t.orderBy&&(d=(function(_){return _.map((w=>(function(B){return new Ac(Io(B.field),(function(D){switch(D){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(B.direction))})(w)))})(t.orderBy));let m=null;t.limit&&(m=(function(_){let w;return w=typeof _=="object"?_.value:_,sh(w)?null:w})(t.limit));let p=null;t.startAt&&(p=(function(_){const w=!!_.before,j=_.values||[];return new Bd(j,w)})(t.startAt));let y=null;return t.endAt&&(y=(function(_){const w=!_.before,j=_.values||[];return new Bd(j,w)})(t.endAt)),kR(e,o,d,l,m,"F",p,y)}function iC(s,e){const t=(function(o){switch(o){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return He(28987,{purpose:o})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function jT(s){return s.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const a=Io(t.unaryFilter.field);return vn.create(a,"==",{doubleValue:NaN});case"IS_NULL":const o=Io(t.unaryFilter.field);return vn.create(o,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const l=Io(t.unaryFilter.field);return vn.create(l,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const d=Io(t.unaryFilter.field);return vn.create(d,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return He(61313);default:return He(60726)}})(s):s.fieldFilter!==void 0?(function(t){return vn.create(Io(t.fieldFilter.field),(function(o){switch(o){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return He(58110);default:return He(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(s):s.compositeFilter!==void 0?(function(t){return qr.create(t.compositeFilter.filters.map((a=>jT(a))),(function(o){switch(o){case"AND":return"and";case"OR":return"or";default:return He(1026)}})(t.compositeFilter.op))})(s):He(30097,{filter:s})}function oC(s){return YR[s]}function lC(s){return QR[s]}function cC(s){return XR[s]}function Co(s){return{fieldPath:s.canonicalString()}}function Io(s){return qn.fromServerFormat(s.fieldPath)}function DT(s){return s instanceof vn?(function(t){if(t.op==="=="){if(Lx(t.value))return{unaryFilter:{field:Co(t.field),op:"IS_NAN"}};if(zx(t.value))return{unaryFilter:{field:Co(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Lx(t.value))return{unaryFilter:{field:Co(t.field),op:"IS_NOT_NAN"}};if(zx(t.value))return{unaryFilter:{field:Co(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Co(t.field),op:lC(t.op),value:t.value}}})(s):s instanceof qr?(function(t){const a=t.getFilters().map((o=>DT(o)));return a.length===1?a[0]:{compositeFilter:{op:cC(t.op),filters:a}}})(s):He(54877,{filter:s})}function uC(s){const e=[];return s.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function MT(s){return s.length>=4&&s.get(0)==="projects"&&s.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ds{constructor(e,t,a,o,l=Ye.min(),d=Ye.min(),m=$n.EMPTY_BYTE_STRING,p=null){this.target=e,this.targetId=t,this.purpose=a,this.sequenceNumber=o,this.snapshotVersion=l,this.lastLimboFreeSnapshotVersion=d,this.resumeToken=m,this.expectedCount=p}withSequenceNumber(e){return new Ds(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Ds(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ds(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ds(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dC{constructor(e){this.yt=e}}function hC(s){const e=sC({parent:s.parent,structuredQuery:s.structuredQuery});return s.limitType==="LAST"?rg(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fC{constructor(){this.Cn=new mC}addToCollectionParentIndex(e,t){return this.Cn.add(t),fe.resolve()}getCollectionParents(e,t){return fe.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return fe.resolve()}deleteFieldIndex(e,t){return fe.resolve()}deleteAllFieldIndexes(e){return fe.resolve()}createTargetIndexes(e,t){return fe.resolve()}getDocumentsMatchingTarget(e,t){return fe.resolve(null)}getIndexType(e,t){return fe.resolve(0)}getFieldIndexes(e,t){return fe.resolve([])}getNextCollectionGroupToUpdate(e){return fe.resolve(null)}getMinOffset(e,t){return fe.resolve(Ls.min())}getMinOffsetFromCollectionGroup(e,t){return fe.resolve(Ls.min())}updateCollectionGroup(e,t,a){return fe.resolve()}updateIndexEntries(e,t){return fe.resolve()}}class mC{constructor(){this.index={}}add(e){const t=e.lastSegment(),a=e.popLast(),o=this.index[t]||new An(qt.comparator),l=!o.has(a);return this.index[t]=o.add(a),l}has(e){const t=e.lastSegment(),a=e.popLast(),o=this.index[t];return o&&o.has(a)}getEntries(e){return(this.index[e]||new An(qt.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jx={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},OT=41943040;class ur{static withCacheSize(e){return new ur(e,ur.DEFAULT_COLLECTION_PERCENTILE,ur.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,a){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=a}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ur.DEFAULT_COLLECTION_PERCENTILE=10,ur.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ur.DEFAULT=new ur(OT,ur.DEFAULT_COLLECTION_PERCENTILE,ur.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ur.DISABLED=new ur(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Go{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Go(0)}static cr(){return new Go(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eb="LruGarbageCollector",PT=1048576;function tb([s,e],[t,a]){const o=gt(s,t);return o===0?gt(e,a):o}class gC{constructor(e){this.Ir=e,this.buffer=new An(tb),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const a=this.buffer.last();tb(t,a)<0&&(this.buffer=this.buffer.delete(a).add(t))}}get maxValue(){return this.buffer.last()[0]}}class pC{constructor(e,t,a){this.garbageCollector=e,this.asyncQueue=t,this.localStore=a,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Ce(eb,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){el(t)?Ce(eb,"Ignoring IndexedDB error during garbage collection: ",t):await Jo(t)}await this.Vr(3e5)}))}}class yC{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((a=>Math.floor(t/100*a)))}nthSequenceNumber(e,t){if(t===0)return fe.resolve(ah.ce);const a=new gC(t);return this.mr.forEachTarget(e,(o=>a.Ar(o.sequenceNumber))).next((()=>this.mr.pr(e,(o=>a.Ar(o))))).next((()=>a.maxValue))}removeTargets(e,t,a){return this.mr.removeTargets(e,t,a)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(Ce("LruGarbageCollector","Garbage collection skipped; disabled"),fe.resolve(Jx)):this.getCacheSize(e).next((a=>a<this.params.cacheSizeCollectionThreshold?(Ce("LruGarbageCollector",`Garbage collection skipped; Cache size ${a} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Jx):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let a,o,l,d,m,p,y;const x=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((_=>(_>this.params.maximumSequenceNumbersToCollect?(Ce("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${_}`),o=this.params.maximumSequenceNumbersToCollect):o=_,d=Date.now(),this.nthSequenceNumber(e,o)))).next((_=>(a=_,m=Date.now(),this.removeTargets(e,a,t)))).next((_=>(l=_,p=Date.now(),this.removeOrphanedDocuments(e,a)))).next((_=>(y=Date.now(),No()<=mt.DEBUG&&Ce("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${d-x}ms
	Determined least recently used ${o} in `+(m-d)+`ms
	Removed ${l} targets in `+(p-m)+`ms
	Removed ${_} documents in `+(y-p)+`ms
Total Duration: ${y-x}ms`),fe.resolve({didRun:!0,sequenceNumbersCollected:o,targetsRemoved:l,documentsRemoved:_}))))}}function vC(s,e){return new yC(s,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xC{constructor(){this.changes=new Mi((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Zn.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const a=this.changes.get(t);return a!==void 0?fe.resolve(a):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bC{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _C{constructor(e,t,a,o){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=a,this.indexManager=o}getDocument(e,t){let a=null;return this.documentOverlayCache.getOverlay(e,t).next((o=>(a=o,this.remoteDocumentCache.getEntry(e,t)))).next((o=>(a!==null&&gc(a.mutation,o,Br.empty(),Gt.now()),o)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((a=>this.getLocalViewOfDocuments(e,a,pt()).next((()=>a))))}getLocalViewOfDocuments(e,t,a=pt()){const o=ki();return this.populateOverlays(e,o,t).next((()=>this.computeViews(e,t,o,a).next((l=>{let d=oc();return l.forEach(((m,p)=>{d=d.insert(m,p.overlayedDocument)})),d}))))}getOverlayedDocuments(e,t){const a=ki();return this.populateOverlays(e,a,t).next((()=>this.computeViews(e,t,a,pt())))}populateOverlays(e,t,a){const o=[];return a.forEach((l=>{t.has(l)||o.push(l)})),this.documentOverlayCache.getOverlays(e,o).next((l=>{l.forEach(((d,m)=>{t.set(d,m)}))}))}computeViews(e,t,a,o){let l=es();const d=mc(),m=(function(){return mc()})();return t.forEach(((p,y)=>{const x=a.get(y.key);o.has(y.key)&&(x===void 0||x.mutation instanceof Oi)?l=l.insert(y.key,y):x!==void 0?(d.set(y.key,x.mutation.getFieldMask()),gc(x.mutation,y,x.mutation.getFieldMask(),Gt.now())):d.set(y.key,Br.empty())})),this.recalculateAndSaveOverlays(e,l).next((p=>(p.forEach(((y,x)=>d.set(y,x))),t.forEach(((y,x)=>m.set(y,new bC(x,d.get(y)??null)))),m)))}recalculateAndSaveOverlays(e,t){const a=mc();let o=new tn(((d,m)=>d-m)),l=pt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((d=>{for(const m of d)m.keys().forEach((p=>{const y=t.get(p);if(y===null)return;let x=a.get(p)||Br.empty();x=m.applyToLocalView(y,x),a.set(p,x);const _=(o.get(m.batchId)||pt()).add(p);o=o.insert(m.batchId,_)}))})).next((()=>{const d=[],m=o.getReverseIterator();for(;m.hasNext();){const p=m.getNext(),y=p.key,x=p.value,_=pT();x.forEach((w=>{if(!l.has(w)){const j=TT(t.get(w),a.get(w));j!==null&&_.set(w,j),l=l.add(w)}})),d.push(this.documentOverlayCache.saveOverlays(e,y,_))}return fe.waitFor(d)})).next((()=>a))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((a=>this.recalculateAndSaveOverlays(e,a)))}getDocumentsMatchingQuery(e,t,a,o){return(function(d){return Ve.isDocumentKey(d.path)&&d.collectionGroup===null&&d.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):dT(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,a,o):this.getDocumentsMatchingCollectionQuery(e,t,a,o)}getNextDocuments(e,t,a,o){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,a,o).next((l=>{const d=o-l.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,a.largestBatchId,o-l.size):fe.resolve(ki());let m=kc,p=l;return d.next((y=>fe.forEach(y,((x,_)=>(m<_.largestBatchId&&(m=_.largestBatchId),l.get(x)?fe.resolve():this.remoteDocumentCache.getEntry(e,x).next((w=>{p=p.insert(x,w)}))))).next((()=>this.populateOverlays(e,y,l))).next((()=>this.computeViews(e,p,y,pt()))).next((x=>({batchId:m,changes:gT(x)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Ve(t)).next((a=>{let o=oc();return a.isFoundDocument()&&(o=o.insert(a.key,a)),o}))}getDocumentsMatchingCollectionGroupQuery(e,t,a,o){const l=t.collectionGroup;let d=oc();return this.indexManager.getCollectionParents(e,l).next((m=>fe.forEach(m,(p=>{const y=(function(_,w){return new tl(w,null,_.explicitOrderBy.slice(),_.filters.slice(),_.limit,_.limitType,_.startAt,_.endAt)})(t,p.child(l));return this.getDocumentsMatchingCollectionQuery(e,y,a,o).next((x=>{x.forEach(((_,w)=>{d=d.insert(_,w)}))}))})).next((()=>d))))}getDocumentsMatchingCollectionQuery(e,t,a,o){let l;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,a.largestBatchId).next((d=>(l=d,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,a,l,o)))).next((d=>{l.forEach(((p,y)=>{const x=y.getKey();d.get(x)===null&&(d=d.insert(x,Zn.newInvalidDocument(x)))}));let m=oc();return d.forEach(((p,y)=>{const x=l.get(p);x!==void 0&&gc(x.mutation,y,Br.empty(),Gt.now()),lh(t,y)&&(m=m.insert(p,y))})),m}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TC{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return fe.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(o){return{id:o.id,version:o.version,createTime:ga(o.createTime)}})(t)),fe.resolve()}getNamedQuery(e,t){return fe.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(o){return{name:o.name,query:hC(o.bundledQuery),readTime:ga(o.readTime)}})(t)),fe.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kC{constructor(){this.overlays=new tn(Ve.comparator),this.qr=new Map}getOverlay(e,t){return fe.resolve(this.overlays.get(t))}getOverlays(e,t){const a=ki();return fe.forEach(t,(o=>this.getOverlay(e,o).next((l=>{l!==null&&a.set(o,l)})))).next((()=>a))}saveOverlays(e,t,a){return a.forEach(((o,l)=>{this.St(e,t,l)})),fe.resolve()}removeOverlaysForBatchId(e,t,a){const o=this.qr.get(a);return o!==void 0&&(o.forEach((l=>this.overlays=this.overlays.remove(l))),this.qr.delete(a)),fe.resolve()}getOverlaysForCollection(e,t,a){const o=ki(),l=t.length+1,d=new Ve(t.child("")),m=this.overlays.getIteratorFrom(d);for(;m.hasNext();){const p=m.getNext().value,y=p.getKey();if(!t.isPrefixOf(y.path))break;y.path.length===l&&p.largestBatchId>a&&o.set(p.getKey(),p)}return fe.resolve(o)}getOverlaysForCollectionGroup(e,t,a,o){let l=new tn(((y,x)=>y-x));const d=this.overlays.getIterator();for(;d.hasNext();){const y=d.getNext().value;if(y.getKey().getCollectionGroup()===t&&y.largestBatchId>a){let x=l.get(y.largestBatchId);x===null&&(x=ki(),l=l.insert(y.largestBatchId,x)),x.set(y.getKey(),y)}}const m=ki(),p=l.getIterator();for(;p.hasNext()&&(p.getNext().value.forEach(((y,x)=>m.set(y,x))),!(m.size()>=o)););return fe.resolve(m)}St(e,t,a){const o=this.overlays.get(a.key);if(o!==null){const d=this.qr.get(o.largestBatchId).delete(a.key);this.qr.set(o.largestBatchId,d)}this.overlays=this.overlays.insert(a.key,new GR(t,a));let l=this.qr.get(t);l===void 0&&(l=pt(),this.qr.set(t,l)),this.qr.set(t,l.add(a.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EC{constructor(){this.sessionToken=$n.EMPTY_BYTE_STRING}getSessionToken(e){return fe.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,fe.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qg{constructor(){this.Qr=new An(Pn.$r),this.Ur=new An(Pn.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const a=new Pn(e,t);this.Qr=this.Qr.add(a),this.Ur=this.Ur.add(a)}Wr(e,t){e.forEach((a=>this.addReference(a,t)))}removeReference(e,t){this.Gr(new Pn(e,t))}zr(e,t){e.forEach((a=>this.removeReference(a,t)))}jr(e){const t=new Ve(new qt([])),a=new Pn(t,e),o=new Pn(t,e+1),l=[];return this.Ur.forEachInRange([a,o],(d=>{this.Gr(d),l.push(d.key)})),l}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new Ve(new qt([])),a=new Pn(t,e),o=new Pn(t,e+1);let l=pt();return this.Ur.forEachInRange([a,o],(d=>{l=l.add(d.key)})),l}containsKey(e){const t=new Pn(e,0),a=this.Qr.firstAfterOrEqual(t);return a!==null&&e.isEqual(a.key)}}class Pn{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return Ve.comparator(e.key,t.key)||gt(e.Yr,t.Yr)}static Kr(e,t){return gt(e.Yr,t.Yr)||Ve.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SC{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new An(Pn.$r)}checkEmpty(e){return fe.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,a,o){const l=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const d=new BR(l,t,a,o);this.mutationQueue.push(d);for(const m of o)this.Zr=this.Zr.add(new Pn(m.key,l)),this.indexManager.addToCollectionParentIndex(e,m.key.path.popLast());return fe.resolve(d)}lookupMutationBatch(e,t){return fe.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const a=t+1,o=this.ei(a),l=o<0?0:o;return fe.resolve(this.mutationQueue.length>l?this.mutationQueue[l]:null)}getHighestUnacknowledgedBatchId(){return fe.resolve(this.mutationQueue.length===0?Og:this.tr-1)}getAllMutationBatches(e){return fe.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const a=new Pn(t,0),o=new Pn(t,Number.POSITIVE_INFINITY),l=[];return this.Zr.forEachInRange([a,o],(d=>{const m=this.Xr(d.Yr);l.push(m)})),fe.resolve(l)}getAllMutationBatchesAffectingDocumentKeys(e,t){let a=new An(gt);return t.forEach((o=>{const l=new Pn(o,0),d=new Pn(o,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([l,d],(m=>{a=a.add(m.Yr)}))})),fe.resolve(this.ti(a))}getAllMutationBatchesAffectingQuery(e,t){const a=t.path,o=a.length+1;let l=a;Ve.isDocumentKey(l)||(l=l.child(""));const d=new Pn(new Ve(l),0);let m=new An(gt);return this.Zr.forEachWhile((p=>{const y=p.key.path;return!!a.isPrefixOf(y)&&(y.length===o&&(m=m.add(p.Yr)),!0)}),d),fe.resolve(this.ti(m))}ti(e){const t=[];return e.forEach((a=>{const o=this.Xr(a);o!==null&&t.push(o)})),t}removeMutationBatch(e,t){Rt(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let a=this.Zr;return fe.forEach(t.mutations,(o=>{const l=new Pn(o.key,t.batchId);return a=a.delete(l),this.referenceDelegate.markPotentiallyOrphaned(e,o.key)})).next((()=>{this.Zr=a}))}ir(e){}containsKey(e,t){const a=new Pn(t,0),o=this.Zr.firstAfterOrEqual(a);return fe.resolve(t.isEqual(o&&o.key))}performConsistencyCheck(e){return this.mutationQueue.length,fe.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wC{constructor(e){this.ri=e,this.docs=(function(){return new tn(Ve.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const a=t.key,o=this.docs.get(a),l=o?o.size:0,d=this.ri(t);return this.docs=this.docs.insert(a,{document:t.mutableCopy(),size:d}),this.size+=d-l,this.indexManager.addToCollectionParentIndex(e,a.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const a=this.docs.get(t);return fe.resolve(a?a.document.mutableCopy():Zn.newInvalidDocument(t))}getEntries(e,t){let a=es();return t.forEach((o=>{const l=this.docs.get(o);a=a.insert(o,l?l.document.mutableCopy():Zn.newInvalidDocument(o))})),fe.resolve(a)}getDocumentsMatchingQuery(e,t,a,o){let l=es();const d=t.path,m=new Ve(d.child("__id-9223372036854775808__")),p=this.docs.getIteratorFrom(m);for(;p.hasNext();){const{key:y,value:{document:x}}=p.getNext();if(!d.isPrefixOf(y.path))break;y.path.length>d.length+1||tR(eR(x),a)<=0||(o.has(x.key)||lh(t,x))&&(l=l.insert(x.key,x.mutableCopy()))}return fe.resolve(l)}getAllFromCollectionGroup(e,t,a,o){He(9500)}ii(e,t){return fe.forEach(this.docs,(a=>t(a)))}newChangeBuffer(e){return new AC(this)}getSize(e){return fe.resolve(this.size)}}class AC extends xC{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((a,o)=>{o.isValidDocument()?t.push(this.Nr.addEntry(e,o)):this.Nr.removeEntry(a)})),fe.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NC{constructor(e){this.persistence=e,this.si=new Mi((t=>zg(t)),Lg),this.lastRemoteSnapshotVersion=Ye.min(),this.highestTargetId=0,this.oi=0,this._i=new qg,this.targetCount=0,this.ai=Go.ur()}forEachTarget(e,t){return this.si.forEach(((a,o)=>t(o))),fe.resolve()}getLastRemoteSnapshotVersion(e){return fe.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return fe.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),fe.resolve(this.highestTargetId)}setTargetsMetadata(e,t,a){return a&&(this.lastRemoteSnapshotVersion=a),t>this.oi&&(this.oi=t),fe.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new Go(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,fe.resolve()}updateTargetData(e,t){return this.Pr(t),fe.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,fe.resolve()}removeTargets(e,t,a){let o=0;const l=[];return this.si.forEach(((d,m)=>{m.sequenceNumber<=t&&a.get(m.targetId)===null&&(this.si.delete(d),l.push(this.removeMatchingKeysForTargetId(e,m.targetId)),o++)})),fe.waitFor(l).next((()=>o))}getTargetCount(e){return fe.resolve(this.targetCount)}getTargetData(e,t){const a=this.si.get(t)||null;return fe.resolve(a)}addMatchingKeys(e,t,a){return this._i.Wr(t,a),fe.resolve()}removeMatchingKeys(e,t,a){this._i.zr(t,a);const o=this.persistence.referenceDelegate,l=[];return o&&t.forEach((d=>{l.push(o.markPotentiallyOrphaned(e,d))})),fe.waitFor(l)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),fe.resolve()}getMatchingKeysForTargetId(e,t){const a=this._i.Hr(t);return fe.resolve(a)}containsKey(e,t){return fe.resolve(this._i.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VT{constructor(e,t){this.ui={},this.overlays={},this.ci=new ah(0),this.li=!1,this.li=!0,this.hi=new EC,this.referenceDelegate=e(this),this.Pi=new NC(this),this.indexManager=new fC,this.remoteDocumentCache=(function(o){return new wC(o)})((a=>this.referenceDelegate.Ti(a))),this.serializer=new dC(t),this.Ii=new TC(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new kC,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let a=this.ui[e.toKey()];return a||(a=new SC(t,this.referenceDelegate),this.ui[e.toKey()]=a),a}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,a){Ce("MemoryPersistence","Starting transaction:",e);const o=new RC(this.ci.next());return this.referenceDelegate.Ei(),a(o).next((l=>this.referenceDelegate.di(o).next((()=>l)))).toPromise().then((l=>(o.raiseOnCommittedEvent(),l)))}Ai(e,t){return fe.or(Object.values(this.ui).map((a=>()=>a.containsKey(e,t))))}}class RC extends rR{constructor(e){super(),this.currentSequenceNumber=e}}class $g{constructor(e){this.persistence=e,this.Ri=new qg,this.Vi=null}static mi(e){return new $g(e)}get fi(){if(this.Vi)return this.Vi;throw He(60996)}addReference(e,t,a){return this.Ri.addReference(a,t),this.fi.delete(a.toString()),fe.resolve()}removeReference(e,t,a){return this.Ri.removeReference(a,t),this.fi.add(a.toString()),fe.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),fe.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((o=>this.fi.add(o.toString())));const a=this.persistence.getTargetCache();return a.getMatchingKeysForTargetId(e,t.targetId).next((o=>{o.forEach((l=>this.fi.add(l.toString())))})).next((()=>a.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return fe.forEach(this.fi,(a=>{const o=Ve.fromPath(a);return this.gi(e,o).next((l=>{l||t.removeEntry(o,Ye.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((a=>{a?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return fe.or([()=>fe.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class Fd{constructor(e,t){this.persistence=e,this.pi=new Mi((a=>iR(a.path)),((a,o)=>a.isEqual(o))),this.garbageCollector=vC(this,t)}static mi(e,t){return new Fd(e,t)}Ei(){}di(e){return fe.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((a=>t.next((o=>a+o))))}wr(e){let t=0;return this.pr(e,(a=>{t++})).next((()=>t))}pr(e,t){return fe.forEach(this.pi,((a,o)=>this.br(e,a,o).next((l=>l?fe.resolve():t(o)))))}removeTargets(e,t,a){return this.persistence.getTargetCache().removeTargets(e,t,a)}removeOrphanedDocuments(e,t){let a=0;const o=this.persistence.getRemoteDocumentCache(),l=o.newChangeBuffer();return o.ii(e,(d=>this.br(e,d,t).next((m=>{m||(a++,l.removeEntry(d,Ye.min()))})))).next((()=>l.apply(e))).next((()=>a))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),fe.resolve()}removeTarget(e,t){const a=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,a)}addReference(e,t,a){return this.pi.set(a,e.currentSequenceNumber),fe.resolve()}removeReference(e,t,a){return this.pi.set(a,e.currentSequenceNumber),fe.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),fe.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=wd(e.data.value)),t}br(e,t,a){return fe.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const o=this.pi.get(t);return fe.resolve(o!==void 0&&o>a)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kg{constructor(e,t,a,o){this.targetId=e,this.fromCache=t,this.Es=a,this.ds=o}static As(e,t){let a=pt(),o=pt();for(const l of t.docChanges)switch(l.type){case 0:a=a.add(l.doc.key);break;case 1:o=o.add(l.doc.key)}return new Kg(e,t.fromCache,a,o)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CC{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IC{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return iw()?8:aR(Jn())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,a,o){const l={result:null};return this.ys(e,t).next((d=>{l.result=d})).next((()=>{if(!l.result)return this.ws(e,t,o,a).next((d=>{l.result=d}))})).next((()=>{if(l.result)return;const d=new CC;return this.Ss(e,t,d).next((m=>{if(l.result=m,this.Vs)return this.bs(e,t,d,m.size)}))})).next((()=>l.result))}bs(e,t,a,o){return a.documentReadCount<this.fs?(No()<=mt.DEBUG&&Ce("QueryEngine","SDK will not create cache indexes for query:",Ro(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),fe.resolve()):(No()<=mt.DEBUG&&Ce("QueryEngine","Query:",Ro(t),"scans",a.documentReadCount,"local documents and returns",o,"documents as results."),a.documentReadCount>this.gs*o?(No()<=mt.DEBUG&&Ce("QueryEngine","The SDK decides to create cache indexes for query:",Ro(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,fa(t))):fe.resolve())}ys(e,t){if(Hx(t))return fe.resolve(null);let a=fa(t);return this.indexManager.getIndexType(e,a).next((o=>o===0?null:(t.limit!==null&&o===1&&(t=rg(t,null,"F"),a=fa(t)),this.indexManager.getDocumentsMatchingTarget(e,a).next((l=>{const d=pt(...l);return this.ps.getDocuments(e,d).next((m=>this.indexManager.getMinOffset(e,a).next((p=>{const y=this.Ds(t,m);return this.Cs(t,y,d,p.readTime)?this.ys(e,rg(t,null,"F")):this.vs(e,y,t,p)}))))})))))}ws(e,t,a,o){return Hx(t)||o.isEqual(Ye.min())?fe.resolve(null):this.ps.getDocuments(e,a).next((l=>{const d=this.Ds(t,l);return this.Cs(t,d,a,o)?fe.resolve(null):(No()<=mt.DEBUG&&Ce("QueryEngine","Re-using previous result from %s to execute query: %s",o.toString(),Ro(t)),this.vs(e,d,t,J2(o,kc)).next((m=>m)))}))}Ds(e,t){let a=new An(fT(e));return t.forEach(((o,l)=>{lh(e,l)&&(a=a.add(l))})),a}Cs(e,t,a,o){if(e.limit===null)return!1;if(a.size!==t.size)return!0;const l=e.limitType==="F"?t.last():t.first();return!!l&&(l.hasPendingWrites||l.version.compareTo(o)>0)}Ss(e,t,a){return No()<=mt.DEBUG&&Ce("QueryEngine","Using full collection scan to execute query:",Ro(t)),this.ps.getDocumentsMatchingQuery(e,t,Ls.min(),a)}vs(e,t,a,o){return this.ps.getDocumentsMatchingQuery(e,a,o).next((l=>(t.forEach((d=>{l=l.insert(d.key,d)})),l)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yg="LocalStore",jC=3e8;class DC{constructor(e,t,a,o){this.persistence=e,this.Fs=t,this.serializer=o,this.Ms=new tn(gt),this.xs=new Mi((l=>zg(l)),Lg),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(a)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new _C(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function MC(s,e,t,a){return new DC(s,e,t,a)}async function zT(s,e){const t=Ze(s);return await t.persistence.runTransaction("Handle user change","readonly",(a=>{let o;return t.mutationQueue.getAllMutationBatches(a).next((l=>(o=l,t.Bs(e),t.mutationQueue.getAllMutationBatches(a)))).next((l=>{const d=[],m=[];let p=pt();for(const y of o){d.push(y.batchId);for(const x of y.mutations)p=p.add(x.key)}for(const y of l){m.push(y.batchId);for(const x of y.mutations)p=p.add(x.key)}return t.localDocuments.getDocuments(a,p).next((y=>({Ls:y,removedBatchIds:d,addedBatchIds:m})))}))}))}function OC(s,e){const t=Ze(s);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(a=>{const o=e.batch.keys(),l=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(m,p,y,x){const _=y.batch,w=_.keys();let j=fe.resolve();return w.forEach((B=>{j=j.next((()=>x.getEntry(p,B))).next((L=>{const D=y.docVersions.get(B);Rt(D!==null,48541),L.version.compareTo(D)<0&&(_.applyToRemoteDocument(L,y),L.isValidDocument()&&(L.setReadTime(y.commitVersion),x.addEntry(L)))}))})),j.next((()=>m.mutationQueue.removeMutationBatch(p,_)))})(t,a,e,l).next((()=>l.apply(a))).next((()=>t.mutationQueue.performConsistencyCheck(a))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(a,o,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(a,(function(m){let p=pt();for(let y=0;y<m.mutationResults.length;++y)m.mutationResults[y].transformResults.length>0&&(p=p.add(m.batch.mutations[y].key));return p})(e)))).next((()=>t.localDocuments.getDocuments(a,o)))}))}function LT(s){const e=Ze(s);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function PC(s,e){const t=Ze(s),a=e.snapshotVersion;let o=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(l=>{const d=t.Ns.newChangeBuffer({trackRemovals:!0});o=t.Ms;const m=[];e.targetChanges.forEach(((x,_)=>{const w=o.get(_);if(!w)return;m.push(t.Pi.removeMatchingKeys(l,x.removedDocuments,_).next((()=>t.Pi.addMatchingKeys(l,x.addedDocuments,_))));let j=w.withSequenceNumber(l.currentSequenceNumber);e.targetMismatches.get(_)!==null?j=j.withResumeToken($n.EMPTY_BYTE_STRING,Ye.min()).withLastLimboFreeSnapshotVersion(Ye.min()):x.resumeToken.approximateByteSize()>0&&(j=j.withResumeToken(x.resumeToken,a)),o=o.insert(_,j),(function(L,D,$){return L.resumeToken.approximateByteSize()===0||D.snapshotVersion.toMicroseconds()-L.snapshotVersion.toMicroseconds()>=jC?!0:$.addedDocuments.size+$.modifiedDocuments.size+$.removedDocuments.size>0})(w,j,x)&&m.push(t.Pi.updateTargetData(l,j))}));let p=es(),y=pt();if(e.documentUpdates.forEach((x=>{e.resolvedLimboDocuments.has(x)&&m.push(t.persistence.referenceDelegate.updateLimboDocument(l,x))})),m.push(VC(l,d,e.documentUpdates).next((x=>{p=x.ks,y=x.qs}))),!a.isEqual(Ye.min())){const x=t.Pi.getLastRemoteSnapshotVersion(l).next((_=>t.Pi.setTargetsMetadata(l,l.currentSequenceNumber,a)));m.push(x)}return fe.waitFor(m).next((()=>d.apply(l))).next((()=>t.localDocuments.getLocalViewOfDocuments(l,p,y))).next((()=>p))})).then((l=>(t.Ms=o,l)))}function VC(s,e,t){let a=pt(),o=pt();return t.forEach((l=>a=a.add(l))),e.getEntries(s,a).next((l=>{let d=es();return t.forEach(((m,p)=>{const y=l.get(m);p.isFoundDocument()!==y.isFoundDocument()&&(o=o.add(m)),p.isNoDocument()&&p.version.isEqual(Ye.min())?(e.removeEntry(m,p.readTime),d=d.insert(m,p)):!y.isValidDocument()||p.version.compareTo(y.version)>0||p.version.compareTo(y.version)===0&&y.hasPendingWrites?(e.addEntry(p),d=d.insert(m,p)):Ce(Yg,"Ignoring outdated watch update for ",m,". Current version:",y.version," Watch version:",p.version)})),{ks:d,qs:o}}))}function zC(s,e){const t=Ze(s);return t.persistence.runTransaction("Get next mutation batch","readonly",(a=>(e===void 0&&(e=Og),t.mutationQueue.getNextMutationBatchAfterBatchId(a,e))))}function LC(s,e){const t=Ze(s);return t.persistence.runTransaction("Allocate target","readwrite",(a=>{let o;return t.Pi.getTargetData(a,e).next((l=>l?(o=l,fe.resolve(o)):t.Pi.allocateTargetId(a).next((d=>(o=new Ds(e,d,"TargetPurposeListen",a.currentSequenceNumber),t.Pi.addTargetData(a,o).next((()=>o)))))))})).then((a=>{const o=t.Ms.get(a.targetId);return(o===null||a.snapshotVersion.compareTo(o.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(a.targetId,a),t.xs.set(e,a.targetId)),a}))}async function lg(s,e,t){const a=Ze(s),o=a.Ms.get(e),l=t?"readwrite":"readwrite-primary";try{t||await a.persistence.runTransaction("Release target",l,(d=>a.persistence.referenceDelegate.removeTarget(d,o)))}catch(d){if(!el(d))throw d;Ce(Yg,`Failed to update sequence numbers for target ${e}: ${d}`)}a.Ms=a.Ms.remove(e),a.xs.delete(o.target)}function nb(s,e,t){const a=Ze(s);let o=Ye.min(),l=pt();return a.persistence.runTransaction("Execute query","readwrite",(d=>(function(p,y,x){const _=Ze(p),w=_.xs.get(x);return w!==void 0?fe.resolve(_.Ms.get(w)):_.Pi.getTargetData(y,x)})(a,d,fa(e)).next((m=>{if(m)return o=m.lastLimboFreeSnapshotVersion,a.Pi.getMatchingKeysForTargetId(d,m.targetId).next((p=>{l=p}))})).next((()=>a.Fs.getDocumentsMatchingQuery(d,e,t?o:Ye.min(),t?l:pt()))).next((m=>(UC(a,SR(e),m),{documents:m,Qs:l})))))}function UC(s,e,t){let a=s.Os.get(e)||Ye.min();t.forEach(((o,l)=>{l.readTime.compareTo(a)>0&&(a=l.readTime)})),s.Os.set(e,a)}class rb{constructor(){this.activeTargetIds=IR()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class BC{constructor(){this.Mo=new rb,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,a){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,a){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new rb,Promise.resolve()}handleUserChange(e,t,a){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GC{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ab="ConnectivityMonitor";class sb{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Ce(ab,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Ce(ab,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let yd=null;function cg(){return yd===null?yd=(function(){return 268435456+Math.round(2147483648*Math.random())})():yd++,"0x"+yd.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Om="RestConnection",HC={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class FC{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",a=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${a}/databases/${o}`,this.Wo=this.databaseId.database===Ld?`project_id=${a}`:`project_id=${a}&database_id=${o}`}Go(e,t,a,o,l){const d=cg(),m=this.zo(e,t.toUriEncodedString());Ce(Om,`Sending RPC '${e}' ${d}:`,m,a);const p={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(p,o,l);const{host:y}=new URL(m),x=Qo(y);return this.Jo(e,m,p,a,x).then((_=>(Ce(Om,`Received RPC '${e}' ${d}: `,_),_)),(_=>{throw Tc(Om,`RPC '${e}' ${d} failed with error: `,_,"url: ",m,"request:",a),_}))}Ho(e,t,a,o,l,d){return this.Go(e,t,a,o,l)}jo(e,t,a){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Wo})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((o,l)=>e[l]=o)),a&&a.headers.forEach(((o,l)=>e[l]=o))}zo(e,t){const a=HC[e];return`${this.Uo}/v1/${t}:${a}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qC{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xn="WebChannelConnection";class $C extends FC{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,a,o,l){const d=cg();return new Promise(((m,p)=>{const y=new B_;y.setWithCredentials(!0),y.listenOnce(G_.COMPLETE,(()=>{try{switch(y.getLastErrorCode()){case Sd.NO_ERROR:const _=y.getResponseJson();Ce(Xn,`XHR for RPC '${e}' ${d} received:`,JSON.stringify(_)),m(_);break;case Sd.TIMEOUT:Ce(Xn,`RPC '${e}' ${d} timed out`),p(new Se(ie.DEADLINE_EXCEEDED,"Request time out"));break;case Sd.HTTP_ERROR:const w=y.getStatus();if(Ce(Xn,`RPC '${e}' ${d} failed with status:`,w,"response text:",y.getResponseText()),w>0){let j=y.getResponseJson();Array.isArray(j)&&(j=j[0]);const B=j?.error;if(B&&B.status&&B.message){const L=(function($){const X=$.toLowerCase().replace(/_/g,"-");return Object.values(ie).indexOf(X)>=0?X:ie.UNKNOWN})(B.status);p(new Se(L,B.message))}else p(new Se(ie.UNKNOWN,"Server responded with status "+y.getStatus()))}else p(new Se(ie.UNAVAILABLE,"Connection failed."));break;default:He(9055,{l_:e,streamId:d,h_:y.getLastErrorCode(),P_:y.getLastError()})}}finally{Ce(Xn,`RPC '${e}' ${d} completed.`)}}));const x=JSON.stringify(o);Ce(Xn,`RPC '${e}' ${d} sending request:`,o),y.send(t,"POST",x,a,15)}))}T_(e,t,a){const o=cg(),l=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],d=q_(),m=F_(),p={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},y=this.longPollingOptions.timeoutSeconds;y!==void 0&&(p.longPollingTimeout=Math.round(1e3*y)),this.useFetchStreams&&(p.useFetchStreams=!0),this.jo(p.initMessageHeaders,t,a),p.encodeInitMessageHeaders=!0;const x=l.join("");Ce(Xn,`Creating RPC '${e}' stream ${o}: ${x}`,p);const _=d.createWebChannel(x,p);this.I_(_);let w=!1,j=!1;const B=new qC({Yo:D=>{j?Ce(Xn,`Not sending because RPC '${e}' stream ${o} is closed:`,D):(w||(Ce(Xn,`Opening RPC '${e}' stream ${o} transport.`),_.open(),w=!0),Ce(Xn,`RPC '${e}' stream ${o} sending:`,D),_.send(D))},Zo:()=>_.close()}),L=(D,$,X)=>{D.listen($,(ne=>{try{X(ne)}catch(ce){setTimeout((()=>{throw ce}),0)}}))};return L(_,ic.EventType.OPEN,(()=>{j||(Ce(Xn,`RPC '${e}' stream ${o} transport opened.`),B.o_())})),L(_,ic.EventType.CLOSE,(()=>{j||(j=!0,Ce(Xn,`RPC '${e}' stream ${o} transport closed`),B.a_(),this.E_(_))})),L(_,ic.EventType.ERROR,(D=>{j||(j=!0,Tc(Xn,`RPC '${e}' stream ${o} transport errored. Name:`,D.name,"Message:",D.message),B.a_(new Se(ie.UNAVAILABLE,"The operation could not be completed")))})),L(_,ic.EventType.MESSAGE,(D=>{if(!j){const $=D.data[0];Rt(!!$,16349);const X=$,ne=X?.error||X[0]?.error;if(ne){Ce(Xn,`RPC '${e}' stream ${o} received error:`,ne);const ce=ne.status;let de=(function(N){const R=yn[N];if(R!==void 0)return ST(R)})(ce),me=ne.message;de===void 0&&(de=ie.INTERNAL,me="Unknown error status: "+ce+" with message "+ne.message),j=!0,B.a_(new Se(de,me)),_.close()}else Ce(Xn,`RPC '${e}' stream ${o} received:`,$),B.u_($)}})),L(m,H_.STAT_EVENT,(D=>{D.stat===Xm.PROXY?Ce(Xn,`RPC '${e}' stream ${o} detected buffering proxy`):D.stat===Xm.NOPROXY&&Ce(Xn,`RPC '${e}' stream ${o} detected no buffering proxy`)})),setTimeout((()=>{B.__()}),0),B}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function Pm(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hh(s){return new ZR(s,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UT{constructor(e,t,a=1e3,o=1.5,l=6e4){this.Mi=e,this.timerId=t,this.d_=a,this.A_=o,this.R_=l,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),a=Math.max(0,Date.now()-this.f_),o=Math.max(0,t-a);o>0&&Ce("ExponentialBackoff",`Backing off for ${o} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${a} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,o,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ib="PersistentStream";class BT{constructor(e,t,a,o,l,d,m,p){this.Mi=e,this.S_=a,this.b_=o,this.connection=l,this.authCredentialsProvider=d,this.appCheckCredentialsProvider=m,this.listener=p,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new UT(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===ie.RESOURCE_EXHAUSTED?(Ja(t.toString()),Ja("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===ie.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([a,o])=>{this.D_===t&&this.G_(a,o)}),(a=>{e((()=>{const o=new Se(ie.UNKNOWN,"Fetching auth token failed: "+a.message);return this.z_(o)}))}))}G_(e,t){const a=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{a((()=>this.listener.Xo()))})),this.stream.t_((()=>{a((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((o=>{a((()=>this.z_(o)))})),this.stream.onMessage((o=>{a((()=>++this.F_==1?this.J_(o):this.onNext(o)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return Ce(ib,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(Ce(ib,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class KC extends BT{constructor(e,t,a,o,l,d){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,a,o,d),this.serializer=l}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=eC(this.serializer,e),a=(function(l){if(!("targetChange"in l))return Ye.min();const d=l.targetChange;return d.targetIds&&d.targetIds.length?Ye.min():d.readTime?ga(d.readTime):Ye.min()})(e);return this.listener.H_(t,a)}Y_(e){const t={};t.database=og(this.serializer),t.addTarget=(function(l,d){let m;const p=d.target;if(m=tg(p)?{documents:rC(l,p)}:{query:aC(l,p).ft},m.targetId=d.targetId,d.resumeToken.approximateByteSize()>0){m.resumeToken=NT(l,d.resumeToken);const y=ag(l,d.expectedCount);y!==null&&(m.expectedCount=y)}else if(d.snapshotVersion.compareTo(Ye.min())>0){m.readTime=Hd(l,d.snapshotVersion.toTimestamp());const y=ag(l,d.expectedCount);y!==null&&(m.expectedCount=y)}return m})(this.serializer,e);const a=iC(this.serializer,e);a&&(t.labels=a),this.q_(t)}Z_(e){const t={};t.database=og(this.serializer),t.removeTarget=e,this.q_(t)}}class YC extends BT{constructor(e,t,a,o,l,d){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,a,o,d),this.serializer=l}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return Rt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Rt(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Rt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=nC(e.writeResults,e.commitTime),a=ga(e.commitTime);return this.listener.na(a,t)}ra(){const e={};e.database=og(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((a=>tC(this.serializer,a)))};this.q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QC{}class XC extends QC{constructor(e,t,a,o){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=a,this.serializer=o,this.ia=!1}sa(){if(this.ia)throw new Se(ie.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,a,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,d])=>this.connection.Go(e,sg(t,a),o,l,d))).catch((l=>{throw l.name==="FirebaseError"?(l.code===ie.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new Se(ie.UNKNOWN,l.toString())}))}Ho(e,t,a,o,l){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([d,m])=>this.connection.Ho(e,sg(t,a),o,d,m,l))).catch((d=>{throw d.name==="FirebaseError"?(d.code===ie.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),d):new Se(ie.UNKNOWN,d.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class ZC{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Ja(t),this.aa=!1):Ce("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ii="RemoteStore";class WC{constructor(e,t,a,o,l){this.localStore=e,this.datastore=t,this.asyncQueue=a,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=l,this.Aa.Oo((d=>{a.enqueueAndForget((async()=>{Pi(this)&&(Ce(Ii,"Restarting streams for network reachability change."),await(async function(p){const y=Ze(p);y.Ea.add(4),await Hc(y),y.Ra.set("Unknown"),y.Ea.delete(4),await fh(y)})(this))}))})),this.Ra=new ZC(a,o)}}async function fh(s){if(Pi(s))for(const e of s.da)await e(!0)}async function Hc(s){for(const e of s.da)await e(!1)}function GT(s,e){const t=Ze(s);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),Wg(t)?Zg(t):nl(t).O_()&&Xg(t,e))}function Qg(s,e){const t=Ze(s),a=nl(t);t.Ia.delete(e),a.O_()&&HT(t,e),t.Ia.size===0&&(a.O_()?a.L_():Pi(t)&&t.Ra.set("Unknown"))}function Xg(s,e){if(s.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ye.min())>0){const t=s.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}nl(s).Y_(e)}function HT(s,e){s.Va.Ue(e),nl(s).Z_(e)}function Zg(s){s.Va=new KR({getRemoteKeysForTarget:e=>s.remoteSyncer.getRemoteKeysForTarget(e),At:e=>s.Ia.get(e)||null,ht:()=>s.datastore.serializer.databaseId}),nl(s).start(),s.Ra.ua()}function Wg(s){return Pi(s)&&!nl(s).x_()&&s.Ia.size>0}function Pi(s){return Ze(s).Ea.size===0}function FT(s){s.Va=void 0}async function JC(s){s.Ra.set("Online")}async function eI(s){s.Ia.forEach(((e,t)=>{Xg(s,e)}))}async function tI(s,e){FT(s),Wg(s)?(s.Ra.ha(e),Zg(s)):s.Ra.set("Unknown")}async function nI(s,e,t){if(s.Ra.set("Online"),e instanceof AT&&e.state===2&&e.cause)try{await(async function(o,l){const d=l.cause;for(const m of l.targetIds)o.Ia.has(m)&&(await o.remoteSyncer.rejectListen(m,d),o.Ia.delete(m),o.Va.removeTarget(m))})(s,e)}catch(a){Ce(Ii,"Failed to remove targets %s: %s ",e.targetIds.join(","),a),await qd(s,a)}else if(e instanceof Rd?s.Va.Ze(e):e instanceof wT?s.Va.st(e):s.Va.tt(e),!t.isEqual(Ye.min()))try{const a=await LT(s.localStore);t.compareTo(a)>=0&&await(function(l,d){const m=l.Va.Tt(d);return m.targetChanges.forEach(((p,y)=>{if(p.resumeToken.approximateByteSize()>0){const x=l.Ia.get(y);x&&l.Ia.set(y,x.withResumeToken(p.resumeToken,d))}})),m.targetMismatches.forEach(((p,y)=>{const x=l.Ia.get(p);if(!x)return;l.Ia.set(p,x.withResumeToken($n.EMPTY_BYTE_STRING,x.snapshotVersion)),HT(l,p);const _=new Ds(x.target,p,y,x.sequenceNumber);Xg(l,_)})),l.remoteSyncer.applyRemoteEvent(m)})(s,t)}catch(a){Ce(Ii,"Failed to raise snapshot:",a),await qd(s,a)}}async function qd(s,e,t){if(!el(e))throw e;s.Ea.add(1),await Hc(s),s.Ra.set("Offline"),t||(t=()=>LT(s.localStore)),s.asyncQueue.enqueueRetryable((async()=>{Ce(Ii,"Retrying IndexedDB access"),await t(),s.Ea.delete(1),await fh(s)}))}function qT(s,e){return e().catch((t=>qd(s,t,e)))}async function mh(s){const e=Ze(s),t=Hs(e);let a=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Og;for(;rI(e);)try{const o=await zC(e.localStore,a);if(o===null){e.Ta.length===0&&t.L_();break}a=o.batchId,aI(e,o)}catch(o){await qd(e,o)}$T(e)&&KT(e)}function rI(s){return Pi(s)&&s.Ta.length<10}function aI(s,e){s.Ta.push(e);const t=Hs(s);t.O_()&&t.X_&&t.ea(e.mutations)}function $T(s){return Pi(s)&&!Hs(s).x_()&&s.Ta.length>0}function KT(s){Hs(s).start()}async function sI(s){Hs(s).ra()}async function iI(s){const e=Hs(s);for(const t of s.Ta)e.ea(t.mutations)}async function oI(s,e,t){const a=s.Ta.shift(),o=Gg.from(a,e,t);await qT(s,(()=>s.remoteSyncer.applySuccessfulWrite(o))),await mh(s)}async function lI(s,e){e&&Hs(s).X_&&await(async function(a,o){if((function(d){return FR(d)&&d!==ie.ABORTED})(o.code)){const l=a.Ta.shift();Hs(a).B_(),await qT(a,(()=>a.remoteSyncer.rejectFailedWrite(l.batchId,o))),await mh(a)}})(s,e),$T(s)&&KT(s)}async function ob(s,e){const t=Ze(s);t.asyncQueue.verifyOperationInProgress(),Ce(Ii,"RemoteStore received new credentials");const a=Pi(t);t.Ea.add(3),await Hc(t),a&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await fh(t)}async function cI(s,e){const t=Ze(s);e?(t.Ea.delete(2),await fh(t)):e||(t.Ea.add(2),await Hc(t),t.Ra.set("Unknown"))}function nl(s){return s.ma||(s.ma=(function(t,a,o){const l=Ze(t);return l.sa(),new KC(a,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,o)})(s.datastore,s.asyncQueue,{Xo:JC.bind(null,s),t_:eI.bind(null,s),r_:tI.bind(null,s),H_:nI.bind(null,s)}),s.da.push((async e=>{e?(s.ma.B_(),Wg(s)?Zg(s):s.Ra.set("Unknown")):(await s.ma.stop(),FT(s))}))),s.ma}function Hs(s){return s.fa||(s.fa=(function(t,a,o){const l=Ze(t);return l.sa(),new YC(a,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,o)})(s.datastore,s.asyncQueue,{Xo:()=>Promise.resolve(),t_:sI.bind(null,s),r_:lI.bind(null,s),ta:iI.bind(null,s),na:oI.bind(null,s)}),s.da.push((async e=>{e?(s.fa.B_(),await mh(s)):(await s.fa.stop(),s.Ta.length>0&&(Ce(Ii,`Stopping write stream with ${s.Ta.length} pending writes`),s.Ta=[]))}))),s.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jg{constructor(e,t,a,o,l){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=a,this.op=o,this.removalCallback=l,this.deferred=new Qa,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((d=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,a,o,l){const d=Date.now()+a,m=new Jg(e,t,d,o,l);return m.start(a),m}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Se(ie.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function ep(s,e){if(Ja("AsyncQueue",`${e}: ${s}`),el(s))return new Se(ie.UNAVAILABLE,`${e}: ${s}`);throw s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Po{static emptySet(e){return new Po(e.comparator)}constructor(e){this.comparator=e?(t,a)=>e(t,a)||Ve.comparator(t.key,a.key):(t,a)=>Ve.comparator(t.key,a.key),this.keyedMap=oc(),this.sortedSet=new tn(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,a)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Po)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),a=e.sortedSet.getIterator();for(;t.hasNext();){const o=t.getNext().key,l=a.getNext().key;if(!o.isEqual(l))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const a=new Po;return a.comparator=this.comparator,a.keyedMap=e,a.sortedSet=t,a}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lb{constructor(){this.ga=new tn(Ve.comparator)}track(e){const t=e.doc.key,a=this.ga.get(t);a?e.type!==0&&a.type===3?this.ga=this.ga.insert(t,e):e.type===3&&a.type!==1?this.ga=this.ga.insert(t,{type:a.type,doc:e.doc}):e.type===2&&a.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&a.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&a.type===0?this.ga=this.ga.remove(t):e.type===1&&a.type===2?this.ga=this.ga.insert(t,{type:1,doc:a.doc}):e.type===0&&a.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):He(63341,{Rt:e,pa:a}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,a)=>{e.push(a)})),e}}class Ho{constructor(e,t,a,o,l,d,m,p,y){this.query=e,this.docs=t,this.oldDocs=a,this.docChanges=o,this.mutatedKeys=l,this.fromCache=d,this.syncStateChanged=m,this.excludesMetadataChanges=p,this.hasCachedResults=y}static fromInitialDocuments(e,t,a,o,l){const d=[];return t.forEach((m=>{d.push({type:0,doc:m})})),new Ho(e,t,Po.emptySet(t),d,a,o,!0,!1,l)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&oh(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,a=e.docChanges;if(t.length!==a.length)return!1;for(let o=0;o<t.length;o++)if(t[o].type!==a[o].type||!t[o].doc.isEqual(a[o].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uI{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class dI{constructor(){this.queries=cb(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,a){const o=Ze(t),l=o.queries;o.queries=cb(),l.forEach(((d,m)=>{for(const p of m.Sa)p.onError(a)}))})(this,new Se(ie.ABORTED,"Firestore shutting down"))}}function cb(){return new Mi((s=>hT(s)),oh)}async function YT(s,e){const t=Ze(s);let a=3;const o=e.query;let l=t.queries.get(o);l?!l.ba()&&e.Da()&&(a=2):(l=new uI,a=e.Da()?0:1);try{switch(a){case 0:l.wa=await t.onListen(o,!0);break;case 1:l.wa=await t.onListen(o,!1);break;case 2:await t.onFirstRemoteStoreListen(o)}}catch(d){const m=ep(d,`Initialization of query '${Ro(e.query)}' failed`);return void e.onError(m)}t.queries.set(o,l),l.Sa.push(e),e.va(t.onlineState),l.wa&&e.Fa(l.wa)&&tp(t)}async function QT(s,e){const t=Ze(s),a=e.query;let o=3;const l=t.queries.get(a);if(l){const d=l.Sa.indexOf(e);d>=0&&(l.Sa.splice(d,1),l.Sa.length===0?o=e.Da()?0:1:!l.ba()&&e.Da()&&(o=2))}switch(o){case 0:return t.queries.delete(a),t.onUnlisten(a,!0);case 1:return t.queries.delete(a),t.onUnlisten(a,!1);case 2:return t.onLastRemoteStoreUnlisten(a);default:return}}function hI(s,e){const t=Ze(s);let a=!1;for(const o of e){const l=o.query,d=t.queries.get(l);if(d){for(const m of d.Sa)m.Fa(o)&&(a=!0);d.wa=o}}a&&tp(t)}function fI(s,e,t){const a=Ze(s),o=a.queries.get(e);if(o)for(const l of o.Sa)l.onError(t);a.queries.delete(e)}function tp(s){s.Ca.forEach((e=>{e.next()}))}var ug,ub;(ub=ug||(ug={})).Ma="default",ub.Cache="cache";class XT{constructor(e,t,a){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=a||{}}Fa(e){if(!this.options.includeMetadataChanges){const a=[];for(const o of e.docChanges)o.type!==3&&a.push(o);e=new Ho(e.query,e.docs,e.oldDocs,a,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const a=t!=="Offline";return(!this.options.qa||!a)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Ho.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==ug.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZT{constructor(e){this.key=e}}class WT{constructor(e){this.key=e}}class mI{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=pt(),this.mutatedKeys=pt(),this.eu=fT(e),this.tu=new Po(this.eu)}get nu(){return this.Ya}ru(e,t){const a=t?t.iu:new lb,o=t?t.tu:this.tu;let l=t?t.mutatedKeys:this.mutatedKeys,d=o,m=!1;const p=this.query.limitType==="F"&&o.size===this.query.limit?o.last():null,y=this.query.limitType==="L"&&o.size===this.query.limit?o.first():null;if(e.inorderTraversal(((x,_)=>{const w=o.get(x),j=lh(this.query,_)?_:null,B=!!w&&this.mutatedKeys.has(w.key),L=!!j&&(j.hasLocalMutations||this.mutatedKeys.has(j.key)&&j.hasCommittedMutations);let D=!1;w&&j?w.data.isEqual(j.data)?B!==L&&(a.track({type:3,doc:j}),D=!0):this.su(w,j)||(a.track({type:2,doc:j}),D=!0,(p&&this.eu(j,p)>0||y&&this.eu(j,y)<0)&&(m=!0)):!w&&j?(a.track({type:0,doc:j}),D=!0):w&&!j&&(a.track({type:1,doc:w}),D=!0,(p||y)&&(m=!0)),D&&(j?(d=d.add(j),l=L?l.add(x):l.delete(x)):(d=d.delete(x),l=l.delete(x)))})),this.query.limit!==null)for(;d.size>this.query.limit;){const x=this.query.limitType==="F"?d.last():d.first();d=d.delete(x.key),l=l.delete(x.key),a.track({type:1,doc:x})}return{tu:d,iu:a,Cs:m,mutatedKeys:l}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,a,o){const l=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const d=e.iu.ya();d.sort(((x,_)=>(function(j,B){const L=D=>{switch(D){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return He(20277,{Rt:D})}};return L(j)-L(B)})(x.type,_.type)||this.eu(x.doc,_.doc))),this.ou(a),o=o??!1;const m=t&&!o?this._u():[],p=this.Xa.size===0&&this.current&&!o?1:0,y=p!==this.Za;return this.Za=p,d.length!==0||y?{snapshot:new Ho(this.query,e.tu,l,d,e.mutatedKeys,p===0,y,!1,!!a&&a.resumeToken.approximateByteSize()>0),au:m}:{au:m}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new lb,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=pt(),this.tu.forEach((a=>{this.uu(a.key)&&(this.Xa=this.Xa.add(a.key))}));const t=[];return e.forEach((a=>{this.Xa.has(a)||t.push(new WT(a))})),this.Xa.forEach((a=>{e.has(a)||t.push(new ZT(a))})),t}cu(e){this.Ya=e.Qs,this.Xa=pt();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Ho.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const np="SyncEngine";class gI{constructor(e,t,a){this.query=e,this.targetId=t,this.view=a}}class pI{constructor(e){this.key=e,this.hu=!1}}class yI{constructor(e,t,a,o,l,d){this.localStore=e,this.remoteStore=t,this.eventManager=a,this.sharedClientState=o,this.currentUser=l,this.maxConcurrentLimboResolutions=d,this.Pu={},this.Tu=new Mi((m=>hT(m)),oh),this.Iu=new Map,this.Eu=new Set,this.du=new tn(Ve.comparator),this.Au=new Map,this.Ru=new qg,this.Vu={},this.mu=new Map,this.fu=Go.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function vI(s,e,t=!0){const a=a1(s);let o;const l=a.Tu.get(e);return l?(a.sharedClientState.addLocalQueryTarget(l.targetId),o=l.view.lu()):o=await JT(a,e,t,!0),o}async function xI(s,e){const t=a1(s);await JT(t,e,!0,!1)}async function JT(s,e,t,a){const o=await LC(s.localStore,fa(e)),l=o.targetId,d=s.sharedClientState.addLocalQueryTarget(l,t);let m;return a&&(m=await bI(s,e,l,d==="current",o.resumeToken)),s.isPrimaryClient&&t&&GT(s.remoteStore,o),m}async function bI(s,e,t,a,o){s.pu=(_,w,j)=>(async function(L,D,$,X){let ne=D.view.ru($);ne.Cs&&(ne=await nb(L.localStore,D.query,!1).then((({documents:O})=>D.view.ru(O,ne))));const ce=X&&X.targetChanges.get(D.targetId),de=X&&X.targetMismatches.get(D.targetId)!=null,me=D.view.applyChanges(ne,L.isPrimaryClient,ce,de);return hb(L,D.targetId,me.au),me.snapshot})(s,_,w,j);const l=await nb(s.localStore,e,!0),d=new mI(e,l.Qs),m=d.ru(l.documents),p=Gc.createSynthesizedTargetChangeForCurrentChange(t,a&&s.onlineState!=="Offline",o),y=d.applyChanges(m,s.isPrimaryClient,p);hb(s,t,y.au);const x=new gI(e,t,d);return s.Tu.set(e,x),s.Iu.has(t)?s.Iu.get(t).push(e):s.Iu.set(t,[e]),y.snapshot}async function _I(s,e,t){const a=Ze(s),o=a.Tu.get(e),l=a.Iu.get(o.targetId);if(l.length>1)return a.Iu.set(o.targetId,l.filter((d=>!oh(d,e)))),void a.Tu.delete(e);a.isPrimaryClient?(a.sharedClientState.removeLocalQueryTarget(o.targetId),a.sharedClientState.isActiveQueryTarget(o.targetId)||await lg(a.localStore,o.targetId,!1).then((()=>{a.sharedClientState.clearQueryState(o.targetId),t&&Qg(a.remoteStore,o.targetId),dg(a,o.targetId)})).catch(Jo)):(dg(a,o.targetId),await lg(a.localStore,o.targetId,!0))}async function TI(s,e){const t=Ze(s),a=t.Tu.get(e),o=t.Iu.get(a.targetId);t.isPrimaryClient&&o.length===1&&(t.sharedClientState.removeLocalQueryTarget(a.targetId),Qg(t.remoteStore,a.targetId))}async function kI(s,e,t){const a=CI(s);try{const o=await(function(d,m){const p=Ze(d),y=Gt.now(),x=m.reduce(((j,B)=>j.add(B.key)),pt());let _,w;return p.persistence.runTransaction("Locally write mutations","readwrite",(j=>{let B=es(),L=pt();return p.Ns.getEntries(j,x).next((D=>{B=D,B.forEach((($,X)=>{X.isValidDocument()||(L=L.add($))}))})).next((()=>p.localDocuments.getOverlayedDocuments(j,B))).next((D=>{_=D;const $=[];for(const X of m){const ne=LR(X,_.get(X.key).overlayedDocument);ne!=null&&$.push(new Oi(X.key,ne,aT(ne.value.mapValue),ma.exists(!0)))}return p.mutationQueue.addMutationBatch(j,y,$,m)})).next((D=>{w=D;const $=D.applyToLocalDocumentSet(_,L);return p.documentOverlayCache.saveOverlays(j,D.batchId,$)}))})).then((()=>({batchId:w.batchId,changes:gT(_)})))})(a.localStore,e);a.sharedClientState.addPendingMutation(o.batchId),(function(d,m,p){let y=d.Vu[d.currentUser.toKey()];y||(y=new tn(gt)),y=y.insert(m,p),d.Vu[d.currentUser.toKey()]=y})(a,o.batchId,t),await Fc(a,o.changes),await mh(a.remoteStore)}catch(o){const l=ep(o,"Failed to persist write");t.reject(l)}}async function e1(s,e){const t=Ze(s);try{const a=await PC(t.localStore,e);e.targetChanges.forEach(((o,l)=>{const d=t.Au.get(l);d&&(Rt(o.addedDocuments.size+o.modifiedDocuments.size+o.removedDocuments.size<=1,22616),o.addedDocuments.size>0?d.hu=!0:o.modifiedDocuments.size>0?Rt(d.hu,14607):o.removedDocuments.size>0&&(Rt(d.hu,42227),d.hu=!1))})),await Fc(t,a,e)}catch(a){await Jo(a)}}function db(s,e,t){const a=Ze(s);if(a.isPrimaryClient&&t===0||!a.isPrimaryClient&&t===1){const o=[];a.Tu.forEach(((l,d)=>{const m=d.view.va(e);m.snapshot&&o.push(m.snapshot)})),(function(d,m){const p=Ze(d);p.onlineState=m;let y=!1;p.queries.forEach(((x,_)=>{for(const w of _.Sa)w.va(m)&&(y=!0)})),y&&tp(p)})(a.eventManager,e),o.length&&a.Pu.H_(o),a.onlineState=e,a.isPrimaryClient&&a.sharedClientState.setOnlineState(e)}}async function EI(s,e,t){const a=Ze(s);a.sharedClientState.updateQueryState(e,"rejected",t);const o=a.Au.get(e),l=o&&o.key;if(l){let d=new tn(Ve.comparator);d=d.insert(l,Zn.newNoDocument(l,Ye.min()));const m=pt().add(l),p=new dh(Ye.min(),new Map,new tn(gt),d,m);await e1(a,p),a.du=a.du.remove(l),a.Au.delete(e),rp(a)}else await lg(a.localStore,e,!1).then((()=>dg(a,e,t))).catch(Jo)}async function SI(s,e){const t=Ze(s),a=e.batch.batchId;try{const o=await OC(t.localStore,e);n1(t,a,null),t1(t,a),t.sharedClientState.updateMutationState(a,"acknowledged"),await Fc(t,o)}catch(o){await Jo(o)}}async function wI(s,e,t){const a=Ze(s);try{const o=await(function(d,m){const p=Ze(d);return p.persistence.runTransaction("Reject batch","readwrite-primary",(y=>{let x;return p.mutationQueue.lookupMutationBatch(y,m).next((_=>(Rt(_!==null,37113),x=_.keys(),p.mutationQueue.removeMutationBatch(y,_)))).next((()=>p.mutationQueue.performConsistencyCheck(y))).next((()=>p.documentOverlayCache.removeOverlaysForBatchId(y,x,m))).next((()=>p.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(y,x))).next((()=>p.localDocuments.getDocuments(y,x)))}))})(a.localStore,e);n1(a,e,t),t1(a,e),a.sharedClientState.updateMutationState(e,"rejected",t),await Fc(a,o)}catch(o){await Jo(o)}}function t1(s,e){(s.mu.get(e)||[]).forEach((t=>{t.resolve()})),s.mu.delete(e)}function n1(s,e,t){const a=Ze(s);let o=a.Vu[a.currentUser.toKey()];if(o){const l=o.get(e);l&&(t?l.reject(t):l.resolve(),o=o.remove(e)),a.Vu[a.currentUser.toKey()]=o}}function dg(s,e,t=null){s.sharedClientState.removeLocalQueryTarget(e);for(const a of s.Iu.get(e))s.Tu.delete(a),t&&s.Pu.yu(a,t);s.Iu.delete(e),s.isPrimaryClient&&s.Ru.jr(e).forEach((a=>{s.Ru.containsKey(a)||r1(s,a)}))}function r1(s,e){s.Eu.delete(e.path.canonicalString());const t=s.du.get(e);t!==null&&(Qg(s.remoteStore,t),s.du=s.du.remove(e),s.Au.delete(t),rp(s))}function hb(s,e,t){for(const a of t)a instanceof ZT?(s.Ru.addReference(a.key,e),AI(s,a)):a instanceof WT?(Ce(np,"Document no longer in limbo: "+a.key),s.Ru.removeReference(a.key,e),s.Ru.containsKey(a.key)||r1(s,a.key)):He(19791,{wu:a})}function AI(s,e){const t=e.key,a=t.path.canonicalString();s.du.get(t)||s.Eu.has(a)||(Ce(np,"New document in limbo: "+t),s.Eu.add(a),rp(s))}function rp(s){for(;s.Eu.size>0&&s.du.size<s.maxConcurrentLimboResolutions;){const e=s.Eu.values().next().value;s.Eu.delete(e);const t=new Ve(qt.fromString(e)),a=s.fu.next();s.Au.set(a,new pI(t)),s.du=s.du.insert(t,a),GT(s.remoteStore,new Ds(fa(Ug(t.path)),a,"TargetPurposeLimboResolution",ah.ce))}}async function Fc(s,e,t){const a=Ze(s),o=[],l=[],d=[];a.Tu.isEmpty()||(a.Tu.forEach(((m,p)=>{d.push(a.pu(p,e,t).then((y=>{if((y||t)&&a.isPrimaryClient){const x=y?!y.fromCache:t?.targetChanges.get(p.targetId)?.current;a.sharedClientState.updateQueryState(p.targetId,x?"current":"not-current")}if(y){o.push(y);const x=Kg.As(p.targetId,y);l.push(x)}})))})),await Promise.all(d),a.Pu.H_(o),await(async function(p,y){const x=Ze(p);try{await x.persistence.runTransaction("notifyLocalViewChanges","readwrite",(_=>fe.forEach(y,(w=>fe.forEach(w.Es,(j=>x.persistence.referenceDelegate.addReference(_,w.targetId,j))).next((()=>fe.forEach(w.ds,(j=>x.persistence.referenceDelegate.removeReference(_,w.targetId,j)))))))))}catch(_){if(!el(_))throw _;Ce(Yg,"Failed to update sequence numbers: "+_)}for(const _ of y){const w=_.targetId;if(!_.fromCache){const j=x.Ms.get(w),B=j.snapshotVersion,L=j.withLastLimboFreeSnapshotVersion(B);x.Ms=x.Ms.insert(w,L)}}})(a.localStore,l))}async function NI(s,e){const t=Ze(s);if(!t.currentUser.isEqual(e)){Ce(np,"User change. New user:",e.toKey());const a=await zT(t.localStore,e);t.currentUser=e,(function(l,d){l.mu.forEach((m=>{m.forEach((p=>{p.reject(new Se(ie.CANCELLED,d))}))})),l.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,a.removedBatchIds,a.addedBatchIds),await Fc(t,a.Ls)}}function RI(s,e){const t=Ze(s),a=t.Au.get(e);if(a&&a.hu)return pt().add(a.key);{let o=pt();const l=t.Iu.get(e);if(!l)return o;for(const d of l){const m=t.Tu.get(d);o=o.unionWith(m.view.nu)}return o}}function a1(s){const e=Ze(s);return e.remoteStore.remoteSyncer.applyRemoteEvent=e1.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=RI.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=EI.bind(null,e),e.Pu.H_=hI.bind(null,e.eventManager),e.Pu.yu=fI.bind(null,e.eventManager),e}function CI(s){const e=Ze(s);return e.remoteStore.remoteSyncer.applySuccessfulWrite=SI.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=wI.bind(null,e),e}class $d{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=hh(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return MC(this.persistence,new IC,e.initialUser,this.serializer)}Cu(e){return new VT($g.mi,this.serializer)}Du(e){return new BC}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}$d.provider={build:()=>new $d};class II extends $d{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Rt(this.persistence.referenceDelegate instanceof Fd,46915);const a=this.persistence.referenceDelegate.garbageCollector;return new pC(a,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?ur.withCacheSize(this.cacheSizeBytes):ur.DEFAULT;return new VT((a=>Fd.mi(a,t)),this.serializer)}}class hg{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=a=>db(this.syncEngine,a,1),this.remoteStore.remoteSyncer.handleCredentialChange=NI.bind(null,this.syncEngine),await cI(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new dI})()}createDatastore(e){const t=hh(e.databaseInfo.databaseId),a=(function(l){return new $C(l)})(e.databaseInfo);return(function(l,d,m,p){return new XC(l,d,m,p)})(e.authCredentials,e.appCheckCredentials,a,t)}createRemoteStore(e){return(function(a,o,l,d,m){return new WC(a,o,l,d,m)})(this.localStore,this.datastore,e.asyncQueue,(t=>db(this.syncEngine,t,0)),(function(){return sb.v()?new sb:new GC})())}createSyncEngine(e,t){return(function(o,l,d,m,p,y,x){const _=new yI(o,l,d,m,p,y);return x&&(_.gu=!0),_})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const a=Ze(t);Ce(Ii,"RemoteStore shutting down."),a.Ea.add(5),await Hc(a),a.Aa.shutdown(),a.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}hg.provider={build:()=>new hg};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s1{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Ja("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fs="FirestoreClient";class jI{constructor(e,t,a,o,l){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=a,this.databaseInfo=o,this.user=cr.UNAUTHENTICATED,this.clientId=Mg.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=l,this.authCredentials.start(a,(async d=>{Ce(Fs,"Received user=",d.uid),await this.authCredentialListener(d),this.user=d})),this.appCheckCredentials.start(a,(d=>(Ce(Fs,"Received new app check token=",d),this.appCheckCredentialListener(d,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Qa;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const a=ep(t,"Failed to shutdown persistence");e.reject(a)}})),e.promise}}async function Vm(s,e){s.asyncQueue.verifyOperationInProgress(),Ce(Fs,"Initializing OfflineComponentProvider");const t=s.configuration;await e.initialize(t);let a=t.initialUser;s.setCredentialChangeListener((async o=>{a.isEqual(o)||(await zT(e.localStore,o),a=o)})),e.persistence.setDatabaseDeletedListener((()=>s.terminate())),s._offlineComponents=e}async function fb(s,e){s.asyncQueue.verifyOperationInProgress();const t=await DI(s);Ce(Fs,"Initializing OnlineComponentProvider"),await e.initialize(t,s.configuration),s.setCredentialChangeListener((a=>ob(e.remoteStore,a))),s.setAppCheckTokenChangeListener(((a,o)=>ob(e.remoteStore,o))),s._onlineComponents=e}async function DI(s){if(!s._offlineComponents)if(s._uninitializedComponentsProvider){Ce(Fs,"Using user provided OfflineComponentProvider");try{await Vm(s,s._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(o){return o.name==="FirebaseError"?o.code===ie.FAILED_PRECONDITION||o.code===ie.UNIMPLEMENTED:!(typeof DOMException<"u"&&o instanceof DOMException)||o.code===22||o.code===20||o.code===11})(t))throw t;Tc("Error using user provided cache. Falling back to memory cache: "+t),await Vm(s,new $d)}}else Ce(Fs,"Using default OfflineComponentProvider"),await Vm(s,new II(void 0));return s._offlineComponents}async function i1(s){return s._onlineComponents||(s._uninitializedComponentsProvider?(Ce(Fs,"Using user provided OnlineComponentProvider"),await fb(s,s._uninitializedComponentsProvider._online)):(Ce(Fs,"Using default OnlineComponentProvider"),await fb(s,new hg))),s._onlineComponents}function MI(s){return i1(s).then((e=>e.syncEngine))}async function o1(s){const e=await i1(s),t=e.eventManager;return t.onListen=vI.bind(null,e.syncEngine),t.onUnlisten=_I.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=xI.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=TI.bind(null,e.syncEngine),t}function OI(s,e,t={}){const a=new Qa;return s.asyncQueue.enqueueAndForget((async()=>(function(l,d,m,p,y){const x=new s1({next:w=>{x.Nu(),d.enqueueAndForget((()=>QT(l,_)));const j=w.docs.has(m);!j&&w.fromCache?y.reject(new Se(ie.UNAVAILABLE,"Failed to get document because the client is offline.")):j&&w.fromCache&&p&&p.source==="server"?y.reject(new Se(ie.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):y.resolve(w)},error:w=>y.reject(w)}),_=new XT(Ug(m.path),x,{includeMetadataChanges:!0,qa:!0});return YT(l,_)})(await o1(s),s.asyncQueue,e,t,a))),a.promise}function PI(s,e,t={}){const a=new Qa;return s.asyncQueue.enqueueAndForget((async()=>(function(l,d,m,p,y){const x=new s1({next:w=>{x.Nu(),d.enqueueAndForget((()=>QT(l,_))),w.fromCache&&p.source==="server"?y.reject(new Se(ie.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):y.resolve(w)},error:w=>y.reject(w)}),_=new XT(m,x,{includeMetadataChanges:!0,qa:!0});return YT(l,_)})(await o1(s),s.asyncQueue,e,t,a))),a.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function l1(s){const e={};return s.timeoutSeconds!==void 0&&(e.timeoutSeconds=s.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mb=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VI="firestore.googleapis.com",gb=!0;class pb{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Se(ie.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=VI,this.ssl=gb}else this.host=e.host,this.ssl=e.ssl??gb;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=OT;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<PT)throw new Se(ie.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}W2("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=l1(e.experimentalLongPollingOptions??{}),(function(a){if(a.timeoutSeconds!==void 0){if(isNaN(a.timeoutSeconds))throw new Se(ie.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (must not be NaN)`);if(a.timeoutSeconds<5)throw new Se(ie.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (minimum allowed value is 5)`);if(a.timeoutSeconds>30)throw new Se(ie.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(a,o){return a.timeoutSeconds===o.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class ap{constructor(e,t,a,o){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=a,this._app=o,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new pb({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Se(ie.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Se(ie.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new pb(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(a){if(!a)return new H2;switch(a.type){case"firstParty":return new $2(a.sessionIndex||"0",a.iamToken||null,a.authTokenFactory||null);case"provider":return a.client;default:throw new Se(ie.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const a=mb.get(t);a&&(Ce("ComponentProvider","Removing Datastore"),mb.delete(t),a.terminate())})(this),Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vi{constructor(e,t,a){this.converter=t,this._query=a,this.type="query",this.firestore=e}withConverter(e){return new Vi(this.firestore,e,this._query)}}class bn{constructor(e,t,a){this.converter=t,this._key=a,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new zs(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new bn(this.firestore,e,this._key)}toJSON(){return{type:bn._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,a){if(Uc(t,bn._jsonSchema))return new bn(e,a||null,new Ve(qt.fromString(t.referencePath)))}}bn._jsonSchemaVersion="firestore/documentReference/1.0",bn._jsonSchema={type:xn("string",bn._jsonSchemaVersion),referencePath:xn("string")};class zs extends Vi{constructor(e,t,a){super(e,t,Ug(a)),this._path=a,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new bn(this.firestore,null,new Ve(e))}withConverter(e){return new zs(this.firestore,e,this._path)}}function qc(s,e,...t){if(s=rr(s),K_("collection","path",e),s instanceof ap){const a=qt.fromString(e,...t);return Rx(a),new zs(s,null,a)}{if(!(s instanceof bn||s instanceof zs))throw new Se(ie.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const a=s._path.child(qt.fromString(e,...t));return Rx(a),new zs(s.firestore,null,a)}}function sp(s,e,...t){if(s=rr(s),arguments.length===1&&(e=Mg.newId()),K_("doc","path",e),s instanceof ap){const a=qt.fromString(e,...t);return Nx(a),new bn(s,null,new Ve(a))}{if(!(s instanceof bn||s instanceof zs))throw new Se(ie.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const a=s._path.child(qt.fromString(e,...t));return Nx(a),new bn(s.firestore,s instanceof zs?s.converter:null,new Ve(a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yb="AsyncQueue";class vb{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new UT(this,"async_queue_retry"),this._c=()=>{const a=Pm();a&&Ce(yb,"Visibility state changed to "+a.visibilityState),this.M_.w_()},this.ac=e;const t=Pm();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Pm();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new Qa;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!el(e))throw e;Ce(yb,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((a=>{throw this.nc=a,this.rc=!1,Ja("INTERNAL UNHANDLED ERROR: ",xb(a)),a})).then((a=>(this.rc=!1,a))))));return this.ac=t,t}enqueueAfterDelay(e,t,a){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const o=Jg.createAndSchedule(this,e,t,a,(l=>this.hc(l)));return this.tc.push(o),o}uc(){this.nc&&He(47125,{Pc:xb(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,a)=>t.targetTimeMs-a.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function xb(s){let e=s.message||"";return s.stack&&(e=s.stack.includes(s.message)?s.stack:s.message+`
`+s.stack),e}class $c extends ap{constructor(e,t,a,o){super(e,t,a,o),this.type="firestore",this._queue=new vb,this._persistenceKey=o?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new vb(e),this._firestoreClient=void 0,await e}}}function zI(s,e,t){t||(t=Ld);const a=Eg(s,"firestore");if(a.isInitialized(t)){const o=a.getImmediate({identifier:t}),l=a.getOptions(t);if(Si(l,e))return o;throw new Se(ie.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new Se(ie.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<PT)throw new Se(ie.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return e.host&&Qo(e.host)&&Jb(e.host),a.initialize({options:e,instanceIdentifier:t})}function ip(s){if(s._terminated)throw new Se(ie.FAILED_PRECONDITION,"The client has already been terminated.");return s._firestoreClient||LI(s),s._firestoreClient}function LI(s){const e=s._freezeSettings(),t=(function(o,l,d,m){return new cR(o,l,d,m.host,m.ssl,m.experimentalForceLongPolling,m.experimentalAutoDetectLongPolling,l1(m.experimentalLongPollingOptions),m.useFetchStreams,m.isUsingEmulator)})(s._databaseId,s._app?.options.appId||"",s._persistenceKey,e);s._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(s._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),s._firestoreClient=new jI(s._authCredentials,s._appCheckCredentials,s._queue,t,s._componentsProvider&&(function(o){const l=o?._online.build();return{_offline:o?._offline.build(l),_online:l}})(s._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Or{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Or($n.fromBase64String(e))}catch(t){throw new Se(ie.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Or($n.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Or._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Uc(e,Or._jsonSchema))return Or.fromBase64String(e.bytes)}}Or._jsonSchemaVersion="firestore/bytes/1.0",Or._jsonSchema={type:xn("string",Or._jsonSchemaVersion),bytes:xn("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class op{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Se(ie.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new qn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lp{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pa{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Se(ie.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Se(ie.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return gt(this._lat,e._lat)||gt(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:pa._jsonSchemaVersion}}static fromJSON(e){if(Uc(e,pa._jsonSchema))return new pa(e.latitude,e.longitude)}}pa._jsonSchemaVersion="firestore/geoPoint/1.0",pa._jsonSchema={type:xn("string",pa._jsonSchemaVersion),latitude:xn("number"),longitude:xn("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ya{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(a,o){if(a.length!==o.length)return!1;for(let l=0;l<a.length;++l)if(a[l]!==o[l])return!1;return!0})(this._values,e._values)}toJSON(){return{type:ya._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Uc(e,ya._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new ya(e.vectorValues);throw new Se(ie.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}ya._jsonSchemaVersion="firestore/vectorValue/1.0",ya._jsonSchema={type:xn("string",ya._jsonSchemaVersion),vectorValues:xn("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UI=/^__.*__$/;class BI{constructor(e,t,a){this.data=e,this.fieldMask=t,this.fieldTransforms=a}toMutation(e,t){return this.fieldMask!==null?new Oi(e,this.data,this.fieldMask,t,this.fieldTransforms):new Bc(e,this.data,t,this.fieldTransforms)}}function c1(s){switch(s){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw He(40011,{Ac:s})}}class cp{constructor(e,t,a,o,l,d){this.settings=e,this.databaseId=t,this.serializer=a,this.ignoreUndefinedProperties=o,l===void 0&&this.Rc(),this.fieldTransforms=l||[],this.fieldMask=d||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new cp({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const t=this.path?.child(e),a=this.Vc({path:t,fc:!1});return a.gc(e),a}yc(e){const t=this.path?.child(e),a=this.Vc({path:t,fc:!1});return a.Rc(),a}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Kd(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(c1(this.Ac)&&UI.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class GI{constructor(e,t,a){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=a||hh(e)}Cc(e,t,a,o=!1){return new cp({Ac:e,methodName:t,Dc:a,path:qn.emptyPath(),fc:!1,bc:o},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function up(s){const e=s._freezeSettings(),t=hh(s._databaseId);return new GI(s._databaseId,!!e.ignoreUndefinedProperties,t)}function u1(s,e,t,a,o,l={}){const d=s.Cc(l.merge||l.mergeFields?2:0,e,t,o);f1("Data must be an object, but it was:",d,a);const m=d1(a,d);let p,y;if(l.merge)p=new Br(d.fieldMask),y=d.fieldTransforms;else if(l.mergeFields){const x=[];for(const _ of l.mergeFields){const w=FI(e,_,t);if(!d.contains(w))throw new Se(ie.INVALID_ARGUMENT,`Field '${w}' is specified in your field mask but missing from your input data.`);$I(x,w)||x.push(w)}p=new Br(x),y=d.fieldTransforms.filter((_=>p.covers(_.field)))}else p=null,y=d.fieldTransforms;return new BI(new Mr(m),p,y)}class dp extends lp{_toFieldTransform(e){return new OR(e.path,new Nc)}isEqual(e){return e instanceof dp}}function HI(s,e,t,a=!1){return hp(t,s.Cc(a?4:3,e))}function hp(s,e){if(h1(s=rr(s)))return f1("Unsupported field value:",e,s),d1(s,e);if(s instanceof lp)return(function(a,o){if(!c1(o.Ac))throw o.Sc(`${a._methodName}() can only be used with update() and set()`);if(!o.path)throw o.Sc(`${a._methodName}() is not currently supported inside arrays`);const l=a._toFieldTransform(o);l&&o.fieldTransforms.push(l)})(s,e),null;if(s===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),s instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(a,o){const l=[];let d=0;for(const m of a){let p=hp(m,o.wc(d));p==null&&(p={nullValue:"NULL_VALUE"}),l.push(p),d++}return{arrayValue:{values:l}}})(s,e)}return(function(a,o){if((a=rr(a))===null)return{nullValue:"NULL_VALUE"};if(typeof a=="number")return jR(o.serializer,a);if(typeof a=="boolean")return{booleanValue:a};if(typeof a=="string")return{stringValue:a};if(a instanceof Date){const l=Gt.fromDate(a);return{timestampValue:Hd(o.serializer,l)}}if(a instanceof Gt){const l=new Gt(a.seconds,1e3*Math.floor(a.nanoseconds/1e3));return{timestampValue:Hd(o.serializer,l)}}if(a instanceof pa)return{geoPointValue:{latitude:a.latitude,longitude:a.longitude}};if(a instanceof Or)return{bytesValue:NT(o.serializer,a._byteString)};if(a instanceof bn){const l=o.databaseId,d=a.firestore._databaseId;if(!d.isEqual(l))throw o.Sc(`Document reference is for database ${d.projectId}/${d.database} but should be for database ${l.projectId}/${l.database}`);return{referenceValue:Fg(a.firestore._databaseId||o.databaseId,a._key.path)}}if(a instanceof ya)return(function(d,m){return{mapValue:{fields:{[nT]:{stringValue:rT},[Ud]:{arrayValue:{values:d.toArray().map((y=>{if(typeof y!="number")throw m.Sc("VectorValues must only contain numeric values.");return Bg(m.serializer,y)}))}}}}}})(a,o);throw o.Sc(`Unsupported field value: ${rh(a)}`)})(s,e)}function d1(s,e){const t={};return X_(s)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Di(s,((a,o)=>{const l=hp(o,e.mc(a));l!=null&&(t[a]=l)})),{mapValue:{fields:t}}}function h1(s){return!(typeof s!="object"||s===null||s instanceof Array||s instanceof Date||s instanceof Gt||s instanceof pa||s instanceof Or||s instanceof bn||s instanceof lp||s instanceof ya)}function f1(s,e,t){if(!h1(t)||!Y_(t)){const a=rh(t);throw a==="an object"?e.Sc(s+" a custom object"):e.Sc(s+" "+a)}}function FI(s,e,t){if((e=rr(e))instanceof op)return e._internalPath;if(typeof e=="string")return m1(s,e);throw Kd("Field path arguments must be of type string or ",s,!1,void 0,t)}const qI=new RegExp("[~\\*/\\[\\]]");function m1(s,e,t){if(e.search(qI)>=0)throw Kd(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,s,!1,void 0,t);try{return new op(...e.split("."))._internalPath}catch{throw Kd(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,s,!1,void 0,t)}}function Kd(s,e,t,a,o){const l=a&&!a.isEmpty(),d=o!==void 0;let m=`Function ${e}() called with invalid data`;t&&(m+=" (via `toFirestore()`)"),m+=". ";let p="";return(l||d)&&(p+=" (found",l&&(p+=` in field ${a}`),d&&(p+=` in document ${o}`),p+=")"),new Se(ie.INVALID_ARGUMENT,m+s+p)}function $I(s,e){return s.some((t=>t.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g1{constructor(e,t,a,o,l){this._firestore=e,this._userDataWriter=t,this._key=a,this._document=o,this._converter=l}get id(){return this._key.path.lastSegment()}get ref(){return new bn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new KI(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(gh("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class KI extends g1{data(){return super.data()}}function gh(s,e){return typeof e=="string"?m1(s,e):e instanceof op?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YI(s){if(s.limitType==="L"&&s.explicitOrderBy.length===0)throw new Se(ie.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class fp{}class p1 extends fp{}function mp(s,e,...t){let a=[];e instanceof fp&&a.push(e),a=a.concat(t),(function(l){const d=l.filter((p=>p instanceof pp)).length,m=l.filter((p=>p instanceof ph)).length;if(d>1||d>0&&m>0)throw new Se(ie.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(a);for(const o of a)s=o._apply(s);return s}class ph extends p1{constructor(e,t,a){super(),this._field=e,this._op=t,this._value=a,this.type="where"}static _create(e,t,a){return new ph(e,t,a)}_apply(e){const t=this._parse(e);return v1(e._query,t),new Vi(e.firestore,e.converter,ng(e._query,t))}_parse(e){const t=up(e.firestore);return(function(l,d,m,p,y,x,_){let w;if(y.isKeyField()){if(x==="array-contains"||x==="array-contains-any")throw new Se(ie.INVALID_ARGUMENT,`Invalid Query. You can't perform '${x}' queries on documentId().`);if(x==="in"||x==="not-in"){_b(_,x);const B=[];for(const L of _)B.push(bb(p,l,L));w={arrayValue:{values:B}}}else w=bb(p,l,_)}else x!=="in"&&x!=="not-in"&&x!=="array-contains-any"||_b(_,x),w=HI(m,d,_,x==="in"||x==="not-in");return vn.create(y,x,w)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function gp(s,e,t){const a=e,o=gh("where",s);return ph._create(o,a,t)}class pp extends fp{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new pp(e,t)}_parse(e){const t=this._queryConstraints.map((a=>a._parse(e))).filter((a=>a.getFilters().length>0));return t.length===1?t[0]:qr.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(o,l){let d=o;const m=l.getFlattenedFilters();for(const p of m)v1(d,p),d=ng(d,p)})(e._query,t),new Vi(e.firestore,e.converter,ng(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class yp extends p1{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new yp(e,t)}_apply(e){const t=(function(o,l,d){if(o.startAt!==null)throw new Se(ie.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(o.endAt!==null)throw new Se(ie.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Ac(l,d)})(e._query,this._field,this._direction);return new Vi(e.firestore,e.converter,(function(o,l){const d=o.explicitOrderBy.concat([l]);return new tl(o.path,o.collectionGroup,d,o.filters.slice(),o.limit,o.limitType,o.startAt,o.endAt)})(e._query,t))}}function y1(s,e="asc"){const t=e,a=gh("orderBy",s);return yp._create(a,t)}function bb(s,e,t){if(typeof(t=rr(t))=="string"){if(t==="")throw new Se(ie.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!dT(e)&&t.indexOf("/")!==-1)throw new Se(ie.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const a=e.path.child(qt.fromString(t));if(!Ve.isDocumentKey(a))throw new Se(ie.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${a}' is not because it has an odd number of segments (${a.length}).`);return Vx(s,new Ve(a))}if(t instanceof bn)return Vx(s,t._key);throw new Se(ie.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${rh(t)}.`)}function _b(s,e){if(!Array.isArray(s)||s.length===0)throw new Se(ie.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function v1(s,e){const t=(function(o,l){for(const d of o)for(const m of d.getFlattenedFilters())if(l.indexOf(m.op)>=0)return m.op;return null})(s.filters,(function(o){switch(o){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new Se(ie.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Se(ie.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class QI{convertValue(e,t="none"){switch(Gs(e)){case 0:return null;case 1:return e.booleanValue;case 2:return hn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Bs(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw He(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const a={};return Di(e,((o,l)=>{a[o]=this.convertValue(l,t)})),a}convertVectorValue(e){const t=e.fields?.[Ud].arrayValue?.values?.map((a=>hn(a.doubleValue)));return new ya(t)}convertGeoPoint(e){return new pa(hn(e.latitude),hn(e.longitude))}convertArray(e,t){return(e.values||[]).map((a=>this.convertValue(a,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const a=ih(e);return a==null?null:this.convertValue(a,t);case"estimate":return this.convertTimestamp(Ec(e));default:return null}}convertTimestamp(e){const t=Us(e);return new Gt(t.seconds,t.nanos)}convertDocumentKey(e,t){const a=qt.fromString(e);Rt(MT(a),9688,{name:e});const o=new Sc(a.get(1),a.get(3)),l=new Ve(a.popFirst(5));return o.isEqual(t)||Ja(`Document ${l} contains a document reference within a different database (${o.projectId}/${o.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x1(s,e,t){let a;return a=s?t&&(t.merge||t.mergeFields)?s.toFirestore(e,t):s.toFirestore(e):e,a}class cc{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Ei extends g1{constructor(e,t,a,o,l,d){super(e,t,a,o,d),this._firestore=e,this._firestoreImpl=e,this.metadata=l}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Cd(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const a=this._document.data.field(gh("DocumentSnapshot.get",e));if(a!==null)return this._userDataWriter.convertValue(a,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Se(ie.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Ei._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Ei._jsonSchemaVersion="firestore/documentSnapshot/1.0",Ei._jsonSchema={type:xn("string",Ei._jsonSchemaVersion),bundleSource:xn("string","DocumentSnapshot"),bundleName:xn("string"),bundle:xn("string")};class Cd extends Ei{data(e={}){return super.data(e)}}class Vo{constructor(e,t,a,o){this._firestore=e,this._userDataWriter=t,this._snapshot=o,this.metadata=new cc(o.hasPendingWrites,o.fromCache),this.query=a}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((a=>{e.call(t,new Cd(this._firestore,this._userDataWriter,a.key,a,new cc(this._snapshot.mutatedKeys.has(a.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Se(ie.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(o,l){if(o._snapshot.oldDocs.isEmpty()){let d=0;return o._snapshot.docChanges.map((m=>{const p=new Cd(o._firestore,o._userDataWriter,m.doc.key,m.doc,new cc(o._snapshot.mutatedKeys.has(m.doc.key),o._snapshot.fromCache),o.query.converter);return m.doc,{type:"added",doc:p,oldIndex:-1,newIndex:d++}}))}{let d=o._snapshot.oldDocs;return o._snapshot.docChanges.filter((m=>l||m.type!==3)).map((m=>{const p=new Cd(o._firestore,o._userDataWriter,m.doc.key,m.doc,new cc(o._snapshot.mutatedKeys.has(m.doc.key),o._snapshot.fromCache),o.query.converter);let y=-1,x=-1;return m.type!==0&&(y=d.indexOf(m.doc.key),d=d.delete(m.doc.key)),m.type!==1&&(d=d.add(m.doc),x=d.indexOf(m.doc.key)),{type:XI(m.type),doc:p,oldIndex:y,newIndex:x}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Se(ie.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Vo._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Mg.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],a=[],o=[];return this.docs.forEach((l=>{l._document!==null&&(t.push(l._document),a.push(this._userDataWriter.convertObjectMap(l._document.data.value.mapValue.fields,"previous")),o.push(l.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function XI(s){switch(s){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return He(61501,{type:s})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function b1(s){s=Ci(s,bn);const e=Ci(s.firestore,$c);return OI(ip(e),s._key).then((t=>WI(e,s,t)))}Vo._jsonSchemaVersion="firestore/querySnapshot/1.0",Vo._jsonSchema={type:xn("string",Vo._jsonSchemaVersion),bundleSource:xn("string","QuerySnapshot"),bundleName:xn("string"),bundle:xn("string")};class _1 extends QI{constructor(e){super(),this.firestore=e}convertBytes(e){return new Or(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new bn(this.firestore,null,t)}}function vp(s){s=Ci(s,Vi);const e=Ci(s.firestore,$c),t=ip(e),a=new _1(e);return YI(s._query),PI(t,s._query).then((o=>new Vo(e,a,s,o)))}function ZI(s,e,t){s=Ci(s,bn);const a=Ci(s.firestore,$c),o=x1(s.converter,e,t);return k1(a,[u1(up(a),"setDoc",s._key,o,s.converter!==null,t).toMutation(s._key,ma.none())])}function T1(s,e){const t=Ci(s.firestore,$c),a=sp(s),o=x1(s.converter,e);return k1(t,[u1(up(s.firestore),"addDoc",a._key,o,s.converter!==null,{}).toMutation(a._key,ma.exists(!1))]).then((()=>a))}function k1(s,e){return(function(a,o){const l=new Qa;return a.asyncQueue.enqueueAndForget((async()=>kI(await MI(a),o,l))),l.promise})(ip(s),e)}function WI(s,e,t){const a=t.docs.get(e._key),o=new _1(s);return new Ei(s,o,e._key,a,new cc(t.hasPendingWrites,t.fromCache),e.converter)}function JI(){return new dp("serverTimestamp")}(function(e,t=!0){(function(o){Wo=o})(Xo),zo(new wi("firestore",((a,{instanceIdentifier:o,options:l})=>{const d=a.getProvider("app").getImmediate(),m=new $c(new F2(a.getProvider("auth-internal")),new K2(d,a.getProvider("app-check-internal")),(function(y,x){if(!Object.prototype.hasOwnProperty.apply(y.options,["projectId"]))throw new Se(ie.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Sc(y.options.projectId,x)})(d,o),d);return l={useFetchStreams:t,...l},m._setSettings(l),m}),"PUBLIC").setMultipleInstances(!0)),Ps(Ex,Sx,e),Ps(Ex,Sx,"esm2020")})();const ej={apiKey:"AIzaSyBj5D2l-lSzekgRUF6w164G5xawAbqKV58",authDomain:"neurolearn-c8df8.firebaseapp.com",projectId:"neurolearn-c8df8",storageBucket:"neurolearn-c8df8.firebasestorage.app",messagingSenderId:"1060414258301",appId:"1:1060414258301:web:86a11e8b84e7d05de10514",measurementId:"G-ZBX8RCHB1X"},E1=mA().length?r_():n_(ej),vd=z2(E1),tj={experimentalForceLongPolling:!0,experimentalLongPollingOptions:{timeoutSeconds:10}},zi=globalThis.__FIREBASE_DB__??(globalThis.__FIREBASE_DB__=zI(E1,tj)),nj=async(s,e)=>{if(!s)throw new Error("UID boş geldi");const t=sp(zi,"users",s);return await ZI(t,{uid:s,...e,createdAt:JI()},{merge:!0}),(await b1(t)).data()},rj=async s=>{const e=sp(zi,"users",s),t=await b1(e);return t.exists()?{id:t.id,...t.data(),createdAt:t.data().createdAt.toDate()}:null},aj=async s=>{const e=mp(qc(zi,"students"),gp("teacherId","==",s),y1("createdAt","desc"));return(await vp(e)).docs.map(a=>({id:a.id,...a.data(),createdAt:a.data().createdAt.toDate()}))},sj=async s=>(await T1(qc(zi,"activities"),{...s,createdAt:Gt.now()})).id,ij=async s=>{const e=mp(qc(zi,"ai_insights"),gp("studentId","==",s),y1("createdAt","desc"));return(await vp(e)).docs.map(a=>({id:a.id,...a.data(),createdAt:a.data().createdAt.toDate()}))},oj=async s=>{try{const e=await T1(qc(zi,"story_attention_games"),{...s,createdAt:Gt.now()});return await sj({studentId:s.studentId,type:"story-attention",score:s.score,duration:s.duration,metadata:{theme:s.storyTheme,attentionScores:{selective:s.attentionData.selectiveAttention,sustained:s.attentionData.sustainedAttention,divided:s.attentionData.dividedAttention,impulseControl:s.attentionData.impulseControl},performance:{accuracy:s.attentionData.accuracy,avgReactionTime:s.attentionData.avgReactionTime,distractorClicks:s.attentionData.distractorClicks}}}),console.log("Story attention game data saved successfully:",e.id),e.id}catch(e){throw console.error("Error saving story attention game data:",e),e}},S1=k.createContext(void 0),_a=()=>{const s=k.useContext(S1);if(s===void 0)throw new Error("useAuth must be used within an AuthProvider");return s},lj=({children:s})=>{const[e,t]=k.useState(null),[a,o]=k.useState(!0);k.useEffect(()=>wN(vd,async x=>{if(x){const _=await rj(x.uid);t(_||{id:x.uid,name:x.displayName||"",email:x.email||"",role:"teacher",createdAt:new Date})}else t(null);o(!1)}),[]);const p={currentUser:e,loading:a,login:async(y,x)=>{await kN(vd,y,x)},register:async(y,x,_,w="teacher",j,B)=>{const L=await TN(vd,y,x),D=L.user?.uid;if(!D)throw new Error("Kullanıcı UID alınamadı");const $={email:L.user.email??y,name:_,role:w,...j&&{age:j},...B&&{teacherId:B}};await nj(D,$),t({id:D,name:_,email:y,role:w,...j&&{age:j},...B&&{teacherId:B},createdAt:new Date})},logout:async()=>{await AN(vd),t(null)}};return u.jsx(S1.Provider,{value:p,children:s})};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cj=s=>s.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),uj=s=>s.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,a)=>a?a.toUpperCase():t.toLowerCase()),Tb=s=>{const e=uj(s);return e.charAt(0).toUpperCase()+e.slice(1)},w1=(...s)=>s.filter((e,t,a)=>!!e&&e.trim()!==""&&a.indexOf(e)===t).join(" ").trim(),dj=s=>{for(const e in s)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var hj={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fj=k.forwardRef(({color:s="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:a,className:o="",children:l,iconNode:d,...m},p)=>k.createElement("svg",{ref:p,...hj,width:e,height:e,stroke:s,strokeWidth:a?Number(t)*24/Number(e):t,className:w1("lucide",o),...!l&&!dj(m)&&{"aria-hidden":"true"},...m},[...d.map(([y,x])=>k.createElement(y,x)),...Array.isArray(l)?l:[l]]));/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tt=(s,e)=>{const t=k.forwardRef(({className:a,...o},l)=>k.createElement(fj,{ref:l,iconNode:e,className:w1(`lucide-${cj(Tb(s))}`,`lucide-${s}`,a),...o}));return t.displayName=Tb(s),t};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mj=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],gj=tt("arrow-left",mj);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pj=[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]],kb=tt("award",pj);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yj=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],A1=tt("book-open",yj);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vj=[["path",{d:"M12 18V5",key:"adv99a"}],["path",{d:"M15 13a4.17 4.17 0 0 1-3-4 4.17 4.17 0 0 1-3 4",key:"1e3is1"}],["path",{d:"M17.598 6.5A3 3 0 1 0 12 5a3 3 0 1 0-5.598 1.5",key:"1gqd8o"}],["path",{d:"M17.997 5.125a4 4 0 0 1 2.526 5.77",key:"iwvgf7"}],["path",{d:"M18 18a4 4 0 0 0 2-7.464",key:"efp6ie"}],["path",{d:"M19.967 17.483A4 4 0 1 1 12 18a4 4 0 1 1-7.967-.517",key:"1gq6am"}],["path",{d:"M6 18a4 4 0 0 1-2-7.464",key:"k1g0md"}],["path",{d:"M6.003 5.125a4 4 0 0 0-2.526 5.77",key:"q97ue3"}]],Ft=tt("brain",vj);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xj=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],bj=tt("calendar",xj);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _j=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],Fa=tt("camera",_j);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tj=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],yh=tt("circle-alert",Tj);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kj=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],N1=tt("circle-check-big",kj);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ej=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],Sj=tt("circle-x",Ej);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wj=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],br=tt("clock",wj);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Aj=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Ic=tt("eye",Aj);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nj=[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]],R1=tt("hash",Nj);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rj=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],Eb=tt("info",Rj);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cj=[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]],fg=tt("lightbulb",Cj);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ij=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],Fo=tt("lock",Ij);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jj=[["path",{d:"m10 17 5-5-5-5",key:"1bsop3"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}]],C1=tt("log-in",jj);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dj=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],I1=tt("log-out",Dj);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mj=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],vh=tt("mail",Mj);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oj=[["path",{d:"M12 19v3",key:"npa21l"}],["path",{d:"M15 9.34V5a3 3 0 0 0-5.68-1.33",key:"1gzdoj"}],["path",{d:"M16.95 16.95A7 7 0 0 1 5 12v-2",key:"cqa7eg"}],["path",{d:"M18.89 13.23A7 7 0 0 0 19 12v-2",key:"16hl24"}],["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12",key:"r2i35w"}]],Pj=tt("mic-off",Oj);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vj=[["path",{d:"M12 19v3",key:"npa21l"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["rect",{x:"9",y:"2",width:"6",height:"13",rx:"3",key:"s6n7sd"}]],zj=tt("mic",Vj);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lj=[["path",{d:"M12.586 12.586 19 19",key:"ea5xo7"}],["path",{d:"M3.688 3.037a.497.497 0 0 0-.651.651l6.5 15.999a.501.501 0 0 0 .947-.062l1.569-6.083a2 2 0 0 1 1.448-1.479l6.124-1.579a.5.5 0 0 0 .063-.947z",key:"277e5u"}]],Uj=tt("mouse-pointer",Lj);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bj=[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]],xh=tt("palette",Bj);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gj=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],Sb=tt("pause",Gj);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hj=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],xp=tt("play",Hj);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fj=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],wb=tt("plus",Fj);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qj=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],Ys=tt("rotate-ccw",qj);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $j=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],j1=tt("sparkles",$j);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kj=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],Yj=tt("square-pen",Kj);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qj=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],ts=tt("star",Qj);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xj=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],Wn=tt("target",Xj);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zj=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Wj=tt("trash-2",Zj);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jj=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],D1=tt("trending-up",Jj);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eD=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Ab=tt("triangle-alert",eD);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tD=[["path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978",key:"1n3hpd"}],["path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978",key:"rfe1zi"}],["path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18",key:"7xy6bh"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z",key:"1mhfuq"}],["path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6",key:"tex48p"}]],zm=tt("trophy",tD);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nD=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],M1=tt("user-plus",nD);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rD=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],bh=tt("user",rD);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aD=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],O1=tt("users",aD);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sD=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]],iD=tt("volume-2",sD);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oD=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],lD=tt("wifi-off",oD);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cD=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]],Nb=tt("wifi",cD);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uD=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],qo=tt("zap",uD),dD=({onToggleMode:s})=>{const[e,t]=k.useState(""),[a,o]=k.useState(""),[l,d]=k.useState(""),[m,p]=k.useState(!1),{login:y}=_a(),x=async _=>{_.preventDefault(),d(""),p(!0);try{await y(e,a)}catch(w){d(w.message||"Giriş yaparken bir hata oluştu")}p(!1)};return u.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-lg w-full max-w-md",children:[u.jsxs("div",{className:"text-center mb-8",children:[u.jsx("div",{className:"mx-auto w-16 h-16 bg-primary rounded-full flex items-center justify-center mb-4",children:u.jsx(C1,{className:"h-8 w-8 text-white"})}),u.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Öğretmen Girişi"}),u.jsx("p",{className:"text-gray-600 mt-2",children:"NeuroLearn AI Platformuna hoş geldiniz"})]}),l&&u.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6 flex items-center",children:[u.jsx(yh,{className:"h-5 w-5 text-red-500 mr-2"}),u.jsx("span",{className:"text-red-700 text-sm",children:l})]}),u.jsxs("form",{onSubmit:x,className:"space-y-6",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"E-posta Adresi"}),u.jsxs("div",{className:"relative",children:[u.jsx(vh,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),u.jsx("input",{type:"email",value:e,onChange:_=>t(_.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"ogretmen@email.com",required:!0})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Şifre"}),u.jsxs("div",{className:"relative",children:[u.jsx(Fo,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),u.jsx("input",{type:"password",value:a,onChange:_=>o(_.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"••••••••",required:!0})]})]}),u.jsx("button",{type:"submit",disabled:m,className:"w-full bg-primary text-white py-3 rounded-lg font-medium hover:bg-blue-700 focus:ring-2 focus:ring-primary focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:m?"Giriş yapılıyor...":"Giriş Yap"})]}),u.jsx("div",{className:"mt-6 text-center",children:u.jsxs("p",{className:"text-gray-600",children:["Hesabınız yok mu?"," ",u.jsx("button",{onClick:s,className:"text-primary font-medium hover:text-blue-700",children:"Kayıt olun"})]})})]})},hD=({onToggleMode:s})=>{const[e,t]=k.useState(""),[a,o]=k.useState(""),[l,d]=k.useState(""),[m,p]=k.useState(""),[y,x]=k.useState(""),[_,w]=k.useState(!1),{register:j}=_a(),B=async L=>{if(L.preventDefault(),x(""),l!==m){x("Şifreler eşleşmiyor");return}if(l.length<6){x("Şifre en az 6 karakter olmalıdır");return}w(!0);try{await j(a,l,e)}catch(D){x(D.message||"Kayıt olurken bir hata oluştu")}w(!1)};return u.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-lg w-full max-w-md",children:[u.jsxs("div",{className:"text-center mb-8",children:[u.jsx("div",{className:"mx-auto w-16 h-16 bg-secondary rounded-full flex items-center justify-center mb-4",children:u.jsx(M1,{className:"h-8 w-8 text-white"})}),u.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Öğretmen Kaydı"}),u.jsx("p",{className:"text-gray-600 mt-2",children:"Yeni hesap oluşturun"})]}),y&&u.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6 flex items-center",children:[u.jsx(yh,{className:"h-5 w-5 text-red-500 mr-2"}),u.jsx("span",{className:"text-red-700 text-sm",children:y})]}),u.jsxs("form",{onSubmit:B,className:"space-y-6",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Ad Soyad"}),u.jsxs("div",{className:"relative",children:[u.jsx(bh,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),u.jsx("input",{type:"text",value:e,onChange:L=>t(L.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-secondary focus:border-transparent",placeholder:"Ahmet Yılmaz",required:!0})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"E-posta Adresi"}),u.jsxs("div",{className:"relative",children:[u.jsx(vh,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),u.jsx("input",{type:"email",value:a,onChange:L=>o(L.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-secondary focus:border-transparent",placeholder:"ogretmen@email.com",required:!0})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Şifre"}),u.jsxs("div",{className:"relative",children:[u.jsx(Fo,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),u.jsx("input",{type:"password",value:l,onChange:L=>d(L.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-secondary focus:border-transparent",placeholder:"••••••••",required:!0})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Şifre Tekrar"}),u.jsxs("div",{className:"relative",children:[u.jsx(Fo,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),u.jsx("input",{type:"password",value:m,onChange:L=>p(L.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-secondary focus:border-transparent",placeholder:"••••••••",required:!0})]})]}),u.jsx("button",{type:"submit",disabled:_,className:"w-full bg-secondary text-white py-3 rounded-lg font-medium hover:bg-purple-700 focus:ring-2 focus:ring-secondary focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:_?"Kayıt oluşturuluyor...":"Kayıt Ol"})]}),u.jsx("div",{className:"mt-6 text-center",children:u.jsxs("p",{className:"text-gray-600",children:["Zaten hesabınız var mı?"," ",u.jsx("button",{onClick:s,className:"text-secondary font-medium hover:text-purple-700",children:"Giriş yapın"})]})})]})},fD=({onToggleMode:s,onToggleRole:e})=>{const[t,a]=k.useState(""),[o,l]=k.useState(""),[d,m]=k.useState(""),[p,y]=k.useState(!1),{login:x}=_a(),_=async w=>{w.preventDefault(),m(""),y(!0);try{await x(t,o)}catch(j){m(j.message||"Giriş yapılırken bir hata oluştu")}y(!1)};return u.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-lg w-full max-w-md",children:[u.jsxs("div",{className:"text-center mb-8",children:[u.jsx("div",{className:"mx-auto w-16 h-16 bg-primary rounded-full flex items-center justify-center mb-4",children:u.jsx(C1,{className:"h-8 w-8 text-white"})}),u.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Öğrenci Girişi"}),u.jsx("p",{className:"text-gray-600 mt-2",children:"Hesabınıza giriş yapın"})]}),d&&u.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6 flex items-center",children:[u.jsx(yh,{className:"h-5 w-5 text-red-500 mr-2"}),u.jsx("span",{className:"text-red-700 text-sm",children:d})]}),u.jsxs("form",{onSubmit:_,className:"space-y-6",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"E-posta Adresi"}),u.jsxs("div",{className:"relative",children:[u.jsx(vh,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),u.jsx("input",{type:"email",value:t,onChange:w=>a(w.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"ogrenci@email.com",required:!0})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Şifre"}),u.jsxs("div",{className:"relative",children:[u.jsx(Fo,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),u.jsx("input",{type:"password",value:o,onChange:w=>l(w.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"••••••••",required:!0})]})]}),u.jsx("button",{type:"submit",disabled:p,className:"w-full bg-primary text-white py-3 rounded-lg font-medium hover:bg-blue-700 focus:ring-2 focus:ring-primary focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:p?"Giriş yapılıyor...":"Giriş Yap"})]}),u.jsxs("div",{className:"mt-6 text-center space-y-2",children:[u.jsxs("p",{className:"text-gray-600",children:["Henüz hesabınız yok mu?"," ",u.jsx("button",{onClick:s,className:"text-primary font-medium hover:text-blue-700",children:"Kayıt olun"})]}),u.jsxs("p",{className:"text-gray-600",children:["Öğretmen misiniz?"," ",u.jsx("button",{onClick:e,className:"text-secondary font-medium hover:text-purple-700",children:"Öğretmen girişi"})]})]})]})},mD=({onToggleMode:s,onToggleRole:e})=>{const[t,a]=k.useState(""),[o,l]=k.useState(""),[d,m]=k.useState(""),[p,y]=k.useState(""),[x,_]=k.useState(""),[w,j]=k.useState(""),[B,L]=k.useState([]),[D,$]=k.useState(""),[X,ne]=k.useState(!1),{register:ce}=_a();k.useEffect(()=>{(async()=>{try{const O=mp(qc(zi,"users"),gp("role","==","teacher")),N=await vp(O),R=[];N.forEach(P=>{const V=P.data();R.push({id:P.id,name:V.name,email:V.email})}),L(R)}catch(O){console.error("Öğretmenler yüklenirken hata:",O)}})()},[]);const de=async me=>{if(me.preventDefault(),$(""),d!==p){$("Şifreler eşleşmiyor");return}if(d.length<6){$("Şifre en az 6 karakter olmalıdır");return}if(!w){$("Lütfen bir öğretmen seçin");return}const O=parseInt(x);if(isNaN(O)||O<3||O>18){$("Yaş 3-18 arasında olmalıdır");return}ne(!0);try{await ce(o,d,t,"student",O,w)}catch(N){$(N.message||"Kayıt olurken bir hata oluştu")}ne(!1)};return u.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-lg w-full max-w-md",children:[u.jsxs("div",{className:"text-center mb-8",children:[u.jsx("div",{className:"mx-auto w-16 h-16 bg-primary rounded-full flex items-center justify-center mb-4",children:u.jsx(M1,{className:"h-8 w-8 text-white"})}),u.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Öğrenci Kaydı"}),u.jsx("p",{className:"text-gray-600 mt-2",children:"Yeni öğrenci hesabı oluşturun"})]}),D&&u.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6 flex items-center",children:[u.jsx(yh,{className:"h-5 w-5 text-red-500 mr-2"}),u.jsx("span",{className:"text-red-700 text-sm",children:D})]}),u.jsxs("form",{onSubmit:de,className:"space-y-6",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Ad Soyad"}),u.jsxs("div",{className:"relative",children:[u.jsx(bh,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),u.jsx("input",{type:"text",value:t,onChange:me=>a(me.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Öğrenci Adı",required:!0})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Yaş"}),u.jsxs("div",{className:"relative",children:[u.jsx(bj,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),u.jsx("input",{type:"number",min:"3",max:"18",value:x,onChange:me=>_(me.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Yaş",required:!0})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Öğretmen Seçin"}),u.jsxs("div",{className:"relative",children:[u.jsx(O1,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),u.jsxs("select",{value:w,onChange:me=>j(me.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent appearance-none bg-white",required:!0,children:[u.jsx("option",{value:"",children:"Öğretmen seçin..."}),B.map(me=>u.jsxs("option",{value:me.id,children:[me.name," (",me.email,")"]},me.id))]})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"E-posta Adresi"}),u.jsxs("div",{className:"relative",children:[u.jsx(vh,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),u.jsx("input",{type:"email",value:o,onChange:me=>l(me.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"ogrenci@email.com",required:!0})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Şifre"}),u.jsxs("div",{className:"relative",children:[u.jsx(Fo,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),u.jsx("input",{type:"password",value:d,onChange:me=>m(me.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"••••••••",required:!0})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Şifre Tekrar"}),u.jsxs("div",{className:"relative",children:[u.jsx(Fo,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),u.jsx("input",{type:"password",value:p,onChange:me=>y(me.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"••••••••",required:!0})]})]}),u.jsx("button",{type:"submit",disabled:X,className:"w-full bg-primary text-white py-3 rounded-lg font-medium hover:bg-blue-700 focus:ring-2 focus:ring-primary focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:X?"Kayıt oluşturuluyor...":"Öğrenci Kaydı Oluştur"})]}),u.jsxs("div",{className:"mt-6 text-center space-y-2",children:[u.jsxs("p",{className:"text-gray-600",children:["Zaten hesabınız var mı?"," ",u.jsx("button",{onClick:s,className:"text-primary font-medium hover:text-blue-700",children:"Giriş yapın"})]}),u.jsxs("p",{className:"text-gray-600",children:["Öğretmen misiniz?"," ",u.jsx("button",{onClick:e,className:"text-secondary font-medium hover:text-purple-700",children:"Öğretmen kaydı"})]})]})]})},gD=()=>{const[s,e]=k.useState(!0),[t,a]=k.useState("teacher");return u.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50 flex items-center justify-center p-4",children:u.jsxs("div",{className:"w-full max-w-6xl mx-auto flex items-center justify-center gap-12",children:[u.jsxs("div",{className:"hidden lg:block flex-1 max-w-lg",children:[u.jsxs("div",{className:"text-center mb-8",children:[u.jsx("div",{className:"inline-flex items-center justify-center w-24 h-24 bg-gradient-to-r from-primary to-secondary rounded-full mb-6",children:u.jsx(Ft,{className:"h-12 w-12 text-white"})}),u.jsx("h1",{className:"text-4xl font-bold text-gray-800 mb-4",children:"NeuroLearn AI"}),u.jsx("p",{className:"text-xl text-gray-600 mb-8",children:"Otizmli öğrenciler için yapay zeka destekli eğitim platformu"})]}),u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"bg-white/70 backdrop-blur-sm rounded-lg p-6 border border-white/20",children:[u.jsxs("div",{className:"flex items-center mb-3",children:[u.jsx(j1,{className:"h-6 w-6 text-primary mr-3"}),u.jsx("h3",{className:"font-semibold text-gray-800",children:"AI Destekli İçerik"})]}),u.jsx("p",{className:"text-gray-600",children:"Yapay zeka ile öğrenciye özel sorular ve aktiviteler üretilir"})]}),u.jsxs("div",{className:"bg-white/70 backdrop-blur-sm rounded-lg p-6 border border-white/20",children:[u.jsxs("div",{className:"flex items-center mb-3",children:[u.jsx("div",{className:"w-6 h-6 bg-success rounded-full mr-3"}),u.jsx("h3",{className:"font-semibold text-gray-800",children:"Duygu Analizi"})]}),u.jsx("p",{className:"text-gray-600",children:"Gerçek zamanlı duygu tanıma ile öğrencinin durumu takip edilir"})]}),u.jsxs("div",{className:"bg-white/70 backdrop-blur-sm rounded-lg p-6 border border-white/20",children:[u.jsxs("div",{className:"flex items-center mb-3",children:[u.jsx("div",{className:"w-6 h-6 bg-warning rounded-full mr-3"}),u.jsx("h3",{className:"font-semibold text-gray-800",children:"Akıllı Raporlama"})]}),u.jsx("p",{className:"text-gray-600",children:"Detaylı analitik ve öğrenci gelişim raporları"})]})]})]}),u.jsxs("div",{className:"flex-1 max-w-md",children:[u.jsxs("div",{className:"bg-white p-1 rounded-lg shadow-sm mb-6 flex",children:[u.jsx("button",{onClick:()=>a("teacher"),className:`flex-1 py-2 px-4 rounded-md text-sm font-medium transition-colors ${t==="teacher"?"bg-secondary text-white":"text-gray-600 hover:text-gray-800"}`,children:"Öğretmen"}),u.jsx("button",{onClick:()=>a("student"),className:`flex-1 py-2 px-4 rounded-md text-sm font-medium transition-colors ${t==="student"?"bg-primary text-white":"text-gray-600 hover:text-gray-800"}`,children:"Öğrenci"})]}),t==="teacher"?s?u.jsx(dD,{onToggleMode:()=>e(!1)}):u.jsx(hD,{onToggleMode:()=>e(!0)}):s?u.jsx(fD,{onToggleMode:()=>e(!1),onToggleRole:()=>a("teacher")}):u.jsx(mD,{onToggleMode:()=>e(!0),onToggleRole:()=>a("teacher")})]})]})})};function P1(s){var e,t,a="";if(typeof s=="string"||typeof s=="number")a+=s;else if(typeof s=="object")if(Array.isArray(s)){var o=s.length;for(e=0;e<o;e++)s[e]&&(t=P1(s[e]))&&(a&&(a+=" "),a+=t)}else for(t in s)s[t]&&(a&&(a+=" "),a+=t);return a}function pD(){for(var s,e,t=0,a="",o=arguments.length;t<o;t++)(s=arguments[t])&&(e=P1(s))&&(a&&(a+=" "),a+=e);return a}function Kc(...s){return pD(s)}const Nt=({variant:s="primary",size:e="md",loading:t=!1,className:a,disabled:o,children:l,...d})=>{const m="inline-flex items-center justify-center font-medium rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",p={primary:"bg-primary text-white hover:bg-blue-700 focus:ring-primary",secondary:"bg-secondary text-white hover:bg-purple-700 focus:ring-secondary",danger:"bg-danger text-white hover:bg-red-700 focus:ring-danger",outline:"border border-gray-300 text-gray-700 hover:bg-gray-50 focus:ring-primary",ghost:"text-gray-700 hover:bg-gray-100 focus:ring-primary"},y={sm:"px-3 py-2 text-sm",md:"px-4 py-2 text-sm",lg:"px-6 py-3 text-base"};return u.jsxs("button",{className:Kc(m,p[s],y[e],a),disabled:o||t,...d,children:[t&&u.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[u.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),u.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),l]})},yD=({aiStatus:s="connected"})=>{const{currentUser:e,logout:t}=_a(),a=()=>{switch(s){case"connected":return u.jsx(Nb,{className:"h-4 w-4 text-success"});case"disconnected":return u.jsx(lD,{className:"h-4 w-4 text-danger"});case"processing":return u.jsx("div",{className:"h-4 w-4 border-2 border-warning border-t-transparent rounded-full animate-spin"});default:return u.jsx(Nb,{className:"h-4 w-4 text-success"})}},o=()=>{switch(s){case"connected":return"AI Bağlı";case"disconnected":return"AI Bağlantısı Yok";case"processing":return"AI İşlemde";default:return"AI Bağlı"}};return u.jsx("header",{className:"bg-white border-b border-gray-200 px-6 py-4",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("div",{className:"flex items-center space-x-4",children:u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-primary to-secondary rounded-full flex items-center justify-center",children:u.jsx(Ft,{className:"h-6 w-6 text-white"})}),u.jsxs("div",{children:[u.jsx("h1",{className:"text-xl font-bold text-gray-800",children:"NeuroLearn AI"}),u.jsx("p",{className:"text-sm text-gray-600",children:"Öğretmen Paneli"})]})]})}),u.jsxs("div",{className:"flex items-center space-x-6",children:[u.jsxs("div",{className:"flex items-center space-x-2 px-3 py-2 bg-gray-50 rounded-lg",children:[a(),u.jsx("span",{className:"text-sm font-medium text-gray-700",children:o()})]}),u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsxs("div",{className:"text-right",children:[u.jsx("p",{className:"text-sm font-medium text-gray-800",children:e?.name||"Öğretmen"}),u.jsx("p",{className:"text-xs text-gray-600",children:e?.email})]}),u.jsx("div",{className:"w-10 h-10 bg-primary rounded-full flex items-center justify-center",children:u.jsx("span",{className:"text-white font-medium text-sm",children:e?.name?.charAt(0)||"Ö"})}),u.jsxs(Nt,{variant:"outline",size:"sm",onClick:t,className:"border-gray-300 text-gray-700 hover:bg-red-50 hover:text-red-700 hover:border-red-300",children:[u.jsx(I1,{className:"h-4 w-4 mr-2"}),"Çıkış"]})]})]})]})})},ut=({className:s,children:e})=>u.jsx("div",{className:Kc("bg-white rounded-lg shadow-sm border border-gray-200 p-6",s),children:e}),Yd=({className:s,children:e})=>u.jsx("div",{className:Kc("mb-4",s),children:e}),Qd=({className:s,children:e})=>u.jsx("h3",{className:Kc("text-lg font-semibold text-gray-800",s),children:e}),dt=({className:s,children:e})=>u.jsx("div",{className:Kc(s),children:e}),vD=({stats:s,loading:e=!1})=>{const t=[{title:"Haftalık İlerleme",value:`%${s.weeklyProgress}`,icon:D1,color:"bg-blue-500",change:"+12%",changeType:"positive"},{title:"Tamamlanan Aktivite",value:s.completedActivities.toString(),icon:Wn,color:"bg-green-500",change:"+8",changeType:"positive"},{title:"Ortalama Başarı",value:`%${s.averageSuccess}`,icon:O1,color:"bg-purple-500",change:"+5%",changeType:"positive"},{title:"AI Önerileri",value:s.aiRecommendations.toString(),icon:fg,color:"bg-yellow-500",change:"+3",changeType:"positive"}];return e?u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[1,2,3,4].map(a=>u.jsx(ut,{className:"animate-pulse",children:u.jsxs(dt,{children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("div",{className:"h-4 bg-gray-200 rounded w-24 mb-2"}),u.jsx("div",{className:"h-8 bg-gray-200 rounded w-16"})]}),u.jsx("div",{className:"w-12 h-12 bg-gray-200 rounded-full"})]}),u.jsx("div",{className:"mt-4",children:u.jsx("div",{className:"h-3 bg-gray-200 rounded w-16"})})]})},a))}):u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:t.map((a,o)=>{const l=a.icon;return u.jsx(ut,{className:"hover:shadow-md transition-shadow",children:u.jsxs(dt,{children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm font-medium text-gray-600",children:a.title}),u.jsx("p",{className:"text-2xl font-bold text-gray-900",children:a.value})]}),u.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center ${a.color}`,children:u.jsx(l,{className:"h-6 w-6 text-white"})})]}),u.jsxs("div",{className:"mt-4 flex items-center",children:[u.jsx("span",{className:`text-sm font-medium ${a.changeType==="positive"?"text-green-600":"text-red-600"}`,children:a.change}),u.jsx("span",{className:"text-sm text-gray-600 ml-2",children:"son 7 günde"})]})]})},o)})})},xD=({students:s,loading:e=!1,onAddStudent:t,onViewStudent:a,onEditStudent:o,onDeleteStudent:l,getStudentLastEmotion:d})=>{const m=y=>({happy:"bg-green-100 text-green-800",sad:"bg-blue-100 text-blue-800",angry:"bg-red-100 text-red-800",neutral:"bg-gray-100 text-gray-800",focused:"bg-purple-100 text-purple-800",confused:"bg-yellow-100 text-yellow-800"})[y]||"bg-gray-100 text-gray-800",p=y=>({happy:"😊",sad:"😢",angry:"😠",neutral:"😐",focused:"🧐",confused:"😕"})[y]||"😐";return e?u.jsxs(ut,{children:[u.jsx(Yd,{children:u.jsx(Qd,{children:"Öğrenciler"})}),u.jsx(dt,{children:u.jsx("div",{className:"space-y-4",children:[1,2,3].map(y=>u.jsxs("div",{className:"animate-pulse flex items-center space-x-4 p-4 border border-gray-200 rounded-lg",children:[u.jsx("div",{className:"w-12 h-12 bg-gray-200 rounded-full"}),u.jsxs("div",{className:"flex-1",children:[u.jsx("div",{className:"h-4 bg-gray-200 rounded w-32 mb-2"}),u.jsx("div",{className:"h-3 bg-gray-200 rounded w-20"})]}),u.jsx("div",{className:"w-20 h-6 bg-gray-200 rounded"})]},y))})})]}):u.jsxs(ut,{children:[u.jsx(Yd,{children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs(Qd,{children:["Öğrenciler (",s.length,")"]}),u.jsxs(Nt,{onClick:t,size:"sm",children:[u.jsx(wb,{className:"h-4 w-4 mr-2"}),"Yeni Öğrenci"]})]})}),u.jsx(dt,{children:s.length===0?u.jsxs("div",{className:"text-center py-8",children:[u.jsx(bh,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),u.jsx("p",{className:"text-gray-600 mb-4",children:"Henüz öğrenci eklenmemiş"}),u.jsxs(Nt,{onClick:t,variant:"outline",children:[u.jsx(wb,{className:"h-4 w-4 mr-2"}),"İlk öğrenciyi ekle"]})]}):u.jsx("div",{className:"space-y-4",children:s.map(y=>{const x=d?.(y.id);return u.jsxs("div",{className:"flex items-center space-x-4 p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[u.jsx("div",{className:"w-12 h-12 bg-primary rounded-full flex items-center justify-center",children:u.jsx("span",{className:"text-white font-medium text-sm",children:y.name.charAt(0).toUpperCase()})}),u.jsxs("div",{className:"flex-1",children:[u.jsx("h4",{className:"font-medium text-gray-900",children:y.name}),u.jsxs("p",{className:"text-sm text-gray-600",children:[y.age," yaş",y.notes&&` • ${y.notes.slice(0,30)}${y.notes.length>30?"...":""}`]})]}),x&&u.jsxs("div",{className:`px-3 py-1 rounded-full text-xs font-medium ${m(x.emotion)}`,children:[u.jsx("span",{className:"mr-1",children:p(x.emotion)}),x.emotion]}),u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx(Nt,{variant:"ghost",size:"sm",onClick:()=>a(y),className:"text-gray-600 hover:text-primary",children:u.jsx(Ic,{className:"h-4 w-4"})}),u.jsx(Nt,{variant:"ghost",size:"sm",onClick:()=>o(y),className:"text-gray-600 hover:text-secondary",children:u.jsx(Yj,{className:"h-4 w-4"})}),u.jsx(Nt,{variant:"ghost",size:"sm",onClick:()=>l(y.id),className:"text-gray-600 hover:text-danger",children:u.jsx(Wj,{className:"h-4 w-4"})})]})]},y.id)})})})]})},bD=({insights:s,loading:e=!1})=>{const t=d=>({progress:N1,attention:Ab,recommendation:fg,warning:Ab})[d]||Eb,a=(d,m)=>m==="warning"||d==="high"?"bg-red-50 border-red-200 text-red-800":m==="attention"||d==="medium"?"bg-yellow-50 border-yellow-200 text-yellow-800":m==="progress"?"bg-green-50 border-green-200 text-green-800":"bg-blue-50 border-blue-200 text-blue-800",o=d=>({progress:"İlerleme",attention:"Dikkat",recommendation:"Öneri",warning:"Uyarı"})[d]||"Bilgi",l=d=>{const p=new Date().getTime()-d.getTime(),y=Math.floor(p/6e4),x=Math.floor(p/36e5),_=Math.floor(p/864e5);return _>0?`${_} gün önce`:x>0?`${x} saat önce`:y>0?`${y} dakika önce`:"Az önce"};return e?u.jsxs(ut,{children:[u.jsx(Yd,{children:u.jsx(Qd,{children:"AI Öngörüleri"})}),u.jsx(dt,{children:u.jsx("div",{className:"space-y-4",children:[1,2,3].map(d=>u.jsx("div",{className:"animate-pulse border border-gray-200 rounded-lg p-4",children:u.jsxs("div",{className:"flex items-start space-x-3",children:[u.jsx("div",{className:"w-6 h-6 bg-gray-200 rounded-full"}),u.jsxs("div",{className:"flex-1",children:[u.jsx("div",{className:"h-4 bg-gray-200 rounded w-20 mb-2"}),u.jsx("div",{className:"h-3 bg-gray-200 rounded w-full mb-1"}),u.jsx("div",{className:"h-3 bg-gray-200 rounded w-3/4"})]})]})},d))})})]}):u.jsxs(ut,{children:[u.jsx(Yd,{children:u.jsxs(Qd,{className:"flex items-center",children:[u.jsx(fg,{className:"h-5 w-5 mr-2 text-primary"}),"AI Öngörüleri (",s.length,")"]})}),u.jsx(dt,{children:s.length===0?u.jsxs("div",{className:"text-center py-8",children:[u.jsx(Eb,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),u.jsx("p",{className:"text-gray-600 mb-2",children:"Henüz AI öngörüsü yok"}),u.jsx("p",{className:"text-sm text-gray-500",children:"Öğrenciler aktivite yaptıkça AI öngörüleri burada görünecek"})]}):u.jsx("div",{className:"space-y-4 max-h-96 overflow-y-auto",children:s.map(d=>{const m=t(d.type);return u.jsx("div",{className:`border rounded-lg p-4 ${a(d.priority,d.type)}`,children:u.jsxs("div",{className:"flex items-start space-x-3",children:[u.jsx(m,{className:"h-5 w-5 mt-0.5 flex-shrink-0"}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsxs("div",{className:"flex items-center justify-between mb-1",children:[u.jsx("h4",{className:"font-medium text-sm",children:o(d.type)}),u.jsxs("div",{className:"flex items-center text-xs opacity-75",children:[u.jsx(br,{className:"h-3 w-3 mr-1"}),l(d.createdAt)]})]}),u.jsx("p",{className:"text-sm opacity-90",children:d.message})]})]})},d.id)})})})]})},_D=()=>{const{currentUser:s}=_a(),[e,t]=k.useState([]),[a,o]=k.useState([]),[l,d]=k.useState(!0),[m]=k.useState("connected"),[p]=k.useState({weeklyProgress:85,completedActivities:24,averageSuccess:78,aiRecommendations:5}),y=k.useCallback(async()=>{if(s)try{d(!0);const L=await aj(s.id);t(L);const D=[];for(const $ of L){const X=await ij($.id);D.push(...X)}D.sort(($,X)=>X.createdAt.getTime()-$.createdAt.getTime()),o(D.slice(0,10))}catch(L){console.error("Error loading data:",L)}finally{d(!1)}},[s]);k.useEffect(()=>{s&&y()},[s,y]);const x=()=>{console.log("Add student clicked")},_=L=>{console.log("View student:",L)},w=L=>{console.log("Edit student:",L)},j=L=>{console.log("Delete student:",L)},B=L=>({emotion:"happy",confidence:.95,timestamp:new Date});return u.jsxs("div",{className:"min-h-screen bg-gray-50",children:[u.jsx(yD,{aiStatus:m}),u.jsx("main",{className:"max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8",children:u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"bg-gradient-to-r from-primary to-secondary rounded-lg p-6 text-white",children:[u.jsxs("h2",{className:"text-2xl font-bold mb-2",children:["Hoş geldiniz, ",s?.name,"! 👋"]}),u.jsx("p",{className:"text-blue-100",children:"NeuroLearn AI ile öğrencilerinizin gelişimini takip edin ve yapay zeka destekli öğrenme deneyimi sunun."})]}),u.jsx(vD,{stats:p,loading:l}),u.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[u.jsx("div",{className:"lg:col-span-2",children:u.jsx(xD,{students:e,loading:l,onAddStudent:x,onViewStudent:_,onEditStudent:w,onDeleteStudent:j,getStudentLastEmotion:B})}),u.jsx("div",{className:"lg:col-span-1",children:u.jsx(bD,{insights:a,loading:l})})]}),u.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Hızlı İşlemler"}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[u.jsxs("button",{className:"p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors text-left",children:[u.jsx("div",{className:"text-primary font-medium mb-1",children:"🎮 Yeni Oyun Başlat"}),u.jsx("div",{className:"text-sm text-gray-600",children:"Öğrenciler için eğitim oyunu başlatın"})]}),u.jsxs("button",{className:"p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors text-left",children:[u.jsx("div",{className:"text-secondary font-medium mb-1",children:"📊 Detaylı Rapor"}),u.jsx("div",{className:"text-sm text-gray-600",children:"Öğrenci gelişim raporlarını inceleyin"})]}),u.jsxs("button",{className:"p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors text-left",children:[u.jsx("div",{className:"text-success font-medium mb-1",children:"🤖 AI Önerileri"}),u.jsx("div",{className:"text-sm text-gray-600",children:"Yapay zeka önerilerini görüntüleyin"})]})]})]})]})})]})};class TD{constructor(){this.performanceData=new Map}initializePlayer(e,t){this.performanceData.has(e)||this.performanceData.set(e,{recentScores:[],averageResponseTime:0,recentEmotions:[],strugglingTopics:[],strengths:[],currentDifficulty:this.getDifficultyByAge(t)})}getDifficultyByAge(e){return e<=5?"easy":e<=8?"medium":"hard"}recordGameResult(e,t,a,o,l,d){const m=this.performanceData.get(e);if(!m)return;const p=t/a;m.recentScores.push(p),m.recentScores.length>10&&m.recentScores.shift(),m.averageResponseTime=(m.averageResponseTime+o)/2,m.recentEmotions.push(...d),m.recentEmotions.length>20&&(m.recentEmotions=m.recentEmotions.slice(-20)),this.analyzeAndAdjustDifficulty(e,l),this.performanceData.set(e,m)}analyzeAndAdjustDifficulty(e,t){const a=this.performanceData.get(e);if(!a||a.recentScores.length<3)return;const o=a.recentScores.slice(-5).reduce((d,m)=>d+m,0)/Math.min(5,a.recentScores.length),l=this.getDominantEmotion(a.recentEmotions.slice(-10));o>=.8&&l==="happy"?(a.currentDifficulty==="easy"?a.currentDifficulty="medium":a.currentDifficulty==="medium"&&(a.currentDifficulty="hard"),a.strengths.push(t)):(o<=.4||l==="confused"||l==="sad")&&(a.currentDifficulty==="hard"?a.currentDifficulty="medium":a.currentDifficulty==="medium"&&(a.currentDifficulty="easy"),a.strugglingTopics.includes(t)||a.strugglingTopics.push(t)),a.strengths=Array.from(new Set(a.strengths)).slice(-5),a.strugglingTopics=Array.from(new Set(a.strugglingTopics)).slice(-5)}getDominantEmotion(e){if(e.length===0)return"neutral";const t={};return e.forEach(a=>{t[a.emotion]=(t[a.emotion]||0)+1}),Object.keys(t).reduce((a,o)=>t[a]>t[o]?a:o)}getPerformance(e){return this.performanceData.get(e)||null}shouldAdaptQuestion(e){const t=this.performanceData.get(e);return t?t.recentScores.length>=3:!1}getAdaptationStrategy(e){const t=this.performanceData.get(e);if(!t)return"neutral";const a=t.recentScores.slice(-3).reduce((l,d)=>l+d,0)/Math.min(3,t.recentScores.length),o=this.getDominantEmotion(t.recentEmotions.slice(-6));return a>=.7&&(o==="happy"||o==="focused")?"success":a<=.4||o==="sad"?"struggle":o==="confused"?"confusion":"neutral"}getInsights(e){const t=this.performanceData.get(e);if(!t)return[];const a=[],o=t.recentScores.length>0?t.recentScores.reduce((d,m)=>d+m,0)/t.recentScores.length:0;o>=.8?a.push("Öğrenci çok başarılı, daha zor sorularla meydan okuyun"):o<=.4&&a.push("Öğrenci zorlanıyor, daha basit sorularla motivasyonu artırın"),t.strugglingTopics.length>0&&a.push(`Zorlandığı konular: ${t.strugglingTopics.join(", ")}`),t.strengths.length>0&&a.push(`Güçlü olduğu konular: ${t.strengths.join(", ")}`);const l=this.getDominantEmotion(t.recentEmotions);return l==="confused"?a.push("Öğrenci karışık görünüyor, açıklamaları basitleştirin"):l==="happy"&&a.push("Öğrenci mutlu ve motive, bu tempoyu koruyun"),a}resetPerformance(e){this.performanceData.delete(e)}exportPerformanceData(e){return this.performanceData.get(e)||null}}const Gr=new TD;class kD{constructor(){this.modelName="alibayram/turkish-gemma-9b-v0.1:latest"}async generateQuestion(e){const{subject:t,difficulty:a,questionType:o="çoktan seçmeli"}=e;console.log("🤖 [OLLAMA DEBUG] Soru üretimi başlıyor:",{subject:t,difficulty:a,questionType:o,timestamp:new Date().toISOString(),stack:new Error().stack?.split(`
`).slice(1,5).join(`
`)});const l=this.buildPrompt(t,a,o);try{const d=await this.callOllama(l),m=this.parseOllamaResponse(d);return console.log("✅ [OLLAMA DEBUG] Soru başarıyla üretildi:",m.question),{id:`ollama_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,question:m.question,options:m.options,correctAnswer:m.correctIndex,confidence:.9,gameType:"word-image",difficulty:this.mapDifficultyToEnglish(a),source:"ollama"}}catch(d){throw console.error("❌ [OLLAMA DEBUG] Soru üretme hatası:",d),new Error(`Ollama servisi ile soru üretilemedi: ${d}`)}}buildPrompt(e,t,a){return`Aşağıdaki talimatları tamamen uygula ve yalnızca istenen biçimde yanıt ver.

Profil (hedef kitle)
Yaş: 12 (ortaokul 5–6. sınıf).
Dikkat süresi için: tek görev, tek cümle, somut/giriş düzeyi soyut kavramlar.
Kelime dağarcığı: B1 düzeyi; günlük ve dersle ilişkili sözcükler.

Dil ve karakterler
Yanıt yalnızca Türkçe olmalıdır.
Çin/Japon tipi karakter ve noktalama kullanma (örn. ： ， ︿ ＜ ＞).
ASCII soru işareti ? kullan.

Çıktı formatı (zorunlu)
Sadece tek bir JSON nesnesi döndür; açıklama/ek metin yok.
Şema: {"question": string, "options": [string,string,string,string], "correctIndex": number}

Kurallar:
question: 6–8 kelime, kısa ve net.
options: tam 4 seçenek, Türkçe ve emoji ile görsel zengin.
Seçenekler benzersiz, benzer uzunlukta; sadece 1 doğru.
correctIndex: 0–3 arası tamsayı.

ADHD'ye uygun tasarım
Olumsuz kalıp kullanma ("hangisi değildir" yok).
Belirsiz/iki anlamlı ifadeler yok.
Aynı veya çok benzer emojiler kullanma (karışıklık oluşturma).
Gereksiz süsleme ve uzun cümleler yok.

Zorluk haritalaması (12 yaş):
kolay: doğrudan tanıma/isimlendirme; açık farklar; 1 adım.
orta: temel sınıflama/özdeşlik; yakın ama ayrılabilir çeldiriciler.
zor: kısa bağlam ipucu veya 2 adımlı basit akıl yürütme (yine kısa).

Kalite kontrolleri
Soru "hangi / ne / kim / nerede / nedir / nasıl" kalıbı içersin.
Seçenekler dilbilgisel olarak tutarlı (hepsi kısa söz öbekleri).
Soruda cevabı açık etmeyin (ipucu sızıntısı yok).
Doğru cevabın konumu rastgele olsun; sabit pozisyon kullanma.

Konu: ${e}
Zorluk: ${t}

DOĞRU örnek
{"question":"🐶 hangi ses çıkarır?","options":["Hav hav","Miyav","Möö","Cik cik"],"correctIndex":0}

YANLIŞ örnekler (yapma)
Ek açıklama/metin döndürmek.
Çin tipi noktalama: ： ， ︿ ＜ ＞
Uzun/iki görevli sorular.
Birden çok doğru cevap.`}getADHDGuidelines(e){switch(e){case"kolay":return`
- Çok basit, günlük yaşamdan konular
- Büyük, kontrastlı emojiler kullan
- Sadece bir odak noktası
- Pozitif, eğlenceli dil`;case"orta":return`
- Bilinen konulardan biraz farklı örnekler
- Rengarenk emojiler
- Hafif düşündürücü ama yorucu değil
- Teşvik edici ifadeler`;case"zor":return`
- Dikkat gerektiren detaylar
- Çoklu görsel ipuçları
- Problem çözme odaklı
- Başarı hissi verecek zorlukta`;default:return"- Temel ADHD uyumlu tasarım prensiplerine uygun"}}async callOllama(e){const t="http://localhost:11434/api/generate";console.log("📡 [OLLAMA DEBUG] API çağrısı başlıyor...");const a={model:this.modelName,prompt:e,format:"json",stream:!1,options:{temperature:.6,top_p:.9,num_predict:300}};try{const o=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!o.ok)throw new Error(`Ollama API hatası: ${o.status} ${o.statusText}`);const l=await o.json();if(!l.response)throw new Error("Ollama boş yanıt döndürdü");return console.log("📨 [OLLAMA DEBUG] API yanıtı alındı"),l.response.trim()}catch(o){throw o instanceof Error?new Error(`Ollama API hatası: ${o.message}`):o}}parseOllamaResponse(e){console.log("🔍 [OLLAMA DEBUG] Parse edilecek yanıt:",e);try{let t;try{t=JSON.parse(e.trim())}catch{const l=e.match(/\{[\s\S]*\}/);if(!l)throw new Error(`JSON bulunamadı. Ham yanıt: ${e}`);const d=l[0];t=JSON.parse(d)}if(!t?.question||typeof t.question!="string")throw new Error(`Geçersiz question: ${t?.question}`);const a=/[\u4e00-\u9fff\uff00-\uffef：，＞︿＜]/;if(a.test(t.question))throw new Error(`Soru Çince karakter içeriyor: ${t.question}`);if(!Array.isArray(t?.options))throw new Error(`Options array değil: ${t?.options}`);if(t.options.length!==4)throw new Error(`4 seçenek gerekli, ${t.options.length} bulundu: ${JSON.stringify(t.options)}`);for(const o of t.options){if(typeof o!="string")throw new Error(`Seçenek string değil: ${o}`);if(a.test(o))throw new Error(`Seçenek Çince karakter içeriyor: ${o}`)}if(typeof t?.correctIndex!="number")throw new Error(`correctIndex sayı değil: ${t?.correctIndex}`);if(t.correctIndex<0||t.correctIndex>3)throw new Error(`correctIndex 0-3 arasında olmalı: ${t.correctIndex}`);return console.log("✅ [OLLAMA DEBUG] JSON başarıyla parse edildi"),t}catch(t){throw console.error("❌ [OLLAMA DEBUG] JSON parse hatası:",t),console.error("🔍 [OLLAMA DEBUG] Ham yanıt:",e),new Error(`Model JSON döndürmedi veya format hatalı: ${t}`)}}mapDifficultyToEnglish(e){return{kolay:"easy",orta:"medium",zor:"hard"}[e]||"medium"}setModel(e){this.modelName=e}getCurrentModel(){return this.modelName}async checkOllamaStatus(){try{const e=await fetch("http://localhost:11434/api/tags",{method:"GET",headers:{"Content-Type":"application/json"}});return e.ok?((await e.json()).models||[]).some(o=>o.name.includes(this.modelName.split(":")[0])):!1}catch(e){return console.error("Ollama status kontrolü hatası:",e),!1}}async generateSimpleResponse(e){console.log("🤖 [OLLAMA DEBUG] Basit yanıt üretimi başlıyor:",e);const t=`${e}

ÖNEMLI TALİMATLAR:
- Sadece tek kelime renk ismi söyle
- Hiç açıklama yapma
- <think> tag'i kullanma
- "Hmm" gibi düşünce belirteci kullanma
- Sadece renk ismini yaz ve dur

Örnek: "Mavi" veya "Kırmızı"`;try{const a="http://localhost:11434/api/generate",o={model:this.modelName,prompt:t,stream:!1,options:{temperature:.3,top_p:.5,num_predict:10}},l=await fetch(a,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});if(!l.ok)throw new Error(`Ollama API hatası: ${l.status} ${l.statusText}`);const d=await l.json();if(!d.response)throw new Error("Ollama boş yanıt döndürdü");return console.log("✅ [OLLAMA DEBUG] Basit yanıt alındı:",d.response.trim()),d.response.trim()}catch(a){throw console.error("❌ [OLLAMA DEBUG] Basit yanıt hatası:",a),new Error(`Ollama servisi yanıt veremedi: ${a}`)}}async generateMultipleQuestions(e,t=5){const a=[];for(let o=0;o<t;o++)try{const l=await this.generateQuestion(e);a.push(l),await new Promise(d=>setTimeout(d,1e3))}catch(l){console.error(`${o+1}. soru üretme hatası:`,l)}if(a.length===0)throw new Error("Hiç soru üretilemedi");return a}}const va=new kD;class ED{async generateAdaptiveQuestion(e){console.log("🧠 [ADAPTIVE DEBUG] generateAdaptiveQuestion çağrıldı:",{gameType:e.gameType,studentAge:e.studentAge,timestamp:new Date().toISOString(),stack:new Error().stack?.split(`
`).slice(1,5).join(`
`)});const{performance:t,currentEmotion:a,gameType:o,studentAge:l}=e,d=this.determineAdaptationStrategy(t,a);switch(o){case"word-image":return this.generateAdaptiveWordImageQuestion(e,d);case"number":return this.generateAdaptiveNumberQuestion(e,d);case"color":return this.generateAdaptiveColorQuestion(e,d);case"attention-sprint":throw new Error("Attention sprint oyunu AttentionSprintGenerator kullanır");default:throw new Error(`Unsupported game type: ${o}`)}}determineAdaptationStrategy(e,t){const a=e.recentScores.length>0?e.recentScores.slice(-3).reduce((o,l)=>o+l,0)/Math.min(3,e.recentScores.length):.5;return a>=.8&&t?.emotion==="happy"?"challenge":a>=.6&&a<.8?"energize":a<=.4||t?.emotion==="sad"?"simplify":t?.emotion==="confused"?"refocus":"encourage"}async generateAdaptiveWordImageQuestion(e,t){const{performance:a,studentAge:o}=e,l=this.getSubjectForWordImage(o,t),d=this.mapDifficultyToTurkish(a.currentDifficulty);try{const m={subject:l,difficulty:d,questionType:"çoktan seçmeli"};return{...await va.generateQuestion(m),difficulty:a.currentDifficulty,adaptedFor:t==="challenge"?"success":t==="simplify"?"struggle":"confusion",gameType:"word-image"}}catch(m){console.error("Ollama question generation failed, using adaptive fallback:",m)}return this.generateAdaptiveFallbackWordImage(t,a.currentDifficulty,o)}buildWordImagePrompt(e,t,a){const o={easy:"very simple",medium:"moderately challenging",hard:"challenging"},l={encourage:"Create an encouraging and positive question",challenge:"Create a more challenging question to push the student",simplify:"Create a very simple and confidence-building question",refocus:"Create a clear, focused question without distractions"};return`Generate a ${o[t]} word-image matching question for a ${a}-year-old child. ${l[e]}.

Format the response as:
Question: [question text]
Options: [option1, option2, option3, option4]
Correct: [index of correct answer 0-3]

Example:
Question: Which animal says "woof woof"?
Options: 🐶, 🐱, 🐸, 🦋
Correct: 0

Topic should be about animals, fruits, or vehicles. Use simple emojis as options.`}parseAIQuestionResponse(e,t){try{const a=e.split(`
`).filter(m=>m.trim());let o="",l=[],d=0;for(const m of a)m.startsWith("Question:")?o=m.replace("Question:","").trim():m.startsWith("Options:")?l=m.replace("Options:","").trim().split(",").map(p=>p.trim()):m.startsWith("Correct:")&&(d=parseInt(m.replace("Correct:","").trim())||0);if(o&&l.length>=4)return{id:`ai_${t}_${Date.now()}`,question:o,options:l.slice(0,4),correctAnswer:Math.max(0,Math.min(3,d)),confidence:.9,gameType:t}}catch(a){console.error("Error parsing AI response:",a)}return null}generateAdaptiveFallbackWordImage(e,t,a){const l={animals:{easy:[{question:"Hangi hayvan köpek?",options:["🐶","🐱","🐸","🦋"],correct:0},{question:"Hangi hayvan kedi?",options:["🐱","🐶","🐸","🦋"],correct:0}],medium:[{question:"Hangi hayvan çiftlikte yaşar?",options:["🐄","🐧","🦁","🐙"],correct:0},{question:"Hangi hayvan denizde yaşar?",options:["🐠","🐶","🐱","🐸"],correct:0}],hard:[{question:"Hangi hayvan gece aktiftir?",options:["🦉","🐶","🐸","🦋"],correct:0},{question:"Hangi hayvan soğuk bölgelerde yaşar?",options:["🐧","🦁","🐴","🐄"],correct:0}]}}.animals[t],d=l[Math.floor(Math.random()*l.length)];let m=d.question;return e==="encourage"?m=`Harika! ${m}`:e==="simplify"?m=`Kolay soru: ${m}`:e==="challenge"&&(m=`Zor soru: ${m}`),{id:`adaptive_word_${Date.now()}`,question:m,options:d.options,correctAnswer:d.correct,confidence:.85,gameType:"word-image",difficulty:t,adaptedFor:e==="challenge"?"success":e==="simplify"?"struggle":"confusion"}}async generateAdaptiveNumberQuestion(e,t){const{performance:a,studentAge:o}=e,d={easy:{min:1,max:5},medium:{min:1,max:10},hard:{min:5,max:15}}[a.currentDifficulty],m=Math.floor(Math.random()*(d.max-d.min+1))+d.min,p=[];for(;p.length<3;){let w;t==="simplify"?w=Math.random()<.5?Math.max(1,m-Math.floor(Math.random()*3)-1):Math.min(d.max,m+Math.floor(Math.random()*3)+1):w=Math.floor(Math.random()*(d.max-d.min+1))+d.min,w!==m&&!p.includes(w)&&p.push(w)}const y=[m,...p].sort(()=>Math.random()-.5),x=y.indexOf(m);let _="Kaç tane 🐶 var?";return t==="encourage"?_=`Harika! ${_}`:t==="challenge"?_=`Dikkatlice say: ${_}`:t==="simplify"&&(_=`Kolay soru: ${_}`),{id:`adaptive_number_${Date.now()}`,question:_,options:y.map(String),correctAnswer:x,confidence:.9,gameType:"number",difficulty:a.currentDifficulty,adaptedFor:t==="challenge"?"success":t==="simplify"?"struggle":"confusion"}}async generateAdaptiveColorQuestion(e,t){const{performance:a}=e,o=[{name:"kırmızı",emoji:"🔴"},{name:"mavi",emoji:"🔵"},{name:"yeşil",emoji:"🟢"},{name:"sarı",emoji:"🟡"},{name:"mor",emoji:"🟣"},{name:"turuncu",emoji:"🟠"}];let l=o;a.currentDifficulty==="easy"?l=o.slice(0,4):t==="simplify"&&(l=o.slice(0,3));const d=l[Math.floor(Math.random()*l.length)],m=l.filter(_=>_.name!==d.name).slice(0,3),p=[d,...m].sort(()=>Math.random()-.5),y=p.findIndex(_=>_.name===d.name);let x=`Hangi renk ${d.name}?`;return t==="encourage"?x=`Çok güzel! ${x}`:t==="challenge"?x=`Dikkat et: ${x}`:t==="simplify"&&(x=`Basit soru: ${x}`),{id:`adaptive_color_${Date.now()}`,question:x,options:p.map(_=>_.emoji),correctAnswer:y,confidence:.9,gameType:"color",difficulty:a.currentDifficulty,adaptedFor:t==="challenge"?"success":t==="simplify"?"struggle":"confusion"}}async generateQuestionWithContext(e,t,a,o){console.log("🎯 [ADAPTIVE DEBUG] generateQuestionWithContext çağrıldı:",{studentId:e,gameType:t,studentAge:a,timestamp:new Date().toISOString(),stack:new Error().stack?.split(`
`).slice(1,5).join(`
`)}),Gr.initializePlayer(e,a);const l=Gr.getPerformance(e);if(!l)throw new Error("Could not retrieve student performance data");const d={performance:l,currentEmotion:o,gameType:t,previousQuestions:[],studentAge:a,adaptiveMode:!0};return this.generateAdaptiveQuestion(d)}getSubjectForWordImage(e,t){const a={easy:["Sevimli Hayvanlar","Parlak Renkler","Lezzetli Meyveler","Eğlenceli Oyuncaklar"],medium:["Hızlı Hayvanlar","Cool Taşıtlar","Maceralı Doğa","Süper Kahramanlar"],hard:["Uzay ve Gezegenler","Dinozorlar","Harika Icatlar","Büyülü Bilim"]};let o;switch(e<=6?o=a.easy:e<=10?o=a.medium:o=a.hard,t){case"simplify":o=a.easy;break;case"energize":o=["Süper Hızlı Hayvanlar","Çılgın Renkler","Aksiyon Arabalar"];break;case"challenge":e>7&&(o=a.hard);break;case"refocus":o=["Sakin Hayvanlar","Yumuşak Renkler","Huzurlu Doğa"];break}return o[Math.floor(Math.random()*o.length)]}mapDifficultyToTurkish(e){return{easy:"kolay",medium:"orta",hard:"zor"}[e]||"orta"}async generateOllamaMathQuestion(e="Temel Matematik",t="orta",a=8){const o=["Eğlenceli sayma (oyuncaklar, hayvanlar ile)","Görsel toplama (emojiler ile)","Kolay çıkarma (çizgi film karakterleri ile)","Renkli şekiller tanıma","Günlük yaşamdan sayılar (yaş, saat, para)"],l=o[Math.floor(Math.random()*o.length)];try{const d={subject:`${l} (${a} yaş için uygun)`,difficulty:t,questionType:"çoktan seçmeli"};return{...await va.generateQuestion(d),gameType:"number"}}catch(d){throw console.error("Ollama matematik sorusu üretme hatası:",d),d}}async generateOllamaScienceQuestion(e="orta",t=10){const a=["Sevimli hayvanların yaşam alanları","Gökyüzündeki renkli olaylar (gökkuşağı, bulutlar)","Eğlenceli deneyimler (mıknatıs, su-yağ)","Uzaydaki parlak gezegen ve yıldızlar","Bitkilerin büyümesi ve çiçek açması","Mevsim değişimleri ve doğadaki renkler"],o=a[Math.floor(Math.random()*a.length)];try{const l={subject:`${o} (${t} yaş çocuk için basit)`,difficulty:e,questionType:"çoktan seçmeli"};return await va.generateQuestion(l)}catch(l){throw console.error("Ollama fen bilgisi sorusu üretme hatası:",l),l}}}const bp=new ED,SD=({studentId:s,studentAge:e=6,onGameComplete:t,onEmotionDetected:a,useAdaptiveAI:o=!0})=>{const[l,d]=k.useState(null),[m,p]=k.useState(null),[y,x]=k.useState(0),[_,w]=k.useState(1),[j,B]=k.useState(30),[L,D]=k.useState("loading"),[$,X]=k.useState([]),[ne,ce]=k.useState(""),[de]=k.useState(Date.now()),[me,O]=k.useState(!1),[N,R]=k.useState(""),[P,V]=k.useState(!1),I=k.useRef(!1),A=5,we=k.useCallback(async()=>{if(!me){D("loading"),O(!0);try{let Y;if(o){const oe=$.length>0?$[$.length-1]:void 0;Y=await bp.generateQuestionWithContext(s,"word-image",e,oe);const ge=Gr.getInsights(s);ge.length>0&&R(ge[0])}else{const oe=["Hayvanlar","Meyveler","Taşıtlar"],ge=oe[Math.floor(Math.random()*oe.length)];Y=await va.generateQuestion({subject:ge,difficulty:"kolay",questionType:"çoktan seçmeli"})}d(Y),p(null),B(30),D("playing")}catch(Y){console.error("Error generating question:",Y);try{const oe=await va.generateQuestion({subject:"Hayvanlar",difficulty:"kolay",questionType:"çoktan seçmeli"});d(oe)}catch(oe){console.error("Ollama fallback failed:",oe);const ge={id:`static_fallback_${Date.now()}`,question:"Hangi hayvan köpek?",options:["🐶","🐱","🐸","🦋"],correctAnswer:0,confidence:1,gameType:"word-image",difficulty:"easy"};d(ge)}p(null),B(30),D("playing")}finally{O(!1)}}},[s,e,o]);k.useEffect(()=>{I.current||P||(I.current=!0,V(!0),we())},[we,P]),k.useEffect(()=>{let Y;return L==="playing"&&j>0?Y=setTimeout(()=>{B(j-1)},1e3):j===0&&L==="playing"&&se(),()=>clearTimeout(Y)},[j,L]);const se=()=>{p(-1);const Y=["Zaman bitti! 🕐 Ama sorun yok, devam edelim!","Hop, zaman doldu! ⏰ Hızlı olmaya çalışalım!","Süre bitti! 🏃‍♂️ Bir sonrakinde daha hızlı!","Zaman tamamlandı! 🎯 Sen yaparsın!"];ce(Y[Math.floor(Math.random()*Y.length)]),D("answered");const oe={emotion:"neutral",confidence:.6,timestamp:new Date};X(ge=>[...ge,oe]),a?.(oe),setTimeout(()=>{he()},1500)},q=Y=>{if(L!=="playing")return;if(p(Y),D("answered"),Y===l?.correctAnswer){x(y+1);const ge=["SÜPER! ⭐ Harika bir seçim!","MÜTHİŞ! 🌟 Çok akıllısın!","WOW! 🎉 Perfect!","BRAVO! 🏆 Harikasın!","YESSss! 🚀 Devam et!"];ce(ge[Math.floor(Math.random()*ge.length)]);const be={emotion:"happy",confidence:.9,timestamp:new Date};X(nt=>[...nt,be]),a?.(be)}else{const ge=["Hey, yaklaştın! 💪 Bir daha dene!","Hiç sorun değil! 😊 Sen harikasın!","Önemli değil! 🌈 Denemeye devam!","Bu sefer olmadı ama 🎯 bir sonrakinde!","Gayet iyi! 🤗 Devam ediyoruz!"];ce(ge[Math.floor(Math.random()*ge.length)]);const be={emotion:"neutral",confidence:.7,timestamp:new Date};X(nt=>[...nt,be]),a?.(be)}setTimeout(()=>{he()},2e3)},he=()=>{_>=A?G():(w(_+1),we())},G=()=>{D("completed");const Y=Math.floor((Date.now()-de)/1e3);o&&Gr.recordGameResult(s,y,A,Y,"word-image",$),t(y,Y,$)},re=()=>{x(0),w(1),X([]),R(""),o&&Gr.initializePlayer(s,e),we()},C=Y=>{if("speechSynthesis"in window){const oe=new SpeechSynthesisUtterance(Y);oe.lang="tr-TR",oe.rate=.8,speechSynthesis.speak(oe)}},Z=()=>{const Y=y/A*100;return Y>=80?"text-green-600":Y>=60?"text-yellow-600":"text-red-600"},H=()=>{const Y=y/A*100;return Y===100?"WAOW! MÜKEMMEL! 🏆✨ Sen bir şampiyon!":Y>=80?"SÜPER! 🌟🚀 Çok akıllısın!":Y>=60?"HARİKA! 👏🎉 Çok iyi gidiyorsun!":Y>=40?"GÜZEL! 💪🌈 Devam et!":"HEY! 🤗⭐ Sen harikasın, tekrar deneyelim!"};return L==="completed"?u.jsx(ut,{className:"max-w-2xl mx-auto",children:u.jsxs(dt,{className:"text-center py-12",children:[u.jsxs("div",{className:"mb-6",children:[u.jsx("div",{className:"w-24 h-24 mx-auto mb-4 bg-gradient-to-r from-primary to-secondary rounded-full flex items-center justify-center",children:u.jsx(ts,{className:"h-12 w-12 text-white"})}),u.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Oyun Tamamlandı!"}),u.jsx("p",{className:"text-gray-600",children:"Harika bir performans sergiledi!"})]}),u.jsx("div",{className:"bg-gray-50 rounded-lg p-6 mb-6",children:u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[u.jsxs("div",{className:"text-center",children:[u.jsxs("div",{className:`text-3xl font-bold ${Z()}`,children:[y,"/",A]}),u.jsx("div",{className:"text-sm text-gray-600",children:"Doğru Cevap"})]}),u.jsxs("div",{className:"text-center",children:[u.jsxs("div",{className:"text-3xl font-bold text-primary",children:["%",Math.round(y/A*100)]}),u.jsx("div",{className:"text-sm text-gray-600",children:"Başarı Oranı"})]}),u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"text-3xl font-bold text-secondary",children:$.length}),u.jsx("div",{className:"text-sm text-gray-600",children:"Duygusal Tepki"})]})]})}),u.jsx("div",{className:"mb-6",children:u.jsx("p",{className:"text-lg font-medium text-gray-800",children:H()})}),u.jsxs(Nt,{onClick:re,size:"lg",className:"mr-4",children:[u.jsx(Ys,{className:"h-5 w-5 mr-2"}),"Tekrar Oyna"]})]})}):L==="loading"||!l?u.jsx(ut,{className:"max-w-2xl mx-auto",children:u.jsxs(dt,{className:"text-center py-12",children:[u.jsx("div",{className:"w-16 h-16 border-4 border-primary border-t-transparent rounded-full animate-spin mx-auto mb-4"}),me&&o?u.jsxs("div",{className:"space-y-2",children:[u.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[u.jsx(Ft,{className:"h-5 w-5 text-primary animate-pulse"}),u.jsx("p",{className:"text-gray-600 font-medium",children:"🤖 Senin için özel soru hazırlıyorum!"})]}),u.jsx("p",{className:"text-sm text-gray-500",children:"✨ ADHD dostum için en iyi soruyu seçiyorum..."})]}):u.jsx("p",{className:"text-gray-600 font-medium",children:"🎯 Yeni macera yükleniyor..."})]})}):u.jsxs("div",{className:"max-w-2xl mx-auto space-y-6",children:[u.jsx(ut,{children:u.jsxs(dt,{children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsxs("div",{className:"text-sm text-gray-600",children:["Soru ",_,"/",A]}),u.jsxs("div",{className:"text-sm font-medium text-gray-800",children:["Skor: ",y,"/",_-1]}),o&&l?.difficulty&&u.jsx("div",{className:`text-xs px-2 py-1 rounded-full ${l.difficulty==="easy"?"bg-green-100 text-green-700":l.difficulty==="medium"?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"}`,children:l.difficulty==="easy"?"Kolay":l.difficulty==="medium"?"Orta":"Zor"})]}),u.jsxs("div",{className:"flex items-center space-x-2",children:[o&&u.jsx("div",{title:"AI Powered",children:u.jsx(Ft,{className:"h-4 w-4 text-primary"})}),u.jsx(br,{className:"h-4 w-4 text-gray-600"}),u.jsxs("span",{className:`font-medium ${j<=10?"text-red-600":"text-gray-800"}`,children:[j,"s"]})]})]}),u.jsx("div",{className:"mt-4",children:u.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:u.jsx("div",{className:"bg-primary h-2 rounded-full transition-all duration-300",style:{width:`${_/A*100}%`}})})}),o&&N&&u.jsx("div",{className:"mt-3 p-2 bg-blue-50 rounded-lg",children:u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx(Ft,{className:"h-4 w-4 text-blue-600"}),u.jsx("p",{className:"text-sm text-blue-700",children:N})]})})]})}),u.jsx(ut,{children:u.jsxs(dt,{className:"text-center py-8",children:[u.jsxs("div",{className:"mb-6",children:[u.jsxs(Nt,{variant:"ghost",onClick:()=>C(l.question),className:"mb-4",children:[u.jsx(iD,{className:"h-5 w-5 mr-2"}),"Soruyu Dinle"]}),u.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:l.question})]}),u.jsx("div",{className:"grid grid-cols-2 gap-4 max-w-md mx-auto",children:l.options.map((Y,oe)=>{let ge="h-24 text-4xl hover:scale-105 transition-transform";return L==="answered"&&(oe===l.correctAnswer?ge+=" bg-green-100 border-green-500 text-green-700":oe===m&&oe!==l.correctAnswer?ge+=" bg-red-100 border-red-500 text-red-700":ge+=" opacity-50"),u.jsx("button",{className:`border-2 border-gray-300 rounded-lg ${ge}`,onClick:()=>q(oe),disabled:L!=="playing",children:Y},oe)})}),L==="answered"&&ne&&u.jsxs("div",{className:"mt-6 flex items-center justify-center space-x-2",children:[m===l.correctAnswer?u.jsx(N1,{className:"h-6 w-6 text-green-600"}):u.jsx(Sj,{className:"h-6 w-6 text-red-600"}),u.jsx("p",{className:"text-lg font-medium text-gray-800",children:ne})]})]})})]})},wD=({studentId:s,studentAge:e=6,onGameComplete:t,onEmotionDetected:a,useAdaptiveAI:o=!0})=>{const[l,d]=k.useState(null),[m,p]=k.useState(null),[y,x]=k.useState(0),[_,w]=k.useState(1),[j,B]=k.useState(45),[L,D]=k.useState("loading"),[$,X]=k.useState([]),[ne,ce]=k.useState(!1),[de]=k.useState(Date.now()),[me,O]=k.useState(!1),[N,R]=k.useState(""),[P,V]=k.useState(!1),I=k.useRef(!1),A=5,we=k.useCallback(async()=>{if(!me){D("loading"),O(!0);try{let H;if(o){const Y=$.length>0?$[$.length-1]:void 0;H=await bp.generateQuestionWithContext(s,"number",e,Y);const oe=Gr.getInsights(s);oe.length>0&&R(oe[0])}else H=await va.generateQuestion({subject:"Sayma ve temel matematik",difficulty:"kolay",questionType:"çoktan seçmeli"}),H.gameType="number";d(H),p(null),B(45),D("playing")}catch(H){console.error("Error generating question:",H);try{const Y=await va.generateQuestion({subject:"Basit sayma",difficulty:"kolay",questionType:"çoktan seçmeli"});Y.gameType="number",d(Y)}catch(Y){console.error("Ollama fallback failed:",Y);const oe={id:`static_number_${Date.now()}`,question:"Kaç tane 🍎 var?",options:["2","3","4","5"],correctAnswer:1,confidence:1,gameType:"number",difficulty:"easy"};d(oe)}p(null),B(45),D("playing")}finally{O(!1)}}},[s,e,o]);k.useEffect(()=>{I.current||P||(I.current=!0,V(!0),we())},[we,P]),k.useEffect(()=>{let H;return L==="playing"&&j>0?H=setTimeout(()=>{B(j-1)},1e3):j===0&&L==="playing"&&se(),()=>clearTimeout(H)},[j,L]);const se=()=>{p(-1),D("answered");const H={emotion:"confused",confidence:.8,timestamp:new Date};X(Y=>[...Y,H]),a?.(H),setTimeout(()=>{G()},2e3)},q=H=>{if(L!=="playing")return;if(p(H),D("answered"),H===l?.correctAnswer){x(y+1);const oe={emotion:"happy",confidence:.9,timestamp:new Date};X(ge=>[...ge,oe]),a?.(oe)}else{const oe={emotion:"sad",confidence:.7,timestamp:new Date};X(ge=>[...ge,oe]),a?.(oe)}setTimeout(()=>{G()},2e3)},he=()=>{if(!("webkitSpeechRecognition"in window)&&!("SpeechRecognition"in window)){alert("Tarayıcınız ses tanımayı desteklemiyor");return}if(ne){ce(!1);return}ce(!0);const H=new(window.webkitSpeechRecognition||window.SpeechRecognition);H.lang="tr-TR",H.interimResults=!1,H.maxAlternatives=1,H.onresult=Y=>{const oe=Y.results[0][0].transcript,ge=parseInt(oe);if(!isNaN(ge)&&l){const be=l.options.findIndex(nt=>parseInt(nt)===ge);be!==-1&&q(be)}ce(!1)},H.onerror=()=>{ce(!1)},H.onend=()=>{ce(!1)},H.start()},G=()=>{_>=A?re():(w(_+1),we())},re=()=>{D("completed");const H=Math.floor((Date.now()-de)/1e3);o&&Gr.recordGameResult(s,y,A,H,"number",$),t(y,H,$)},C=()=>{x(0),w(1),X([]),R(""),o&&Gr.initializePlayer(s,e),we()};if(L==="completed")return u.jsx(ut,{className:"max-w-2xl mx-auto",children:u.jsxs(dt,{className:"text-center py-12",children:[u.jsxs("div",{className:"mb-6",children:[u.jsx("div",{className:"w-24 h-24 mx-auto mb-4 bg-gradient-to-r from-green-500 to-blue-500 rounded-full flex items-center justify-center",children:u.jsx(ts,{className:"h-12 w-12 text-white"})}),u.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Sayı Oyunu Tamamlandı!"}),u.jsx("p",{className:"text-gray-600",children:"Matematik becerilerin gelişiyor!"})]}),u.jsx("div",{className:"bg-gray-50 rounded-lg p-6 mb-6",children:u.jsxs("div",{className:"text-center",children:[u.jsxs("div",{className:"text-4xl font-bold text-green-600 mb-2",children:[y,"/",A]}),u.jsx("div",{className:"text-sm text-gray-600",children:"Doğru Sayı"})]})}),u.jsxs(Nt,{onClick:C,size:"lg",children:[u.jsx(Ys,{className:"h-5 w-5 mr-2"}),"Tekrar Oyna"]})]})});if(L==="loading"||!l)return u.jsx(ut,{className:"max-w-2xl mx-auto",children:u.jsxs(dt,{className:"text-center py-12",children:[u.jsx("div",{className:"w-16 h-16 border-4 border-green-500 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),me&&o?u.jsxs("div",{className:"space-y-2",children:[u.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[u.jsx(Ft,{className:"h-5 w-5 text-green-600"}),u.jsx("p",{className:"text-gray-600",children:"AI sayı sorusu üretiyor..."})]}),u.jsx("p",{className:"text-sm text-gray-500",children:"Performansına göre uyarlanıyor"})]}):u.jsx("p",{className:"text-gray-600",children:"Sayı sorusu hazırlanıyor..."})]})});const Z=()=>{if(!l)return null;const H=parseInt(l.options[l.correctAnswer]),Y="🐶".repeat(H);return u.jsx("div",{className:"text-6xl mb-6 leading-relaxed",children:Y})};return u.jsxs("div",{className:"max-w-2xl mx-auto space-y-6",children:[u.jsx(ut,{children:u.jsxs(dt,{children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsxs("div",{className:"text-sm text-gray-600",children:["Soru ",_,"/",A]}),u.jsxs("div",{className:"text-sm font-medium text-gray-800",children:["Skor: ",y]}),o&&l?.difficulty&&u.jsx("div",{className:`text-xs px-2 py-1 rounded-full ${l.difficulty==="easy"?"bg-green-100 text-green-700":l.difficulty==="medium"?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"}`,children:l.difficulty==="easy"?"Kolay":l.difficulty==="medium"?"Orta":"Zor"})]}),u.jsxs("div",{className:"flex items-center space-x-2",children:[o&&u.jsx("div",{title:"AI Powered",children:u.jsx(Ft,{className:"h-4 w-4 text-green-600"})}),u.jsx(br,{className:"h-4 w-4 text-gray-600"}),u.jsxs("span",{className:`font-medium ${j<=15?"text-red-600":"text-gray-800"}`,children:[j,"s"]})]})]}),o&&N&&u.jsx("div",{className:"mt-3 p-2 bg-blue-50 rounded-lg",children:u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx(Ft,{className:"h-4 w-4 text-blue-600"}),u.jsx("p",{className:"text-sm text-blue-700",children:N})]})})]})}),u.jsx(ut,{children:u.jsxs(dt,{className:"text-center py-8",children:[u.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-6",children:l.question}),u.jsx("div",{className:"mb-8",children:Z()}),u.jsxs("div",{className:"mb-6",children:[u.jsxs(Nt,{onClick:he,variant:ne?"danger":"secondary",size:"lg",className:"mb-4",children:[ne?u.jsx(Pj,{className:"h-5 w-5 mr-2"}):u.jsx(zj,{className:"h-5 w-5 mr-2"}),ne?"Dinlemeyi Durdur":"Sesli Cevap Ver"]}),ne&&u.jsx("p",{className:"text-sm text-gray-600",children:"Cevabınızı söyleyin..."})]}),u.jsx("div",{className:"grid grid-cols-5 gap-3 max-w-lg mx-auto",children:l.options.map((H,Y)=>{let oe="h-16 text-xl font-bold hover:scale-105 transition-transform";return L==="answered"&&(Y===l.correctAnswer?oe+=" bg-green-100 border-green-500 text-green-700":Y===m&&Y!==l.correctAnswer?oe+=" bg-red-100 border-red-500 text-red-700":oe+=" opacity-50"),u.jsx("button",{className:`border-2 border-gray-300 rounded-lg ${oe}`,onClick:()=>q(Y),disabled:L!=="playing",children:H},Y)})})]})})]})},AD=({studentId:s,studentAge:e=6,onGameComplete:t,onEmotionDetected:a,useAdaptiveAI:o=!0})=>{const[l,d]=k.useState(null),[m,p]=k.useState(null),[y,x]=k.useState(0),[_,w]=k.useState(1),[j,B]=k.useState(25),[L,D]=k.useState("loading"),[$,X]=k.useState([]),[ne]=k.useState(Date.now()),[ce,de]=k.useState(!1),[me,O]=k.useState(""),[N,R]=k.useState(!1),P=k.useRef(!1),V=5,I=k.useCallback(async()=>{if(console.log("🔍 [DEBUG] generateQuestion çağrıldı",{isAIGenerating:ce,gameState:L,questionNumber:_,timestamp:new Date().toISOString()}),ce){console.log("⚠️ [DEBUG] Zaten soru üretiliyor, çıkılıyor...");return}console.log("🚀 [DEBUG] Soru üretimi başlıyor..."),D("loading"),de(!0);try{let G;if(o){const re=$.length>0?$[$.length-1]:void 0;G=await bp.generateQuestionWithContext(s,"color",e,re);const C=Gr.getInsights(s);C.length>0&&O(C[0])}else G=await va.generateQuestion({subject:"Renkler ve renk tanıma",difficulty:"kolay",questionType:"çoktan seçmeli"}),G.gameType="color";console.log("✅ [DEBUG] Soru başarıyla üretildi:",G.question),d(G),p(null),B(25),D("playing")}catch(G){console.error("Error generating question:",G);try{const re=await va.generateQuestion({subject:"Temel renkler",difficulty:"kolay",questionType:"çoktan seçmeli"});re.gameType="color",d(re)}catch(re){console.error("Ollama fallback failed:",re);const C={id:`static_color_${Date.now()}`,question:"Hangi renk kırmızı?",options:["🔴","🔵","🟢","🟡"],correctAnswer:0,confidence:1,gameType:"color",difficulty:"easy"};d(C)}p(null),B(25),D("playing")}finally{console.log("🏁 [DEBUG] Soru üretimi tamamlandı, isAIGenerating = false"),de(!1)}},[s,e,o]);k.useEffect(()=>{if(console.log("🔄 [DEBUG] useEffect çalıştı",{isInitialized:N,initStarted:P.current}),P.current){console.log("🛡️ [DEBUG] StrictMode guard - çıkılıyor");return}N||(console.log("🎯 [DEBUG] İlk kez başlatılıyor, generateQuestion çağrılıyor"),P.current=!0,R(!0),I())},[I,N]),k.useEffect(()=>{let G;return L==="playing"&&j>0?G=setTimeout(()=>{B(j-1)},1e3):j===0&&L==="playing"&&A(),()=>clearTimeout(G)},[j,L]);const A=()=>{p(-1),D("answered");const G={emotion:"confused",confidence:.8,timestamp:new Date};X(re=>[...re,G]),a?.(G),setTimeout(()=>{se()},2e3)},we=G=>{if(L!=="playing")return;if(p(G),D("answered"),G===l?.correctAnswer){x(y+1);const C={emotion:"happy",confidence:.9,timestamp:new Date};X(Z=>[...Z,C]),a?.(C)}else{const C={emotion:"sad",confidence:.7,timestamp:new Date};X(Z=>[...Z,C]),a?.(C)}setTimeout(()=>{se()},2e3)},se=k.useCallback(()=>{console.log("➡️ [DEBUG] nextQuestion çağrıldı",{questionNumber:_,totalQuestions:V}),_>=V?(console.log("🏆 [DEBUG] Oyun tamamlandı"),q()):(console.log("🔢 [DEBUG] Sonraki soruya geçiliyor:",_+1),w(_+1),I())},[_,V,I]),q=()=>{D("completed");const G=Math.floor((Date.now()-ne)/1e3);o&&Gr.recordGameResult(s,y,V,G,"color",$),t(y,G,$)},he=()=>{x(0),w(1),X([]),O(""),R(!1),o&&Gr.initializePlayer(s,e),I()};return L==="completed"?u.jsx(ut,{className:"max-w-2xl mx-auto",children:u.jsxs(dt,{className:"text-center py-12",children:[u.jsxs("div",{className:"mb-6",children:[u.jsx("div",{className:"w-24 h-24 mx-auto mb-4 bg-gradient-to-r from-purple-500 to-pink-500 rounded-full flex items-center justify-center",children:u.jsx(xh,{className:"h-12 w-12 text-white"})}),u.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Renk Oyunu Tamamlandı!"}),u.jsx("p",{className:"text-gray-600",children:"Renkler konusunda çok başarılısın!"})]}),u.jsx("div",{className:"bg-gray-50 rounded-lg p-6 mb-6",children:u.jsxs("div",{className:"text-center",children:[u.jsxs("div",{className:"text-4xl font-bold text-purple-600 mb-2",children:[y,"/",V]}),u.jsx("div",{className:"text-sm text-gray-600",children:"Doğru Renk"})]})}),u.jsxs(Nt,{onClick:he,size:"lg",children:[u.jsx(Ys,{className:"h-5 w-5 mr-2"}),"Tekrar Oyna"]})]})}):L==="loading"||!l?u.jsx(ut,{className:"max-w-2xl mx-auto",children:u.jsxs(dt,{className:"text-center py-12",children:[u.jsx("div",{className:"w-16 h-16 border-4 border-purple-500 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),ce&&o?u.jsxs("div",{className:"space-y-2",children:[u.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[u.jsx(Ft,{className:"h-5 w-5 text-purple-600"}),u.jsx("p",{className:"text-gray-600",children:"AI renk sorusu üretiyor..."})]}),u.jsx("p",{className:"text-sm text-gray-500",children:"Performansına göre uyarlanıyor"})]}):u.jsx("p",{className:"text-gray-600",children:"Renk sorusu hazırlanıyor..."})]})}):u.jsxs("div",{className:"max-w-2xl mx-auto space-y-6",children:[u.jsx(ut,{children:u.jsxs(dt,{children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsxs("div",{className:"text-sm text-gray-600",children:["Soru ",_,"/",V]}),u.jsxs("div",{className:"text-sm font-medium text-gray-800",children:["Skor: ",y]}),o&&l?.difficulty&&u.jsx("div",{className:`text-xs px-2 py-1 rounded-full ${l.difficulty==="easy"?"bg-green-100 text-green-700":l.difficulty==="medium"?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"}`,children:l.difficulty==="easy"?"Kolay":l.difficulty==="medium"?"Orta":"Zor"})]}),u.jsxs("div",{className:"flex items-center space-x-2",children:[o&&u.jsx("div",{title:"AI Powered",children:u.jsx(Ft,{className:"h-4 w-4 text-purple-600"})}),u.jsx(br,{className:"h-4 w-4 text-gray-600"}),u.jsxs("span",{className:`font-medium ${j<=10?"text-red-600":"text-gray-800"}`,children:[j,"s"]})]})]}),o&&me&&u.jsx("div",{className:"mt-3 p-2 bg-blue-50 rounded-lg",children:u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx(Ft,{className:"h-4 w-4 text-blue-600"}),u.jsx("p",{className:"text-sm text-blue-700",children:me})]})})]})}),u.jsx(ut,{children:u.jsxs(dt,{className:"text-center py-8",children:[u.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-8",children:l.question}),u.jsx("div",{className:"grid grid-cols-2 gap-6 max-w-md mx-auto",children:l.options.map((G,re)=>{let C="w-24 h-24 text-6xl hover:scale-110 transition-transform rounded-full border-4";return L==="answered"?re===l.correctAnswer?C+=" border-green-500 shadow-lg shadow-green-200":re===m&&re!==l.correctAnswer?C+=" border-red-500 shadow-lg shadow-red-200":C+=" opacity-50 border-gray-300":C+=" border-gray-300 hover:border-gray-400",u.jsx("button",{className:C,onClick:()=>we(re),disabled:L!=="playing",children:G},re)})}),L==="answered"&&u.jsx("div",{className:"mt-8",children:m===l.correctAnswer?u.jsxs("div",{className:"flex items-center justify-center space-x-2 text-green-600",children:[u.jsx(ts,{className:"h-6 w-6"}),u.jsx("p",{className:"text-lg font-medium",children:"Harika! Doğru renk! 🌈"})]}):u.jsx("p",{className:"text-lg font-medium text-red-600",children:"Yanlış renk. Tekrar deneyelim! 🎨"})})]})})]})};class ND{async generateAttentionSprint(e){const{performansOzeti:t,studentAge:a,sonGorevler:o=[],forcedDifficulty:l,emotionData:d}=e,m=l||this.determineDifficulty(t);l&&console.log("👤 [USER CHOICE] Kullanıcının seçtiği zorluk kullanılıyor:",l);const p=this.determineTaskVariety(o),y=this.buildAttentionSprintPrompt(t,a,m,p,d);console.log("📝 [AI PROMPT FULL]",{hasEmotionData:!!d,promptLength:y.length,emotionDataLength:d?.length||0,preview:d?`${JSON.parse(d).length} emotions`:"no emotions"}),console.log("📄 [AI PROMPT TEXT]"),console.log("=".repeat(80)),console.log(y),console.log("=".repeat(80));try{console.log("🎯 [ATTENTION SPRINT] Görev üretiliyor:",{difficulty:m,performansOzeti:t});const x=await this.callOllama(y),_=this.parseSprintResponse(x,m);return console.log("✅ [ATTENTION SPRINT] Görev üretildi:",_.gorev),_}catch(x){return console.error("❌ [ATTENTION SPRINT] Görev üretme hatası:",x),this.getFallbackTask(m,a)}}determineDifficulty(e){const{basariOrani:t,odaklanmaDurumu:a,ortalamaReaksiyonSuresi:o,son3Tur:l,sayiGorevPerformansi:d,zamanlamaPerformansi:m}=e,p=l.filter(j=>j.hizliCozum).length,y=l.some(j=>j.hedefTipi==="sayi"),x=l.some(j=>j.hedefZaman!==null),_=m?.ortalamaSapma||0,w=m?.idealZamanlamaOrani||0;if(console.log("📊 [ADAPTIVE DIFFICULTY]",{basariOrani:t,ortalamaReaksiyonSuresi:o,hizliCozumSayisi:p,sayiGoreviVarMi:y,zamanlamaGoreviVarMi:x,ortalamaSapma:_,idealZamanlamaOrani:w,sayiGorevPerformansi:d,zamanlamaPerformansi:m}),console.log("🔍 [DIFFICULTY DEBUG]",{"Test 1 (Süper)":t>=.8&&(p>=2||o<2.5),"Test 2 (İyi)":t>=.7&&(p>=1||o<4),"Test 3 (Yavaş)":t>=.8&&o<6,"Test 4 (Zayıf)":t<.5||o>8,conditions:{"basariOrani >= 0.8":t>=.8,"hizliCozumSayisi >= 2":p>=2,"ortalamaReaksiyonSuresi < 2.5":o<2.5}}),p>=2&&t>=.8&&o<2)return console.log("🚀 [DIFFICULTY] Süper hızlı - 2x atlama!"),"zor";if(d&&y){const j=this.evaluateNumberTaskPerformance(d,l);if(j.zorlukArtisi>1)return console.log(`🔢 [DIFFICULTY] Sayı görevi adaptasyonu: +${j.zorlukArtisi}`),j.onerilen}if(x&&m){if(w>=.8&&_<=.5)return console.log("🎯 [DIFFICULTY] Mükemmel zamanlama (sapma ≤0.5s) - ZOR seviye!"),"zor";if(w>=.6&&_<=1.5)return console.log("⏱️ [DIFFICULTY] İyi zamanlama (sapma ≤1.5s) - ORTA seviye!"),"orta";if(w>=.4&&_<=3)return console.log("⏰ [DIFFICULTY] Orta zamanlama (sapma ≤3s) - KOLAY/ORTA seviye!"),t>=.7?"orta":"kolay";if(_>3)return console.log("❌ [DIFFICULTY] Kötü zamanlama (sapma >3s) - KOLAY seviye!"),"kolay"}return t>=.8&&(p>=2||o<2.5)?(console.log("🔥 [DIFFICULTY] Süper performans - ZOR seviye!"),"zor"):t>=.7&&(p>=1||o<4)?(console.log("⬆️ [DIFFICULTY] İyi performans - ORTA seviye!"),"orta"):t>=.8&&o<6?(console.log("🐌 [DIFFICULTY] Yavaş ama başarılı - ORTA seviye!"),"orta"):t<.5||o>8?(console.log("📉 [DIFFICULTY] Zayıf performans - KOLAY seviye!"),"kolay"):(console.log("🎯 [DIFFICULTY] Varsayılan - ORTA seviye!"),"orta")}determineTaskVariety(e){if(e.length===1){const m=e[0];if(m==="sayma")return console.log("🎨 [VARIETY] Özel istek: Sayma oyunu"),"sayma";if(m==="dinamik-tıklama")return console.log("🎨 [VARIETY] Özel istek: Dinamik tıklama oyunu"),"dinamik-tıklama";if(m==="tıklama"||m==="tek-tıklama")return console.log("🎨 [VARIETY] Özel istek: Normal tıklama oyunu"),"tek-tıklama"}const t=e.map(m=>this.analyzeTaskType(m)),o=["renk-tıklama","şekil-tıklama","sayma","bekleme","kombinasyon","dinamik-sayma","dinamik-tıklama","sayı-tıklama"].map(m=>({tip:m,sayi:t.filter(p=>p===m).length})),l=o.filter(m=>m.sayi===Math.min(...o.map(p=>p.sayi))),d=l[Math.floor(Math.random()*l.length)];return console.log("🎨 [VARIETY] Son görevler:",t,"→ Önerilen tip:",d.tip),d.tip}analyzeTaskType(e){const t=e.toLowerCase();if(t.includes("say")||t.includes("count")||t.includes("adet"))return t.includes("tüm")||t.includes("saniye içinde")?"dinamik-sayma":"sayma";if(t.includes("tüm")&&t.includes("tıkla")&&(t.includes("saniye")||t.includes("dakika")))return"dinamik-tıklama";if(t.includes("bekle")||t.includes("wait")||t.includes("sessiz")||t.includes("dur"))return"bekleme";if(["1","2","3","4","5","6","7","8","9"].some(y=>t.includes(y)&&t.includes("tıkla")))return"sayı-tıklama";const l=["kırmızı","mavi","yeşil","sarı","mor","turuncu"],d=["daire","kare","üçgen","yıldız","kalp","elmas"],m=l.some(y=>t.includes(y)),p=d.some(y=>t.includes(y));return m&&p?"kombinasyon":m?"renk-tıklama":p?"şekil-tıklama":"renk-tıklama"}getTaskExamplesForType(e,t){const a={"renk-tıklama":{kolay:['"🔴 Kırmızı butona 2 saniye sonra bas"','"🔵 Mavi daire görünce hemen tıkla"','"🟢 Yeşil rengi gördüğünde bas"'],orta:['"🔴 3 saniye bekle, sonra kırmızı daire tıkla"','"🔵 Mavi renk çıktığında hızlıca bas"','"🟡 Sarı butonu gördüğün anda tıkla"'],zor:['"🔴 Kırmızı hedef çıktığında 1 saniye içinde bas"','"🔵 Mavi objesi belirdiğinde çok hızlı tıkla"','"🟢 Yeşil hedef görünür görünmez bas"']},"şekil-tıklama":{kolay:['"⭐ Yıldızı gördüğünde tıkla"','"🔺 Üçgen çıktığında bas"','"⭕ Daire görünce hemen tıkla"'],orta:['"⭐ Yıldız belirdiğinde 2 saniye içinde bas"','"🔺 Üçgen hedefe odaklan ve tıkla"','"💎 Elmas şeklini gördüğünde bas"'],zor:['"⭐ Yıldız çıktığında anında tıkla"','"🔺 Üçgen hedefini çok hızlı yakala"','"💎 Elmas görünür görünmez bas"']},sayma:{kolay:['"🔵 Mavi karelerin sayısını bul"','"⭐ Yıldızları say"','"🔴 Kırmızı daireleri hesapla"'],orta:['"🟢 Yeşil üçgenleri dikkatli say"','"🔵 Mavi şekillerin toplam sayısını bul"','"⭐ Sarı yıldızları say ve say"'],zor:['"🔺 Hızlı çıkan kırmızı üçgenleri say"','"🟦 Mavi kareleri çabuk hesapla"','"⭐ Parlayan yıldızları hızla say"']},bekleme:{kolay:['"⏰ 3 saniye sessizce bekle"','"🤫 5 saniye hareketsiz dur"','"⏳ 4 saniye sakin ol"'],orta:['"⏰ 6 saniye bekle, sonra başla"','"🧘 8 saniye nefes al ve bekle"','"⏳ 7 saniye odaklan ve dur"'],zor:['"⏰ 10 saniye tam konsantre bekle"','"🧘 12 saniye hiç hareket etme"','"⏳ 15 saniye mükemmel bekleme"']},kombinasyon:{kolay:['"🔴 Kırmızı daireyi tıkla"','"🔵 Mavi üçgeni bul ve bas"','"🟢 Yeşil kareyi hedefle"'],orta:['"🔴 Kırmızı yıldızı 3 saniye sonra tıkla"','"🔵 Mavi kalbi gördüğünde bas"','"🟡 Sarı elmasını yakala"'],zor:['"🔴 Kırmızı üçgeni çok hızlı yakala"','"🔵 Mavi kareyi anında tıkla"','"🟢 Yeşil yıldızı 1 saniyede bas"']},"dinamik-sayma":{kolay:['"15 saniye içinde çıkan mavi daireleri say"','"20 saniye boyunca gelen yıldızları hesapla"','"12 saniye içinde beliren şekilleri say"'],orta:['"25 saniye içinde gelen kırmızı üçgenleri say"','"30 saniye boyunca çıkan mavi kareleri hesapla"','"20 saniye içinde beliren yeşil daireleri say"'],zor:['"35 saniye içinde hızlı çıkan hedefleri say"','"40 saniye boyunca değişken objeleri hesapla"','"30 saniye içinde karışık şekilleri say"']},"dinamik-tıklama":{kolay:['"20 saniye içinde tüm 🔵 mavi daireleri tıkla"','"25 saniye içinde tüm 🟡 sarı yıldızları tıkla"','"15 saniye içinde tüm 🟢 yeşil kareleri tıkla"'],orta:['"35 saniye içinde tüm 🔺 kırmızı üçgenleri tıkla"','"40 saniye içinde tüm 🟦 mavi kareleri tıkla"','"30 saniye içinde tüm 🟢 yeşil daireleri tıkla"'],zor:['"50 saniye içinde tüm 🔺 kırmızı üçgenleri tıkla"','"60 saniye içinde tüm 🟡 sarı yıldızları tıkla"','"45 saniye içinde tüm 💜 mor kalpleri tıkla"']},"sayı-tıklama":{kolay:['"3️⃣ 3 sayısını gördüğünde tıkla"','"5️⃣ 5 rakamına bas"','"2️⃣ 2 sayısını yakala"'],orta:['"7️⃣ 7 rakamını 2 saniye sonra tıkla"','"4️⃣ 4 sayısını hızlıca yakala"','"6️⃣ 6 rakamını gördüğünde bas"'],zor:['"9️⃣ 9 sayısını çok hızlı yakala"','"8️⃣ 8 rakamını anında tıkla"','"1️⃣ 1 sayısını görür görmez bas"']}};return(a[e]?.[t]||a["renk-tıklama"][t]).join(`
`)}buildAttentionSprintPrompt(e,t,a,o,l){const d=this.formatPerformanceForPrompt(e),m=this.getTaskExamplesForType(o,a),p=`ADHD'li 12 yaş çocuk için Dikkat Sprintleri görevi üret. SADECE JSON döndür.

ÖNERİLEN GÖREV TİPİ: ${o} (çeşitlilik için)

TİP BAZLI ÖRNEKLER:
${m}

HEDEF KITLE:
- Yaş: 12 (ortaokul seviyesi)
- ADHD özellik: Kısa dikkat süresi, hiperaktivite, impulse kontrol zorluğu
- Motivasyon: Görsel ödüller, hızlı geri bildirim, başarı hissi

${l?`KAMERA VERİSİ - TÜM DUYGUSAL DURUMLAR (Oyun süresince):
${l}

DİKKAT: Bu emotion data'dan çok boyutlu analiz yap:

DUYGUSAL DURUM ANALİZİ:
- Hangi duygu baskın? Son trend nasıl?
- Emotion stabilite: Sabit mi değişken mi?
- Pozitif/negatif emotion dengesi?

ÖĞRENME STİLİ ÇIKARIMI:
- confused→happy geçişi = Yavaş öğrenen ama başarılı mı?
- happy→bored pattern = Hızla sıkılan, challenge isteyen mi?
- surprised spike'ları = Yenilikçi görevleri seven mi?

MOTİVASYON/STRES ANALİZİ:
- İçsel motivasyon: happy/neutral dominant mı?
- Frustration tolerance: angry/confused nasıl?
- Kaygı seviyesi: emotion volatility yüksek mi?

ATTENTION SPAN PATTERNİ:
- Emotion değişim hızı = Dikkat süresi ipucu
- Bored'a kadar geçen süre = Natural attention span
- Cognitive load: neutral→confused geçiş noktası

Bu analizlere göre en uygun görev stratejisini belirle:

Bu analizine göre çocuğun mevcut duygusal durumuna uygun görev üret:
- Mutlu/heyecanlı ise: Momentum sürdürecek, biraz daha zorlayıcı görevler
- Kafa karışık/yorgun ise: Basit, net talimatlar, daha az dikkat dağıtıcı
- Odaklanmış ise: Bu durumu koruyacak dengeli görevler
- Stresli/sinirli ise: Sakinleştirici, pozitif, başarıya odaklı görevler

İpuçlarını da bu duygusal duruma göre ayarla.`:""}

GÖREV KURALLARI:
- Süre: 30-60 saniye (ADHD için kısa)
- Tek odak: Sadece 1 şey yap (çoklu görev yok)
- Net talimat: Basit, anlaşılır komutlar
- Görsel zengin: Renkler, şekiller, emojiler kullan
- Olumlu dil: "Yapma" yerine "Yap" kalıbı
- Duygu durumuna uygun ipuçları ve zorluk seviyesi ayarla
${o==="sayma"?'- ÖNEMLİ: SADECE SAYMA GÖREVİ ÜRETİN! "tıkla", "bas", "yakala" gibi eylemler YOK. Sadece "say", "hesapla", "bul" kullanın.':""}

ZORLUK SEVİYESİ: ${a}

PERFORMANS ÖZETİ:
${d}

${e.attentionMetrics?`
DETAYLI DİKKAT METRİKLERİ:
- Oyun süresi: ${e.attentionMetrics.totalGameTime.toFixed(1)}s
- Ekrana bakma: %${e.attentionMetrics.screenLookingPercentage.toFixed(1)}
- Dikkat skoru: ${e.attentionMetrics.attentionScore.toFixed(1)}/100
- Baskın duygu: ${e.attentionMetrics.dominantEmotion}
- Dikkat dağılması: ${e.attentionMetrics.distractionEvents} kez
- Emotion dağılımı: ${e.attentionMetrics.emotionStats.map(y=>`${y.emotion}(${y.percentage.toFixed(1)}%)`).join(", ")}

Bu metrikleri de göz önünde bulundurarak çocuğun GERÇEK odaklanma seviyesini sen belirle:
- Başarı oranı + Dikkat skoru + Ekrana bakma + Emotion pattern + Dikkat dağılması
- "yuksek", "orta" veya "dusuk" olarak değerlendir
`:""}

ÇIKTI ŞEMASI:
{
  "gorev": string, // ÖRNERİLEN TİPE GÖRE: ${o==="sayma"?'"🔴 Kırmızı daireleri say"':o==="tek-tıklama"?'"🔴 Kırmızı daire çıktığında tıkla"':o==="dinamik-tıklama"?'"30 saniye içinde tüm 🔴 kırmızı daireleri tıkla"':'"3 saniye bekle, sonra 🔴 kırmızı daire tıkla"'}
  "sure_saniye": number, // 30-60 arası
  "ipuclari": [string], // Max 2 ipucu, kısa ve net, duygusal duruma uygun
  "hedefRenk": string, // Varsa: "kırmızı", "mavi" vs
  "hedefSayi": number, // Varsa: sayma görevi için
  "hedefSekil": string, // Varsa: "daire", "kare" vs
  "dikkatDagitici": number, // 0-1 arası (0=yok, 1=maksimum)

  // EMOTION ANALİZİNE GÖRE OYUN PARAMETRELERİ:
  "gameParams": {
    "spawnInterval": number, // 1500-4000ms - Kısa attention span = düşük değer, confused'dan kaçın
    "objectLifespan": number, // 3000-8000ms - Yavaş reaction = yüksek değer, stressed ise uzat
    "targetRatio": number, // 0.3-0.8 - Düşük frustration tolerance = yüksek ratio (kolay)
    "visualComplexity": number, // 0.2-1.0 - Confused/overwhelmed ise düşür, happy/confident ise artır
    "feedbackFrequency": number // 0.5-3.0 - Low motivation = sık feedback, high confidence = az feedback
  }
}

12 YAŞ İÇİN GÖREV ÖRNEKLERİ (ÖNERİLEN TİP: ${o}):
${o==="sayma"?`- "🔴 Kırmızı daireleri say"
- "🟢 Yeşil kareleri hesapla"
- "⭐ Yıldızların sayısını bul"
- "🔵 Mavi şekilleri say"
- "🟡 Sarı objeleri hesapla"`:o==="tek-tıklama"?`- "🔴 Kırmızı daire çıktığında tıkla"
- "🔵 Mavi kare belirdiğinde bas"
- "🟢 Yeşil yıldız gördüğünde tıkla"
- "🟡 Sarı üçgen görünce bas"
- "⭐ Yıldız şekli çıktığında tıkla"`:o==="dinamik-tıklama"?`- "30 saniye içinde tüm 🔴 kırmızı daireleri tıkla"
- "25 saniye içinde tüm 🔵 mavi kareleri yakala"
- "35 saniye içinde tüm 🟢 yeşil yıldızları tıkla"`:`- "🔴 Kırmızı butona 2 saniye sonra bas"
- "🟢 Yeşil kareler sayısını bul"
- "👀 Mavi ⭐ yıldızları takip et"
- "⏰ 5 saniye sessizce bekle"
- "🎯 Ortadaki hedefe odaklan"`}

YAPMA:
- Uzun açıklamalar
- Karmaşık çoklu adımlar
- Olumsuz kelimeler
- Soyut kavramlar

ZORUNLU KURALLAR DİNAMİK TIKLAMA İÇİN:
- Süre MUTLAKA belirt: "30 saniye içinde" formatında
- Renk MUTLAKA emoji ile: 🔴 kırmızı, 🔵 mavi, 🟢 yeşil, 🟡 sarı
- Şekil MUTLAKA spesifik: daire, kare, üçgen, yıldız, kalp, elmas
- Örnek: "45 saniye içinde tüm 🔵 mavi daireleri tıkla"
- "hedefRenk" ve "hedefSekil" alanları MUTLAKA doldur`;return console.log("🤖 [AI PROMPT] ============================================================================="),console.log(p),console.log("🤖 [AI PROMPT END] ========================================================================"),p}formatPerformanceForPrompt(e){const{son3Tur:t,basariOrani:a,ortalamaReaksiyonSuresi:o,odaklanmaDurumu:l,sayiGorevPerformansi:d}=e,m=t.map((y,x)=>`Tur ${x+1}: ${y.basari?"Başarılı":"Başarısız"} - ${y.sure}s - ${y.zorluk}`).join(`
`);let p="";return d&&d.hedefYakalamaOrani!==void 0&&d.toplamHedefSayisi!==void 0&&(p=`

HEDEF YAKALAMA METRİKLERİ:
- Hedef Yakalama Oranı: ${Math.round((d.hedefYakalamaOrani||0)*100)}%
- Yakalanan Hedefler: ${d.yakalinanHedefSayisi||0}/${d.toplamHedefSayisi||0}
- Yanlış Tıklamalar: ${d.yanlisTiklamaSayisi||0}

HIZLI TIKLAMA ANALİZİ (ADHD İÇİN ÖNEMLİ) - KÜMÜLATIF PERFORMANS:
- Genel Hızlı Tıklama Oranı: ${d.hizliTiklamaOrani?Math.round(d.hizliTiklamaOrani*100):0}% (3 saniye altı)
- Toplam Hızlı Tıklamalar: ${d.hizliTiklamaSayisi||0}/${d.toplamTiklamaSayisi||0}
- Toplam Hızlı+Doğru Tıklamalar: ${d.hizliVeDogruTiklamalar||0}
- Genel Hızlı Tıklama Doğruluğu: ${d.hizliTiklamaDogrulukOrani?Math.round(d.hizliTiklamaDogrulukOrani*100):0}%

SON ROUND HIZLI TIKLAMA PERFORMANSI:
- Son Round Hızlı Tıklama Oranı: ${d.sonRoundHizliTiklamaOrani?Math.round(d.sonRoundHizliTiklamaOrani*100):0}%
- Son Round Hızlı Tıklamalar: ${d.sonRoundHizliTiklamaSayisi||0}/${d.sonRoundToplamTiklamaSayisi||0}
- Son Round Hızlı+Doğru: ${d.sonRoundHizliVeDogruTiklamalar||0}
- Son Round Hızlı Tıklama Doğruluğu: ${d.sonRoundHizliTiklamaDogrulukOrani?Math.round(d.sonRoundHizliTiklamaDogrulukOrani*100):0}%`),`Son 3 Tur:
${m}

Genel Durum:
- Başarı Oranı: ${Math.round(a*100)}%
- Ortalama Reaksiyon: ${o.toFixed(1)}s
- Odaklanma: ${l}${p}`}async callOllama(e){const o=await fetch("http://localhost:11434/api/generate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:"hf.co/umutkkgz/Kaira-Turkish-Gemma-9B-T1-GGUF:Q3_K_M",prompt:e,format:"json",stream:!1,options:{temperature:.7,top_p:.9,num_predict:250}})});if(!o.ok)throw new Error(`Ollama API hatası: ${o.status}`);return(await o.json()).response?.trim()||""}parseSprintResponse(e,t){try{const a=JSON.parse(e);if(!a.gorev||typeof a.gorev!="string")throw new Error("Geçersiz görev");const o={id:`sprint_${Date.now()}_${Math.random().toString(36).substr(2,6)}`,gorev:a.gorev,sure_saniye:Math.max(30,Math.min(60,a.sure_saniye||45)),ipuclari:Array.isArray(a.ipuclari)?a.ipuclari.slice(0,2):[],hedefRenk:a.hedefRenk||void 0,hedefSayi:a.hedefSayi||void 0,hedefSekil:a.hedefSekil||void 0,dikkatDagitici:Math.max(0,Math.min(1,a.dikkatDagitici||0)),difficulty:t,hedefTipi:this.determineTargetType(a)},l=this.validateAndCorrectTask(o);return console.log("🔍 [AI TASK] Orijinal görev:",a),console.log("✅ [AI TASK] Düzeltilmiş görev:",l),l}catch(a){throw console.error("Sprint response parse hatası:",a),new Error(`JSON parse hatası: ${a}`)}}getFallbackTask(e,t){const o={kolay:[{gorev:"🔴 Kırmızı butona bas",sure_saniye:30,ipuclari:["Kırmızı rengi ara","Büyük buton olacak"],hedefRenk:"kırmızı",dikkatDagitici:0},{gorev:"⭐ Yıldızları say",sure_saniye:35,ipuclari:["Sarı yıldızları bul","Parmakla işaret et"],hedefSekil:"yıldız",dikkatDagitici:0}],orta:[{gorev:"🟢 Yeşil kareler sayısını bul",sure_saniye:45,ipuclari:["Sadece yeşil olanlar","Sessizce say"],hedefRenk:"yeşil",hedefSekil:"kare",dikkatDagitici:.3},{gorev:"🎯 Ortadaki hedefe 3 saniye odaklan",sure_saniye:40,ipuclari:["Gözlerini hedeften ayırma","Nefes al"],dikkatDagitici:.5}],zor:[{gorev:"🔵 Mavi daireler gözükünce hızla tıkla",sure_saniye:50,ipuclari:["Hazır ol","Hızlı reaksiyon göster"],hedefRenk:"mavi",hedefSekil:"daire",dikkatDagitici:.7},{gorev:"🟡⭐ Sarı yıldızları takip et ve say",sure_saniye:55,ipuclari:["Hareket eden yıldızları takip et","Sayıyı unutma"],hedefRenk:"sarı",hedefSekil:"yıldız",dikkatDagitici:.8}]}[e],l=o[Math.floor(Math.random()*o.length)];return{id:`fallback_sprint_${Date.now()}`,...l,difficulty:e,hedefTipi:l.hedefRenk?"renk":l.hedefSekil?"sekil":l.hedefSayi?"sayi":"genel"}}determineTargetType(e){return e.hedefRenk&&e.hedefSekil||e.hedefRenk?"renk":e.hedefSekil?"sekil":e.hedefSayi?"sayi":"genel"}validateAndCorrectTask(e){const t=e.gorev.toLowerCase(),a=["kırmızı","mavi","yeşil","sarı","mor","turuncu"].find(m=>t.includes(m)),o=["yıldız","daire","kare","üçgen","kalp","elmas"].find(m=>t.includes(m));let l=null;if(t.includes("tane")||t.includes("adet")||t.includes("say")){const m=t.match(/(\d+)\s*(tane|adet|say)/);l=m?parseInt(m[1]):null}else if(t.includes("numar")||t.includes("rakam")){const m=t.match(/(\d+)\s*(numar|rakam)/);l=m?parseInt(m[1]):null}console.log("🔍 [TEXT ANALYSIS]",{görev:e.gorev,detectedColors:a,detectedShapes:o,detectedNumbers:l,originalTask:{hedefRenk:e.hedefRenk,hedefSekil:e.hedefSekil,hedefSayi:e.hedefSayi}});const d={...e};return a&&o?(console.log(`🔧 [TASK FIX] Karma hedef: ${a} ${o}`),d.hedefRenk=a,d.hedefSekil=o,d.hedefSayi=void 0,d.gorev=d.gorev.replace(/(\d+)\s*(tane|adet)/g,"").replace(/\s+/g," ").trim()):a&&!o?(console.log(`🔧 [TASK FIX] Sadece renk: ${a}`),d.hedefRenk=a,d.hedefSekil=void 0,d.hedefSayi=void 0,d.gorev=d.gorev.replace(/(\d+)\s*(tane|adet)/g,"").replace(/\s+/g," ").trim()):o&&!a&&(console.log(`🔧 [TASK FIX] Sadece şekil: ${o}`),d.hedefSekil=o,d.hedefRenk=void 0,d.hedefSayi=void 0,d.gorev=d.gorev.replace(/(\d+)\s*(tane|adet)/g,"").replace(/\s+/g," ").trim()),l&&(!e.hedefSayi||e.hedefSayi!==l)?(console.log(`🔧 [TASK FIX] Sayı düzeltmesi: ${e.hedefSayi} → ${l}`),d.hedefSayi=l,d.hedefRenk=void 0,d.hedefSekil=void 0):e.hedefSayi&&!l&&(a||o)&&(console.log(`🔧 [TASK FIX] Yanlış sayı temizleme: hedefSayi ${e.hedefSayi} silindi`),d.hedefSayi=void 0,d.gorev=d.gorev.replace(/(\d+)\s*(tane|adet)/g,"").replace(/\s+/g," ").trim()),d}evaluateNumberTaskPerformance(e,t){const{ortalamaSayiZorlugu:a,sayiBasariOrani:o,ortalamaReaksiyonSuresiSayi:l,hizliCozumSayisi:d}=e,m=t.filter(x=>x.hedefTipi==="sayi");m[m.length-1];let p=0,y="orta";return d>=2&&l<2?(p=3,y="zor"):o>=.8&&l<4?(p=2,y=a<5?"orta":"zor"):o>=.6&&l<6?(p=1,y="orta"):(o<.5||l>8)&&(p=-1,y="kolay"),{zorlukArtisi:p,onerilen:y}}determineNumberDifficulty(e,t,a){const l=Math.max(1,Math.min(3,(e==="kolay"?1:e==="orta"?2:3)+a)),d={1:{min:1,max:3},2:{min:2,max:5},3:{min:3,max:7},4:{min:5,max:9}};return d[Math.min(4,l)]||d[2]}}const Xd=new ND;class RD{constructor(){this.emotions=[],this.gameStartTime=0,this.lastAnalysisTime=0,this.currentGameSession=[],this.currentRoundSession=[],this.isGameActive=!1,this.roundStartTime=0}startGameSession(){this.gameStartTime=Date.now(),this.currentGameSession=[],this.lastAnalysisTime=this.gameStartTime,this.isGameActive=!0,console.log("🎮 [EMOTION] Oyun seansı başladı, emotion tracking aktif")}startRoundSession(){this.roundStartTime=Date.now(),this.currentRoundSession=[],console.log("🔄 [EMOTION] Round seansı başladı, round emotion tracking aktif")}addEmotionResult(e){if(!this.isGameActive){console.log("⏸️ [EMOTION] Oyun aktif değil, emotion kaydedilmiyor");return}this.emotions.push(e),this.currentGameSession.push(e),this.currentRoundSession.push(e),console.log("📥 [EMOTION ADDED]",{emotion:e.emotion,confidence:(e.confidence*100).toFixed(1)+"%",gazeStatus:e.gazeStatus,lookingAtScreen:e.lookingAtScreen,gameActive:this.isGameActive,gameTotal:this.currentGameSession.length,roundTotal:this.currentRoundSession.length,timestamp:new Date(e.timestamp).toLocaleTimeString()});const t=this.currentRoundSession[this.currentRoundSession.length-2];(!t||t.emotion!==e.emotion)&&console.log(`😊 [EMOTION] ${e.emotion} (${(e.confidence*100).toFixed(1)}%) - ${e.gazeStatus} [Round: ${this.currentRoundSession.length}]`)}getCurrentGameMetrics(){if(this.currentGameSession.length===0)return this.getEmptyMetrics();const e=(Date.now()-this.gameStartTime)/1e3,t=this.groupEmotionsByType(this.currentGameSession),a=this.currentGameSession.filter(x=>x.lookingAtScreen),o=e/this.currentGameSession.length,l=a.length*o,d=l/e*100;console.log("👁️ [SCREEN LOOKING DEBUG]",{totalEmotions:this.currentGameSession.length,lookingEmotions:a.length,totalGameTime:e.toFixed(1)+"s",avgEmotionDuration:o.toFixed(1)+"s",screenLookingTime:l.toFixed(1)+"s",screenLookingPercentage:d.toFixed(1)+"%",calculationCheck:`${a.length}/${this.currentGameSession.length} = ${(a.length/this.currentGameSession.length*100).toFixed(1)}%`,sampleEmotions:this.currentGameSession.slice(-3).map(x=>({emotion:x.emotion,lookingAtScreen:x.lookingAtScreen,timestamp:new Date(x.timestamp).toLocaleTimeString()}))});const m=this.getDominantEmotion(t),p=this.calculateAttentionScore(d,m,this.countDistractionEvents());return{totalGameTime:e,screenLookingTime:l,screenLookingPercentage:d,emotionStats:this.formatEmotionStats(t,e),dominantEmotion:m,attentionScore:p,distractionEvents:this.countDistractionEvents()}}endGameSession(){const e=this.getCurrentGameMetrics();return this.isGameActive=!1,console.log("🏁 [EMOTION] Oyun seansı bitti",{totalTime:`${e.totalGameTime.toFixed(1)}s`,attentionScore:e.attentionScore,dominantEmotion:e.dominantEmotion,totalEmotions:this.currentGameSession.length}),e}groupEmotionsByType(e){return e.reduce((t,a)=>(t[a.emotion]||(t[a.emotion]=[]),t[a.emotion].push(a),t),{})}getDominantEmotion(e){let t=0,a="neutral";for(const[o,l]of Object.entries(e))l.length>t&&(t=l.length,a=o);return a}calculateAttentionScore(e,t,a){let o=0;o+=Math.min(e*.5,50),o+={happy:30,neutral:25,surprised:20,confused:15,bored:10,sad:5,angry:0}[t]||15;const d=Math.min(a*2,20);return o-=d,Math.max(0,Math.min(100,o))}countDistractionEvents(){let e=0,t=!0;for(const a of this.currentGameSession)t&&!a.lookingAtScreen&&e++,t=a.lookingAtScreen;return e}formatEmotionStats(e,t){const a=Object.values(e).reduce((o,l)=>o+l.length,0);return Object.entries(e).map(([o,l])=>{const d=l.length/a*100,m=l.filter(y=>y.lookingAtScreen),p=l.length>0?m.length/l.length*100:0;return{emotion:o,totalTime:l.length,lookingTime:m.length,percentage:d,lookingPercentage:p}}).sort((o,l)=>l.totalTime-o.totalTime)}getEmptyMetrics(){return{totalGameTime:0,screenLookingTime:0,screenLookingPercentage:0,emotionStats:[],dominantEmotion:"neutral",attentionScore:50,distractionEvents:0}}clearHistory(){this.emotions=[],this.currentGameSession=[],console.log("🗑️ [EMOTION] Emotion history temizlendi")}isGameActiveStatus(){return this.isGameActive}getCurrentRoundEmotions(){return[...this.currentRoundSession]}getFullGameEmotions(){return[...this.currentGameSession]}endRoundSession(){const e=[...this.currentRoundSession];return console.log("🏁 [EMOTION] Round seansı bitti",{roundEmotions:e.length,totalGameEmotions:this.currentGameSession.length,roundDuration:this.roundStartTime?`${((Date.now()-this.roundStartTime)/1e3).toFixed(1)}s`:"N/A"}),e}getRecentEmotionTrend(){const e=this.currentGameSession.slice(-10);if(e.length===0)return{emotion:"neutral",confidence:.5,lookingAtScreen:!0};const t={};let a=0,o=0;for(const d of e)t[d.emotion]=(t[d.emotion]||0)+1,d.lookingAtScreen&&a++,o+=d.confidence;return{emotion:Object.entries(t).sort(([,d],[,m])=>m-d)[0][0],confidence:o/e.length,lookingAtScreen:a/e.length>.5}}}const Tt=new RD;class CD{constructor(){this.performanceHistory=[],this.baseSettings={kolay:{speed:.8,objectCount:3,duration:20},orta:{speed:1,objectCount:4,duration:30},zor:{speed:1.5,objectCount:6,duration:40}}}calculateDifficultyAdjustment(e,t){console.log("🎯 [ADAPTIVE] Zorluk analizi başlıyor...",{currentDifficulty:e,accuracy:t.accuracy,attentionScore:t.attentionMetrics.attentionScore});const a=this.analyzeEmotionState(t.attentionMetrics),o=this.analyzeGamePerformance(t),l=this.analyzeAttentionLevel(t.attentionMetrics),d=this.calculateAdjustment(e,a,o,l);return this.performanceHistory.push(t),this.performanceHistory.length>5&&this.performanceHistory.shift(),console.log("✅ [ADAPTIVE] Zorluk ayarlaması tamamlandı:",{newDifficulty:d.newDifficulty,reason:d.reason,speedMultiplier:d.speedMultiplier}),d}analyzeEmotionState(e){const{dominantEmotion:t,attentionScore:a}=e;let o=0,l="neutral";o={happy:10,surprised:8,neutral:6,confused:4,bored:2,sad:1,angry:0}[t]||5,o>=8?l="positive":o>=4?l="neutral":l="negative";let m="maintain";return l==="positive"&&a>70?m="increase":l==="negative"||a<30?m="decrease":t==="bored"&&a>50&&(m="increase"),{score:o,type:l,recommendation:m}}analyzeGamePerformance(e){const{accuracy:t,avgReactionTime:a}=e;let o="average",l="maintain";return t>.8&&a<1.5?(o="excellent",l="increase"):t>.6&&a<2?(o="good",l="maintain"):t>.4||a<3?(o="average",l="maintain"):(o="poor",l="decrease"),{level:o,recommendation:l}}analyzeAttentionLevel(e){const{screenLookingPercentage:t,distractionEvents:a,attentionScore:o}=e;let l="medium",d="maintain";return t>80&&a<3&&o>70?(l="high",d="increase"):t>60&&a<5&&o>50?(l="medium",d="maintain"):(l="low",d="decrease"),{level:l,recommendation:d}}calculateAdjustment(e,t,a,o){const l=[t.recommendation,a.recommendation,o.recommendation],d=l.filter(B=>B==="increase").length,m=l.filter(B=>B==="decrease").length;let p=e,y="",x=[];d>=2?(e==="kolay"?p="orta":e==="orta"&&(p="zor"),y="Performansın mükemmel! Daha zorlu görevler deniyoruz 🎯",x=["Harika gidiyorsun! 🌟","Dikkatini toplamayı başarıyorsun","Daha hızlı objeler gelecek"]):m>=2?(e==="zor"?p="orta":e==="orta"&&(p="kolay"),y="Odaklanma konusunda zorluk yaşıyorsun. Daha kolay görevlerle devam edelim 💪",x=["Merak etme, adım adım öğreniyoruz","Nefes al ve odaklanmaya çalış","Objeler daha yavaş gelecek"]):(y="Performansın dengeli, mevcut zorlukta devam ediyoruz 👍",x=["İyi gidiyorsun!","Bu tempoda devam et","Dikkatini korumaya çalış"]);const _=this.baseSettings[p];let w=_.speed,j=_.objectCount;return t.type==="negative"?(w*=.8,j=Math.max(2,j-1)):t.type==="positive"&&o.level==="high"&&(w*=1.2,j=Math.min(8,j+1)),o.level==="low"&&(w*=.7,j=Math.max(2,j-1)),{newDifficulty:p,speedMultiplier:Number(w.toFixed(1)),objectCount:j,reason:y,suggestions:x}}formatForPrompt(e,t){const a=e.attentionMetrics;return`
DUYGU VE DİKKAT ANALİZİ:
- Baskın Duygu: ${a.dominantEmotion} (${a.emotionStats[0]?.percentage.toFixed(1)||"0"}% süre)
- Ekrana Bakma: %${a.screenLookingPercentage.toFixed(1)} (${a.screenLookingTime.toFixed(1)}s)
- Dikkat Skoru: ${a.attentionScore}/100
- Dikkat Dağılması: ${a.distractionEvents} kez ekrandan baktı
- Oyun Performansı: %${(e.accuracy*100).toFixed(1)} doğruluk, ${e.avgReactionTime.toFixed(1)}s ortalama tepki

ZORLUK AYARLAMA:
- Mevcut Zorluk → Yeni Zorluk: ${t.newDifficulty}
- Hız Çarpanı: ${t.speedMultiplier}x
- Sebep: ${t.reason}

ADHD İÇİN ÖPTİMİZASYON GEREKSİNİMLERİ:
${this.getADHDOptimizations(a,e)}`}getADHDOptimizations(e,t){const a=[];return e.screenLookingPercentage<60&&(a.push("- DİKKAT: Çok dikkat dağınıklığı var, daha büyük ve renkli objeler kullan"),a.push("- Görevde daha açık talimatlar ve görsel ipuçları ekle")),e.dominantEmotion==="bored"&&(a.push("- SIKINTI: Oyuncu sıkılmış, daha eğlenceli ve değişken görevler sun"),a.push("- Motivasyon artırıcı pozitif geri bildirimler kullan")),e.dominantEmotion==="confused"&&(a.push("- KARIŞIKLIK: Görevler karmaşık gelmiş, daha basit ve net talimatlar ver"),a.push("- Adım adım açıklamalar ve örnek göster")),t.accuracy<.5&&(a.push("- PERFORMANS: Başarı oranı düşük, daha kolay hedefler ve daha uzun süre ver"),a.push("- Pozitif teşvik ve cesaretlendirme mesajları ekle")),e.distractionEvents>5&&(a.push("- DİKKAT DAĞINIKLIGI: Çok sık ekrandan bakıyor, daha ilgi çekici görevler tasarla"),a.push("- Kısa süreli görevler ve sık ara verme imkanı sun")),a.length>0?a.join(`
`):"- Mevcut ayarlar ADHD için uygun görünüyor"}getRealtimeFeedback(e){return e.screenLookingPercentage<40?{message:"Ekrana odaklanmaya çalış! 👀",type:"warning",suggestion:"Gözlerini ekrandaki renklere odakla"}:e.dominantEmotion==="bored"?{message:"Sıkılıyor gibisin, devam et! 🎯",type:"info",suggestion:"Bu görev bittikten sonra daha eğlenceli bir görev gelecek"}:e.attentionScore>70?{message:"Harika odaklanıyorsun! 🌟",type:"success",suggestion:"Bu tempoda devam et"}:{message:"İyi gidiyorsun! 👍",type:"info",suggestion:"Dikkatini korumaya devam et"}}}const _p=new CD;class ID{constructor(){this.isActive=!1,this.isAnalysisActive=!1,this.pythonServerUrl="http://localhost:5000",this.pollInterval=null,this.videoRef=null,this.lastAnalysisTime=0,this.ANALYSIS_INTERVAL=5e3}async checkCameraAvailability(){try{return(await navigator.mediaDevices.getUserMedia({video:!0})).getTracks().forEach(t=>t.stop()),!0}catch(e){return console.log("📷 [CAMERA] Kamera erişimi yok:",e),!1}}async checkPythonServer(){try{return(await fetch(`${this.pythonServerUrl}/health`,{method:"GET",timeout:2e3})).ok}catch(e){return console.log("🐍 [PYTHON] Python server erişilemiyor:",e),!1}}async startEmotionTracking(e,t){if(console.log("🎭 [EMOTION] Real-time tracking başlatılıyor..."),!await this.checkCameraAvailability())return console.log("❌ [EMOTION] Kamera erişimi yok, mock mode kullanılacak"),!1;if(!await this.checkPythonServer())return console.log("❌ [EMOTION] Python server çalışmıyor, mock mode kullanılacak"),!1;try{const l=await navigator.mediaDevices.getUserMedia({video:{width:640,height:480,facingMode:"user"}});return e.srcObject=l,await e.play(),this.onEmotionCallback=t,this.isActive=!0,this.pollInterval=setInterval(()=>{this.captureAndAnalyzeFrame(e)},1e3),console.log("✅ [EMOTION] Real-time kamera tracking aktif"),!0}catch(l){return console.error("❌ [EMOTION] Kamera başlatma hatası:",l),!1}}async captureAndAnalyzeFrame(e){if(!this.isActive||!this.isAnalysisActive)return;if(!Tt.isGameActiveStatus()){console.log("⏸️ [CAMERA FRAME] Oyun aktif değil, frame analizi atlanıyor");return}const t=Date.now();if(this.lastAnalysisTime>0&&t-this.lastAnalysisTime<this.ANALYSIS_INTERVAL){console.log("⏱️ [TIMING] Analiz çok erken, atlanıyor",{timeSinceLastAnalysis:`${t-this.lastAnalysisTime}ms`,required:`${this.ANALYSIS_INTERVAL}ms`});return}this.lastAnalysisTime=t;try{const a=document.createElement("canvas");a.width=640,a.height=480;const o=a.getContext("2d");if(!o)return;o.drawImage(e,0,0,a.width,a.height);const l=a.toDataURL("image/jpeg",.8),d=await fetch(`${this.pythonServerUrl}/analyze_frame`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({frame:l.split(",")[1]})});if(d.ok){const m=await d.json(),p=this.convertToEmotionResult(m);console.log("✅ [FRAME ANALYSIS] Analiz tamamlandı",{emotion:p.emotion,confidence:`${(p.confidence*100).toFixed(1)}%`,gaze:p.gazeStatus,timeSinceLastAnalysis:`${Date.now()-this.lastAnalysisTime}ms`}),this.onEmotionCallback&&this.onEmotionCallback(p)}}catch(a){console.log("🔍 [FRAME] Frame analiz hatası:",a)}}async pollEmotionData(){if(this.isActive)try{const e=await fetch(`${this.pythonServerUrl}/emotion_data`,{method:"GET",headers:{"Content-Type":"application/json"}});if(e.ok){const t=await e.json(),a=this.convertToEmotionResult(t);this.onEmotionCallback&&this.onEmotionCallback(a)}}catch{}}convertToEmotionResult(e){const a={happy:"happy",sad:"sad",bored:"bored",confused:"confused",surprised:"surprised",angry:"angry",neutral:"neutral",focused:"neutral",frustrated:"angry"}[e.emotion]||"neutral";let o="no-face";const l=e.lookingAtScreen||e.looking_at_screen||!1;return e.faceDetected&&(o=l?"looking":"not-looking"),console.log("🔍 [GAZE MAPPING DEBUG]",{faceDetected:e.faceDetected,lookingAtScreen_snake:e.looking_at_screen,lookingAtScreen_camel:e.lookingAtScreen,finalLookingAtScreen:l,gazeStatus:o}),{emotion:a,confidence:e.confidence,timestamp:new Date,gazeStatus:o,gazeX:e.gaze_x,lookingAtScreen:l}}stopEmotionTracking(){console.log("⏹️ [EMOTION] Real-time tracking durduruluyor..."),this.isActive=!1,this.isAnalysisActive=!1,this.pollInterval&&(clearInterval(this.pollInterval),this.pollInterval=null),fetch(`${this.pythonServerUrl}/stop_camera`,{method:"POST",headers:{"Content-Type":"application/json"}}).catch(()=>{}),this.onEmotionCallback=void 0}startMockEmotionSimulation(e,t){console.log("🎭 [MOCK] Mock emotion simulation başlatılıyor...");let a="neutral",o=0;const l=()=>{if(!this.isActive)return;o+=1;const{correctClicks:d,wrongClicks:m,timeLeft:p,isPlaying:y}=t,x=d+m>0?d/(d+m):.5;y?x>.8&&d>5?a=Math.random()>.7?"happy":"neutral":x<.3&&m>3?a=Math.random()>.6?"confused":Math.random()>.5?"sad":"neutral":p<10&&x>.6?a=Math.random()>.7?"surprised":"neutral":o>30&&x<.5&&(a=Math.random()>.6?"bored":"neutral"):a="neutral";const w=!(Math.random()<.15),j={emotion:a,confidence:.7+Math.random()*.25,timestamp:new Date,gazeStatus:w?"looking":"not-looking",gazeX:w?320+(Math.random()-.5)*100:Math.random()*640,lookingAtScreen:w};e(j)};this.isActive=!0,this.pollInterval=setInterval(l,1e3),console.log("✅ [MOCK] Mock emotion simulation aktif")}startFrameAnalysis(){if(!this.isActive){console.log("⚠️ [CAMERA] Kamera bağlantısı yok, frame analizi başlatılamıyor");return}this.isAnalysisActive=!0,this.lastAnalysisTime=0,console.log("🎥 [CAMERA] Frame analizi başlatıldı, strict 5s timing aktif")}stopFrameAnalysis(){this.isAnalysisActive=!1,console.log("⏸️ [CAMERA] Frame analizi durduruldu")}isTrackingActive(){return this.isActive}isFrameAnalysisActive(){return this.isAnalysisActive}}const sn=new ID,jD=({studentId:s,studentAge:e=12,difficulty:t,onGameComplete:a,onEmotionDetected:o})=>{console.log("🎯 [AttentionClickGame] Component initialized with props:",{studentId:s,studentAge:e,difficulty:t});const[l,d]=k.useState(null),[m,p]=k.useState("ready"),[y,x]=k.useState(0),[_,w]=k.useState([]),[j,B]=k.useState(0),[L,D]=k.useState(0),[$,X]=k.useState([]),ne=k.useRef([]),[ce]=k.useState(Date.now()),[de,me]=k.useState(3),[O,N]=k.useState(!1),[R,P]=k.useState(!1),[V,I]=k.useState(!1),[A,we]=k.useState({x:50,y:50}),[se,q]=k.useState([]),[he,G]=k.useState(!1),[re,C]=k.useState(null),[Z,H]=k.useState(null),[Y,oe]=k.useState(""),[ge,be]=k.useState(0),[nt,We]=k.useState(0),[st,Re]=k.useState(0),[Me,kt]=k.useState(null),St=k.useRef(0),Qe=k.useRef(!1),jt=k.useRef(!1),rt=k.useRef(!1),$e=k.useRef(null),$t=k.useRef(null),at=5,zt=k.useCallback(async()=>{console.log("🎭 [EMOTION] Emotion tracking başlatılıyor..."),G(!0);const Pe=yt=>{if(!Tt.isGameActiveStatus())return;C(yt),Tt.addEmotionResult(yt);const Dt=Tt.getCurrentGameMetrics();H(Dt);const pe=_p.getRealtimeFeedback(Dt);oe(pe.message);const _e={emotion:yt.emotion,confidence:yt.confidence,timestamp:yt.timestamp};X(Ne=>{const De=[...Ne.slice(-10),_e];return ne.current=De,De}),o?.(_e)};let Fe=!1;$t.current&&(Fe=await sn.startEmotionTracking($t.current,Pe)),Fe||console.log("📱 [EMOTION] Gerçek kamera bulunamadı - Python server çalışıyor mu?"),console.log("✅ [EMOTION] Emotion tracking aktif")},[o]),Wt=k.useCallback(()=>{console.log("⏹️ [EMOTION] Emotion tracking durduruluyor..."),sn.stopEmotionTracking(),G(!1);const Pe=Tt.endGameSession();H(Pe),console.log("🏁 [EMOTION] Final metrics:",Pe)},[]);k.useEffect(()=>(!Qe.current&&!V&&(Qe.current=!0,fn()),()=>{$e.current&&(clearInterval($e.current),$e.current=null)}),[]);const fn=k.useCallback(async()=>{if(jt.current)return;jt.current=!0,I(!0);const Pe=_.reduce((ee,Te)=>ee+(Te.success?1:0),0),Fe=_.length,yt=Fe>0?Pe/Fe:.7,Dt=_.length>0?_.reduce((ee,Te)=>ee+Te.reactionTime,0)/_.length:2.5,pe=_.length>0?_.reduce((ee,Te)=>ee+Te.targetAppearanceDelay,0)/_.length:1.5,_e=_.reduce((ee,Te)=>ee+Te.distractorClicks,0),Ne=_.reduce((ee,Te)=>ee+Te.missedTargets,0),De=_.slice(-3).map(ee=>({basari:ee.success,sure:ee.reactionTime,zorluk:t,hedefTipi:"tek-tıklama",hizliCozum:ee.reactionTime<1.5,zamanlamaSapmasi:Math.abs(ee.reactionTime-Dt),hedefZaman:pe})),Ke=Tt.getCurrentGameMetrics(),Lt={son3Tur:De,ortalamaReaksiyonSuresi:Dt,basariOrani:yt,odaklanmaDurumu:"ai-analiz",attentionMetrics:Ke,clickGorevPerformansi:{hedefBulmaHizi:Dt,dikkatDagiticiDirenci:_e>0?yt:1,hedefKacirmaSayisi:Ne,ortalamaBeklemeSSuresi:pe,basariOrani:yt,toplamTur:Fe,basariliTur:Pe,yanlisTiklamalar:_e}};try{const ee=Tt.getCurrentRoundEmotions(),Te=ee.length>0?JSON.stringify(ee):void 0;console.log("🎯 [CLICK GAME AI PROMPT DATA]",{hasEmotionData:!!Te,roundEmotionCount:ee.length,roundsCount:_.length,accuracy:yt,avgReactionTime:Dt,distractorClicks:_e});const Ie=await Xd.generateAttentionSprint({performansOzeti:Lt,studentAge:e,sonGorevler:["tek-tıklama"],emotionData:Te}),Be={...Ie,difficulty:t,gorev:Jt(Ie.gorev)};d(Be),x(Be.sure_saniye)}catch(ee){console.error("İlk görev üretme hatası:",ee),d(Vn())}finally{jt.current=!1,I(!1)}},[e,t,_]),Jt=Pe=>{const Fe=Pe.toLowerCase();if(!Fe.includes("say")&&!Fe.includes("count")&&!Fe.includes("adet")&&!Fe.includes("tüm")&&!Fe.includes("hepsi"))return Pe;const yt=["🔴 Kırmızı","🔵 Mavi","🟢 Yeşil","🟡 Sarı"],Dt=["daire","kare","üçgen","yıldız"],pe=yt[Math.floor(Math.random()*yt.length)],_e=Dt[Math.floor(Math.random()*Dt.length)];return`${pe} ${_e}i tıkla`},Vn=()=>{const Fe={kolay:[{gorev:"🔴 Kırmızı daire tıkla",hedefRenk:"kırmızı",hedefSekil:"daire"},{gorev:"🔵 Mavi kare tıkla",hedefRenk:"mavi",hedefSekil:"kare"},{gorev:"🟢 Yeşil yıldız tıkla",hedefRenk:"yeşil",hedefSekil:"yıldız"}],orta:[{gorev:"🔴 Kırmızı üçgen 2 saniye sonra tıkla",hedefRenk:"kırmızı",hedefSekil:"üçgen"},{gorev:"🔵 Mavi daire belirdiğinde tıkla",hedefRenk:"mavi",hedefSekil:"daire"},{gorev:"🟡 Sarı kare gördüğünde bas",hedefRenk:"sarı",hedefSekil:"kare"}],zor:[{gorev:"🔴 Kırmızı yıldız çıktığında hemen tıkla",hedefRenk:"kırmızı",hedefSekil:"yıldız"},{gorev:"🔵 Mavi üçgen görünür görünmez bas",hedefRenk:"mavi",hedefSekil:"üçgen"},{gorev:"🟢 Yeşil daire belirdiğinde anında tıkla",hedefRenk:"yeşil",hedefSekil:"daire"}]}[t],yt=Fe[Math.floor(Math.random()*Fe.length)];return{id:`click_fallback_${Date.now()}`,...yt,sure_saniye:t==="kolay"?30:t==="orta"?40:50,ipuclari:["Hedefe odaklan","Hızlı reaksiyon göster"],dikkatDagitici:t==="kolay"?0:t==="orta"?.3:.5,difficulty:t,hedefTipi:"renk"}},ar=async()=>{if(!l)return;p("countdown"),me(3),N(!1),P(!1),await zt();const Pe=setInterval(()=>{me(Fe=>Fe<=1?(clearInterval(Pe),Qt(),0):Fe-1)},1e3)},Je=()=>{$e.current&&(clearInterval($e.current),$e.current=null),St.current=Date.now(),$e.current=setInterval(()=>{x(Pe=>Pe<=1?($e.current&&(clearInterval($e.current),$e.current=null),zn(!1),0):Pe-1)},1e3)},lt=()=>({x:Math.random()*70+15,y:Math.random()*60+20}),Yt=()=>{if(!l)return[];const Pe=Math.floor(l.dikkatDagitici*5),Fe=[];for(let yt=0;yt<Pe;yt++){const Dt=lt();let pe="shape",_e="⚫";if(l.hedefRenk&&l.hedefSekil){pe="combo";const Ne=l.hedefRenk;let De=[];Ne==="mavi"?De=["🔴","🟢","🟡","🟠","🟣"]:Ne==="kırmızı"?De=["🔵","🟢","🟡","🟠","🟣"]:Ne==="yeşil"?De=["🔴","🔵","🟡","🟠","🟣"]:Ne==="sarı"&&(De=["🔴","🔵","🟢","🟠","🟣"]),_e=De[Math.floor(Math.random()*De.length)]||"⚫"}Fe.push({id:`distractor-${yt}`,x:Dt.x,y:Dt.y,type:pe,value:_e})}return Fe},Qt=()=>{if(!l)return;p("active"),x(l.sure_saniye),we(lt()),q(Yt()),Tt.startGameSession(),Tt.startRoundSession();const Pe=Math.random()*2e3+1e3;be(Pe),setTimeout(()=>{N(!0),Je(),sn.startFrameAnalysis?.()},Pe)},Kr=Pe=>{if(Pe.stopPropagation(),m!=="active"||!O||R)return;P(!0),kt({isCorrect:!0,x:A.x,y:A.y}),setTimeout(()=>{kt(null)},1e3);const Fe=(Date.now()-St.current)/1e3;zn(!0,Fe)},Yr=(Pe,Fe,yt)=>{if(Pe.stopPropagation(),m!=="active"||R)return;kt({isCorrect:!1,x:Fe,y:yt}),setTimeout(()=>{kt(null)},1e3),We(pe=>pe+1);const Dt=(Date.now()-St.current)/1e3;zn(!1,Dt)},dr=()=>{if(m!=="active"||!O||R)return;Re(Fe=>Fe+1);const Pe=(Date.now()-St.current)/1e3;zn(!1,Pe)},zn=(Pe,Fe)=>{if(!l||rt.current)return;rt.current=!0,$e.current&&(clearInterval($e.current),$e.current=null);const yt=Fe||(Date.now()-St.current)/1e3,Dt=Pe?1:0,pe={task:l,startTime:St.current,endTime:Date.now(),success:Pe,reactionTime:yt,targetAppearanceDelay:ge,clickAccuracy:Dt,distractorClicks:nt,missedTargets:st};console.log("🎯 [CLICK ROUND METRICS]",{success:Pe,reactionTime:yt,targetDelay:ge,distractorClicks:nt,missedTargets:st,clickAccuracy:Dt}),w(Ne=>[...Ne,pe]);const _e=Tt.endRoundSession();if(console.log("🏁 [CLICK ROUND ENDED] Round emotion data:",_e.length),sn.stopFrameAnalysis?.(),j+1>=at){const Ne=Tt.endGameSession();H(Ne),console.log("⏹️ [CLICK GAME ENDED] Final metrics:",Ne)}if(Pe){D(De=>De+1);const Ne={emotion:"happy",confidence:.9,timestamp:new Date};X(De=>[...De,Ne]),o?.(Ne)}else{const Ne={emotion:"confused",confidence:.7,timestamp:new Date};X(De=>[...De,Ne]),o?.(Ne)}p("waiting"),setTimeout(()=>{j+1>=at?sr():(B(Ne=>Ne+1),N(!1),P(!1),q([]),We(0),Re(0),be(0),Tt.startRoundSession(),fn(),p("ready")),rt.current=!1},2e3)},sr=()=>{p("completed"),Wt();const Pe=Math.floor((Date.now()-ce)/1e3);a(L,Pe,$)},Nn=()=>{$e.current&&(clearInterval($e.current),$e.current=null),Wt(),w([]),B(0),D(0),X([]),ne.current=[],p("ready"),N(!1),P(!1),we({x:50,y:50}),q([]),G(!1),C(null),H(null),oe(""),We(0),Re(0),be(0),kt(null),Qe.current=!1,jt.current=!1,rt.current=!1,fn()};return m==="completed"?u.jsx(ut,{className:"max-w-2xl mx-auto",children:u.jsxs(dt,{className:"text-center py-12",children:[u.jsxs("div",{className:"mb-6",children:[u.jsx("div",{className:"w-24 h-24 mx-auto mb-4 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full flex items-center justify-center",children:u.jsx(Wn,{className:"h-12 w-12 text-white"})}),u.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Dikkat Tıklama Oyunu Tamamlandı!"}),u.jsx("p",{className:"text-gray-600",children:"Hızlı reaksiyon becerin gelişiyor!"})]}),u.jsx("div",{className:"bg-gray-50 rounded-lg p-6 mb-6",children:u.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[u.jsxs("div",{children:[u.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:[L,"/",at]}),u.jsx("div",{className:"text-sm text-gray-600",children:"Başarılı Tıklama"})]}),u.jsxs("div",{children:[u.jsxs("div",{className:"text-2xl font-bold text-green-600",children:[Math.round(L/at*100),"%"]}),u.jsx("div",{className:"text-sm text-gray-600",children:"Başarı Oranı"})]}),u.jsxs("div",{children:[u.jsxs("div",{className:"text-2xl font-bold text-purple-600",children:[_.length>0?(_.reduce((Pe,Fe)=>Pe+Fe.reactionTime,0)/_.length).toFixed(1):"0.0","s"]}),u.jsx("div",{className:"text-sm text-gray-600",children:"Ort. Reaksiyon"})]})]})}),u.jsxs(Nt,{onClick:Nn,size:"lg",children:[u.jsx(Ys,{className:"h-5 w-5 mr-2"}),"Tekrar Oyna"]})]})}):u.jsxs("div",{className:"max-w-2xl mx-auto space-y-6",children:[u.jsx("video",{ref:$t,autoPlay:!0,playsInline:!0,muted:!0,style:{display:"none"}}),u.jsx(ut,{children:u.jsx(dt,{children:u.jsx("div",{className:"flex items-center justify-between",children:u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsxs("div",{className:"text-sm text-gray-600",children:["Tur ",j+1,"/",at]}),u.jsxs("div",{className:"text-sm font-medium text-gray-800",children:["Skor: ",L]}),u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx(Ft,{className:"h-4 w-4 text-purple-600"}),u.jsxs("span",{className:"text-xs text-purple-600",children:["Zorluk: ",t]})]}),he&&u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx("div",{className:`w-2 h-2 rounded-full ${sn.isTrackingActive()&&sn.isFrameAnalysisActive?.()?"bg-green-500":sn.isTrackingActive()?"bg-yellow-500":"bg-orange-500"}`}),u.jsx(Fa,{className:"h-4 w-4 text-green-600"}),u.jsx("span",{className:"text-xs text-green-600",children:sn.isTrackingActive()&&sn.isFrameAnalysisActive?.()?"Analiz Aktif":sn.isTrackingActive()?"Kamera Bağlı":"Mock Mode"})]}),re&&u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx(Ic,{className:`h-4 w-4 ${re.lookingAtScreen?"text-green-600":"text-red-600"}`}),u.jsxs("span",{className:"text-xs text-gray-600",children:[re.emotion," (",(re.confidence*100).toFixed(0),"%)"]})]})]})})})}),u.jsx(ut,{children:u.jsx(dt,{className:"text-center py-12",children:V?u.jsxs("div",{className:"space-y-4",children:[u.jsx("div",{className:"w-16 h-16 border-4 border-blue-500 border-t-transparent rounded-full animate-spin mx-auto"}),u.jsx("p",{className:"text-gray-600",children:"Senin için özel görev hazırlanıyor..."})]}):m==="ready"?u.jsxs("div",{className:"space-y-6",children:[u.jsx("div",{className:"w-20 h-20 mx-auto mb-4 bg-gradient-to-r from-green-500 to-blue-500 rounded-full flex items-center justify-center",children:u.jsx(xp,{className:"h-10 w-10 text-white"})}),u.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Dikkat Tıklama"}),u.jsx("p",{className:"text-gray-600 mb-6",children:"Hızlıca doğru hedefe tıkla ve reaksiyon sürenı geliştir!"}),l&&u.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 mb-6",children:[u.jsx("h3",{className:"font-medium text-blue-800 mb-2",children:"Görevin:"}),u.jsx("p",{className:"text-blue-700",children:l.gorev}),l.ipuclari.length>0&&u.jsxs("div",{className:"mt-3",children:[u.jsx("p",{className:"text-xs text-blue-600 font-medium mb-1",children:"İpuçları:"}),l.ipuclari.map((Pe,Fe)=>u.jsxs("p",{className:"text-xs text-blue-600",children:["• ",Pe]},Fe))]})]}),u.jsxs(Nt,{onClick:ar,size:"lg",disabled:!l,children:[u.jsx(qo,{className:"h-5 w-5 mr-2"}),"Başla"]})]}):m==="countdown"?u.jsxs("div",{className:"space-y-6",children:[u.jsx("h2",{className:"text-4xl font-bold text-gray-800",children:"Hazırlan!"}),u.jsx("div",{className:"text-6xl font-bold text-blue-600 animate-bounce",children:de})]}):m==="active"?u.jsxs("div",{className:"space-y-6 cursor-crosshair",onClick:dr,children:[u.jsx("h2",{className:"text-xl font-bold text-gray-800",children:l?.gorev}),O&&l&&u.jsxs("div",{className:"relative w-full h-96",children:[se.map(Pe=>u.jsx("button",{onClick:Fe=>Yr(Fe,Pe.x,Pe.y),className:"absolute w-12 h-12 rounded-full bg-white hover:bg-gray-100 transition-colors duration-200 flex items-center justify-center text-2xl shadow-lg border-2 border-gray-300",style:{left:`${Pe.x}%`,top:`${Pe.y}%`,transform:"translate(-50%, -50%)"},children:Pe.value},Pe.id)),u.jsxs("button",{onClick:Kr,disabled:R,className:"absolute w-12 h-12 rounded-full transition-colors duration-200 flex items-center justify-center text-2xl shadow-lg border-2 bg-white hover:bg-gray-50 border-gray-300 hover:border-blue-400",style:{left:`${A.x}%`,top:`${A.y}%`,transform:"translate(-50%, -50%)"},children:[l.hedefRenk==="kırmızı"&&l.hedefSekil==="daire"&&"🔴",l.hedefRenk==="mavi"&&l.hedefSekil==="daire"&&"🔵",l.hedefRenk==="yeşil"&&l.hedefSekil==="daire"&&"🟢",l.hedefRenk==="sarı"&&l.hedefSekil==="daire"&&"🟡",l.hedefRenk==="kırmızı"&&l.hedefSekil==="kare"&&"🟥",l.hedefRenk==="mavi"&&l.hedefSekil==="kare"&&"🟦",l.hedefRenk==="yeşil"&&l.hedefSekil==="kare"&&"🟩",l.hedefRenk==="sarı"&&l.hedefSekil==="kare"&&"🟨",l.hedefRenk==="kırmızı"&&l.hedefSekil==="üçgen"&&"🔺",l.hedefRenk==="mavi"&&l.hedefSekil==="üçgen"&&"🔹",!l.hedefRenk&&l.hedefSekil==="yıldız"&&"⭐",!l.hedefRenk&&l.hedefSekil==="daire"&&"⭕",!l.hedefSekil&&l.hedefRenk==="kırmızı"&&"🔴",!l.hedefSekil&&l.hedefRenk==="mavi"&&"🔵",!l.hedefSekil&&l.hedefRenk==="yeşil"&&"🟢",!l.hedefSekil&&l.hedefRenk==="sarı"&&"🟡",!l.hedefSekil&&!l.hedefRenk&&!l.hedefSayi&&"🎯"]}),Me&&u.jsx("div",{className:`absolute w-16 h-16 rounded-full flex items-center justify-center text-2xl font-bold animate-ping pointer-events-none ${Me.isCorrect?"bg-green-500 text-white":"bg-red-500 text-white"}`,style:{left:`${Me.x}%`,top:`${Me.y}%`,transform:"translate(-50%, -50%)",zIndex:1e3},children:Me.isCorrect?"✓":"✗"})]}),!O&&u.jsxs("div",{className:"text-gray-600",children:[u.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-blue-500 border-t-transparent rounded-full mx-auto mb-2"}),"Hazırlan..."]}),u.jsxs("div",{className:"flex items-center justify-center space-x-2 text-lg",children:[u.jsx(br,{className:"h-5 w-5 text-blue-600"}),u.jsxs("span",{className:"font-mono font-bold text-blue-600",children:[y,"s"]})]})]}):m==="waiting"?u.jsxs("div",{className:"space-y-4",children:[_.length>0&&_[_.length-1].success?u.jsxs("div",{className:"text-green-600",children:[u.jsx(ts,{className:"h-12 w-12 mx-auto mb-2"}),u.jsx("h3",{className:"text-xl font-bold",children:"Harika!"}),u.jsxs("p",{children:["Reaksiyon süresi: ",_[_.length-1].reactionTime.toFixed(2),"s"]})]}):u.jsxs("div",{className:"text-orange-600",children:[u.jsx(Wn,{className:"h-12 w-12 mx-auto mb-2"}),u.jsx("h3",{className:"text-xl font-bold",children:"Bir daha deneyelim!"}),u.jsx("p",{children:"Daha hızlı olmaya çalış"})]}),u.jsx("p",{className:"text-sm text-gray-600",children:"Sonraki görev hazırlanıyor..."})]}):null})})]})},DD=({studentId:s,studentAge:e=12,difficulty:t,onGameComplete:a,onEmotionDetected:o})=>{const[l,d]=k.useState(null),[m,p]=k.useState("ready"),[y,x]=k.useState(0),[_,w]=k.useState([]),[j,B]=k.useState(0),[L,D]=k.useState(0),[$,X]=k.useState([]),ne=k.useRef([]),[ce]=k.useState(Date.now()),[de,me]=k.useState(3),[O,N]=k.useState(!1),[R,P]=k.useState(!1),[V,I]=k.useState(null),[A,we]=k.useState(null),[se,q]=k.useState(""),[he,G]=k.useState([]),[re,C]=k.useState(""),[Z,H]=k.useState(0),[Y,oe]=k.useState(0),[ge,be]=k.useState(!1),[nt,We]=k.useState(t),[st,Re]=k.useState(1),[Me,kt]=k.useState(()=>t==="kolay"?2:t==="orta"?3:5),[St,Qe]=k.useState([]),jt=k.useRef(0),rt=k.useRef(!1),$e=k.useRef(!1),$t=k.useRef(!1),at=k.useRef(null),zt=k.useRef(null),Wt=k.useRef(null),fn=5;k.useCallback(async()=>{console.log("🎭 [EMOTION] Emotion tracking başlatılıyor..."),P(!0);const pe=Ne=>{if(!Tt.isGameActiveStatus())return;I(Ne),Tt.addEmotionResult(Ne);const De=Tt.getCurrentGameMetrics();we(De);const Ke=_p.getRealtimeFeedback(De);q(Ke.message);const Lt={emotion:Ne.emotion,confidence:Ne.confidence,timestamp:Ne.timestamp};X(ee=>{const Te=[...ee.slice(-10),Lt];return ne.current=Te,Te}),o?.(Lt)};let _e=!1;Wt.current&&(_e=await sn.startEmotionTracking(Wt.current,pe)),_e||console.log("📱 [EMOTION] Gerçek kamera bulunamadı - Python server çalışıyor mu?"),console.log("✅ [EMOTION] Emotion tracking aktif")},[o]),k.useCallback(()=>{console.log("⏹️ [EMOTION] Emotion tracking durduruluyor..."),sn.stopEmotionTracking(),P(!1);const pe=Tt.endGameSession();we(pe),console.log("🏁 [EMOTION] Final metrics:",pe)},[]);const Jt=k.useCallback(async()=>{if($e.current){console.log("🚫 [DUPLICATE CALL] generateFirstTask already running, skipping");return}console.log("🎬 [TASK GENERATION] Starting task generation"),$e.current=!0,N(!0);const pe=_.reduce((ye,Ae)=>ye+(Ae.success?1:0),0),_e=_.length,Ne=_e>0?pe/_e:.7,De=_.length>0?_.reduce((ye,Ae)=>ye+Ae.reactionTime,0)/_.length:15,Ke=_.length>0?_.reduce((ye,Ae)=>ye+Ae.countingDuration,0)/_.length:15,Lt=_.length>0?_.reduce((ye,Ae)=>ye+Ae.answerTime,0)/_.length:5,ee=_.reduce((ye,Ae)=>ye+Ae.objectsDisplayed,0),Te=_.reduce((ye,Ae)=>ye+Ae.targetObjectsDisplayed,0),Ie=_.slice(-3).map(ye=>({basari:ye.success,sure:ye.reactionTime,zorluk:t,hedefTipi:"sayma",hizliCozum:ye.reactionTime<10,zamanlamaSapmasi:Math.abs(ye.reactionTime-De),hedefZaman:Ke})),Be=Tt.getCurrentGameMetrics(),Ee={son3Tur:Ie,ortalamaReaksiyonSuresi:De,basariOrani:Ne,odaklanmaDurumu:"ai-analiz",attentionMetrics:Be,saymaGorevPerformansi:{saymaDogrulugu:Ne,ortalamaSaymaSuresi:Ke,ortalamaCevapSuresi:Lt,toplamObjeGosterilen:ee,toplamHedefObje:Te,saymaHizi:Ke>0?Te/Ke:0,toplamTur:_e,basariliTur:pe,ortalamaDikkatSuresi:Ke}};try{const ye=Tt.getCurrentRoundEmotions(),Ae=ye.length>0?JSON.stringify(ye):void 0;console.log("🔢 [COUNT GAME AI PROMPT DATA]",{hasEmotionData:!!Ae,roundEmotionCount:ye.length,roundsCount:_.length,accuracy:Ne,avgReactionTime:De,avgCountingDuration:Ke});const ke=await Xd.generateAttentionSprint({performansOzeti:Ee,studentAge:e,sonGorevler:["sayma"],emotionData:Ae}),it={...ke,difficulty:t,gorev:Vn(ke.gorev),hedefRenk:ar(ke.gorev)||ke.hedefRenk,hedefSekil:Je(ke.gorev)||ke.hedefSekil,hedefSayi:void 0};console.log("🔢 [COUNT GAME] Generated counting task:",it.gorev),d(it),x(it.sure_saniye)}catch(ye){console.error("İlk görev üretme hatası:",ye),d(lt())}finally{$e.current=!1,N(!1)}},[e,t,_]);k.useEffect(()=>(!rt.current&&!O&&(rt.current=!0,Jt()),()=>{at.current&&(clearInterval(at.current),at.current=null),zt.current&&(clearInterval(zt.current),zt.current=null)}),[Jt]);const Vn=pe=>{const _e=pe.toLowerCase();if(_e.includes("say")||_e.includes("count")||_e.includes("adet")||_e.includes("hesapla"))return pe;const Ne=[{turkish:"mavi",emoji:"🔵"},{turkish:"kırmızı",emoji:"🔴"},{turkish:"yeşil",emoji:"🟢"},{turkish:"sarı",emoji:"🟡"}],De=[{turkish:"daire",emoji:"⭕"},{turkish:"kare",emoji:"⬜"},{turkish:"üçgen",emoji:"🔺"},{turkish:"yıldız",emoji:"⭐"}],Ke=Ne[Math.floor(Math.random()*Ne.length)],Lt=De[Math.floor(Math.random()*De.length)];return`${Ke.emoji} ${Ke.turkish} ${Lt.turkish}leri say`},ar=pe=>["kırmızı","mavi","yeşil","sarı","mor","turuncu"].find(Ne=>pe.toLowerCase().includes(Ne)),Je=pe=>["yıldız","daire","kare","üçgen","kalp","elmas"].find(Ne=>pe.toLowerCase().includes(Ne)),lt=()=>{const _e={kolay:[{gorev:"🔵 Mavi daireleri say",hedefRenk:"mavi",hedefSekil:"daire"},{gorev:"🟢 Yeşil kareleri say",hedefRenk:"yeşil",hedefSekil:"kare"},{gorev:"⭐ Yıldızları say",hedefSekil:"yıldız"}],orta:[{gorev:"🔴 Kırmızı üçgenleri dikkatli say",hedefRenk:"kırmızı",hedefSekil:"üçgen"},{gorev:"🟡 Sarı daireleri hesapla",hedefRenk:"sarı",hedefSekil:"daire"},{gorev:"🔵 Mavi kareleri hızla say",hedefRenk:"mavi",hedefSekil:"kare"}],zor:[{gorev:"🟢 Hızlı çıkan yeşil yıldızları say",hedefRenk:"yeşil",hedefSekil:"yıldız"},{gorev:"🔴 Karışık kırmızı daireleri hesapla",hedefRenk:"kırmızı",hedefSekil:"daire"},{gorev:"🔵 Parlayan mavi üçgenleri say",hedefRenk:"mavi",hedefSekil:"üçgen"}]}[t],Ne=_e[Math.floor(Math.random()*_e.length)];return{id:`count_fallback_${Date.now()}`,...Ne,sure_saniye:t==="kolay"?20:t==="orta"?25:30,ipuclari:["Dikkatli say","Unutma sayıları"],dikkatDagitici:t==="kolay"?.2:t==="orta"?.4:.6,difficulty:t,hedefTipi:"renk"}},Yt=pe=>{if(St.length<1)return pe;const _e=St.slice(-3),Ne=_e.filter(ee=>ee.correct).length,De=_e.reduce((ee,Te)=>ee+Te.accuracy,0)/_e.length;let Ke=st;console.log("⏱️ [GAME DURATION] Analiz:",{recent3Count:_e.length,correctCount:Ne,avgAccuracy:De.toFixed(2),currentMultiplier:st.toFixed(2),baseDuration:pe}),_e.length<2?console.log("⏸️ [DURATION] Henüz yeterli veri yok - süre sabit kalıyor"):De>.9?(Ke=Math.min(1.5,st+.2),console.log("⬆️ [DURATION] Mükemmel performans - oyunu uzatıyorum!")):De>.8?(Ke=Math.min(1.3,st+.1),console.log("↗️ [DURATION] İyi performans - hafif uzatıyorum")):De>.6?console.log("➡️ [DURATION] Dengeli performans - süre sabit"):De<.5?(Ke=Math.max(.7,st-.1),console.log("⬇️ [DURATION] Zayıf performans - oyunu kısaltıyorum")):De<.3&&(Ke=Math.max(.6,st-.2),console.log("↘️ [DURATION] Çok kötü performans - fazla kısaltıyorum")),Re(Ke);const Lt=Math.round(pe*Ke);if(_e.length>=2){const ee={kolay:2,orta:3,zor:5};let Te=Me;De>.9?(Te=Math.min(ee[t]+2,t==="zor"?6:4),console.log("⬆️ [MAX OBJECTS] Mükemmel performans - daha fazla obje!")):De>.8?(Te=Math.min(ee[t]+1,t==="zor"?6:4),console.log("↗️ [MAX OBJECTS] İyi performans - obje sayısı artırıldı")):De<.5?(Te=Math.max(ee[t]-1,2),console.log("⬇️ [MAX OBJECTS] Zayıf performans - obje sayısı azaltıldı")):(Te=ee[t],console.log("➡️ [MAX OBJECTS] Normal performans - varsayılan obje sayısı")),Te!==Me&&(console.log("🎯 [MAX OBJECTS] Ayarlandı:",{difficulty:t,oldMax:Me,newMax:Te,avgAccuracy:De.toFixed(2)}),kt(Te))}return console.log("🎯 [DURATION] Süre ayarlandı:",{baseDuration:pe,multiplier:Ke.toFixed(2),adjustedDuration:Lt}),Lt},Qt=(pe,_e)=>{const Ne=Yt(_e),Ke=Math.max((Ne-5)*1e3,1e4),Lt={kolay:{totalObjectsRatio:4,targetCountRatio:8,spawnInterval:3e3,objectLifespan:6e3,persistanceChance:0},orta:{totalObjectsRatio:3,targetCountRatio:6,spawnInterval:2500,objectLifespan:5e3,persistanceChance:.35},zor:{totalObjectsRatio:2,targetCountRatio:4,spawnInterval:2e3,objectLifespan:4e3,persistanceChance:.7}},ee=Lt[pe]||Lt.orta,Te={totalObjects:Math.ceil(Ne/ee.totalObjectsRatio),targetCount:Math.ceil(Ne/ee.targetCountRatio),spawnInterval:ee.spawnInterval,objectLifespan:ee.objectLifespan,spawnDuration:Ke,persistanceChance:ee.persistanceChance,adjustedGameDuration:Ne};return console.log("🎮 [PARAMS] Süre bazlı parametreler:",{baseParams:ee,baseDurationSeconds:_e,adjustedGameDuration:Ne,durationMultiplier:st.toFixed(2),adjustedParams:Te}),Te},Kr=()=>{if(!l)return;p("countdown"),me(3);const pe=setInterval(()=>{me(_e=>_e<=1?(clearInterval(pe),sr(),0):_e-1)},1e3)},Yr=()=>{at.current&&(clearInterval(at.current),at.current=null),jt.current=Date.now(),at.current=setInterval(()=>{x(pe=>pe<=1?(at.current&&(clearInterval(at.current),at.current=null),Fe(!1),0):(pe===6&&(be(!0),console.log("⏰ [COUNTING] Son 5 saniye! Cevabını hazırla.")),pe-1))},1e3)},dr=()=>({x:Math.random()*70+15,y:Math.random()*60+20}),zn=()=>{if(!l)return;zt.current&&(console.log("🚫 [DUPLICATE SPAWN] Spawn already running, clearing previous"),clearInterval(zt.current),zt.current=null),console.log("🎬 [SPAWN START] Starting counting spawn");const pe=Qt(t,l.sure_saniye);let _e=0,Ne=0;console.log("🔢 [COUNTING SPAWN] Parametreler:",{gameDuration:l.sure_saniye,totalObjects:pe.totalObjects,targetCount:pe.targetCount,spawnDuration:pe.spawnDuration,spawnInterval:pe.spawnInterval,persistanceChance:pe.persistanceChance,answerTime:"5 saniye (son kısım)"}),H(0),oe(Date.now()),zt.current=setInterval(()=>{if(_e>=pe.totalObjects){clearInterval(zt.current),zt.current=null;return}G(ee=>{let Te=ee,Ie=0;return t==="kolay"?(Te=ee.filter(Be=>{const Ee=Math.random()<.3;return!Ee&&Be.isTarget&&Ie++,Ee}),Ie>0&&console.log("🔄 [KOLAY MOD] Bazı eski objeler kaldırılıyor:",Ie,"(sayım değişmiyor)")):(Te=ee.filter(Be=>{const Ee=Math.random()<pe.persistanceChance;return!Ee&&Be.isTarget&&Ie++,Ee}),Ie>0&&console.log(`🔄 [${t.toUpperCase()} MOD] Rastgele objeler kaldırılıyor:`,Ie,"(sayım değişmiyor)")),Te});let De=1;if(t==="orta")Math.random()<.2&&(De=2,console.log("🎲 [ORTA MOD] Çoklu spawn! 2 obje birden"));else if(t==="zor"){const ee=Math.random();ee<.05?(De=3,console.log("🎲 [ZOR MOD] Süper spawn! 3 obje birden")):ee<.2&&(De=2,console.log("🎲 [ZOR MOD] Çoklu spawn! 2 obje birden"))}const Ke=he.length,Lt=Me-Ke;if(De=Math.min(De,Lt),De<=0){console.log("🚫 [MAX LIMIT] Maksimum obje sayısına ulaşıldı:",Me,"spawn bekliyor");return}console.log(`🎯 [SPAWN COUNT] ${De} obje spawn edilecek (maks: ${Me}, mevcut: ${Ke})`);for(let ee=0;ee<De;ee++){const Ie=Ne<pe.targetCount&&(Math.random()<.4||_e>=pe.totalObjects-(pe.targetCount-Ne));Ie&&(Ne++,H(Ae=>Ae+1));const Be=dr();let Ee="";if(l?.hedefRenk&&l?.hedefSekil)if(Ie)l.hedefRenk==="yeşil"&&l.hedefSekil==="daire"?Ee="🟢":l.hedefRenk==="yeşil"&&l.hedefSekil==="kare"?Ee="🟩":l.hedefRenk==="sarı"&&l.hedefSekil==="daire"?Ee="🟡":l.hedefRenk==="sarı"&&l.hedefSekil==="kare"?Ee="🟨":l.hedefRenk==="mavi"&&l.hedefSekil==="üçgen"?Ee="🔹":l.hedefRenk==="kırmızı"&&l.hedefSekil==="daire"?Ee="🔴":l.hedefRenk==="kırmızı"&&l.hedefSekil==="kare"?Ee="🟥":l.hedefRenk==="mavi"&&l.hedefSekil==="daire"?Ee="🔵":l.hedefRenk==="mavi"&&l.hedefSekil==="kare"?Ee="🟦":Ee="🔴";else{const Ae=l.hedefRenk;let ke=[];Ae==="mavi"?ke=["🔴","🟢","🟡","🟣","🟠"]:Ae==="kırmızı"?ke=["🔵","🟢","🟡","🟣","🟠"]:Ae==="yeşil"?ke=["🔴","🔵","🟡","🟣","🟠"]:Ae==="sarı"?ke=["🔴","🔵","🟢","🟣","🟠"]:ke=["🔴","🔵","🟢","🟡"],Ee=ke[Math.floor(Math.random()*ke.length)]}else if(l?.hedefRenk){const Ae={kırmızı:"🔴",mavi:"🔵",yeşil:"🟢",sarı:"🟡",mor:"🟣",turuncu:"🟠"};if(Ie)Ee=Ae[l.hedefRenk]||"🟢";else{const ke=Object.values(Ae).filter(it=>it!==Ae[l.hedefRenk]);Ee=ke[Math.floor(Math.random()*ke.length)]}}else if(l?.hedefSekil){const Ae={yıldız:"⭐",daire:"⭕",kare:"⬜",üçgen:"🔺",kalp:"❤️",elmas:"💎"};if(Ie)Ee=Ae[l.hedefSekil]||"🔺";else{const ke=Object.values(Ae).filter(it=>it!==Ae[l.hedefSekil]);Ee=ke[Math.floor(Math.random()*ke.length)]}}const ye={id:`counting-${Date.now()}-${Math.random()}-${ee}`,x:Be.x,y:Be.y,value:Ee,isTarget:Ie,createdAt:Date.now(),lifespan:pe.objectLifespan};G(Ae=>[...Ae,ye]),console.log("➕ [SPAWN]",{spawnIndex:ee+1,spawnTotal:De,isTarget:Ie,value:Ee,targetSpawnedCount:Ne,totalTargetCountCurrent:Z,spawnedCount:_e+1,totalObjects:pe.totalObjects}),setTimeout(()=>{G(Ae=>{const ke=Ae.filter(it=>it.id!==ye.id);return ye.isTarget&&console.log("⏱️ [LIFESPAN END] Hedef obje yaşam süresi bitti, ekrandan kaldırılıyor (sayım değişmiyor)"),ke})},pe.objectLifespan)}_e+=De},pe.spawnInterval),setTimeout(()=>{zt.current&&(clearInterval(zt.current),zt.current=null,console.log("⏹️ [SPAWN END] Spawn duration ended, clearing interval"))},pe.spawnDuration)},sr=()=>{if(!l)return;const _e=Qt(t,l.sure_saniye).adjustedGameDuration;p("active"),x(_e),C(""),be(!1),console.log("🚀 [GAME START] Oyun başlıyor:",{originalDuration:l.sure_saniye,adjustedDuration:_e,answerTime:5}),zn(),Yr()},Nn=pe=>{if(pe.preventDefault(),re.trim()==="")return;const _e=parseInt(re),Ne=_e===Z,De=(Date.now()-jt.current)/1e3;console.log("🔢 [COUNTING RESULT]",{userAnswer:_e,correctAnswer:Z,isCorrect:Ne,reactionTime:De,currentObjectsOnScreen:he.length,targetObjectsOnScreen:he.filter(Ke=>Ke.isTarget).length}),Fe(Ne,De,_e)},Pe=pe=>{const _e=pe.target.value;(_e===""||/^\d+$/.test(_e))&&C(_e)},Fe=(pe,_e,Ne)=>{if(!l||$t.current)return;$t.current=!0,at.current&&(clearInterval(at.current),at.current=null);const De=_e||(Date.now()-jt.current)/1e3,Ke=Ne||parseInt(re)||0,Lt=Z>0?Math.max(0,1-Math.abs(Ke-Z)/Z):0,ee={correct:pe,accuracy:Lt,round:j+1};Qe(Ie=>[...Ie.slice(-4),ee]),console.log("📈 [PERFORMANCE] Yeni kayıt:",{round:j+1,correct:pe,accuracy:Lt.toFixed(2),userAnswer:Ke,correctAnswer:Z,currentDurationMultiplier:st.toFixed(2)});const Te={task:l,startTime:jt.current,endTime:Date.now(),success:pe,reactionTime:De,userAnswer:Ke,correctAnswer:Z};if(w(Ie=>[...Ie,Te]),pe){D(Be=>Be+1);const Ie={emotion:"happy",confidence:.9,timestamp:new Date};X(Be=>[...Be,Ie]),o?.(Ie)}else{const Ie={emotion:"confused",confidence:.7,timestamp:new Date};X(Be=>[...Be,Ie]),o?.(Ie)}p("waiting"),setTimeout(()=>{j+1>=fn?yt():(B(Ie=>Ie+1),G([]),C(""),H(0),oe(0),Jt(),p("ready")),$t.current=!1},2e3)},yt=()=>{p("completed");const pe=Math.floor((Date.now()-ce)/1e3);a(L,pe,$)},Dt=()=>{at.current&&(clearInterval(at.current),at.current=null),w([]),B(0),D(0),X([]),p("ready"),G([]),C(""),H(0),oe(0),We(t),Re(1),Qe([]),rt.current=!1,$e.current=!1,$t.current=!1,Jt()};return m==="completed"?u.jsx(ut,{className:"max-w-2xl mx-auto",children:u.jsxs(dt,{className:"text-center py-12",children:[u.jsxs("div",{className:"mb-6",children:[u.jsx("div",{className:"w-24 h-24 mx-auto mb-4 bg-gradient-to-r from-green-500 to-blue-500 rounded-full flex items-center justify-center",children:u.jsx(Wn,{className:"h-12 w-12 text-white"})}),u.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Dikkat Sayma Oyunu Tamamlandı!"}),u.jsx("p",{className:"text-gray-600",children:"Sayma becerin gelişiyor!"})]}),u.jsx("div",{className:"bg-gray-50 rounded-lg p-6 mb-6",children:u.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[u.jsxs("div",{children:[u.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:[L,"/",fn]}),u.jsx("div",{className:"text-sm text-gray-600",children:"Doğru Sayım"})]}),u.jsxs("div",{children:[u.jsxs("div",{className:"text-2xl font-bold text-green-600",children:[Math.round(L/fn*100),"%"]}),u.jsx("div",{className:"text-sm text-gray-600",children:"Başarı Oranı"})]}),u.jsxs("div",{children:[u.jsxs("div",{className:"text-2xl font-bold text-purple-600",children:[_.length>0?(_.reduce((pe,_e)=>pe+_e.reactionTime,0)/_.length).toFixed(1):"0.0","s"]}),u.jsx("div",{className:"text-sm text-gray-600",children:"Ort. Süre"})]})]})}),u.jsxs(Nt,{onClick:Dt,size:"lg",children:[u.jsx(Ys,{className:"h-5 w-5 mr-2"}),"Tekrar Oyna"]})]})}):u.jsxs("div",{className:"max-w-2xl mx-auto space-y-6",children:[u.jsx(ut,{children:u.jsx(dt,{children:u.jsx("div",{className:"flex items-center justify-between",children:u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsxs("div",{className:"text-sm text-gray-600",children:["Tur ",j+1,"/",fn]}),u.jsxs("div",{className:"text-sm font-medium text-gray-800",children:["Skor: ",L]}),u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx(Ft,{className:"h-4 w-4 text-purple-600"}),u.jsxs("span",{className:"text-xs text-purple-600",children:["Zorluk: ",t,st!==1&&u.jsxs("span",{className:"ml-1 text-xs bg-purple-100 px-1 rounded",children:["⏱️ ",st>1?"⬆️":"⬇️"," ",st.toFixed(1),"x"]})]})]})]})})})}),u.jsx(ut,{children:u.jsx(dt,{className:"text-center py-12",children:O?u.jsxs("div",{className:"space-y-4",children:[u.jsx("div",{className:"w-16 h-16 border-4 border-green-500 border-t-transparent rounded-full animate-spin mx-auto"}),u.jsx("p",{className:"text-gray-600",children:"Senin için özel sayma görevi hazırlanıyor..."})]}):m==="ready"?u.jsxs("div",{className:"space-y-6",children:[u.jsx("div",{className:"w-20 h-20 mx-auto mb-4 bg-gradient-to-r from-green-500 to-emerald-500 rounded-full flex items-center justify-center",children:u.jsx(xp,{className:"h-10 w-10 text-white"})}),u.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Dikkat Sayma"}),u.jsx("p",{className:"text-gray-600 mb-6",children:"Beliren objeleri dikkatli şekilde say ve konsantrasyonunu geliştir!"}),l&&u.jsxs("div",{className:"bg-green-50 rounded-lg p-4 mb-6",children:[u.jsx("h3",{className:"font-medium text-green-800 mb-2",children:"Görevin:"}),u.jsx("p",{className:"text-green-700",children:l.gorev}),l.ipuclari.length>0&&u.jsxs("div",{className:"mt-3",children:[u.jsx("p",{className:"text-xs text-green-600 font-medium mb-1",children:"İpuçları:"}),l.ipuclari.map((pe,_e)=>u.jsxs("p",{className:"text-xs text-green-600",children:["• ",pe]},_e))]})]}),u.jsxs(Nt,{onClick:Kr,size:"lg",disabled:!l,children:[u.jsx(qo,{className:"h-5 w-5 mr-2"}),"Başla"]})]}):m==="countdown"?u.jsxs("div",{className:"space-y-6",children:[u.jsx("h2",{className:"text-4xl font-bold text-gray-800",children:"Hazırlan!"}),u.jsx("div",{className:"text-6xl font-bold text-green-600 animate-bounce",children:de})]}):m==="active"?u.jsxs("div",{className:"space-y-6",children:[u.jsx("h2",{className:"text-xl font-bold text-gray-800",children:l?.gorev}),u.jsx("div",{className:"relative w-full h-96 bg-gray-50 rounded-lg overflow-hidden",children:he.map(pe=>u.jsx("div",{className:"absolute w-8 h-8 text-2xl animate-bounce transition-all duration-500",style:{left:`${pe.x}%`,top:`${pe.y}%`,transform:"translate(-50%, -50%)",animationDuration:`${1+Math.random()}s`},children:pe.value},pe.id))}),u.jsx("form",{onSubmit:Nn,className:"space-y-4",children:u.jsxs("div",{className:"flex items-center justify-center space-x-4",children:[u.jsx("label",{className:"text-lg font-medium",children:"Toplam:"}),u.jsx("input",{type:"text",value:re,onChange:Pe,className:"w-20 h-12 text-center text-xl font-bold border-2 border-green-400 rounded-lg focus:outline-none focus:border-green-600",placeholder:"0",maxLength:2}),u.jsx("button",{type:"submit",disabled:re.trim()==="",className:"px-6 py-2 bg-green-500 text-white rounded-lg font-medium hover:bg-green-600 disabled:bg-gray-300 disabled:cursor-not-allowed",children:"Gönder"})]})}),u.jsxs("div",{className:"flex items-center justify-center space-x-2 text-lg",children:[u.jsx(br,{className:"h-5 w-5 text-green-600"}),u.jsxs("span",{className:"font-mono font-bold text-green-600",children:[y,"s"]})]}),ge&&u.jsxs("div",{className:"bg-orange-100 border-2 border-orange-300 rounded-lg p-4 animate-pulse",children:[u.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[u.jsx(br,{className:"h-5 w-5 text-orange-600 animate-spin"}),u.jsxs("p",{className:"text-orange-700 font-bold text-lg",children:["⏰ Son ",y," saniye! Cevabını yaz ve gönder!"]})]}),u.jsx("p",{className:"text-orange-600 text-sm mt-2",children:"Objeler artık çıkmıyor, şimdi sayını gir"})]})]}):m==="waiting"?u.jsxs("div",{className:"space-y-4",children:[_.length>0&&_[_.length-1].success?u.jsxs("div",{className:"text-green-600",children:[u.jsx(ts,{className:"h-12 w-12 mx-auto mb-2"}),u.jsx("h3",{className:"text-xl font-bold",children:"Mükemmel!"}),u.jsxs("p",{children:["Doğru cevap: ",_[_.length-1].correctAnswer]}),u.jsxs("p",{children:["Senin cevabın: ",_[_.length-1].userAnswer]})]}):u.jsxs("div",{className:"text-orange-600",children:[u.jsx(Wn,{className:"h-12 w-12 mx-auto mb-2"}),u.jsx("h3",{className:"text-xl font-bold",children:"Bir daha deneyelim!"}),_.length>0&&u.jsxs(u.Fragment,{children:[u.jsxs("p",{children:["Doğru cevap: ",_[_.length-1].correctAnswer]}),u.jsxs("p",{children:["Senin cevabın: ",_[_.length-1].userAnswer]})]})]}),u.jsx("p",{className:"text-sm text-gray-600",children:"Sonraki görev hazırlanıyor..."})]}):null})})]})},MD=({className:s})=>u.jsx("span",{className:s,children:"❌"}),OD=({studentId:s,studentAge:e=12,difficulty:t,onGameComplete:a,onEmotionDetected:o})=>{const[l,d]=k.useState(null),[m,p]=k.useState("ready"),[y,x]=k.useState(0),[_,w]=k.useState([]),[j,B]=k.useState(0),[L,D]=k.useState(0),[$,X]=k.useState([]),ne=k.useRef([]),[ce]=k.useState(Date.now()),[de,me]=k.useState(2),[O,N]=k.useState(!1),[R,P]=k.useState(!1),[V,I]=k.useState(null),[A,we]=k.useState(null),[se,q]=k.useState(null),[he,G]=k.useState(""),[re,C]=k.useState([]),[Z,H]=k.useState(0),[Y,oe]=k.useState(0),ge=k.useRef(0),be=k.useRef(0),[nt,We]=k.useState(0),[st,Re]=k.useState(0),Me=k.useRef(0),[kt,St]=k.useState([]),Qe=k.useRef([]),[jt,rt]=k.useState([]),$e=k.useRef([]),[$t,at]=k.useState(null),zt=ee=>({kırmızı:"#dc2626",mavi:"#2563eb",yeşil:"#16a34a",sarı:"#eab308",mor:"#9333ea",turuncu:"#ea580c"})[ee]||"#dc2626",Wt=ee=>{if(ee.includes("-")){const[Be,Ee]=ee.split("-"),ye=zt(Ee);switch(Be){case"triangle":return u.jsx("div",{className:"w-0 h-0",style:{borderLeft:"15px solid transparent",borderRight:"15px solid transparent",borderBottom:`30px solid ${ye}`}});case"circle":return u.jsx("div",{className:"w-8 h-8 rounded-full",style:{backgroundColor:ye}});case"square":return u.jsx("div",{className:"w-8 h-8",style:{backgroundColor:ye}});case"star":return u.jsx("div",{className:"relative w-8 h-8",style:{clipPath:"polygon(50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%)",backgroundColor:ye}});case"heart":return u.jsxs("div",{className:"relative w-8 h-8",style:{transform:"rotate(-45deg)"},children:[u.jsx("div",{className:"w-6 h-6 rounded-full absolute top-0 left-1",style:{backgroundColor:ye}}),u.jsx("div",{className:"w-6 h-6 rounded-full absolute top-1 left-0",style:{backgroundColor:ye}}),u.jsx("div",{className:"w-4 h-4 absolute top-3 left-2",style:{backgroundColor:ye}})]});case"diamond":return u.jsx("div",{className:"w-8 h-8 transform rotate-45",style:{backgroundColor:ye}});case"hexagon":return u.jsx("div",{className:"w-8 h-8",style:{clipPath:"polygon(50% 0%, 100% 25%, 100% 75%, 50% 100%, 0% 75%, 0% 25%)",backgroundColor:ye}});case"oval":return u.jsx("div",{className:"w-10 h-6 rounded-full",style:{backgroundColor:ye}});default:return u.jsx("div",{className:"w-8 h-8 rounded-full",style:{backgroundColor:"#6b7280"}})}}const Ie={"🔴":"#dc2626","🔵":"#2563eb","🟢":"#16a34a","🟡":"#eab308","🟣":"#9333ea","🟠":"#ea580c"}[ee]||"#6b7280";return u.jsx("div",{className:"w-8 h-8 rounded-full",style:{backgroundColor:Ie}})},fn=k.useRef(0),Jt=k.useRef(!1),Vn=k.useRef(!1),ar=k.useRef(!1),Je=k.useRef(null),lt=k.useRef(null),Yt=5,Qt=3e3,Kr=k.useCallback(async()=>{console.log("🎭 [EMOTION] Emotion tracking başlatılıyor..."),P(!0);const ee=Ie=>{if(!Tt.isGameActiveStatus())return;I(Ie),Tt.addEmotionResult(Ie);const Be=Tt.getCurrentGameMetrics();we(Be);const Ee=_p.getRealtimeFeedback(Be);G(Ee.message);const ye={emotion:Ie.emotion,confidence:Ie.confidence,timestamp:Ie.timestamp};X(Ae=>{const ke=[...Ae.slice(-10),ye];return ne.current=ke,ke}),o?.(ye)};let Te=!1;lt.current&&(Te=await sn.startEmotionTracking(lt.current,ee)),Te||(console.log("📱 [EMOTION] Gerçek kamera bulunamadı - Python server çalışıyor mu?"),console.log("💡 [TIP] Terminal'de çalıştır: python emotion_server.py")),console.log("✅ [EMOTION] Emotion tracking aktif")},[o]),Yr=k.useCallback(()=>{console.log("⏹️ [EMOTION] Emotion tracking durduruluyor..."),sn.stopEmotionTracking(),P(!1);const ee=Tt.endGameSession();we(ee),console.log("🏁 [EMOTION] Final metrics:",ee)},[]);k.useEffect(()=>(!Jt.current&&!O&&(console.log("🤖 [TASK] İlk görev AI'dan yükleniyor (emotion data olmadan)"),Jt.current=!0,zn()),()=>{Je.current&&(clearInterval(Je.current),Je.current=null)}),[]);const dr=k.useCallback(async(ee,Te,Ie)=>{if(Vn.current)return;Vn.current=!0,N(!0);const Be=Te??Z,Ee=Ie??Y,ye=ee.reduce((ve,Xe)=>ve+Xe.correctClicks,0),Ae=ee.reduce((ve,Xe)=>ve+Xe.wrongClicks,0),ke=ee.reduce((ve,Xe)=>ve+Xe.targetSpawned,0),it=ye+Be,nn=Ae+Ee,Kt=ke+(Me.current||0),Rn=it+nn,_n=Rn>0?it/Rn:.5,on=Kt>0?it/Kt:.5,ln=[...Qe.current];ee.forEach(ve=>{ve.avgReactionTimeMs&&ln.push(ve.avgReactionTimeMs)});const Tn=ln.length>0?ln.reduce((ve,Xe)=>ve+Xe,0)/ln.length/1e3:2.5;Qe.current.length>0&&Qe.current.reduce((ve,Xe)=>ve+Xe,0)/Qe.current.length;const Cn=ee.slice(-3).map(ve=>({basari:ve.success,sure:ve.reactionTime,zorluk:t,hedefTipi:"renk",hizliCozum:ve.reactionTime<2,zamanlamaSapmasi:Math.abs(ve.reactionTime-(l?.sure_saniye||30)),hedefZaman:l?.sure_saniye||30})),cn=Cn.filter(ve=>ve.hizliCozum).length,Ut=Tt.getCurrentGameMetrics(),ze={son3Tur:Cn,ortalamaReaksiyonSuresi:Tn,basariOrani:_n,odaklanmaDurumu:"ai-analiz",attentionMetrics:Ut,sayiGorevPerformansi:{ortalamaSayiZorlugu:t==="kolay"?3:t==="orta"?5:7,sayiBasariOrani:_n,ortalamaReaksiyonSuresiSayi:Tn,hizliCozumSayisi:cn,hedefYakalamaOrani:on,toplamHedefSayisi:Kt,yakalinanHedefSayisi:it,yanlisTiklamaSayisi:nn,hizliTiklamaOrani:ee.length>0?ee.reduce((ve,Xe)=>ve+Xe.fastClickRate,0)/ee.length:0,hizliTiklamaSayisi:ee.reduce((ve,Xe)=>ve+Xe.fastClicks,0),toplamTiklamaSayisi:ee.reduce((ve,Xe)=>ve+Xe.totalClicksAnalyzed,0),hizliVeDogruTiklamalar:ee.reduce((ve,Xe)=>ve+Xe.correctFastClicks,0),hizliTiklamaDogrulukOrani:ee.length>0?ee.reduce((ve,Xe)=>ve+Xe.fastAccuracyRate,0)/ee.length:0,sonRoundHizliTiklamaOrani:ee.length>0?ee[ee.length-1].fastClickRate:0,sonRoundHizliTiklamaSayisi:ee.length>0?ee[ee.length-1].fastClicks:0,sonRoundToplamTiklamaSayisi:ee.length>0?ee[ee.length-1].totalClicksAnalyzed:0,sonRoundHizliVeDogruTiklamalar:ee.length>0?ee[ee.length-1].correctFastClicks:0,sonRoundHizliTiklamaDogrulukOrani:ee.length>0?ee[ee.length-1].fastAccuracyRate:0,odaklanmaSayisi:ee.length}};try{const ve=Tt.getCurrentRoundEmotions(),Xe=Tt.getFullGameEmotions(),Kn=ve.length>0?JSON.stringify(ve):void 0;console.log("🤖 [AI PROMPT DATA WITH UPDATED ROUNDS]",{hasEmotionData:!!Kn,roundEmotionCount:ve.length,fullGameEmotionCount:Xe.length,legacyEmotionCount:$.length,roundsCount:ee.length,kumulatifFastClickData:{hizliTiklamaOrani:ze.sayiGorevPerformansi?.hizliTiklamaOrani,hizliTiklamaSayisi:ze.sayiGorevPerformansi?.hizliTiklamaSayisi,toplamTiklamaSayisi:ze.sayiGorevPerformansi?.toplamTiklamaSayisi},sonRoundFastClickData:{sonRoundHizliTiklamaOrani:ze.sayiGorevPerformansi?.sonRoundHizliTiklamaOrani,sonRoundHizliTiklamaSayisi:ze.sayiGorevPerformansi?.sonRoundHizliTiklamaSayisi,sonRoundToplamTiklamaSayisi:ze.sayiGorevPerformansi?.sonRoundToplamTiklamaSayisi}});const Qr=await Xd.generateAttentionSprint({performansOzeti:ze,studentAge:e,sonGorevler:["dinamik-tıklama"],emotionData:Kn}),Ta=sr(Qr.gorev),Xr={...Qr,difficulty:t,gorev:Ta,sure_saniye:Qr.sure_saniye};d(Xr),x(Xr.sure_saniye)}catch(ve){console.error("İlk görev üretme hatası:",ve),d(Nn())}finally{Vn.current=!1,N(!1)}},[e,t,Z,Y]),zn=k.useCallback(async(ee,Te)=>{if(Vn.current)return;Vn.current=!0,N(!0);const Ie=ee??Z,Be=Te??Y,Ee=_.reduce((ze,ve)=>ze+ve.correctClicks,0),ye=_.reduce((ze,ve)=>ze+ve.wrongClicks,0),Ae=_.reduce((ze,ve)=>ze+ve.targetSpawned,0),ke=Ee+Ie,it=ye+Be,nn=Ae+(Me.current||0),Kt=ke+it,Rn=Kt>0?ke/Kt:.5,_n=nn>0?ke/nn:.5,on=[...Qe.current];_.forEach(ze=>{ze.avgReactionTimeMs&&on.push(ze.avgReactionTimeMs)});const ln=on.length>0?on.reduce((ze,ve)=>ze+ve,0)/on.length/1e3:2.5;Qe.current.length>0&&Qe.current.reduce((ze,ve)=>ze+ve,0)/Qe.current.length;const Tn=_.slice(-3).map(ze=>({basari:ze.success,sure:ze.reactionTime,zorluk:t,hedefTipi:"renk",hizliCozum:ze.reactionTime<2,zamanlamaSapmasi:Math.abs(ze.reactionTime-(l?.sure_saniye||30)),hedefZaman:l?.sure_saniye||30})),Cn=Tn.filter(ze=>ze.hizliCozum).length,cn=Tt.getCurrentGameMetrics(),Ut={son3Tur:Tn,ortalamaReaksiyonSuresi:ln,basariOrani:Rn,odaklanmaDurumu:"ai-analiz",attentionMetrics:cn,sayiGorevPerformansi:{ortalamaSayiZorlugu:t==="kolay"?3:t==="orta"?5:7,sayiBasariOrani:Rn,ortalamaReaksiyonSuresiSayi:ln,hizliCozumSayisi:Cn,hedefYakalamaOrani:_n,toplamHedefSayisi:nn,yakalinanHedefSayisi:ke,yanlisTiklamaSayisi:it,hizliTiklamaOrani:_.length>0?_.reduce((ze,ve)=>ze+ve.fastClickRate,0)/_.length:0,hizliTiklamaSayisi:_.reduce((ze,ve)=>ze+ve.fastClicks,0),toplamTiklamaSayisi:_.reduce((ze,ve)=>ze+ve.totalClicksAnalyzed,0),hizliVeDogruTiklamalar:_.reduce((ze,ve)=>ze+ve.correctFastClicks,0),hizliTiklamaDogrulukOrani:_.length>0?_.reduce((ze,ve)=>ze+ve.fastAccuracyRate,0)/_.length:0,odaklanmaSayisi:_.length}};try{const ze=Tt.getCurrentRoundEmotions(),ve=Tt.getFullGameEmotions(),Xe=ze.length>0?JSON.stringify(ze):void 0;console.log("🤖 [AI PROMPT DATA]",{hasEmotionData:!!Xe,roundEmotionCount:ze.length,fullGameEmotionCount:ve.length,legacyEmotionCount:$.length,isFirstTask:!_.length});const Kn=await Xd.generateAttentionSprint({performansOzeti:Ut,studentAge:e,sonGorevler:["dinamik-tıklama"],emotionData:Xe}),Qr=sr(Kn.gorev),Ta={...Kn,difficulty:t,gorev:Qr,sure_saniye:Kn.sure_saniye};d(Ta),x(Ta.sure_saniye)}catch(ze){console.error("İlk görev üretme hatası:",ze),d(Nn())}finally{Vn.current=!1,N(!1)}},[e,t,_,Z,Y]),sr=ee=>{const Te=ee.toLowerCase();if(Te.includes("tıkla")||Te.includes("yakala"))return ee;const Ie=[{turkish:"mavi",emoji:"🔵"},{turkish:"kırmızı",emoji:"🔴"},{turkish:"yeşil",emoji:"🟢"},{turkish:"sarı",emoji:"🟡"}],Be=[{turkish:"daire",emoji:"⭕"},{turkish:"kare",emoji:"⬜"},{turkish:"üçgen",emoji:"🔺"},{turkish:"yıldız",emoji:"⭐"}],Ee=Ie[Math.floor(Math.random()*Ie.length)],ye=Be[Math.floor(Math.random()*Be.length)];return`${t==="kolay"?"20 saniye":t==="orta"?"30 saniye":"40 saniye"} içinde tüm ${Ee.emoji} ${Ee.turkish} ${ye.turkish}leri tıkla`},Nn=()=>{const Te={kolay:[{gorev:"20 saniye içinde tüm mavi daireleri tıkla",hedefRenk:"mavi",hedefSekil:"daire",sure:20},{gorev:"20 saniye içinde tüm yeşil kareleri yakala",hedefRenk:"yeşil",hedefSekil:"kare",sure:20},{gorev:"20 saniye içinde tüm sarı yıldızları tıkla",hedefRenk:"sarı",hedefSekil:"yıldız",sure:20}],orta:[{gorev:"30 saniye içinde tüm kırmızı üçgenleri tıkla",hedefRenk:"kırmızı",hedefSekil:"üçgen",sure:30},{gorev:"30 saniye içinde tüm mavi kareleri yakala",hedefRenk:"mavi",hedefSekil:"kare",sure:30},{gorev:"30 saniye içinde tüm yeşil daireleri tıkla",hedefRenk:"yeşil",hedefSekil:"daire",sure:30}],zor:[{gorev:"40 saniye içinde tüm hızlı hedefleri yakala",hedefRenk:"kırmızı",hedefSekil:"yıldız",sure:40},{gorev:"40 saniye içinde tüm mavi üçgenleri tıkla",hedefRenk:"mavi",hedefSekil:"üçgen",sure:40},{gorev:"40 saniye içinde tüm karışık hedefleri yakala",hedefRenk:"yeşil",hedefSekil:"kare",sure:40}]}[t],Ie=Te[Math.floor(Math.random()*Te.length)];return{id:`dynamic_fallback_${Date.now()}`,...Ie,sure_saniye:Ie.sure,ipuclari:["Hızlı ol","Doğru hedefleri seç"],dikkatDagitici:t==="kolay"?.3:t==="orta"?.5:.7,difficulty:t,hedefTipi:"renk"}},Pe=ee=>{switch(ee){case"kolay":return{spawnInterval:3e3,objectLifespan:6e3,targetRatio:.7};case"orta":return{spawnInterval:2500,objectLifespan:5e3,targetRatio:.6};case"zor":return{spawnInterval:2e3,objectLifespan:4e3,targetRatio:.5};default:return{spawnInterval:2500,objectLifespan:5e3,targetRatio:.6}}},Fe=async()=>{if(!l)return;p("countdown"),me(2),await Kr();const ee=setInterval(()=>{me(Te=>Te<=1?(clearInterval(ee),_e(),0):Te-1)},1e3)},yt=()=>{Je.current&&(clearInterval(Je.current),Je.current=null),fn.current=Date.now(),Je.current=setInterval(()=>{x(ee=>ee<=1?(Je.current&&(clearInterval(Je.current),Je.current=null),De(!0),0):ee-1)},1e3)},Dt=()=>({x:Math.random()*70+15,y:Math.random()*60+20}),pe=()=>{const ee=l?.gameParams?{spawnInterval:l.gameParams.spawnInterval,objectLifespan:l.gameParams.objectLifespan,targetRatio:l.gameParams.targetRatio}:Pe(t);console.log("🎮 [GAME PARAMS]",{source:l?.gameParams?"AI-emotion-based":"default-difficulty",spawnInterval:`${ee.spawnInterval}ms`,objectLifespan:`${ee.objectLifespan}ms`,targetRatio:`${(ee.targetRatio*100).toFixed(1)}%`,aiParams:l?.gameParams}),H(0),oe(0),We(0),Re(0),Me.current=0;const Te=()=>{const Be=Math.random()<ee.targetRatio,Ee=Dt();let ye="";if(l?.hedefRenk&&l?.hedefSekil)if(Be)l.hedefSekil==="daire"?ye=`circle-${l.hedefRenk}`:l.hedefSekil==="kare"?ye=`square-${l.hedefRenk}`:l.hedefSekil==="üçgen"?ye=`triangle-${l.hedefRenk}`:l.hedefSekil==="yıldız"?ye=`star-${l.hedefRenk}`:l.hedefSekil==="kalp"?ye=`heart-${l.hedefRenk}`:l.hedefSekil==="elmas"?ye=`diamond-${l.hedefRenk}`:ye="🔴";else{const ke=["circle","square","triangle","star","heart","diamond"],it=["kırmızı","mavi","yeşil","sarı","mor","turuncu"];let nn,Kt;do nn=ke[Math.floor(Math.random()*ke.length)],Kt=it[Math.floor(Math.random()*it.length)];while(nn===l.hedefSekil&&Kt===l.hedefRenk);ye=`${nn}-${Kt}`}else if(l?.hedefRenk){const ke=["circle","square","triangle","star","heart","diamond"],it=ke[Math.floor(Math.random()*ke.length)];if(Be)ye=`${it}-${l.hedefRenk}`;else{const nn=["kırmızı","mavi","yeşil","sarı","mor","turuncu"].filter(Rn=>Rn!==l.hedefRenk),Kt=nn[Math.floor(Math.random()*nn.length)];ye=`${it}-${Kt}`}}else if(l?.hedefSekil){const ke=["kırmızı","mavi","yeşil","sarı","mor","turuncu"],it=ke[Math.floor(Math.random()*ke.length)];if(Be)ye=`${l.hedefSekil==="daire"?"circle":l.hedefSekil==="kare"?"square":l.hedefSekil==="üçgen"?"triangle":l.hedefSekil==="yıldız"?"star":l.hedefSekil==="kalp"?"heart":l.hedefSekil==="elmas"?"diamond":"circle"}-${it}`;else{const nn=["circle","square","triangle","star","heart","diamond"],Kt=l.hedefSekil==="daire"?"circle":l.hedefSekil==="kare"?"square":l.hedefSekil==="üçgen"?"triangle":l.hedefSekil==="yıldız"?"star":l.hedefSekil==="kalp"?"heart":l.hedefSekil==="elmas"?"diamond":"circle";ye=`${nn.filter(_n=>_n!==Kt)[Math.floor(Math.random()*(nn.length-1))]}-${it}`}}const Ae={id:`clicking-${Date.now()}-${Math.random()}`,x:Ee.x,y:Ee.y,value:ye,isTarget:Be,createdAt:Date.now(),lifespan:ee.objectLifespan};C(ke=>[...ke,Ae]),We(ke=>ke+1),Be&&(Re(ke=>ke+1),Me.current+=1),setTimeout(()=>{C(ke=>ke.filter(it=>it.id!==Ae.id))},ee.objectLifespan)};Te(),sn.startFrameAnalysis?.();const Ie=setInterval(Te,ee.spawnInterval);setTimeout(()=>{clearInterval(Ie)},(l?.sure_saniye||30)*1e3)},_e=()=>{l&&(p("active"),x(l.sure_saniye),We(0),Tt.startGameSession(),Tt.startRoundSession(),pe(),yt())},Ne=(ee,Te)=>{const Ie=Date.now(),Be=re.find(ke=>ke.id===ee);if(!Be)return;const Ee=Ie-Be.createdAt,ye=Ee<Qt;console.log(`⚡ [FAST CLICK DEBUG] Reaction: ${Ee}ms, Threshold: ${Qt}ms, IsFast: ${ye}`),at({id:`feedback-${Date.now()}`,isCorrect:Te,x:Be.x,y:Be.y}),setTimeout(()=>{at(null)},1e3),Qe.current.push(Ee),St(ke=>[...ke,Ee]);const Ae={timestamp:Date.now(),reactionTime:Ee,isCorrect:Te,isFast:ye};$e.current.push(Ae),rt(ke=>[...ke,Ae]),C(ke=>ke.filter(it=>it.id!==ee)),Te?(ge.current+=1,H(ke=>ke+1)):(be.current+=1,oe(ke=>ke+1))},De=(ee,Te)=>{if(console.log("🚨 [END ROUND CALLED]",{success:ee,reactionTime:Te,currentTask:!!l,isEndingRound:ar.current}),!l||ar.current)return;ar.current=!0;const Ie=ge.current,Be=be.current,Ee=Me.current;Je.current&&(clearInterval(Je.current),Je.current=null);const ye=(Date.now()-fn.current)/1e3,Ae=Ie+Be,it=(Ae>0?Ie/Ae:0)>=.5&&Ae>=3,nn=Qe.current.length>0?Qe.current.reduce((ve,Xe)=>ve+Xe,0)/Qe.current.length:0,Kt=Ee>0?Ie/Ee:0,Rn=$e.current,_n=Rn.length,on=Rn.filter(ve=>ve.isFast).length,ln=Rn.filter(ve=>ve.isFast&&ve.isCorrect).length,Tn=_n>0?on/_n:0,Cn=on>0?ln/on:0;console.log("📊 [FAST CLICK DETAILS]",{totalClicks:_n,fastClicks:on,correctFastClicks:ln,fastClickRate:`${(Tn*100).toFixed(1)}%`,fastAccuracyRate:`${(Cn*100).toFixed(1)}%`,allClicks:Rn.map(ve=>({reaction:`${ve.reactionTime}ms`,isFast:ve.isFast,isCorrect:ve.isCorrect}))});const cn={task:l,startTime:fn.current,endTime:Date.now(),success:it,reactionTime:ye,correctClicks:Ie,wrongClicks:Be,totalSpawned:nt,targetSpawned:Ee,targetHitRate:Kt,avgReactionTimeMs:nn,fastClicks:on,totalClicksAnalyzed:_n,fastClickRate:Tn,correctFastClicks:ln,fastAccuracyRate:Cn},Ut=Tt.endRoundSession();if(console.log("🏁 [ROUND ENDED] Round emotion data:",Ut.length),sn.stopFrameAnalysis?.(),j+1>=Yt){const ve=Tt.endGameSession();we(ve),console.log("⏹️ [GAME ENDED] Emotion kaydetme durdu, final metrics:",ve)}w(ve=>{const Xe=[...ve,cn];return j+1<Yt&&setTimeout(()=>{dr(Xe,Ie,Be)},100),Xe});const ze=it?{emotion:"happy",confidence:.9,timestamp:new Date}:{emotion:"confused",confidence:.7,timestamp:new Date};X(ve=>{const Xe=[...ve,ze];return ne.current=Xe,Xe}),o?.(ze),p("waiting"),setTimeout(()=>{j+1>=Yt?Ke():(B(ve=>ve+1),C([]),H(0),oe(0),ge.current=0,be.current=0,St([]),Qe.current=[],We(0),Re(0),Me.current=0,rt([]),$e.current=[],at(null),Tt.startRoundSession(),p("ready")),ar.current=!1},2e3)},Ke=()=>{p("completed"),Yr();const ee=Math.floor((Date.now()-ce)/1e3);a(L,ee,$)},Lt=()=>{Je.current&&(clearInterval(Je.current),Je.current=null),Yr(),w([]),B(0),D(0),X([]),ne.current=[],p("ready"),P(!1),I(null),we(null),q(null),G(""),C([]),H(0),oe(0),We(0),Re(0),Me.current=0,rt([]),$e.current=[],at(null),Jt.current=!1,Vn.current=!1,ar.current=!1,zn()};return m==="completed"?u.jsx(ut,{className:"max-w-2xl mx-auto",children:u.jsxs(dt,{className:"text-center py-12",children:[u.jsxs("div",{className:"mb-6",children:[u.jsx("div",{className:"w-24 h-24 mx-auto mb-4 bg-gradient-to-r from-purple-500 to-pink-500 rounded-full flex items-center justify-center",children:u.jsx(Wn,{className:"h-12 w-12 text-white"})}),u.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Dinamik Dikkat Oyunu Tamamlandı!"}),u.jsx("p",{className:"text-gray-600",children:"Hızlı karar verme becerin gelişiyor!"})]}),u.jsx("div",{className:"bg-gray-50 rounded-lg p-6 mb-6",children:u.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[u.jsxs("div",{children:[u.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:[L,"/",Yt]}),u.jsx("div",{className:"text-sm text-gray-600",children:"Başarılı Tur"})]}),u.jsxs("div",{children:[u.jsxs("div",{className:"text-2xl font-bold text-green-600",children:[Math.round(L/Yt*100),"%"]}),u.jsx("div",{className:"text-sm text-gray-600",children:"Başarı Oranı"})]}),u.jsxs("div",{children:[u.jsx("div",{className:"text-2xl font-bold text-purple-600",children:_.length>0?Math.round(_.reduce((ee,Te)=>ee+Te.correctClicks,0)/_.length):0}),u.jsx("div",{className:"text-sm text-gray-600",children:"Ort. Doğru Tıklama"})]})]})}),u.jsxs(Nt,{onClick:Lt,size:"lg",children:[u.jsx(Ys,{className:"h-5 w-5 mr-2"}),"Tekrar Oyna"]})]})}):u.jsxs("div",{className:"max-w-2xl mx-auto space-y-6",children:[u.jsx("video",{ref:lt,autoPlay:!0,playsInline:!0,muted:!0,style:{display:"none"}}),u.jsx(ut,{children:u.jsx(dt,{children:u.jsx("div",{className:"flex items-center justify-between",children:u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsxs("div",{className:"text-sm text-gray-600",children:["Tur ",j+1,"/",Yt]}),u.jsxs("div",{className:"text-sm font-medium text-gray-800",children:["Skor: ",L]}),u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx(Ft,{className:"h-4 w-4 text-purple-600"}),u.jsxs("span",{className:"text-xs text-purple-600",children:["Zorluk: ",t]})]}),R&&u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx("div",{className:`w-2 h-2 rounded-full ${sn.isTrackingActive()&&sn.isFrameAnalysisActive?.()?"bg-green-500":sn.isTrackingActive()?"bg-yellow-500":"bg-orange-500"}`}),u.jsx(Fa,{className:"h-4 w-4 text-green-600"}),u.jsx("span",{className:"text-xs text-green-600",children:sn.isTrackingActive()&&sn.isFrameAnalysisActive?.()?"Analiz Aktif":sn.isTrackingActive()?"Kamera Bağlı":"Mock Mode"})]}),V&&u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx(Ic,{className:`h-4 w-4 ${V.lookingAtScreen?"text-green-600":"text-red-600"}`}),u.jsxs("span",{className:"text-xs text-gray-600",children:[V.emotion," (",(V.confidence*100).toFixed(0),"%)"]})]})]})})})}),u.jsx(ut,{children:u.jsx(dt,{className:"text-center py-12",children:O?u.jsxs("div",{className:"space-y-4",children:[u.jsx("div",{className:"w-16 h-16 border-4 border-purple-500 border-t-transparent rounded-full animate-spin mx-auto"}),u.jsx("p",{className:"text-gray-600",children:"Senin için özel dinamik görev hazırlanıyor..."})]}):m==="ready"?u.jsxs("div",{className:"space-y-6",children:[u.jsx("div",{className:"w-20 h-20 mx-auto mb-4 bg-gradient-to-r from-purple-500 to-pink-500 rounded-full flex items-center justify-center",children:u.jsx(xp,{className:"h-10 w-10 text-white"})}),u.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Dinamik Dikkat"}),u.jsx("p",{className:"text-gray-600 mb-6",children:"Sürekli çıkan hedefleri hızlıca yakala ve reflexlerini geliştir!"}),l&&u.jsxs("div",{className:"bg-purple-50 rounded-lg p-4 mb-6",children:[u.jsx("h3",{className:"font-medium text-purple-800 mb-2",children:"Görevin:"}),u.jsx("p",{className:"text-purple-700",children:l.gorev}),l.ipuclari?.length>0&&u.jsxs("div",{className:"mt-3",children:[u.jsx("p",{className:"text-xs text-purple-600 font-medium mb-1",children:"İpuçları:"}),l.ipuclari.map((ee,Te)=>u.jsxs("p",{className:"text-xs text-purple-600",children:["• ",ee]},Te))]})]}),u.jsxs(Nt,{onClick:Fe,size:"lg",disabled:!l,children:[u.jsx(qo,{className:"h-5 w-5 mr-2"}),"Başla"]})]}):m==="countdown"?u.jsxs("div",{className:"space-y-6",children:[u.jsx("h2",{className:"text-4xl font-bold text-gray-800",children:"Hazırlan!"}),u.jsx("div",{className:"text-6xl font-bold text-purple-600 animate-bounce",children:de})]}):m==="active"?u.jsxs("div",{className:"space-y-6",children:[u.jsx("h2",{className:"text-xl font-bold text-gray-800",children:l?.gorev}),u.jsxs("div",{className:"relative w-full h-96 bg-gray-50 rounded-lg overflow-hidden",children:[re.map(ee=>u.jsx("button",{onClick:()=>Ne(ee.id,ee.isTarget),className:"absolute w-12 h-12 rounded-full transition-all duration-300 flex items-center justify-center text-2xl shadow-lg border-2 bg-white border-gray-300 hover:bg-gray-50 hover:scale-110 animate-bounce",style:{left:`${ee.x}%`,top:`${ee.y}%`,transform:"translate(-50%, -50%)",animationDuration:`${.8+Math.random()*.4}s`},children:Wt(ee.value)},ee.id)),$t&&u.jsx("div",{className:`absolute w-16 h-16 rounded-full flex items-center justify-center text-2xl font-bold animate-ping pointer-events-none ${$t.isCorrect?"bg-green-500 text-white":"bg-red-500 text-white"}`,style:{left:`${$t.x}%`,top:`${$t.y}%`,transform:"translate(-50%, -50%)",zIndex:1e3},children:$t.isCorrect?"✓":"✗"})]}),u.jsxs("div",{className:"flex items-center justify-center space-x-8",children:[u.jsxs("div",{className:"flex items-center space-x-2 text-green-600",children:[u.jsx(ts,{className:"h-5 w-5"}),u.jsxs("span",{className:"text-lg font-bold",children:["Doğru: ",Z]})]}),u.jsxs("div",{className:"flex items-center space-x-2 text-red-600",children:[u.jsx(MD,{className:"h-5 w-5"}),u.jsxs("span",{className:"text-lg font-bold",children:["Yanlış: ",Y]})]}),u.jsxs("div",{className:"flex items-center space-x-2 text-blue-600",children:[u.jsx(Wn,{className:"h-5 w-5"}),u.jsxs("span",{className:"text-lg font-bold",children:["Toplam Çıkan: ",nt]})]})]}),u.jsxs("div",{className:"flex items-center justify-center space-x-2 text-lg",children:[u.jsx(br,{className:"h-5 w-5 text-purple-600"}),u.jsxs("span",{className:"font-mono font-bold text-purple-600",children:[y,"s"]})]})]}):m==="waiting"?u.jsxs("div",{className:"space-y-4",children:[_.length>0&&_[_.length-1].success?u.jsxs("div",{className:"text-green-600",children:[u.jsx(ts,{className:"h-12 w-12 mx-auto mb-2"}),u.jsx("h3",{className:"text-xl font-bold",children:"Mükemmel!"}),u.jsxs("p",{children:["Doğru: ",_[_.length-1].correctClicks,", Yanlış: ",_[_.length-1].wrongClicks]}),u.jsxs("p",{children:["Hedef Yakalama: ",_[_.length-1].correctClicks,"/",_[_.length-1].targetSpawned," (",Math.round(_[_.length-1].targetHitRate*100),"%)"]}),u.jsxs("p",{children:["Hızlı Tıklama: ",_[_.length-1].fastClicks,"/",_[_.length-1].totalClicksAnalyzed," (",Math.round(_[_.length-1].fastClickRate*100),"%)"]}),u.jsxs("p",{children:["Hızlı+Doğru: ",_[_.length-1].correctFastClicks," (",Math.round(_[_.length-1].fastAccuracyRate*100),"%)"]})]}):u.jsxs("div",{className:"text-orange-600",children:[u.jsx(Wn,{className:"h-12 w-12 mx-auto mb-2"}),u.jsx("h3",{className:"text-xl font-bold",children:"Daha iyi yapabilirsin!"}),_.length>0&&u.jsxs(u.Fragment,{children:[u.jsxs("p",{children:["Doğru: ",_[_.length-1].correctClicks,", Yanlış: ",_[_.length-1].wrongClicks]}),u.jsxs("p",{children:["Hedef Yakalama: ",_[_.length-1].correctClicks,"/",_[_.length-1].targetSpawned," (",Math.round(_[_.length-1].targetHitRate*100),"%)"]}),u.jsxs("p",{children:["Hızlı Tıklama: ",_[_.length-1].fastClicks,"/",_[_.length-1].totalClicksAnalyzed," (",Math.round(_[_.length-1].fastClickRate*100),"%)"]}),u.jsx("p",{children:"Daha dikkatli olmaya çalış"})]})]}),u.jsx("p",{className:"text-sm text-gray-600",children:"Sonraki görev hazırlanıyor..."})]}):null})})]})};class PD{constructor(){this.modelName="llama3.2:1b"}async getAdaptiveDifficulty(e){const t=this.buildDifficultyPrompt(e);try{const a=await this.callOllama(t),o=this.parseAIResponse(a);return console.log("🤖 AI Zorluk Önerisi:",o),o}catch(a){return console.error("❌ AI Zorluk Analizi hatası:",a),this.getFallbackDifficulty(e)}}buildDifficultyPrompt(e){const t=e.totalAttempts>0?e.correctAttempts/e.totalAttempts*100:0;return this.analyzeErrorPatterns(e.recentErrors),`Adjust difficulty for ADHD child Stroop game.

DATA: ${t.toFixed(1)}% accuracy, ${e.averageReactionTime}ms reaction

RULES:
- If accuracy >80% AND reaction <2000ms: increase difficulty
- If accuracy <50% OR reaction >2500ms: decrease difficulty
- If reaction <700ms: slow down (impulsive)
- If reaction >2800ms: motivate (struggling)

OUTPUT JSON:
{
  "newSettings": {"boxCount": ${t>80&&e.averageReactionTime<2e3?6:t<50?4:5}, "commandVisibilityDuration": ${e.averageReactionTime<700?3500:e.averageReactionTime>2800?2e3:2500}, "conflictRate": ${t>80?.6:t<50?.3:.5}, "distractorCount": ${t>80?1:0}, "distractorTypes": ["${t>80?"text":"none"}"], "pauseTime": ${e.averageReactionTime<700?800:400}},
  "reasoning": "Based on ${t.toFixed(1)}% accuracy and ${e.averageReactionTime}ms reaction",
  "encouragement": "Keep going!",
  "tips": ["Focus", "Read carefully"]
}`}analyzeErrorPatterns(e){if(!e.length)return"Henüz hata analizi için yeterli veri yok";const t={colorCommand:0,textCommand:0,quickClicks:0,slowClicks:0};e.forEach(l=>{l.includes("color")&&t.colorCommand++,l.includes("text")&&t.textCommand++,l.includes("quick")&&t.quickClicks++,l.includes("slow")&&t.slowClicks++});const a=Object.entries(t).reduce((l,d)=>t[l[0]]>t[d[0]]?l:d);return{colorCommand:"Renk komutlarında zorluk",textCommand:"Kelime komutlarında zorluk",quickClicks:"Çok hızlı tıklama eğilimi",slowClicks:"Yavaş reaksiyon gösterme"}[a[0]]||"Karma hata türleri"}async callOllama(e){const t="https://3c9bc3387069.ngrok-free.app/api/generate",a={model:this.modelName,prompt:e,format:"json",stream:!1,options:{temperature:.1,top_p:.7,num_predict:100}};try{const o=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!o.ok)throw new Error(`Ollama API hatası: ${o.status}`);return(await o.json()).response.trim()}catch(o){throw new Error(`Ollama bağlantı hatası: ${o}`)}}parseAIResponse(e){try{let t;try{t=JSON.parse(e.trim())}catch{const l=e.match(/\{[\s\S]*\}/);if(!l)throw new Error("JSON bulunamadı");t=JSON.parse(l[0])}if(!t.newSettings)throw new Error("newSettings eksik");const a=t.newSettings;a.boxCount=Math.max(2,Math.min(10,a.boxCount||4)),a.commandVisibilityDuration=Math.max(1500,Math.min(4e3,a.commandVisibilityDuration||2500)),a.conflictRate=Math.max(.2,Math.min(.9,a.conflictRate||.5)),a.distractorCount=Math.max(0,Math.min(3,a.distractorCount||0)),a.pauseTime=Math.max(200,Math.min(1200,a.pauseTime||600));const o=["emoji","text","shape","none"];return Array.isArray(a.distractorTypes)?(a.distractorTypes=a.distractorTypes.filter(l=>o.includes(l)),a.distractorTypes.length===0&&(a.distractorTypes=["none"])):a.distractorTypes=["none"],{newSettings:a,reasoning:t.reasoning||"AI tarafından optimize edildi",encouragement:t.encouragement||"Harika gidiyorsun! Devam et!",tips:Array.isArray(t.tips)?t.tips:["Odaklan ve sakin ol","Her cevap öğrenme fırsatı"]}}catch(t){throw console.error("AI response parse hatası:",t),new Error(`AI yanıtı parse edilemedi: ${t}`)}}getFallbackDifficulty(e){const t=e.totalAttempts>0?e.correctAttempts/e.totalAttempts:0;let a=5,o=2500,l=.5,d=0,m=600;return t>.8?(a=6,l=.6,d=1):t<.5&&(a=4,l=.3,o=3e3,m=800),{newSettings:{boxCount:a,commandVisibilityDuration:o,conflictRate:l,distractorCount:d,distractorTypes:d>0?["emoji"]:["none"],pauseTime:m},reasoning:"AI mevcut değil, basit algoritma kullanıldı",encouragement:t>.7?"Harika devam ediyorsun!":"Güzel, pratik yapmaya devam et!",tips:["Komutları dikkatli oku","Acele etme, doğruluğa odaklan","Her seferinde biraz daha iyi oluyorsun"]}}setModel(e){this.modelName=e}}const VD=new PD,jr=["KIRMIZI","MAVİ","YEŞİL","SARI","TURUNCU","PEMBE"],zD={KIRMIZI:"#DC2626",MAVİ:"#2563EB",YEŞİL:"#16A34A",SARI:"#CA8A04",TURUNCU:"#EA580C",PEMBE:"#DB2777"},Rb=["🎯","⚠️","?","⭐","🔥","💎","🎪","⚡"],LD=({studentId:s,studentAge:e=12,difficulty:t="orta",onGameComplete:a,onEmotionDetected:o})=>{const l=k.useRef(null),d=k.useRef([]),m=k.useRef(0),[p,y]=k.useState({boxCount:6,commandVisibilityDuration:2500,conflictRate:.5,distractorCount:0,distractorTypes:["none"],pauseTime:600}),[x,_]=k.useState({correctAttempts:0,totalAttempts:0,averageReactionTime:0,streakCounter:0,bestStreak:0,timeSpent:0,difficultyLevel:5,recentErrors:[]}),[w,j]=k.useState(""),[B,L]=k.useState([]);k.useMemo(()=>({kolay:p,orta:p,zor:p}),[p]);const[D,$]=k.useState({boxes:[],command:"",commandType:"color",targetColor:"KIRMIZI",score:0,timeRemaining:60,gameStarted:!1,gameEnded:!1,currentLevel:1,consecutiveCorrect:0,consecutiveWrong:0,commandVisible:!0,commandTimeLeft:p.commandVisibilityDuration,boxesVisible:!1,totalAttempts:0,correctAttempts:0,streakCounter:0,bestStreak:0,aiAnalyzing:!1,feedback:{show:!1,type:"correct",message:""}}),X=k.useRef([]),ne=k.useRef(0),ce=k.useCallback(I=>{const A=l.current;if(!A)return console.log("⚠️ [DEBUG] Container not found, using default position"),{x:50+Math.random()*400,y:50+Math.random()*300};const we=A.getBoundingClientRect(),se=100,q=20;if(we.width===0||we.height===0)return console.log("⚠️ [DEBUG] Container has no dimensions, using fallback"),{x:50+Math.random()*400,y:50+Math.random()*300};let he=0,G;do G={x:Math.random()*(we.width-se-2*q)+q,y:Math.random()*(we.height-se-2*q)+q},he++;while(he<50&&I.some(re=>Math.abs(re.x-G.x)<se+10&&Math.abs(re.y-G.y)<se+10));return he>10&&console.log("📍 [DEBUG] Position generation took",he,"attempts"),G},[]),de=k.useCallback((I,A)=>{const we=p,se=[],q=[];console.log("🎯 [DEBUG] Generating boxes for:",{targetColor:I,commandType:A,settings:we});const he=ce(q);q.push(he);const G={id:0,textLabel:I,textColor:I,position:he,isCorrect:!0};if(A==="text"){G.textLabel=I;const H=jr.filter(Y=>Y!==I);G.textColor=H[Math.floor(Math.random()*H.length)]}else{G.textColor=I;const H=jr.filter(Y=>Y!==I);G.textLabel=H[Math.floor(Math.random()*H.length)]}console.log("✅ [DEBUG] Correct box created:",G),se.push(G);const re=Math.max(2,we.boxCount-1-(we.distractorCount||0));console.log("📊 [DEBUG] Generating",re,"normal boxes + 1 correct box =",re+1,"total");for(let H=1;H<=re;H++){const Y=ce(q);q.push(Y);const oe=Math.random()<we.conflictRate;let ge,be,nt=0;do{if(nt++,oe){ge=jr[Math.floor(Math.random()*jr.length)];do be=jr[Math.floor(Math.random()*jr.length)];while(be===ge)}else{const st=jr[Math.floor(Math.random()*jr.length)];ge=st,be=st}if(!(A==="color"?be===I:ge===I))break;if(nt>=10){if(A==="color"){const st=jr.filter(Re=>Re!==I);be=st[Math.floor(Math.random()*st.length)]}else{const st=jr.filter(Re=>Re!==I);ge=st[Math.floor(Math.random()*st.length)]}break}}while(nt<20);se.push({id:H,textLabel:ge,textColor:be,position:Y,isCorrect:!1})}const C=we.distractorCount;if(C>0&&!we.distractorTypes.includes("none"))for(let H=re+1;H<=re+C;H++){const Y=ce(q);q.push(Y);let oe;const ge=we.distractorTypes[Math.floor(Math.random()*we.distractorTypes.length)];switch(ge){case"emoji":oe=Rb[Math.floor(Math.random()*Rb.length)];break;case"text":oe="?";break;case"shape":oe="●";break;default:continue}se.push({id:H,textLabel:oe,textColor:"KIRMIZI",position:Y,isCorrect:!1,isDistractor:!0}),console.log(`🎭 [DEBUG] Distractor box ${H} created with type ${ge}`)}const Z=se.filter(H=>H.isCorrect);return console.log("🔍 [DEBUG] Final boxes check:",{totalBoxes:se.length,correctBoxes:Z.length,normalBoxes:se.filter(H=>!H.isCorrect&&!H.isDistractor).length,distractorBoxes:se.filter(H=>H.isDistractor).length}),Z.length===0&&(console.error("❌ [ERROR] No correct boxes found! This should not happen."),se.length>0&&(se[0].isCorrect=!0,A==="text"?se[0].textLabel=I:se[0].textColor=I)),se},[p,ce]),me=k.useCallback(()=>{if(!l.current){setTimeout(()=>me(),100);return}const I=Math.random()>.5?"color":"text",A=jr[Math.floor(Math.random()*jr.length)],we=I==="color"?`${A} renkli yazana tıkla`:`${A} yazısını seç`,se=de(A,I);$(q=>({...q,boxes:se,command:we,commandType:I,targetColor:A,commandVisible:!0,commandTimeLeft:p.commandVisibilityDuration,boxesVisible:!1,feedback:{show:!1,type:"correct",message:""}})),setTimeout(()=>{$(q=>({...q,commandVisible:!1,boxesVisible:!0})),ne.current=Date.now()},p.commandVisibilityDuration)},[de,p]),O=k.useCallback(I=>{const A=D.boxes.find(G=>G.id===I);if(!A||D.gameEnded||D.aiAnalyzing||!D.boxesVisible)return;const we=A.isCorrect,q=Date.now()-ne.current;X.current.push(q),$(G=>{const re={...G};if(re.totalAttempts+=1,we){re.correctAttempts+=1,re.streakCounter+=1,re.bestStreak=Math.max(re.bestStreak,re.streakCounter);const C=Math.max(0,Math.floor(G.commandTimeLeft/100*10));re.score+=100+C,re.consecutiveCorrect+=1,re.consecutiveWrong=0,re.feedback={show:!0,type:"correct",message:`Doğru! +${100+C} puan`}}else{re.streakCounter=0,re.score=Math.max(0,re.score-50),re.timeRemaining=Math.max(0,re.timeRemaining-2),re.consecutiveWrong+=1,re.consecutiveCorrect=0;const C=`${G.commandType}_error_${q<1e3?"quick":"slow"}`;re.feedback={show:!0,type:"incorrect",message:"Yanlış! -50 puan, -2 saniye"},_(Z=>({...Z,recentErrors:[...Z.recentErrors.slice(-4),C]}))}return re}),_(G=>({...G,correctAttempts:we?G.correctAttempts+1:G.correctAttempts,totalAttempts:G.totalAttempts+1,averageReactionTime:X.current.length>0?X.current.reduce((C,Z)=>C+Z,0)/X.current.length:0,streakCounter:we?G.streakCounter+1:0,bestStreak:Math.max(G.bestStreak,we?G.streakCounter+1:0),timeSpent:Date.now()-m.current,difficultyLevel:Math.round(((p.boxCount-2)/8+p.conflictRate)*5)}));const he=D.totalAttempts+1;he>=5&&he%3===0?(console.log("🚀 AI Tetikleniyor! Deneme sayısı:",he),$(G=>({...G,aiAnalyzing:!0,boxesVisible:!0})),N().then(()=>{$(G=>({...G,aiAnalyzing:!1,boxesVisible:!1})),setTimeout(()=>{me()},p.pauseTime)})):(he<5&&console.log("📊 Veri toplaniyor... Deneme:",he,"/5"),setTimeout(()=>{me()},p.pauseTime))},[D.boxes,D.gameEnded,D.boxesVisible,D.aiAnalyzing,D.totalAttempts,p,me]),N=k.useCallback(async()=>{if(x.totalAttempts<3){console.log("⚠️ Yetersiz veri, AI analizi atlanıyor. Deneme:",x.totalAttempts),j("Daha fazla veri toplanıyor... 📊"),setTimeout(()=>j(""),2e3);return}try{console.log("🤖 AI Adaptasyon kontrolü başlıyor...",x),j("AI analiz ediyor... 🤖");const I=await VD.getAdaptiveDifficulty(x);y(I.newSettings),j(I.encouragement),L(I.tips),console.log("✅ AI Adaptasyon tamamlandı:",{newSettings:I.newSettings,reasoning:I.reasoning,oldSettings:p}),setTimeout(()=>{j("")},5e3)}catch(I){console.error("❌ AI Adaptasyon hatası:",I);const A=x.totalAttempts>0?x.correctAttempts/x.totalAttempts:0;A>.8?(y(we=>({...we,boxCount:Math.min(8,we.boxCount+1),conflictRate:Math.min(.9,we.conflictRate+.1)})),j("Harika performans! Zorluk artırıldı 🚀")):A<.5?(y(we=>({...we,boxCount:Math.max(3,we.boxCount-1),conflictRate:Math.max(.3,we.conflictRate-.1)})),j("Kolaylaştırdım, sen yapabilirsin! 💪")):j("Güzel devam ediyorsun! 👍"),setTimeout(()=>{j("")},4e3)}},[x,p]),R=k.useCallback(()=>{_({correctAttempts:0,totalAttempts:0,averageReactionTime:0,streakCounter:0,bestStreak:0,timeSpent:0,difficultyLevel:5,recentErrors:[]}),X.current=[],$(I=>({...I,gameStarted:!0,gameEnded:!1,score:0,timeRemaining:60,currentLevel:1,consecutiveCorrect:0,consecutiveWrong:0,totalAttempts:0,correctAttempts:0,streakCounter:0,bestStreak:0,boxesVisible:!1})),m.current=Date.now(),d.current=[],me()},[me]),P=k.useCallback(()=>{$(A=>({...A,gameEnded:!0}));const I=Date.now()-m.current;a(D.score,I,d.current)},[D.score,a]),V=k.useCallback(()=>{y({boxCount:6,commandVisibilityDuration:2500,conflictRate:.5,distractorCount:0,distractorTypes:["none"],pauseTime:600}),j(""),L([]),$(I=>({...I,gameStarted:!1,gameEnded:!1,score:0,timeRemaining:60,currentLevel:1,consecutiveCorrect:0,consecutiveWrong:0,totalAttempts:0,correctAttempts:0,streakCounter:0,bestStreak:0,aiAnalyzing:!1,boxesVisible:!1,boxes:[]}))},[]);return k.useEffect(()=>{if(!D.gameStarted||D.gameEnded||D.aiAnalyzing)return;const I=setInterval(()=>{$(A=>A.timeRemaining<=1?{...A,timeRemaining:0}:{...A,timeRemaining:A.timeRemaining-1})},1e3);return()=>clearInterval(I)},[D.gameStarted,D.gameEnded,D.aiAnalyzing]),k.useEffect(()=>{D.gameStarted&&D.timeRemaining===0&&!D.gameEnded&&P()},[D.gameStarted,D.timeRemaining,D.gameEnded,P]),k.useEffect(()=>{if(D.feedback.show){const I=setTimeout(()=>{$(A=>({...A,feedback:{...A.feedback,show:!1}}))},1500);return()=>clearTimeout(I)}},[D.feedback.show]),D.gameStarted?D.gameEnded?u.jsx("div",{className:"max-w-2xl mx-auto space-y-6",children:u.jsx(ut,{children:u.jsxs(dt,{className:"text-center py-8",children:[u.jsx("div",{className:"mb-6",children:u.jsx("div",{className:"w-20 h-20 mx-auto bg-gradient-to-r from-green-500 to-blue-500 rounded-full flex items-center justify-center",children:u.jsx(kb,{className:"h-10 w-10 text-white"})})}),u.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-4",children:"Oyun Tamamlandı!"}),u.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 max-w-2xl mx-auto mb-6",children:[u.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[u.jsx("div",{className:"text-2xl font-bold text-blue-600",children:D.score}),u.jsx("div",{className:"text-sm text-blue-800",children:"Toplam Puan"})]}),u.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[u.jsxs("div",{className:"text-2xl font-bold text-green-600",children:["%",D.totalAttempts>0?Math.round(D.correctAttempts/D.totalAttempts*100):0]}),u.jsx("div",{className:"text-sm text-green-800",children:"Doğruluk"})]}),u.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg",children:[u.jsx("div",{className:"text-2xl font-bold text-purple-600",children:D.bestStreak}),u.jsx("div",{className:"text-sm text-purple-800",children:"En İyi Seri"})]}),u.jsxs("div",{className:"bg-orange-50 p-4 rounded-lg",children:[u.jsxs("div",{className:"text-2xl font-bold text-orange-600",children:[x.averageReactionTime>0?Math.round(x.averageReactionTime):0,"ms"]}),u.jsx("div",{className:"text-sm text-orange-800",children:"Ort. Reaksiyon"})]})]}),B.length>0&&u.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 p-4 rounded-lg max-w-md mx-auto mb-6",children:[u.jsxs("div",{className:"flex items-center mb-2",children:[u.jsx(Ft,{className:"h-5 w-5 text-blue-600 mr-2"}),u.jsx("span",{className:"font-semibold text-blue-800",children:"AI Analizi"})]}),u.jsx("div",{className:"space-y-1",children:B.map((I,A)=>u.jsxs("div",{className:"text-sm text-blue-700",children:["• ",I]},A))})]}),u.jsxs("div",{className:"flex gap-4 justify-center",children:[u.jsxs(Nt,{onClick:V,className:"bg-gradient-to-r from-blue-500 to-purple-500 hover:from-blue-600 hover:to-purple-600 text-white",children:[u.jsx(Ys,{className:"h-4 w-4 mr-2"}),"Tekrar Oyna"]}),u.jsx(Nt,{onClick:()=>a(D.score,Date.now()-m.current,d.current),variant:"outline",children:"Bitir"})]})]})})}):u.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-purple-50 p-4",children:[u.jsx("div",{className:"max-w-6xl mx-auto mb-6",children:u.jsx(ut,{children:u.jsx(dt,{className:"py-4",children:u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsxs("div",{className:"flex items-center space-x-6",children:[D.commandVisible&&u.jsxs("div",{className:"bg-gradient-to-r from-blue-500 to-purple-500 text-white px-8 py-4 rounded-xl shadow-lg",children:[u.jsx("div",{className:"font-bold text-2xl text-center",children:D.command}),u.jsx("div",{className:"text-sm text-center mt-2 opacity-90",children:"Komutu oku ve hatırla!"})]}),!D.commandVisible&&!D.boxesVisible&&u.jsx("div",{className:"bg-gradient-to-r from-orange-500 to-red-500 text-white px-6 py-3 rounded-lg",children:u.jsx("div",{className:"font-bold text-lg text-center",children:"Kutular hazırlanıyor..."})}),!D.commandVisible&&D.boxesVisible&&u.jsx("div",{className:"text-gray-600 italic text-lg font-semibold",children:"Komutu hatırla ve doğru kutuyu seç!"})]}),u.jsxs("div",{className:"flex items-center space-x-6 text-sm",children:[u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx(br,{className:"h-4 w-4 text-blue-600"}),u.jsxs("span",{className:"font-semibold",children:[D.timeRemaining,"s"]})]}),u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx(kb,{className:"h-4 w-4 text-green-600"}),u.jsx("span",{className:"font-semibold",children:D.score})]}),u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx(Wn,{className:"h-4 w-4 text-purple-600"}),u.jsxs("span",{className:"font-semibold",children:[D.totalAttempts>0?Math.round(D.correctAttempts/D.totalAttempts*100):0,"% Doğru"]})]}),u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx(D1,{className:"h-4 w-4 text-orange-600"}),u.jsxs("span",{className:"font-semibold",children:["Seri: ",D.streakCounter]})]}),u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx(Ft,{className:"h-4 w-4 text-indigo-600"}),u.jsxs("span",{className:"font-semibold text-xs",children:["AI: ",p.boxCount," kutu, %",Math.round(p.conflictRate*100)," çatışma"]})]})]})]})})})}),u.jsx("div",{className:"max-w-6xl mx-auto",children:u.jsx("div",{ref:l,className:"relative w-full h-[600px] bg-white rounded-xl shadow-lg overflow-hidden",style:{position:"relative"},children:D.boxesVisible&&D.boxes.map(I=>u.jsx("div",{className:"absolute cursor-pointer transform hover:scale-105 transition-transform duration-150",style:{left:I.position.x,top:I.position.y,width:"100px",height:"100px"},onClick:()=>O(I.id),children:u.jsx("div",{className:"w-full h-full bg-white rounded-lg shadow-md border-2 border-gray-200 flex items-center justify-center hover:shadow-lg",children:I.isDistractor?u.jsx("div",{className:"text-4xl",children:I.textLabel}):u.jsx("div",{className:"text-xl font-bold",style:{color:zD[I.textColor]},children:I.textLabel})})},I.id))})}),D.aiAnalyzing&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:u.jsxs("div",{className:"bg-gradient-to-r from-blue-500 to-purple-500 text-white px-8 py-6 rounded-xl shadow-lg",children:[u.jsxs("div",{className:"flex items-center space-x-3",children:[u.jsx("div",{className:"w-6 h-6 border-2 border-white border-t-transparent rounded-full animate-spin"}),u.jsx(Ft,{className:"h-6 w-6"}),u.jsx("span",{className:"font-semibold text-lg",children:"AI performansını analiz ediyor..."})]}),u.jsx("div",{className:"text-center mt-2 text-blue-100 text-sm",children:"Oyun kısa sürede devam edecek"})]})}),w&&!D.aiAnalyzing&&u.jsx("div",{className:"fixed top-20 left-1/2 transform -translate-x-1/2 z-40 pointer-events-none",children:u.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-purple-500 text-white px-6 py-3 rounded-xl shadow-lg",children:u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx(Ft,{className:"h-5 w-5"}),u.jsx("span",{className:"font-semibold",children:w})]})})}),D.feedback.show&&u.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-50 pointer-events-none",children:u.jsx("div",{className:`
            px-8 py-4 rounded-xl text-white text-xl font-bold shadow-lg
            ${D.feedback.type==="correct"?"bg-gradient-to-r from-green-500 to-emerald-500":"bg-gradient-to-r from-red-500 to-pink-500"}
          `,children:D.feedback.message})})]}):u.jsx("div",{className:"max-w-4xl mx-auto space-y-6",children:u.jsx(ut,{children:u.jsxs(dt,{className:"text-center py-8",children:[u.jsx("div",{className:"mb-6",children:u.jsx("div",{className:"w-20 h-20 mx-auto bg-gradient-to-r from-red-500 to-orange-500 rounded-full flex items-center justify-center",children:u.jsx(Ft,{className:"h-10 w-10 text-white"})})}),u.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-4",children:"Çatışma Oyunu"}),u.jsx("p",{className:"text-gray-600 text-lg mb-6",children:"Stroop etkisiyle dikkatini geliştir! Yazan kelimeyle renk farklı olabilir."}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 max-w-2xl mx-auto mb-6",children:[u.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[u.jsx(Wn,{className:"h-6 w-6 text-blue-600 mx-auto mb-2"}),u.jsx("h3",{className:"font-semibold text-blue-800 mb-1",children:"Renk Odaklı"}),u.jsx("p",{className:"text-sm text-blue-600",children:"Belirtilen renkteki yazıyı bul"})]}),u.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[u.jsx(Ft,{className:"h-6 w-6 text-green-600 mx-auto mb-2"}),u.jsx("h3",{className:"font-semibold text-green-800 mb-1",children:"Kelime Odaklı"}),u.jsx("p",{className:"text-sm text-green-600",children:"Belirtilen kelimeyi bul"})]}),u.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg",children:[u.jsx(br,{className:"h-6 w-6 text-purple-600 mx-auto mb-2"}),u.jsx("h3",{className:"font-semibold text-purple-800 mb-1",children:"Zamana Karşı"}),u.jsx("p",{className:"text-sm text-purple-600",children:"60 saniyede en yüksek skoru yap"})]})]}),u.jsxs("div",{className:"mb-6 p-4 bg-yellow-50 rounded-lg max-w-md mx-auto",children:[u.jsx("h4",{className:"font-semibold text-yellow-800 mb-2",children:"Nasıl Oynanır?"}),u.jsxs("ul",{className:"text-sm text-yellow-700 space-y-1",children:[u.jsx("li",{children:"• Ekranda çıkan komutu oku"}),u.jsx("li",{children:"• Komuta uygun kutuyu tıkla"}),u.jsx("li",{children:"• Dikkat: Kelime ve renk farklı olabilir!"}),u.jsx("li",{children:"• Doğru: +100 puan, Yanlış: -50 puan"})]})]}),u.jsxs("div",{className:"flex flex-col gap-4 items-center",children:[u.jsxs(Nt,{onClick:R,size:"lg",className:"bg-gradient-to-r from-red-500 to-orange-500 hover:from-red-600 hover:to-orange-600 text-white px-8 py-3",children:[u.jsx(Wn,{className:"h-5 w-5 mr-2"}),"Oyunu Başlat - ",t==="kolay"?"Kolay":t==="orta"?"Orta":"Zor"]}),u.jsxs(Nt,{onClick:()=>N(),variant:"outline",size:"sm",className:"text-blue-600 border-blue-600 hover:bg-blue-50",children:[u.jsx(Ft,{className:"h-4 w-4 mr-2"}),"AI Test Et"]})]})]})})})},Ns=[{name:"Kırmızı",hex:"#FF0000",bgColor:"bg-red-500"},{name:"Mavi",hex:"#0000FF",bgColor:"bg-blue-500"},{name:"Yeşil",hex:"#00FF00",bgColor:"bg-green-500"},{name:"Sarı",hex:"#FFFF00",bgColor:"bg-yellow-500"},{name:"Turuncu",hex:"#FFA500",bgColor:"bg-orange-500"},{name:"Mor",hex:"#800080",bgColor:"bg-purple-500"},{name:"Pembe",hex:"#FFC0CB",bgColor:"bg-pink-500"},{name:"Beyaz",hex:"#FFFFFF",bgColor:"bg-white"},{name:"Siyah",hex:"#000000",bgColor:"bg-black"}],UD=({studentId:s,studentAge:e=6,onGameComplete:t,onEmotionDetected:a})=>{const[o,l]=k.useState("idle"),[d,m]=k.useState(null),[p,y]=k.useState(5),[x,_]=k.useState(60),[w,j]=k.useState(0),[B,L]=k.useState(1),[D]=k.useState(Date.now()),[$,X]=k.useState([]),[ne,ce]=k.useState(!1);k.useEffect(()=>{console.log("🎬 isVideoActive değişti:",ne)},[ne]);const[de,me]=k.useState(!1),[O,N]=k.useState(""),[R,P]=k.useState(0),[V,I]=k.useState(""),[A,we]=k.useState(null),se=k.useRef(null),q=k.useRef(null),he=k.useRef(null),G=k.useRef(null),re=k.useRef(null),C=k.useRef(null),Z=k.useCallback(async()=>{if(console.log("🎥 Kamera başlatılmaya çalışılıyor..."),console.log("🔍 Video ref durumu:",{current:!!se.current,isConnected:se.current?.isConnected,parentElement:!!se.current?.parentElement}),!se.current){console.error("❌ Video element henüz mevcut değil, DOM mount bekleniyor..."),I("Video element henüz hazır değil"),setTimeout(()=>{se.current&&(console.log("🔄 Video element bulundu, tekrar deneniyor..."),Z())},500);return}if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia){const Re="Browser kamera desteği yok. Lütfen modern bir tarayıcı kullanın.";console.error("❌",Re),I(Re),ce(!1);return}try{const Re=await navigator.mediaDevices.getUserMedia({video:!0,audio:!1});if(console.log("✅ Kamera akışı alındı:",Re),se.current){console.log("🎬 Video element bulundu, stream atanıyor..."),console.log("🏗️ Video element DOM durumu:",{isConnected:se.current.isConnected,parentElement:!!se.current.parentElement,tagName:se.current.tagName,autoplay:se.current.autoplay,playsInline:se.current.playsInline,muted:se.current.muted}),console.log("📊 Video element durumu:",{readyState:se.current.readyState,networkState:se.current.networkState,videoWidth:se.current.videoWidth,videoHeight:se.current.videoHeight}),se.current.srcObject=Re,se.current.onloadedmetadata=null,se.current.onerror=null;const Me=()=>{console.log("📹 Video metadata yüklendi"),console.log("📏 Video boyutları:",se.current?.videoWidth,"x",se.current?.videoHeight),console.log("📊 Video readyState:",se.current?.readyState),se.current&&se.current.play().then(()=>{console.log("▶️ Video oynatılmaya başladı"),console.log("✅ setIsVideoActive(true) çağrılıyor"),ce(!0),I("")}).catch(rt=>{console.error("❌ Video oynatma hatası:",rt),I("Video oynatılamıyor. Lütfen tarayıcıyı yenileyin."),ce(!1)})},kt=rt=>{console.error("❌ Video element hatası:",rt),I("Video element hatası oluştu."),ce(!1)};console.log("🔧 Event listener'lar ekleniyor..."),se.current.addEventListener("loadedmetadata",Me),se.current.addEventListener("error",kt),console.log("📊 Stream atama sonrası durum:",{readyState:se.current.readyState,networkState:se.current.networkState,srcObject:!!se.current.srcObject}),se.current.readyState>=1?(console.log("📹 Metadata zaten yüklü, direkt oynatılıyor"),Me()):console.log("⏳ Metadata yüklenmesi bekleniyor..."),setTimeout(()=>{se.current&&se.current.srcObject&&(console.log("🚀 Immediate play attempt..."),se.current.play().then(()=>{console.log("✅ Immediate play başarılı"),ne||(ce(!0),I(""))}).catch(rt=>{console.log("⏸️ Immediate play başarısız (normal):",rt.message)}))},100);const Qe=()=>{console.log("✅ Video oynatılabilir durumda"),console.log("🔍 isVideoActive mevcut değeri:",ne),ne||(console.log("📺 setIsVideoActive(true) çağrılıyor (canplay event)"),ce(!0),I(""))};se.current.addEventListener("canplay",Qe);const jt=()=>{if(se.current&&!ne&&(console.log("🔄 Agresif kontrol...",{readyState:se.current.readyState,videoWidth:se.current.videoWidth,videoHeight:se.current.videoHeight,srcObject:!!se.current.srcObject,currentTime:se.current.currentTime}),se.current.srcObject&&(se.current.readyState>=1||se.current.videoWidth>0||se.current.currentTime>0))){console.log("🚀 AGRESIF AKTİFLEŞTİRME: setIsVideoActive(true)"),ce(!0),I("");return}ne||setTimeout(jt,500)};setTimeout(jt,500)}}catch(Re){console.error("❌ Kamera erişimi başarısız:",Re),console.error("Hata tipi:",Re.name),console.error("Hata mesajı:",Re.message);let Me="";Re.name==="NotAllowedError"?Me="Kamera izni reddedildi. Lütfen tarayıcı ayarlarından kamera iznini aktifleştirin.":Re.name==="NotFoundError"?Me="Kamera bulunamadı. Lütfen kameranızın bağlı ve çalışır durumda olduğunu kontrol edin.":Re.name==="NotSupportedError"?Me="HTTPS gerekli. Lütfen sayfayı HTTPS üzerinden açın.":Me=`Kamera hatası: ${Re.message}`,I(Me),ce(!1)}},[]),H=k.useCallback(()=>{console.log("🛑 Kamera durduruluyor..."),se.current?.srcObject&&(se.current.srcObject.getTracks().forEach(Me=>{console.log("⏹️ Track durduruluyor:",Me.kind),Me.stop()}),se.current.srcObject=null),se.current&&(se.current.removeEventListener("loadedmetadata",()=>{}),se.current.removeEventListener("error",()=>{}),se.current.removeEventListener("canplay",()=>{})),ce(!1),I("")},[]),Y=k.useCallback(()=>{l("completed");const Re=Math.floor((Date.now()-D)/1e3);re.current&&clearInterval(re.current),G.current&&clearInterval(G.current),H(),t(w,Re,$)},[w,$,D,t,H]),oe=k.useCallback(async()=>{l("asking-ai"),_(60),await Z(),re.current=setInterval(()=>{_(Re=>Re<=1?(Y(),0):Re-1)},1e3),nt()},[Z,Y]),ge=k.useCallback(()=>{if(!se.current||!q.current||!d)return console.log("🔍 detectColor: Eksik element",{video:!!se.current,canvas:!!q.current,targetColor:!!d}),!1;const Re=q.current,Me=Re.getContext("2d"),kt=se.current;if(!Me)return console.log("❌ Canvas context alınamadı"),!1;if(kt.videoWidth===0||kt.videoHeight===0)return console.log("⚠️ Video boyutları henüz yüklenmedi:",kt.videoWidth,"x",kt.videoHeight),!1;try{Re.width=kt.videoWidth,Re.height=kt.videoHeight,Me.drawImage(kt,0,0);const St=Re.width/2,Qe=Re.height/2,jt=80,rt=Me.getImageData(St-jt/2,Qe-jt/2,jt,jt);let $e=0,$t=0,at=0;const zt=rt.data.length/4;for(let Jt=0;Jt<rt.data.length;Jt+=4)$e+=rt.data[Jt],$t+=rt.data[Jt+1],at+=rt.data[Jt+2];$e=Math.round($e/zt),$t=Math.round($t/zt),at=Math.round(at/zt),we({r:$e,g:$t,b:at});const Wt=We(d.hex);if(!Wt)return console.log("❌ Target RGB dönüştürülemedi:",d.hex),!1;const fn=Math.sqrt(Math.pow($e-Wt.r,2)+Math.pow($t-Wt.g,2)+Math.pow(at-Wt.b,2));return Math.random()<.05&&console.log("🎨 Renk analizi:",{detected:`rgb(${$e}, ${$t}, ${at})`,target:`rgb(${Wt.r}, ${Wt.g}, ${Wt.b})`,targetName:d.name,distance:fn.toFixed(1),threshold:200,match:fn<150}),fn<200}catch(St){return console.error("❌ Renk algılama hatası:",St),!1}},[d]),be=k.useCallback(()=>{if(!d){console.log("⚠️ Target color henüz belirlenmedi, renk algılama başlatılamıyor");return}if(G.current){console.log("⚠️ Renk algılama zaten çalışıyor, yeni başlatılmıyor");return}console.log("🎯 Renk algılama başlatılıyor...",{targetColor:d?.name,gameTimeLeft:x}),P(0),me(!1),G.current=setInterval(()=>{ge()?(console.log("✅ Renk eşleşti!"),me(!0),P(Me=>{const kt=Me+.1;if(kt>=5){console.log("🎉 5 saniye tamamlandı! Başarı!"),G.current&&(clearInterval(G.current),G.current=null),l("success"),j(Qe=>Qe+1);const St={emotion:"happy",confidence:.9,timestamp:new Date};X(Qe=>[...Qe,St]),a?.(St),setTimeout(()=>{x>0?(console.log("🔄 Yeni renk seçiliyor..."),nt()):console.log("⏰ Oyun süresi doldu")},2e3)}return kt})):(de&&console.log("❌ Renk kaybedildi, süre sıfırlanıyor"),me(!1),P(0))},100),console.log("✅ Renk algılama interval başlatıldı")},[ge,a,x,d,de]),nt=k.useCallback(async()=>{console.log("🤖 AI renk seçimi başlıyor..."),l("asking-ai"),N("");try{const Re=Ns.map(rt=>rt.name).join(", "),Me=Math.floor(Math.random()*1e3),kt=`SADECE TEK KELİME RENK İSMİ SÖYLE!

Renkler: ${Re}

SADECE BİR RENGİN İSMİNİ YAZ, BAŞKA HİÇBİR ŞEY YAZMA!
Örnek: Mavi
Örnek: Kırmızı

Şimdi sadece bir renk ismi yaz:`;console.log("📤 AI'ya gönderilen prompt:",kt);const St=await va.generateSimpleResponse(kt);console.log("📥 AI'dan gelen ham yanıt:",St);let Qe=St.replace(/<think>[\s\S]*?<\/think>/gs,"").replace(/<think>[\s\S]*/gs,"").replace(/<.*?>/g,"").replace(/Tamam,.*$/gs,"").replace(/Hmm,.*$/gs,"").replace(/Oyun #\d+.*$/gs,"").replace(/kullanıcı.*$/gs,"").replace(/.*?listesi.*$/gs,"").replace(/.*?seç.*$/gs,"").replace(/\n+/g," ").trim();if(!Qe||Qe.length<2){console.log("🎲 AI yanıtı boş/kısa, direkt fallback kullanılıyor");const rt=Ns[Math.floor(Math.random()*Ns.length)];console.log("🎲 Rastgele seçilen renk:",rt.name),m(rt),l("counting");return}console.log("🧹 Temizlenmiş AI yanıtı:",Qe),N(Qe);const jt=Ns.find(rt=>Qe.toLowerCase().includes(rt.name.toLowerCase())||rt.name.toLowerCase().includes(Qe.toLowerCase()));if(jt)console.log("✅ AI renk seçimi başarılı:",jt.name),m(jt),l("counting");else{console.log("⚠️ AI yanıtından renk bulunamadı, fallback kullanılıyor"),console.log("🔍 Aranan response:",Qe);const rt=Ns[Math.floor(Math.random()*Ns.length)];console.log("🎲 Rastgele seçilen renk:",rt.name),m(rt),l("counting")}}catch(Re){console.error("❌ AI renk seçimi başarısız:",Re);const Me=Ns[Math.floor(Math.random()*Ns.length)];console.log("🎲 Hata sonrası rastgele seçilen renk:",Me.name),m(Me),l("counting")}},[]),We=Re=>{const Me=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(Re);return Me?{r:parseInt(Me[1],16),g:parseInt(Me[2],16),b:parseInt(Me[3],16)}:null};k.useEffect(()=>{if(d&&o==="counting"){console.log("🎯 Target color değişti, renk algılama başlatılıyor:",d.name),G.current&&(clearInterval(G.current),G.current=null);const Re=setTimeout(()=>{be()},100);return()=>{clearTimeout(Re)}}},[d,o]),k.useEffect(()=>{console.log("🚀 Component mount oldu, kamera başlatılıyor...");const Re=setTimeout(()=>{Z()},100);return()=>clearTimeout(Re)},[]),k.useEffect(()=>()=>{he.current&&clearInterval(he.current),G.current&&clearInterval(G.current),re.current&&clearInterval(re.current),C.current&&clearInterval(C.current),H()},[H]);const st=()=>{j(0),L(1),X([]),l("idle"),m(null),_(60),P(0),me(!1),I(""),re.current&&clearInterval(re.current),G.current&&clearInterval(G.current),H()};return o==="completed"?u.jsx(ut,{className:"max-w-2xl mx-auto",children:u.jsxs(dt,{className:"text-center py-12",children:[u.jsxs("div",{className:"mb-6",children:[u.jsx("div",{className:"w-24 h-24 mx-auto mb-4 bg-gradient-to-r from-purple-500 to-pink-500 rounded-full flex items-center justify-center",children:u.jsx(xh,{className:"h-12 w-12 text-white"})}),u.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"1 Dakika Tamamlandı!"}),u.jsx("p",{className:"text-gray-600",children:"AI ile renk tanıma oyununu başarıyla bitirdin!"})]}),u.jsx("div",{className:"bg-gray-50 rounded-lg p-6 mb-6",children:u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"text-4xl font-bold text-purple-600 mb-2",children:w}),u.jsx("div",{className:"text-sm text-gray-600",children:"Başarılı Renk Tanıma"}),u.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"1 dakika içinde"})]})}),u.jsxs(Nt,{onClick:st,size:"lg",children:[u.jsx(Ys,{className:"h-5 w-5 mr-2"}),"Tekrar Oyna"]})]})}):u.jsxs("div",{className:"max-w-2xl mx-auto space-y-6",children:[u.jsx("video",{ref:se,autoPlay:!0,playsInline:!0,muted:!0,style:{display:"none"}}),u.jsx(ut,{children:u.jsx(dt,{children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsxs("div",{className:"text-sm text-gray-600",children:["Süre: ",Math.floor(x/60),":",(x%60).toString().padStart(2,"0")]}),u.jsxs("div",{className:"text-sm font-medium text-gray-800",children:["Skor: ",w]}),o==="counting"&&d&&u.jsxs("div",{className:"text-sm text-blue-600",children:[d.name,": ",R.toFixed(1),"/5.0s"]})]}),u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx(Ft,{className:"h-4 w-4 text-purple-600"}),u.jsx("span",{className:"text-sm text-gray-600",children:"AI Destekli"}),ne&&u.jsx(Fa,{className:"h-4 w-4 text-green-600"})]})]})})}),u.jsx(ut,{children:u.jsxs(dt,{className:"text-center py-8",children:[o==="idle"&&u.jsxs("div",{className:"space-y-6",children:[u.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full flex items-center justify-center",children:u.jsx(Wn,{className:"h-8 w-8 text-white"})}),u.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"AI Renk Tanıma Oyunu"}),u.jsxs("p",{className:"text-gray-600",children:["1 dakika süresince AI'nin seçtiği renkleri kameraya göster!",u.jsx("br",{}),"Her rengi 5 saniye tuttuğunda puan kazanırsın."]}),V?u.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[u.jsxs("div",{className:"flex items-center space-x-2 text-red-700 mb-2",children:[u.jsx(Fa,{className:"h-5 w-5"}),u.jsx("span",{className:"font-medium",children:"Kamera Sorunu"})]}),u.jsx("p",{className:"text-red-600 text-sm mb-3",children:V}),u.jsx(Nt,{onClick:Z,size:"sm",className:"bg-red-600 hover:bg-red-700",children:"Kamerayı Tekrar Dene"})]}):ne?u.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:u.jsxs("div",{className:"flex items-center space-x-2 text-green-700",children:[u.jsx(Fa,{className:"h-5 w-5"}),u.jsx("span",{className:"font-medium",children:"Kamera Hazır ✓"})]})}):u.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[u.jsxs("div",{className:"flex items-center space-x-2 text-blue-700 mb-2",children:[u.jsx(Fa,{className:"h-5 w-5"}),u.jsx("span",{className:"font-medium",children:"Kamera Gerekli"})]}),u.jsx("p",{className:"text-blue-600 text-sm mb-3",children:"Bu oyun kamera erişimi gerektirir"}),u.jsx(Nt,{onClick:Z,size:"sm",className:"bg-blue-600 hover:bg-blue-700",children:"Kamerayı Test Et"})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsxs(Nt,{onClick:oe,size:"lg",disabled:!ne,className:`${ne?"":"opacity-50 cursor-not-allowed"}`,children:[u.jsx(Fa,{className:"h-5 w-5 mr-2"}),"Oyunu Başlat"]}),u.jsxs("div",{className:"text-xs text-gray-500 bg-gray-100 p-2 rounded space-y-1",children:[u.jsxs("div",{children:["Debug: isVideoActive = ",ne.toString()]}),u.jsxs("div",{children:["Video ref: ",se.current?"mevcut":"yok"]}),se.current&&u.jsxs("div",{children:["Video readyState: ",se.current.readyState]}),V&&u.jsxs("div",{className:"text-red-500",children:["Error: ",V]})]}),ne&&u.jsx("div",{className:"relative inline-block",children:u.jsxs("div",{className:"w-60 h-45 rounded-lg border-2 border-gray-300 shadow-lg bg-black relative overflow-hidden",children:[u.jsx("video",{autoPlay:!0,playsInline:!0,muted:!0,className:"w-full h-full object-cover",ref:Re=>{Re&&se.current?.srcObject&&(Re.srcObject=se.current.srcObject)}}),u.jsx("div",{className:"absolute bottom-2 left-2 bg-black bg-opacity-50 text-white text-xs px-2 py-1 rounded",children:"Kamera Hazır"})]})})]})]}),o==="asking-ai"&&u.jsxs("div",{className:"space-y-4",children:[u.jsx("div",{className:"w-16 h-16 border-4 border-purple-500 border-t-transparent rounded-full animate-spin mx-auto"}),u.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"AI Renk Seçiyor..."}),u.jsx("p",{className:"text-gray-600",children:"Gemma 9B model çalışıyor"})]}),o==="counting"&&d&&u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"space-y-4",children:[O&&u.jsx("div",{className:"bg-blue-50 p-3 rounded-lg",children:u.jsxs("p",{className:"text-blue-800 font-medium",children:['AI: "',O,'"']})}),u.jsx("div",{className:`w-32 h-32 mx-auto rounded-full ${d.bgColor} shadow-xl border-4 border-gray-300`}),u.jsx("h2",{className:"text-3xl font-bold text-gray-800",children:d.name})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[u.jsx(br,{className:"h-5 w-5 text-gray-600"}),u.jsx("p",{className:"text-gray-600",children:"Bu rengi kameraya 5 saniye göster!"})]}),u.jsx("div",{className:"w-full bg-gray-200 rounded-full h-4",children:u.jsx("div",{className:`h-4 rounded-full transition-all duration-100 ${de?"bg-green-500":"bg-gray-400"}`,style:{width:`${R/5*100}%`}})}),u.jsx("div",{className:"text-center",children:u.jsxs("span",{className:`text-2xl font-bold ${de?"text-green-600":"text-gray-500"}`,children:[R.toFixed(1),"/5.0s"]})}),de&&u.jsx("div",{className:"text-green-600 font-medium",children:"✅ Renk algılandı! Tutmaya devam et..."}),A&&u.jsxs("div",{className:"text-xs bg-gray-100 p-2 rounded space-y-1",children:[u.jsxs("div",{children:["Algılanan: rgb(",A.r,", ",A.g,", ",A.b,")"]}),u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx("span",{children:"Örnek:"}),u.jsx("div",{className:"w-8 h-4 border rounded",style:{backgroundColor:`rgb(${A.r}, ${A.g}, ${A.b})`}})]}),d&&u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx("span",{children:"Hedef:"}),u.jsx("div",{className:"w-8 h-4 border rounded",style:{backgroundColor:d.hex}}),u.jsx("span",{children:d.hex})]})]})]}),u.jsx("div",{className:"space-y-4",children:ne?u.jsx("div",{className:"relative inline-block",children:u.jsxs("div",{className:"w-80 h-60 rounded-lg border-4 border-gray-300 shadow-lg bg-black relative overflow-hidden",children:[u.jsx("video",{autoPlay:!0,playsInline:!0,muted:!0,className:"w-full h-full object-cover",ref:Re=>{Re&&se.current?.srcObject&&(Re.srcObject=se.current.srcObject)}}),u.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2",children:u.jsx("div",{className:`w-16 h-16 border-4 ${de?"border-green-400":"border-yellow-400"} rounded-lg pointer-events-none animate-pulse`,children:u.jsx("div",{className:"w-full h-full bg-transparent"})})}),u.jsx("div",{className:"absolute top-2 right-2",children:u.jsx("div",{className:`w-8 h-8 rounded-full ${d.bgColor} border-2 border-white shadow-md`})})]})}):u.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[u.jsxs("div",{className:"flex items-center justify-center space-x-2 text-red-700 mb-2",children:[u.jsx(Fa,{className:"h-5 w-5"}),u.jsx("span",{className:"font-medium",children:"Kamera Problemi"})]}),u.jsx("p",{className:"text-red-600 text-sm mb-3",children:V||"Kamera erişilemedi"}),u.jsx(Nt,{onClick:Z,size:"sm",className:"bg-red-600 hover:bg-red-700",children:"Kamerayı Yeniden Başlat"})]})})]}),o==="success"&&u.jsxs("div",{className:"space-y-6",children:[u.jsx("div",{className:"w-24 h-24 mx-auto bg-green-500 rounded-full flex items-center justify-center",children:u.jsx(ts,{className:"h-12 w-12 text-white"})}),u.jsx("h2",{className:"text-2xl font-bold text-green-600",children:"Başarılı!"}),u.jsx("p",{className:"text-gray-600",children:"+1 Puan! Yeni renk yükleniyor... 🌈"}),u.jsx("div",{className:"w-16 h-16 border-4 border-green-500 border-t-transparent rounded-full animate-spin mx-auto"})]})]})}),u.jsx("canvas",{ref:q,style:{display:"none"}})]})},BD=({studentId:s,studentAge:e=12,onGameComplete:t,onEmotionDetected:a})=>{const[o,l]=k.useState(null),[d,m]=k.useState("orta"),[p,y]=k.useState(!1),x=k.useRef({studentId:s,studentAge:e,onGameComplete:t,onEmotionDetected:a}),_=k.useRef(0);_.current+=1;const w=x.current.studentId!==s||x.current.studentAge!==e||x.current.onGameComplete!==t||x.current.onEmotionDetected!==a;console.log("🔄 [RENDER] AttentionGameSelector render edildi:",{renderCount:_.current,selectedGame:o,selectedDifficulty:d,gameStarted:p,propsChanged:w,changedProps:w?{studentId:x.current.studentId!==s,studentAge:x.current.studentAge!==e,onGameComplete:x.current.onGameComplete!==t,onEmotionDetected:x.current.onEmotionDetected!==a}:"none",timestamp:new Date().toISOString()}),x.current={studentId:s,studentAge:e,onGameComplete:t,onEmotionDetected:a};const j=[{id:"click",name:"Dikkat Tıklama",description:"Hızlı reaksiyon gerektiren tek hedef tıklama oyunu",icon:u.jsx(Uj,{className:"h-8 w-8"}),color:"blue",bgGradient:"from-blue-500 to-purple-500",features:["Tek hedef odaklanma","Hızlı reaksiyon geliştirme","Dikkat dağıtıcılarla mücadele","Zamanlama becerileri"]},{id:"count",name:"Dikkat Sayma",description:"Beliren objeleri sayarak konsantrasyon geliştirme",icon:u.jsx(R1,{className:"h-8 w-8"}),color:"green",bgGradient:"from-green-500 to-emerald-500",features:["Sayısal dikkat","Görsel takip","Konsantrasyon geliştirme","Bellek destekleme"]},{id:"dynamic",name:"Dinamik Dikkat",description:"Sürekli çıkan hedefleri hızla yakalama",icon:u.jsx(qo,{className:"h-8 w-8"}),color:"purple",bgGradient:"from-purple-500 to-pink-500",features:["Çoklu hedef takibi","Hızlı karar verme","Reflexleri geliştirme","Sürekli dikkat"]},{id:"conflict",name:"Çatışma Oyunu",description:"Stroop etkisi ile dikkat geliştirme",icon:u.jsx(xh,{className:"h-8 w-8"}),color:"red",bgGradient:"from-red-500 to-orange-500",features:["Stroop etkisi deneyimi","Renk-kelime çatışması","Dikkat odaklanma","Bilişsel esneklik"]},{id:"colorRecognition",name:"AI Renk Tanıma",description:"AI seçtiği rengi kameraya gösterme oyunu",icon:u.jsx(Fa,{className:"h-8 w-8"}),color:"indigo",bgGradient:"from-indigo-500 to-purple-500",features:["AI destekli renk seçimi","Gerçek zamanlı renk tanıma","Kamera etkileşimi","5 saniye odaklanma"]}],B=[{id:"kolay",name:"Kolay",description:"Yeni başlayanlar için",color:"green",features:["Az dikkat dağıtıcı","Uzun süre limiti","Basit hedefler"]},{id:"orta",name:"Orta",description:"Deneyimliler için",color:"yellow",features:["Orta dikkat dağıtıcı","Normal süre","Karmaşık hedefler"]},{id:"zor",name:"Zor",description:"Uzmanlar için",color:"red",features:["Çok dikkat dağıtıcı","Kısa süre","Karışık hedefler"]}],L=ce=>{console.log("🎮 [DEBUG] Game selected:",ce),l(ce)},D=ce=>{console.log("🎯 [DEBUG] Difficulty selected:",ce),m(ce),console.log("🎯 [DEBUG] Selected difficulty updated to:",ce)},$=()=>{console.log("🎮 [DEBUG] Starting game:",o,"difficulty:",d),y(!0)},X=()=>{l(null),m("orta"),y(!1)},ne=(ce,de,me)=>{t(ce,de,me),y(!1)};if(p&&o){console.log("🚀 [DEBUG] Rendering game:",o,"with props:",{studentId:s,studentAge:e,difficulty:d});const ce={studentId:s,studentAge:e,difficulty:d,onGameComplete:ne,onEmotionDetected:a};try{switch(o){case"click":return console.log("🎯 [DEBUG] Loading AttentionClickGame"),u.jsx(jD,{...ce});case"count":return console.log("🔢 [DEBUG] Loading AttentionCountGame"),u.jsx(DD,{...ce});case"dynamic":return console.log("⚡ [DEBUG] Loading AttentionDynamicGame"),u.jsx(OD,{...ce});case"conflict":return console.log("🎨 [DEBUG] Loading ConflictGame"),u.jsx(LD,{...ce});case"colorRecognition":return console.log("📷 [DEBUG] Loading ColorRecognitionGame"),u.jsx(UD,{studentId:s,studentAge:e,onGameComplete:ne,onEmotionDetected:a});default:return console.error("❌ [DEBUG] Unknown game type:",o),null}}catch(de){return console.error("❌ [DEBUG] Error rendering game:",de),u.jsxs("div",{className:"max-w-2xl mx-auto p-8 text-center",children:[u.jsx("h2",{className:"text-xl font-bold text-red-600 mb-4",children:"Oyun Yüklenirken Hata Oluştu"}),u.jsxs("p",{className:"text-gray-600 mb-4",children:["Hata: ",de.message]}),u.jsx(Nt,{onClick:X,children:"Geri Dön"})]})}}if(o){const ce=j.find(de=>de.id===o);return console.log("🎯 [DEBUG] Zorluk seçim ekranı açıldı. Oyun:",o,"Mevcut zorluk:",d),u.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[u.jsx(ut,{children:u.jsxs(dt,{className:"flex items-center justify-between py-4",children:[u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsxs(Nt,{variant:"ghost",size:"sm",onClick:X,className:"text-gray-600 hover:text-gray-800",children:[u.jsx(gj,{className:"h-4 w-4 mr-2"}),"Geri Dön"]}),u.jsxs("div",{className:"flex items-center space-x-3",children:[u.jsx("div",{className:`w-10 h-10 rounded-full bg-gradient-to-r ${ce.bgGradient} flex items-center justify-center text-white`,children:ce.icon}),u.jsxs("div",{children:[u.jsx("h2",{className:"text-xl font-bold text-gray-800",children:ce.name}),u.jsx("p",{className:"text-sm text-gray-600",children:"Zorluk seviyesi seç"})]})]})]}),u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx(Ft,{className:"h-5 w-5 text-purple-600"}),u.jsx("span",{className:"text-sm text-purple-600",children:"Adaptif AI"})]})]})}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:B.map(de=>u.jsx(ut,{className:`
                cursor-pointer transition-all duration-200 hover:scale-105 pointer-events-auto
                ${d===de.id?"ring-2 ring-blue-500 shadow-lg":"hover:shadow-md"}
              `,onClick:me=>{me.preventDefault(),me.stopPropagation(),console.log("🖱️ [DEBUG] Card clicked for difficulty:",de.id,"Game:",o),D(de.id)},onMouseDown:me=>{me.preventDefault(),console.log("🖱️ [DEBUG] MouseDown for difficulty:",de.id),D(de.id)},style:{zIndex:1},children:u.jsxs(dt,{className:"text-center py-8 pointer-events-none",children:[u.jsx("div",{className:"mb-4",children:u.jsx("div",{className:`
                    w-16 h-16 mx-auto rounded-full flex items-center justify-center text-2xl font-bold
                    ${de.color==="green"?"bg-green-100 text-green-600":de.color==="yellow"?"bg-yellow-100 text-yellow-600":"bg-red-100 text-red-600"}
                  `,children:de.id==="kolay"?"1":de.id==="orta"?"2":"3"})}),u.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-2",children:de.name}),u.jsx("p",{className:"text-gray-600 text-sm mb-4",children:de.description}),u.jsx("div",{className:"space-y-2",children:de.features.map((me,O)=>u.jsxs("div",{className:"flex items-center justify-center space-x-2 text-sm text-gray-700",children:[u.jsx(ts,{className:"h-3 w-3 text-gray-400"}),u.jsx("span",{children:me})]},O))}),d===de.id&&u.jsx("div",{className:"mt-4",children:u.jsx("div",{className:"w-6 h-6 mx-auto bg-blue-500 rounded-full flex items-center justify-center",children:u.jsx("div",{className:"w-2 h-2 bg-white rounded-full"})})}),u.jsx("div",{className:"mt-4 pointer-events-auto",children:u.jsx("button",{className:"w-full py-2 px-4 text-sm bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",onClick:me=>{me.preventDefault(),me.stopPropagation(),console.log("🔘 [DEBUG] Button clicked for difficulty:",de.id),D(de.id)},children:d===de.id?"✓ Seçili":"Seç"})})]})},de.id))}),u.jsx("div",{className:"text-center",children:u.jsxs(Nt,{onClick:$,size:"lg",className:"bg-gradient-to-r from-blue-500 to-purple-500 hover:from-blue-600 hover:to-purple-600 text-white px-8 py-3",children:[u.jsx(Wn,{className:"h-5 w-5 mr-2"}),ce.name," - ",B.find(de=>de.id===d)?.name," Başlat"]})})]})}return u.jsxs("div",{className:"max-w-6xl mx-auto space-y-6",children:[u.jsx(ut,{children:u.jsxs(dt,{className:"text-center py-8",children:[u.jsx("div",{className:"mb-4",children:u.jsx("div",{className:"w-20 h-20 mx-auto bg-gradient-to-r from-blue-500 to-purple-500 rounded-full flex items-center justify-center",children:u.jsx(Ft,{className:"h-10 w-10 text-white"})})}),u.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Dikkat Oyunları"}),u.jsx("p",{className:"text-gray-600 text-lg",children:"Dikkat dağınıklığıyla başa çıkmak için özel olarak tasarlanmış oyunlar"}),u.jsxs("div",{className:"mt-4 flex items-center justify-center space-x-2 text-sm text-purple-600",children:[u.jsx(br,{className:"h-4 w-4"}),u.jsx("span",{children:"AI destekli adaptif zorluk sistemi"})]})]})}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:j.map(ce=>u.jsx(ut,{className:"cursor-pointer transition-all duration-200 hover:scale-105 hover:shadow-lg",onClick:()=>L(ce.id),children:u.jsxs(dt,{className:"text-center py-8",children:[u.jsx("div",{className:"mb-6",children:u.jsx("div",{className:`w-16 h-16 mx-auto rounded-full bg-gradient-to-r ${ce.bgGradient} flex items-center justify-center text-white`,children:ce.icon})}),u.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-3",children:ce.name}),u.jsx("p",{className:"text-gray-600 text-sm mb-6",children:ce.description}),u.jsx("div",{className:"space-y-3",children:ce.features.map((de,me)=>u.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-700",children:[u.jsx("div",{className:`w-2 h-2 rounded-full ${ce.color==="blue"?"bg-blue-400":ce.color==="green"?"bg-green-400":ce.color==="purple"?"bg-purple-400":ce.color==="indigo"?"bg-indigo-400":"bg-red-400"}`}),u.jsx("span",{children:de})]},me))}),u.jsx("div",{className:"mt-6",children:u.jsx(Nt,{onClick:()=>L(ce.id),className:`w-full ${ce.color==="blue"?"bg-blue-500 hover:bg-blue-600":ce.color==="green"?"bg-green-500 hover:bg-green-600":ce.color==="purple"?"bg-purple-500 hover:bg-purple-600":ce.color==="indigo"?"bg-indigo-500 hover:bg-indigo-600":"bg-red-500 hover:bg-red-600"} text-white`,children:"Oyna"})})]})},ce.id))}),u.jsx(ut,{className:"bg-gradient-to-r from-blue-50 to-purple-50",children:u.jsx(dt,{className:"py-6",children:u.jsxs("div",{className:"flex items-start space-x-4",children:[u.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full flex items-center justify-center flex-shrink-0",children:u.jsx(Ft,{className:"h-6 w-6 text-white"})}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"AI Destekli Adaptif Sistem"}),u.jsx("p",{className:"text-gray-700 text-sm",children:"Her oyun, performansına göre otomatik olarak zorluk seviyesini ayarlar. Başarı oranına, reaksiyon süresine ve odaklanma durumuna göre kişiselleştirilmiş görevler üretir. Bu sayede her zaman en uygun zorluk seviyesinde oynayarak dikkat becerilerini geliştirebilirsin."})]})]})})})]})};class GD{constructor(){this.apiEndpoint="https://3c9bc3387069.ngrok-free.app/api/generate",this.fallbackScenes=[{id:1,story:"Ali büyülü bir ormana girdi. Önünde iki kapı belirdi.",question:"Ali hangi kapıyı seçmeli?",choices:[{id:"a",text:"🟢 Yeşil Kapı",color:"#10B981",isCorrect:!0},{id:"b",text:"🔴 Kırmızı Kapı",color:"#EF4444",isCorrect:!1},{id:"c",text:"🎁 Parlak Kutu",color:"#F59E0B",isCorrect:!1,isDistractor:!0}]},{id:2,story:"Ali doğru renge sahip kapıdan geçmeli.",question:"Hangi seçenek doğru RENGE sahip?",choices:[{id:"a",text:"MAVİ",color:"#EF4444",isCorrect:!1,stroopConflict:!0},{id:"b",text:"KIRMIZI",color:"#3B82F6",isCorrect:!1,stroopConflict:!0},{id:"c",text:"YEŞİL",color:"#10B981",isCorrect:!0},{id:"d",text:"💎 Elmas",color:"#8B5CF6",isCorrect:!1,isDistractor:!0}]},{id:3,story:"Ali köprüden geçerken dikkatli olmalı. Tehlikeli yaratıklar var!",question:"Ali hangi köprüyü seçmeli?",choices:[{id:"a",text:"🌉 Güvenli Köprü",isCorrect:!0},{id:"b",text:"⚡ Yıldırım Köprü",isCorrect:!1},{id:"c",text:"🍭 Şeker Köprü",isCorrect:!1,isDistractor:!0}],backgroundTask:{targetSymbol:"🐍",instruction:"Yılan göründüğünde DOKUNMA!"}},{id:4,story:"Ejderha aniden ortaya çıktı! Hızla kaçmak gerekiyor!",question:"Acil durum! Ne yapmalı?",choices:[{id:"a",text:"🏃‍♂️ KAÇ",isCorrect:!0},{id:"b",text:"⚔️ SAVAŞ",isCorrect:!1},{id:"c",text:"🎪 DANS ET",isCorrect:!1,isDistractor:!0}],emergencyTask:{symbol:"🚨",duration:2e3,instruction:"HIZLA KAÇ butonuna bas!"}},{id:5,story:"Ali hazine odasına ulaştı. Doğru renkteki sandığı seçmeli.",question:"Hangi renk yazısı doğru renkte yazılmış?",choices:[{id:"a",text:"SARI",color:"#10B981",isCorrect:!1,stroopConflict:!0},{id:"b",text:"PEMBE",color:"#EC4899",isCorrect:!0},{id:"c",text:"TURUNCU",color:"#3B82F6",isCorrect:!1,stroopConflict:!0},{id:"d",text:"🌟 Yıldız",color:"#F59E0B",isCorrect:!1,isDistractor:!0}]},{id:6,story:"Ali büyücünün testine girdi. Aynı anda iki işi yapması gerekiyor!",question:"Ali hangi büyüyü seçmeli?",choices:[{id:"a",text:"✨ İyileştirme Büyüsü",isCorrect:!0},{id:"b",text:"💥 Patlama Büyüsü",isCorrect:!1},{id:"c",text:"🎭 Yanılsama Büyüsü",isCorrect:!1,isDistractor:!0}],backgroundTask:{targetSymbol:"🦉",instruction:"Baykuş göründüğünde DOKUNMA!"}}]}async generateStory(e){try{const t=await this.callAIService(e);return t.scenes&&t.scenes.length>0?t:(console.warn("AI service returned empty scenes, using fallback"),this.generateFallbackStory(e))}catch(t){return console.warn("AI Story Service failed, using fallback:",t),this.generateFallbackStory(e)}}async generateNextScene(e){try{return await this.callDynamicSceneService(e)}catch(t){return console.warn("Dynamic scene generation failed, using fallback:",t),this.generateFallbackScene(e)}}async callAIService(e){const t=this.constructPrompt(e),a=await fetch(this.apiEndpoint,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:"alibayram/turkish-gemma-9b-v0.1:latest",prompt:t,stream:!1,options:{num_ctx:2048,num_batch:256,temperature:.7,top_p:.9,repeat_penalty:1.1}})});if(!a.ok){const l=await a.text();throw console.error("Ollama error response:",l),new Error(`Ollama Service responded with status: ${a.status} - ${l}`)}const o=await a.json();return console.log("Ollama response:",o),this.parseOllamaResponse(o,e)}async callDynamicSceneService(e){const t=this.constructDynamicPrompt(e),a=await fetch(this.apiEndpoint,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:"alibayram/turkish-gemma-9b-v0.1:latest",prompt:t,stream:!1,options:{num_ctx:1024,num_batch:256,temperature:.8,top_p:.9,repeat_penalty:1.1}})});if(!a.ok){const l=await a.text();throw console.error("Dynamic scene error:",l),new Error(`Dynamic Scene Service error: ${a.status}`)}const o=await a.json();return console.log("Dynamic scene response:",o),this.parseDynamicSceneResponse(o,e)}constructDynamicPrompt(e){let t=`${e.studentAge} yaşındaki çocuk için ${e.theme} temalı hikaye devamı oluştur.

Sahne ${e.sceneNumber}:`;return e.previousStory&&e.userChoice?t+=`
Önceki durum: ${e.previousStory}
Çocuğun seçimi: ${e.userChoice}

Bu seçime göre hikayeyi devam ettir.`:t+=`
Bu hikayenin başlangıç sahnesi. Çocuk için ilginç bir durumla başla.`,t+=`

Tek bir sahne JSON'ı döndür:
{
  "id": ${e.sceneNumber},
  "story": "Kısa hikaye (1-2 cümle)",
  "question": "Çocuğa soru?",
  "choices": [
    {"id": "a", "text": "🟢 Seçenek 1", "isCorrect": true},
    {"id": "b", "text": "🔴 Seçenek 2", "isCorrect": false},
    {"id": "c", "text": "💎 Çeldirici seçenek", "isCorrect": false, "isDistractor": true}
  ]
}

Sadece JSON döndür.`,t}parseDynamicSceneResponse(e,t){try{const a=e.response||"";console.log("Dynamic scene response text:",a);let o=a;o.includes("```json")&&(o=o.replace(/```json\s*/,"")),o.includes("```")&&(o=o.replace(/```\s*$/,""));const l=o.match(/\{[\s\S]*\}/);if(!l)throw new Error("No JSON found in dynamic scene response");let d=l[0];d=d.replace(/,(\s*[}\]])/g,"$1"),d=d.trim(),console.log("Parsed dynamic scene JSON:",d);const m=JSON.parse(d);return{id:m.id||t.sceneNumber,story:m.story||`Sahne ${t.sceneNumber}`,question:m.question||"Ne yapmalı?",choices:m.choices?.map((p,y)=>({id:p.id||String.fromCharCode(97+y),text:p.text||`Seçenek ${y+1}`,color:p.color,isCorrect:p.isCorrect||!1,isDistractor:p.isDistractor||!1,stroopConflict:p.stroopConflict||!1}))||[{id:"a",text:"🟢 Devam et",isCorrect:!0,isDistractor:!1,stroopConflict:!1},{id:"b",text:"🔴 Dur",isCorrect:!1,isDistractor:!1,stroopConflict:!1}],emergencyTask:m.emergencyTask,backgroundTask:m.backgroundTask}}catch(a){throw console.error("Dynamic scene parse error:",a),a}}generateFallbackScene(e){const a=[{story:`Ali yeni bir yola çıktı. (Sahne ${e.sceneNumber})`,question:"Hangi yönde gitmeli?",choices:[{id:"a",text:"🟢 Sağa git",isCorrect:!0},{id:"b",text:"🔴 Sola git",isCorrect:!1},{id:"c",text:"💎 Parlak taş",isCorrect:!1,isDistractor:!0}]},{story:`Ali ilginç bir yaratıkla karşılaştı. (Sahne ${e.sceneNumber})`,question:"Ne yapmalı?",choices:[{id:"a",text:"🟢 Dostça yaklaş",isCorrect:!0},{id:"b",text:"🔴 Kaç",isCorrect:!1},{id:"c",text:"🎁 Hediye ver",isCorrect:!1,isDistractor:!0}]}][e.sceneNumber%2];return{id:e.sceneNumber,story:a.story,question:a.question,choices:a.choices.map((o,l)=>({...o,isDistractor:o.isDistractor||!1,stroopConflict:!1}))}}constructPrompt(e){return`${e.studentAge} yaşındaki bir çocuk için Türkçe hikaye oyunu oluştur. ${e.sceneCount||4} sahne olsun.

Tema: ${e.theme||"Ali'nin maceraları"}

Her sahne için:
- Kısa hikaye (1-2 cümle)
- Soru
- 3-4 seçenek (1 doğru, diğerleri yanlış, bazıları çeldirici)

JSON formatında döndür:
{
  "scenes": [
    {
      "id": 1,
      "story": "Ali ormana girdi.",
      "question": "Hangi yolu seçmeli?",
      "choices": [
        {"id": "a", "text": "🟢 Yeşil yol", "isCorrect": true},
        {"id": "b", "text": "🔴 Kırmızı yol", "isCorrect": false},
        {"id": "c", "text": "💎 Parlayan taş", "isCorrect": false, "isDistractor": true}
      ]
    }
  ]
}

Sadece JSON döndür, başka açıklama yazma.`}parseOllamaResponse(e,t){try{const a=e.response||"";console.log("Full Ollama response text:",a);let o=a;o.includes("```json")&&(o=o.replace(/```json\s*/,"")),o.includes("```")&&(o=o.replace(/```\s*$/,""));let l=o.match(/\{[\s\S]*\}/);if(!l)throw console.error("No valid JSON found in response"),new Error("No JSON found in Ollama response");let d=l[0];return d=d.replace(/,(\s*[}\]])/g,"$1"),d=d.trim(),console.log("Cleaned JSON text:",d),{scenes:(JSON.parse(d).scenes||[]).map((y,x)=>({id:y.id||x+1,story:y.story||`Sahne ${x+1}`,question:y.question||"Ne yapmalı?",choices:y.choices?.map((_,w)=>({id:_.id||String.fromCharCode(97+w),text:_.text||`Seçenek ${w+1}`,color:_.color,isCorrect:_.isCorrect||!1,isDistractor:_.isDistractor||!1,stroopConflict:_.stroopConflict||!1}))||[{id:"a",text:"🟢 Devam et",isCorrect:!0,isDistractor:!1,stroopConflict:!1},{id:"b",text:"🔴 Dur",isCorrect:!1,isDistractor:!1,stroopConflict:!1}],emergencyTask:y.emergencyTask,backgroundTask:y.backgroundTask})),difficulty:this.calculateDifficulty(t.attentionLevel),estimatedDuration:(t.sceneCount||4)*90,theme:t.theme||"Adventure"}}catch(a){throw console.error("Failed to parse Ollama response:",a),console.error("Original response:",e),a}}parseAIResponse(e,t){try{return{scenes:(e.scenes||e.content?.scenes||[]).map((o,l)=>({id:o.id||l+1,story:o.story||"",question:o.question||"",choices:o.choices?.map((d,m)=>({id:d.id||String.fromCharCode(97+m),text:d.text||"",color:d.color,isCorrect:d.isCorrect||!1,isDistractor:d.isDistractor||!1,stroopConflict:d.stroopConflict||!1}))||[],emergencyTask:o.emergencyTask,backgroundTask:o.backgroundTask})),difficulty:this.calculateDifficulty(t.attentionLevel),estimatedDuration:(t.sceneCount||4)*90,theme:t.theme||"Adventure"}}catch(a){throw console.error("Failed to parse AI response:",a),a}}generateFallbackStory(e){let t=this.fallbackScenes;return e.sceneCount&&e.sceneCount<this.fallbackScenes.length&&(t=this.fallbackScenes.slice(0,e.sceneCount)),e.studentAge<6&&(t=t.map(a=>({...a,choices:a.choices.filter(o=>!o.stroopConflict||o.isCorrect),emergencyTask:void 0}))),{scenes:t,difficulty:this.calculateDifficulty(e.attentionLevel),estimatedDuration:t.length*90,theme:e.theme||"Macera"}}calculateDifficulty(e){switch(e){case"beginner":return"Kolay";case"intermediate":return"Orta";case"advanced":return"Zor";default:return"Orta"}}generateTemplate(e,t){const a={adventure:{theme:"Ali'nin büyülü orman macerası",sceneCount:t<6?3:t<8?4:6},space:{theme:"Uzay kahramanı Aylin'in gezegen keşfi",sceneCount:t<6?3:t<8?4:6},underwater:{theme:"Denizaltı kaşifi Cem'in okyanus yolculuğu",sceneCount:t<6?3:t<8?4:6}};return a[e]||a.adventure}}const HD=new GD,FD=({studentId:s,studentAge:e,onGameComplete:t})=>{const[a,o]=k.useState(null),[l,d]=k.useState(!1),[m,p]=k.useState("adventure"),[y,x]=k.useState(1),[_,w]=k.useState(""),[j,B]=k.useState(!1),[L,D]=k.useState(!1),[$,X]=k.useState({selectiveAttention:0,sustainedAttention:0,dividedAttention:0,impulseControl:0,reactionTime:[],distractorClicks:0,correctChoices:0,totalChoices:0}),[ne,ce]=k.useState(0),[de,me]=k.useState(!1),[O,N]=k.useState(!1),[R,P]=k.useState(!1),V=k.useCallback(async()=>{if(l){console.log("Already loading story, skipping...");return}d(!0);try{const re={studentAge:e,theme:{adventure:"Orman Macerası",space:"Uzay Keşfi",underwater:"Deniz Altı Maceraları"}[m],previousStory:a?.story||void 0,userChoice:_,sceneNumber:y},C=await HD.generateNextScene(re);o(C)}catch(G){console.error("Dynamic scene generation failed:",G)}finally{d(!1)}},[e,m,_,l]);k.useEffect(()=>{j&&!L&&y>1&&!l&&a?.id!==y&&(console.log("Generating next scene for scene number:",y),V())},[y,j,L,V,l,a]),k.useEffect(()=>{if(L&&R){const re=(H=>{const Y=H.reactionTime.length>0?H.reactionTime.reduce((st,Re)=>st+Re,0)/H.reactionTime.length:0,oe=H.totalChoices>0?H.correctChoices/H.totalChoices*100:0,ge=Math.max(0,100-H.distractorClicks*20),be=Math.max(0,100-(H.reactionTime.length-H.correctChoices)*10),nt=Math.max(0,100-H.distractorClicks*15),We=Math.max(0,100-H.impulseControl*25);return{...H,selectiveAttention:ge,sustainedAttention:be,dividedAttention:nt,impulseControl:We,avgReactionTime:Y,accuracy:oe}})($);X(re);const C=(re.accuracy+re.selectiveAttention+re.sustainedAttention+re.dividedAttention+re.impulseControl)/5,Z={studentId:s,studentAge:e,gameType:"story-attention",score:Math.round(C),duration:Date.now()-ne,storyTheme:m,attentionData:{selectiveAttention:re.selectiveAttention,sustainedAttention:re.sustainedAttention,dividedAttention:re.dividedAttention,impulseControl:re.impulseControl,avgReactionTime:re.avgReactionTime||0,accuracy:re.accuracy||0,distractorClicks:re.distractorClicks,correctChoices:re.correctChoices,totalChoices:re.totalChoices},timestamp:new Date().toISOString()};oj(Z).catch(H=>{console.error("Failed to save story attention game data:",H)})}},[L,R,$,s,e,ne,m]),k.useEffect(()=>{if(j&&!L&&a){if(ce(Date.now()),a.backgroundTask){const G=setInterval(()=>{me(!0),setTimeout(()=>me(!1),1500)},3e3+Math.random()*2e3);return()=>clearInterval(G)}if(a.emergencyTask){const G=setTimeout(()=>{N(!0),setTimeout(()=>{N(!1),se()},a.emergencyTask.duration)},2e3+Math.random()*3e3);return()=>clearTimeout(G)}}},[y,j,L,a]);const I=k.useCallback(G=>{if(console.log("Choice clicked:",G),!a||O||l)return;const re=Date.now()-ne,C=a.choices.find(Z=>Z.id===G);C&&(console.log("Selected choice:",C.text),w(C.text),X(Z=>{const H={...Z,reactionTime:[...Z.reactionTime,re],totalChoices:Z.totalChoices+1};return C.isCorrect&&H.correctChoices++,C.isDistractor&&H.distractorClicks++,re<500&&(H.impulseControl+=1),H}),se())},[a,ne,O]),A=k.useCallback(()=>{X(G=>({...G,distractorClicks:G.distractorClicks+1})),me(!1)},[]),we=k.useCallback(()=>{const G=Date.now()-ne;X(re=>({...re,reactionTime:[...re.reactionTime,G]})),N(!1),se()},[ne]),se=k.useCallback(()=>{console.log("Handling next scene. Current scene number:",y),y>=10?(console.log("Game ending - reached max scenes"),D(!0),P(!0)):(console.log("Moving to next scene:",y+1),x(G=>G+1))},[y]),q=async(G="adventure")=>{p(G),B(!0),x(1),w(""),await V()},he=()=>{B(!1),D(!1),x(1),o(null),P(!1),w(""),d(!1),X({selectiveAttention:0,sustainedAttention:0,dividedAttention:0,impulseControl:0,reactionTime:[],distractorClicks:0,correctChoices:0,totalChoices:0})};return R?u.jsx("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 to-pink-50 p-4",children:u.jsx("div",{className:"max-w-4xl mx-auto",children:u.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8",children:[u.jsxs("div",{className:"text-center mb-8",children:[u.jsx("div",{className:"text-6xl mb-4",children:"🎯"}),u.jsx("h2",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Hikaye Tamamlandı!"}),u.jsx("p",{className:"text-gray-600",children:"Dikkat becerilerinin analizi"})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[u.jsxs("div",{className:"bg-gradient-to-r from-blue-500 to-blue-600 p-6 rounded-lg text-white",children:[u.jsx(Ic,{className:"h-8 w-8 mb-4"}),u.jsx("h3",{className:"text-lg font-bold",children:"Seçici Dikkat"}),u.jsxs("p",{className:"text-2xl font-bold",children:[Math.round($.selectiveAttention),"%"]}),u.jsx("p",{className:"text-blue-100 text-sm",children:"Çeldiricileri görmezden gelme"})]}),u.jsxs("div",{className:"bg-gradient-to-r from-green-500 to-green-600 p-6 rounded-lg text-white",children:[u.jsx(Wn,{className:"h-8 w-8 mb-4"}),u.jsx("h3",{className:"text-lg font-bold",children:"Sürekli Dikkat"}),u.jsxs("p",{className:"text-2xl font-bold",children:[Math.round($.sustainedAttention),"%"]}),u.jsx("p",{className:"text-green-100 text-sm",children:"Dikkatin devamlılığı"})]}),u.jsxs("div",{className:"bg-gradient-to-r from-purple-500 to-purple-600 p-6 rounded-lg text-white",children:[u.jsx(qo,{className:"h-8 w-8 mb-4"}),u.jsx("h3",{className:"text-lg font-bold",children:"Bölünmüş Dikkat"}),u.jsxs("p",{className:"text-2xl font-bold",children:[Math.round($.dividedAttention),"%"]}),u.jsx("p",{className:"text-purple-100 text-sm",children:"Çoklu görev yetisi"})]}),u.jsxs("div",{className:"bg-gradient-to-r from-orange-500 to-red-500 p-6 rounded-lg text-white",children:[u.jsx(Sb,{className:"h-8 w-8 mb-4"}),u.jsx("h3",{className:"text-lg font-bold",children:"Dürtü Kontrolü"}),u.jsxs("p",{className:"text-2xl font-bold",children:[Math.round($.impulseControl),"%"]}),u.jsx("p",{className:"text-orange-100 text-sm",children:"Hızlı karar verme kontrolü"})]})]}),u.jsxs("div",{className:"bg-gray-50 rounded-lg p-6 mb-8",children:[u.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:"Detaylı Analiz"}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[u.jsxs("div",{children:[u.jsxs("p",{children:[u.jsx("span",{className:"font-medium",children:"Toplam Doğru Cevap:"})," ",$.correctChoices,"/",$.totalChoices]}),u.jsxs("p",{children:[u.jsx("span",{className:"font-medium",children:"Başarı Oranı:"})," ",Math.round($.correctChoices/$.totalChoices*100),"%"]})]}),u.jsxs("div",{children:[u.jsxs("p",{children:[u.jsx("span",{className:"font-medium",children:"Çeldirici Tıklama:"})," ",$.distractorClicks]}),u.jsxs("p",{children:[u.jsx("span",{className:"font-medium",children:"Ortalama Tepki Süresi:"})," ",Math.round($.reactionTime.reduce((G,re)=>G+re,0)/$.reactionTime.length),"ms"]})]})]})]}),u.jsxs("div",{className:"flex gap-4 justify-center",children:[u.jsx("button",{onClick:he,className:"bg-blue-500 hover:bg-blue-600 text-white px-6 py-3 rounded-lg font-medium transition-colors",children:"Tekrar Oyna"}),u.jsx("button",{onClick:()=>t(Math.round(($.selectiveAttention+$.sustainedAttention+$.dividedAttention+$.impulseControl)/4),Date.now()-ne,$),className:"bg-gray-500 hover:bg-gray-600 text-white px-6 py-3 rounded-lg font-medium transition-colors",children:"Ana Menüye Dön"})]})]})})}):j?u.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 to-pink-50 p-4",children:[de&&a?.backgroundTask&&u.jsx("div",{className:"fixed top-20 right-20 text-4xl cursor-pointer animate-bounce z-10",onClick:A,children:a.backgroundTask.targetSymbol}),O&&a?.emergencyTask&&u.jsx("div",{className:"fixed inset-0 bg-red-500/80 flex items-center justify-center z-50",children:u.jsxs("div",{className:"bg-white rounded-lg p-8 text-center animate-pulse",children:[u.jsx("div",{className:"text-6xl mb-4",children:a.emergencyTask.symbol}),u.jsx("h3",{className:"text-2xl font-bold text-red-600 mb-4",children:a.emergencyTask.instruction}),u.jsx("button",{onClick:we,className:"bg-red-500 hover:bg-red-600 text-white px-8 py-4 rounded-lg font-bold text-lg animate-pulse",children:"🏃‍♂️ KAÇ!"})]})}),u.jsxs("div",{className:"max-w-4xl mx-auto",children:[u.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-4 mb-6",children:[u.jsxs("div",{className:"flex justify-between items-center mb-2",children:[u.jsxs("span",{className:"text-sm font-medium text-gray-700",children:["Sahne ",y," / 10"]}),u.jsxs("span",{className:"text-sm text-gray-500",children:[Math.round(y/10*100),"%"]})]}),u.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:u.jsx("div",{className:"bg-purple-600 h-3 rounded-full transition-all duration-500",style:{width:`${y/10*100}%`}})})]}),u.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8",children:[u.jsxs("div",{className:"text-center mb-8",children:[u.jsx("div",{className:"text-4xl mb-4",children:"📚"}),u.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:a?.story}),u.jsx("p",{className:"text-lg text-gray-600 mb-6",children:a?.question})]}),l&&u.jsxs("div",{className:"text-center py-8",children:[u.jsx("div",{className:"text-4xl mb-4",children:"✨"}),u.jsx("h3",{className:"text-xl font-bold text-purple-600 mb-2",children:"Hikaye devam ediyor..."}),u.jsx("p",{className:"text-gray-600",children:"Seçiminize göre yeni macera hazırlanıyor!"}),u.jsx("div",{className:"w-8 h-8 border-4 border-purple-600 border-t-transparent rounded-full animate-spin mx-auto mt-4"})]}),_&&!l&&y>1&&u.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 mb-6",children:u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("div",{className:"text-2xl",children:"✅"}),u.jsxs("div",{children:[u.jsxs("h4",{className:"font-bold text-green-800",children:["Seçimin: ",_]}),u.jsx("p",{className:"text-green-700 text-sm",children:"Hikaye bu seçiminle devam ediyor..."})]})]})}),!l&&u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:a?.choices.map(G=>u.jsx("button",{onClick:()=>I(G.id),className:`p-6 rounded-lg border-2 transition-all duration-200 hover:shadow-lg ${G.isDistractor?"border-yellow-300 bg-yellow-50 hover:bg-yellow-100":G.stroopConflict?"border-red-300 bg-red-50 hover:bg-red-100":"border-purple-300 bg-purple-50 hover:bg-purple-100"} ${l?"opacity-50 cursor-not-allowed":""}`,style:G.color?{borderColor:G.color,backgroundColor:G.color+"20"}:{},disabled:O||l,children:u.jsx("span",{className:"text-lg font-bold",style:G.color&&G.stroopConflict?{color:G.color}:{},children:G.text})},G.id))}),a?.backgroundTask&&u.jsx("div",{className:"mt-6 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:u.jsxs("p",{className:"text-center text-yellow-800 font-medium",children:["⚠️ ",a.backgroundTask.instruction]})})]})]})]}):u.jsx("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 to-pink-50 p-4",children:u.jsx("div",{className:"max-w-2xl mx-auto",children:u.jsx("div",{className:"bg-white rounded-lg shadow-lg p-8",children:u.jsxs("div",{className:"text-center",children:[u.jsx(A1,{className:"h-16 w-16 text-purple-600 mx-auto mb-6"}),u.jsx("h2",{className:"text-3xl font-bold text-gray-800 mb-4",children:"Hikaye Tabanlı Dikkat Oyunu"}),u.jsx("p",{className:"text-gray-600 mb-8",children:"Ali'nin macerasında ona yardım et! Bu oyun dikkat becerilerini ölçer:"}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-8 text-left",children:[u.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[u.jsx(Ic,{className:"h-6 w-6 text-blue-600 mb-2"}),u.jsx("h3",{className:"font-bold text-blue-800",children:"Seçici Dikkat"}),u.jsx("p",{className:"text-blue-700 text-sm",children:"Çeldiricileri görmezden gel"})]}),u.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[u.jsx(Wn,{className:"h-6 w-6 text-green-600 mb-2"}),u.jsx("h3",{className:"font-bold text-green-800",children:"Sürekli Dikkat"}),u.jsx("p",{className:"text-green-700 text-sm",children:"Dikkati uzun süre koru"})]}),u.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg",children:[u.jsx(qo,{className:"h-6 w-6 text-purple-600 mb-2"}),u.jsx("h3",{className:"font-bold text-purple-800",children:"Bölünmüş Dikkat"}),u.jsx("p",{className:"text-purple-700 text-sm",children:"Aynı anda iki işi yap"})]}),u.jsxs("div",{className:"bg-orange-50 p-4 rounded-lg",children:[u.jsx(Sb,{className:"h-6 w-6 text-orange-600 mb-2"}),u.jsx("h3",{className:"font-bold text-orange-800",children:"Dürtü Kontrolü"}),u.jsx("p",{className:"text-orange-700 text-sm",children:"Düşünmeden hareket etme"})]})]}),u.jsxs("div",{className:"space-y-6",children:[u.jsx("h3",{className:"text-lg font-bold text-gray-800 text-center mb-4",children:"Hangi hikayeyi oynamak istiyorsun?"}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[u.jsxs("button",{onClick:()=>q("adventure"),disabled:l,className:"bg-green-500 hover:bg-green-600 text-white p-4 rounded-lg font-medium transition-colors disabled:opacity-50",children:[u.jsx("div",{className:"text-3xl mb-2",children:"🌲"}),u.jsx("h4",{className:"font-bold",children:"Orman Macerası"}),u.jsx("p",{className:"text-sm text-green-100",children:"Ali'nin büyülü orman yolculuğu"})]}),u.jsxs("button",{onClick:()=>q("space"),disabled:l,className:"bg-blue-500 hover:bg-blue-600 text-white p-4 rounded-lg font-medium transition-colors disabled:opacity-50",children:[u.jsx("div",{className:"text-3xl mb-2",children:"🚀"}),u.jsx("h4",{className:"font-bold",children:"Uzay Keşfi"}),u.jsx("p",{className:"text-sm text-blue-100",children:"Aylin'in gezegen maceraları"})]}),u.jsxs("button",{onClick:()=>q("underwater"),disabled:l,className:"bg-teal-500 hover:bg-teal-600 text-white p-4 rounded-lg font-medium transition-colors disabled:opacity-50",children:[u.jsx("div",{className:"text-3xl mb-2",children:"🐠"}),u.jsx("h4",{className:"font-bold",children:"Deniz Altı"}),u.jsx("p",{className:"text-sm text-teal-100",children:"Cem'in okyanus keşfi"})]})]}),l&&u.jsxs("div",{className:"text-center py-4",children:[u.jsx("div",{className:"w-8 h-8 border-4 border-purple-600 border-t-transparent rounded-full animate-spin mx-auto mb-2"}),u.jsx("p",{className:"text-gray-600",children:"Hikaye hazırlanıyor..."})]})]})]})})})})},qD=()=>{const{currentUser:s,logout:e}=_a(),[t,a]=k.useState(null),[o]=k.useState({gamesPlayed:12,totalScore:850,averageScore:71,timeSpent:145}),l=async()=>{try{await e()}catch(p){console.error("Çıkış yapılırken hata:",p)}},d=(p,y,x)=>{a(null),p!==void 0&&console.log("Oyun tamamlandı:",{score:p,duration:y,emotions:x})},m=()=>{if(!s?.id)return null;switch(t){case"word-image":return u.jsx(SD,{studentId:s.id,studentAge:s.age||6,onGameComplete:d});case"number":return u.jsx(wD,{studentId:s.id,studentAge:s.age||6,onGameComplete:d});case"color":return u.jsx(AD,{studentId:s.id,studentAge:s.age||6,onGameComplete:d});case"attention-sprint":return u.jsx(BD,{studentId:s.id,studentAge:s.age||12,onGameComplete:d});case"story-attention":return u.jsx(FD,{studentId:s.id,studentAge:s.age||8,onGameComplete:d});default:return null}};return t?u.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50",children:u.jsxs("div",{className:"container mx-auto px-4 py-8",children:[u.jsx("button",{onClick:()=>a(null),className:"mb-4 bg-white text-gray-700 px-4 py-2 rounded-lg shadow hover:shadow-md transition-shadow",children:"← Geri Dön"}),m()]})}):u.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50",children:[u.jsx("div",{className:"bg-white shadow-sm border-b",children:u.jsx("div",{className:"container mx-auto px-4 py-4",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-primary to-secondary rounded-full flex items-center justify-center",children:u.jsx(Ft,{className:"h-6 w-6 text-white"})}),u.jsxs("div",{children:[u.jsx("h1",{className:"text-xl font-bold text-gray-800",children:"NeuroLearn AI"}),u.jsx("p",{className:"text-sm text-gray-600",children:"Öğrenci Paneli"})]})]}),u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsxs("div",{className:"flex items-center space-x-2 text-gray-600",children:[u.jsx(bh,{className:"h-5 w-5"}),u.jsx("span",{className:"hidden sm:inline",children:s?.name})]}),u.jsxs("button",{onClick:l,className:"flex items-center space-x-2 bg-gray-100 hover:bg-gray-200 px-4 py-2 rounded-lg transition-colors",children:[u.jsx(I1,{className:"h-4 w-4"}),u.jsx("span",{className:"hidden sm:inline",children:"Çıkış"})]})]})]})})}),u.jsxs("div",{className:"container mx-auto px-4 py-8",children:[u.jsxs("div",{className:"mb-8 text-center",children:[u.jsxs("h2",{className:"text-3xl font-bold text-gray-800 mb-4",children:["Hoş Geldin, ",s?.name,"! 🌟"]}),u.jsx("p",{className:"text-gray-600 text-lg",children:"Hangi oyunu oynamak istiyorsun?"})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[u.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm text-gray-600",children:"Oynanan Oyun"}),u.jsx("p",{className:"text-2xl font-bold text-primary",children:o.gamesPlayed})]}),u.jsx(zm,{className:"h-8 w-8 text-primary"})]})}),u.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm text-gray-600",children:"Toplam Puan"}),u.jsx("p",{className:"text-2xl font-bold text-success",children:o.totalScore})]}),u.jsx(zm,{className:"h-8 w-8 text-success"})]})}),u.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm text-gray-600",children:"Ortalama Puan"}),u.jsx("p",{className:"text-2xl font-bold text-warning",children:o.averageScore})]}),u.jsx(zm,{className:"h-8 w-8 text-warning"})]})}),u.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm text-gray-600",children:"Geçirilen Süre"}),u.jsxs("p",{className:"text-2xl font-bold text-purple-600",children:[o.timeSpent,"dk"]})]}),u.jsx(br,{className:"h-8 w-8 text-purple-600"})]})})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-6",children:[u.jsxs("div",{className:"bg-white rounded-lg shadow-lg overflow-hidden hover:shadow-xl transition-shadow",children:[u.jsxs("div",{className:"bg-gradient-to-r from-blue-500 to-blue-600 p-6 text-white",children:[u.jsx(A1,{className:"h-12 w-12 mb-4"}),u.jsx("h3",{className:"text-xl font-bold mb-2",children:"Kelime-Resim Eşleştirme"}),u.jsx("p",{className:"text-blue-100",children:"Kelimeler ve resimler arasında bağlantı kur"})]}),u.jsxs("div",{className:"p-6",children:[u.jsxs("div",{className:"mb-4",children:[u.jsxs("div",{className:"flex justify-between text-sm text-gray-600 mb-1",children:[u.jsx("span",{children:"Son Puan"}),u.jsx("span",{children:"85/100"})]}),u.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:u.jsx("div",{className:"bg-blue-500 h-2 rounded-full",style:{width:"85%"}})})]}),u.jsx("button",{onClick:()=>a("word-image"),className:"w-full bg-blue-500 hover:bg-blue-600 text-white py-3 px-4 rounded-lg font-medium transition-colors",children:"Oyunu Başlat"})]})]}),u.jsxs("div",{className:"bg-white rounded-lg shadow-lg overflow-hidden hover:shadow-xl transition-shadow",children:[u.jsxs("div",{className:"bg-gradient-to-r from-green-500 to-green-600 p-6 text-white",children:[u.jsx(R1,{className:"h-12 w-12 mb-4"}),u.jsx("h3",{className:"text-xl font-bold mb-2",children:"Sayı Öğrenme"}),u.jsx("p",{className:"text-green-100",children:"Sayıları sayarak matematik öğren"})]}),u.jsxs("div",{className:"p-6",children:[u.jsxs("div",{className:"mb-4",children:[u.jsxs("div",{className:"flex justify-between text-sm text-gray-600 mb-1",children:[u.jsx("span",{children:"Son Puan"}),u.jsx("span",{children:"72/100"})]}),u.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:u.jsx("div",{className:"bg-green-500 h-2 rounded-full",style:{width:"72%"}})})]}),u.jsx("button",{onClick:()=>a("number"),className:"w-full bg-green-500 hover:bg-green-600 text-white py-3 px-4 rounded-lg font-medium transition-colors",children:"Oyunu Başlat"})]})]}),u.jsxs("div",{className:"bg-white rounded-lg shadow-lg overflow-hidden hover:shadow-xl transition-shadow",children:[u.jsxs("div",{className:"bg-gradient-to-r from-purple-500 to-purple-600 p-6 text-white",children:[u.jsx(xh,{className:"h-12 w-12 mb-4"}),u.jsx("h3",{className:"text-xl font-bold mb-2",children:"Renk Eşleştirme"}),u.jsx("p",{className:"text-purple-100",children:"Renkleri eşleştirerek öğren"})]}),u.jsxs("div",{className:"p-6",children:[u.jsxs("div",{className:"mb-4",children:[u.jsxs("div",{className:"flex justify-between text-sm text-gray-600 mb-1",children:[u.jsx("span",{children:"Son Puan"}),u.jsx("span",{children:"91/100"})]}),u.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:u.jsx("div",{className:"bg-purple-500 h-2 rounded-full",style:{width:"91%"}})})]}),u.jsx("button",{onClick:()=>a("color"),className:"w-full bg-purple-500 hover:bg-purple-600 text-white py-3 px-4 rounded-lg font-medium transition-colors",children:"Oyunu Başlat"})]})]}),u.jsxs("div",{className:"bg-white rounded-lg shadow-lg overflow-hidden hover:shadow-xl transition-shadow",children:[u.jsxs("div",{className:"bg-gradient-to-r from-orange-500 to-red-500 p-6 text-white",children:[u.jsx(Wn,{className:"h-12 w-12 mb-4"}),u.jsx("h3",{className:"text-xl font-bold mb-2",children:"Dikkat Oyunları"}),u.jsx("p",{className:"text-orange-100",children:"3 farklı dikkat geliştirici oyun seçeneği"})]}),u.jsxs("div",{className:"p-6",children:[u.jsxs("div",{className:"mb-4",children:[u.jsxs("div",{className:"flex justify-between text-sm text-gray-600 mb-1",children:[u.jsx("span",{children:"Oyun Çeşidi"}),u.jsx("span",{children:"3 Tür"})]}),u.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:u.jsx("div",{className:"bg-orange-500 h-2 rounded-full",style:{width:"100%"}})}),u.jsx("div",{className:"mt-2 text-xs text-gray-600",children:"Tıklama • Sayma • Dinamik"})]}),u.jsx("button",{onClick:()=>a("attention-sprint"),className:"w-full bg-orange-500 hover:bg-orange-600 text-white py-3 px-4 rounded-lg font-medium transition-colors",children:"Oyunları Keşfet"})]})]}),u.jsxs("div",{className:"bg-white rounded-lg shadow-lg overflow-hidden hover:shadow-xl transition-shadow",children:[u.jsxs("div",{className:"bg-gradient-to-r from-pink-500 to-purple-600 p-6 text-white",children:[u.jsx(j1,{className:"h-12 w-12 mb-4"}),u.jsx("h3",{className:"text-xl font-bold mb-2",children:"Hikaye Dikkat Oyunu"}),u.jsx("p",{className:"text-pink-100",children:"Ali'nin macerasında dikkat becerilerini test et"})]}),u.jsxs("div",{className:"p-6",children:[u.jsxs("div",{className:"mb-4",children:[u.jsxs("div",{className:"flex justify-between text-sm text-gray-600 mb-1",children:[u.jsx("span",{children:"Dikkat Türü"}),u.jsx("span",{children:"4 Boyut"})]}),u.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:u.jsx("div",{className:"bg-pink-500 h-2 rounded-full",style:{width:"100%"}})}),u.jsx("div",{className:"mt-2 text-xs text-gray-600",children:"Seçici • Sürekli • Bölünmüş • Dürtü Kontrolü"})]}),u.jsx("button",{onClick:()=>a("story-attention"),className:"w-full bg-pink-500 hover:bg-pink-600 text-white py-3 px-4 rounded-lg font-medium transition-colors",children:"Hikayeyi Başlat"})]})]})]}),u.jsxs("div",{className:"mt-12 text-center bg-white rounded-lg p-8 shadow-sm",children:[u.jsx("div",{className:"text-6xl mb-4",children:"🎯"}),u.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Harika İş Çıkarıyorsun!"}),u.jsx("p",{className:"text-gray-600",children:"Her oyun oynayışında daha da iyi oluyorsun. Böyle devam et! 🌟"})]})]})]})},Cb=({children:s})=>{const{currentUser:e,loading:t}=_a();return t?u.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"w-16 h-16 border-4 border-primary border-t-transparent rounded-full animate-spin mx-auto mb-4"}),u.jsx("p",{className:"text-gray-600",children:"Yükleniyor..."})]})}):e?u.jsx(u.Fragment,{children:s}):u.jsx(yc,{to:"/auth",replace:!0})},$D=({children:s})=>{const{currentUser:e,loading:t}=_a();return t?u.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"w-16 h-16 border-4 border-primary border-t-transparent rounded-full animate-spin mx-auto mb-4"}),u.jsx("p",{className:"text-gray-600",children:"Yükleniyor..."})]})}):e?u.jsx(yc,{to:"/dashboard",replace:!0}):u.jsx(u.Fragment,{children:s})},KD=()=>{const{currentUser:s,loading:e}=_a();if(e)return u.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"w-16 h-16 border-4 border-primary border-t-transparent rounded-full animate-spin mx-auto mb-4"}),u.jsx("p",{className:"text-gray-600",children:"Yükleniyor..."})]})});if(!s)return u.jsx(yc,{to:"/auth",replace:!0});const t=s.role==="teacher"?"/dashboard/teacher":"/dashboard/student";return u.jsx(yc,{to:t,replace:!0})};function YD(){return u.jsx(lj,{children:u.jsx(IS,{children:u.jsx("div",{className:"App",children:u.jsxs(lS,{children:[u.jsx(Ao,{path:"/auth",element:u.jsx($D,{children:u.jsx(gD,{})})}),u.jsx(Ao,{path:"/dashboard/teacher",element:u.jsx(Cb,{children:u.jsx(_D,{})})}),u.jsx(Ao,{path:"/dashboard/student",element:u.jsx(Cb,{children:u.jsx(qD,{})})}),u.jsx(Ao,{path:"/dashboard",element:u.jsx(KD,{})}),u.jsx(Ao,{path:"/",element:u.jsx(yc,{to:"/dashboard",replace:!0})})]})})})})}vE.createRoot(document.getElementById("root")).render(u.jsx(YD,{}));
