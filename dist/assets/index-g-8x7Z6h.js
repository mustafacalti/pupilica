(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const c of o)if(c.type==="childList")for(const d of c.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&r(d)}).observe(document,{childList:!0,subtree:!0});function t(o){const c={};return o.integrity&&(c.integrity=o.integrity),o.referrerPolicy&&(c.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?c.credentials="include":o.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function r(o){if(o.ep)return;o.ep=!0;const c=t(o);fetch(o.href,c)}})();function pw(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var wf={exports:{}},nc={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Lx;function yw(){if(Lx)return nc;Lx=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(r,o,c){var d=null;if(c!==void 0&&(d=""+c),o.key!==void 0&&(d=""+o.key),"key"in o){c={};for(var f in o)f!=="key"&&(c[f]=o[f])}else c=o;return o=c.ref,{$$typeof:s,type:r,key:d,ref:o!==void 0?o:null,props:c}}return nc.Fragment=e,nc.jsx=t,nc.jsxs=t,nc}var Vx;function xw(){return Vx||(Vx=1,wf.exports=yw()),wf.exports}var l=xw(),Ef={exports:{}},ac={},Sf={exports:{}},Af={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ux;function vw(){return Ux||(Ux=1,(function(s){function e(W,de){var me=W.length;W.push(de);e:for(;0<me;){var ye=me-1>>>1,O=W[ye];if(0<o(O,de))W[ye]=de,W[me]=O,me=ye;else break e}}function t(W){return W.length===0?null:W[0]}function r(W){if(W.length===0)return null;var de=W[0],me=W.pop();if(me!==de){W[0]=me;e:for(var ye=0,O=W.length,H=O>>>1;ye<H;){var ee=2*(ye+1)-1,X=W[ee],fe=ee+1,_e=W[fe];if(0>o(X,me))fe<O&&0>o(_e,X)?(W[ye]=_e,W[fe]=me,ye=fe):(W[ye]=X,W[ee]=me,ye=ee);else if(fe<O&&0>o(_e,me))W[ye]=_e,W[fe]=me,ye=fe;else break e}}return de}function o(W,de){var me=W.sortIndex-de.sortIndex;return me!==0?me:W.id-de.id}if(s.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var c=performance;s.unstable_now=function(){return c.now()}}else{var d=Date,f=d.now();s.unstable_now=function(){return d.now()-f}}var p=[],y=[],v=1,k=null,S=3,I=!1,q=!1,L=!1,P=!1,K=typeof setTimeout=="function"?setTimeout:null,U=typeof clearTimeout=="function"?clearTimeout:null,B=typeof setImmediate<"u"?setImmediate:null;function F(W){for(var de=t(y);de!==null;){if(de.callback===null)r(y);else if(de.startTime<=W)r(y),de.sortIndex=de.expirationTime,e(p,de);else break;de=t(y)}}function ae(W){if(L=!1,F(W),!q)if(t(p)!==null)q=!0,ne||(ne=!0,z());else{var de=t(y);de!==null&&le(ae,de.startTime-W)}}var ne=!1,N=-1,R=5,E=-1;function C(){return P?!0:!(s.unstable_now()-E<R)}function M(){if(P=!1,ne){var W=s.unstable_now();E=W;var de=!0;try{e:{q=!1,L&&(L=!1,U(N),N=-1),I=!0;var me=S;try{t:{for(F(W),k=t(p);k!==null&&!(k.expirationTime>W&&C());){var ye=k.callback;if(typeof ye=="function"){k.callback=null,S=k.priorityLevel;var O=ye(k.expirationTime<=W);if(W=s.unstable_now(),typeof O=="function"){k.callback=O,F(W),de=!0;break t}k===t(p)&&r(p),F(W)}else r(p);k=t(p)}if(k!==null)de=!0;else{var H=t(y);H!==null&&le(ae,H.startTime-W),de=!1}}break e}finally{k=null,S=me,I=!1}de=void 0}}finally{de?z():ne=!1}}}var z;if(typeof B=="function")z=function(){B(M)};else if(typeof MessageChannel<"u"){var j=new MessageChannel,Ve=j.port2;j.port1.onmessage=M,z=function(){Ve.postMessage(null)}}else z=function(){K(M,0)};function le(W,de){N=K(function(){W(s.unstable_now())},de)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(W){W.callback=null},s.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<W?Math.floor(1e3/W):5},s.unstable_getCurrentPriorityLevel=function(){return S},s.unstable_next=function(W){switch(S){case 1:case 2:case 3:var de=3;break;default:de=S}var me=S;S=de;try{return W()}finally{S=me}},s.unstable_requestPaint=function(){P=!0},s.unstable_runWithPriority=function(W,de){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var me=S;S=W;try{return de()}finally{S=me}},s.unstable_scheduleCallback=function(W,de,me){var ye=s.unstable_now();switch(typeof me=="object"&&me!==null?(me=me.delay,me=typeof me=="number"&&0<me?ye+me:ye):me=ye,W){case 1:var O=-1;break;case 2:O=250;break;case 5:O=1073741823;break;case 4:O=1e4;break;default:O=5e3}return O=me+O,W={id:v++,callback:de,priorityLevel:W,startTime:me,expirationTime:O,sortIndex:-1},me>ye?(W.sortIndex=me,e(y,W),t(p)===null&&W===t(y)&&(L?(U(N),N=-1):L=!0,le(ae,me-ye))):(W.sortIndex=O,e(p,W),q||I||(q=!0,ne||(ne=!0,z()))),W},s.unstable_shouldYield=C,s.unstable_wrapCallback=function(W){var de=S;return function(){var me=S;S=de;try{return W.apply(this,arguments)}finally{S=me}}}})(Af)),Af}var Bx;function bw(){return Bx||(Bx=1,Sf.exports=vw()),Sf.exports}var Nf={exports:{}},rt={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Hx;function _w(){if(Hx)return rt;Hx=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),c=Symbol.for("react.consumer"),d=Symbol.for("react.context"),f=Symbol.for("react.forward_ref"),p=Symbol.for("react.suspense"),y=Symbol.for("react.memo"),v=Symbol.for("react.lazy"),k=Symbol.iterator;function S(O){return O===null||typeof O!="object"?null:(O=k&&O[k]||O["@@iterator"],typeof O=="function"?O:null)}var I={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},q=Object.assign,L={};function P(O,H,ee){this.props=O,this.context=H,this.refs=L,this.updater=ee||I}P.prototype.isReactComponent={},P.prototype.setState=function(O,H){if(typeof O!="object"&&typeof O!="function"&&O!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,O,H,"setState")},P.prototype.forceUpdate=function(O){this.updater.enqueueForceUpdate(this,O,"forceUpdate")};function K(){}K.prototype=P.prototype;function U(O,H,ee){this.props=O,this.context=H,this.refs=L,this.updater=ee||I}var B=U.prototype=new K;B.constructor=U,q(B,P.prototype),B.isPureReactComponent=!0;var F=Array.isArray,ae={H:null,A:null,T:null,S:null,V:null},ne=Object.prototype.hasOwnProperty;function N(O,H,ee,X,fe,_e){return ee=_e.ref,{$$typeof:s,type:O,key:H,ref:ee!==void 0?ee:null,props:_e}}function R(O,H){return N(O.type,H,void 0,void 0,void 0,O.props)}function E(O){return typeof O=="object"&&O!==null&&O.$$typeof===s}function C(O){var H={"=":"=0",":":"=2"};return"$"+O.replace(/[=:]/g,function(ee){return H[ee]})}var M=/\/+/g;function z(O,H){return typeof O=="object"&&O!==null&&O.key!=null?C(""+O.key):H.toString(36)}function j(){}function Ve(O){switch(O.status){case"fulfilled":return O.value;case"rejected":throw O.reason;default:switch(typeof O.status=="string"?O.then(j,j):(O.status="pending",O.then(function(H){O.status==="pending"&&(O.status="fulfilled",O.value=H)},function(H){O.status==="pending"&&(O.status="rejected",O.reason=H)})),O.status){case"fulfilled":return O.value;case"rejected":throw O.reason}}throw O}function le(O,H,ee,X,fe){var _e=typeof O;(_e==="undefined"||_e==="boolean")&&(O=null);var Ee=!1;if(O===null)Ee=!0;else switch(_e){case"bigint":case"string":case"number":Ee=!0;break;case"object":switch(O.$$typeof){case s:case e:Ee=!0;break;case v:return Ee=O._init,le(Ee(O._payload),H,ee,X,fe)}}if(Ee)return fe=fe(O),Ee=X===""?"."+z(O,0):X,F(fe)?(ee="",Ee!=null&&(ee=Ee.replace(M,"$&/")+"/"),le(fe,H,ee,"",function(pe){return pe})):fe!=null&&(E(fe)&&(fe=R(fe,ee+(fe.key==null||O&&O.key===fe.key?"":(""+fe.key).replace(M,"$&/")+"/")+Ee)),H.push(fe)),1;Ee=0;var $e=X===""?".":X+":";if(F(O))for(var je=0;je<O.length;je++)X=O[je],_e=$e+z(X,je),Ee+=le(X,H,ee,_e,fe);else if(je=S(O),typeof je=="function")for(O=je.call(O),je=0;!(X=O.next()).done;)X=X.value,_e=$e+z(X,je++),Ee+=le(X,H,ee,_e,fe);else if(_e==="object"){if(typeof O.then=="function")return le(Ve(O),H,ee,X,fe);throw H=String(O),Error("Objects are not valid as a React child (found: "+(H==="[object Object]"?"object with keys {"+Object.keys(O).join(", ")+"}":H)+"). If you meant to render a collection of children, use an array instead.")}return Ee}function W(O,H,ee){if(O==null)return O;var X=[],fe=0;return le(O,X,"","",function(_e){return H.call(ee,_e,fe++)}),X}function de(O){if(O._status===-1){var H=O._result;H=H(),H.then(function(ee){(O._status===0||O._status===-1)&&(O._status=1,O._result=ee)},function(ee){(O._status===0||O._status===-1)&&(O._status=2,O._result=ee)}),O._status===-1&&(O._status=0,O._result=H)}if(O._status===1)return O._result.default;throw O._result}var me=typeof reportError=="function"?reportError:function(O){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var H=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof O=="object"&&O!==null&&typeof O.message=="string"?String(O.message):String(O),error:O});if(!window.dispatchEvent(H))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",O);return}console.error(O)};function ye(){}return rt.Children={map:W,forEach:function(O,H,ee){W(O,function(){H.apply(this,arguments)},ee)},count:function(O){var H=0;return W(O,function(){H++}),H},toArray:function(O){return W(O,function(H){return H})||[]},only:function(O){if(!E(O))throw Error("React.Children.only expected to receive a single React element child.");return O}},rt.Component=P,rt.Fragment=t,rt.Profiler=o,rt.PureComponent=U,rt.StrictMode=r,rt.Suspense=p,rt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=ae,rt.__COMPILER_RUNTIME={__proto__:null,c:function(O){return ae.H.useMemoCache(O)}},rt.cache=function(O){return function(){return O.apply(null,arguments)}},rt.cloneElement=function(O,H,ee){if(O==null)throw Error("The argument must be a React element, but you passed "+O+".");var X=q({},O.props),fe=O.key,_e=void 0;if(H!=null)for(Ee in H.ref!==void 0&&(_e=void 0),H.key!==void 0&&(fe=""+H.key),H)!ne.call(H,Ee)||Ee==="key"||Ee==="__self"||Ee==="__source"||Ee==="ref"&&H.ref===void 0||(X[Ee]=H[Ee]);var Ee=arguments.length-2;if(Ee===1)X.children=ee;else if(1<Ee){for(var $e=Array(Ee),je=0;je<Ee;je++)$e[je]=arguments[je+2];X.children=$e}return N(O.type,fe,void 0,void 0,_e,X)},rt.createContext=function(O){return O={$$typeof:d,_currentValue:O,_currentValue2:O,_threadCount:0,Provider:null,Consumer:null},O.Provider=O,O.Consumer={$$typeof:c,_context:O},O},rt.createElement=function(O,H,ee){var X,fe={},_e=null;if(H!=null)for(X in H.key!==void 0&&(_e=""+H.key),H)ne.call(H,X)&&X!=="key"&&X!=="__self"&&X!=="__source"&&(fe[X]=H[X]);var Ee=arguments.length-2;if(Ee===1)fe.children=ee;else if(1<Ee){for(var $e=Array(Ee),je=0;je<Ee;je++)$e[je]=arguments[je+2];fe.children=$e}if(O&&O.defaultProps)for(X in Ee=O.defaultProps,Ee)fe[X]===void 0&&(fe[X]=Ee[X]);return N(O,_e,void 0,void 0,null,fe)},rt.createRef=function(){return{current:null}},rt.forwardRef=function(O){return{$$typeof:f,render:O}},rt.isValidElement=E,rt.lazy=function(O){return{$$typeof:v,_payload:{_status:-1,_result:O},_init:de}},rt.memo=function(O,H){return{$$typeof:y,type:O,compare:H===void 0?null:H}},rt.startTransition=function(O){var H=ae.T,ee={};ae.T=ee;try{var X=O(),fe=ae.S;fe!==null&&fe(ee,X),typeof X=="object"&&X!==null&&typeof X.then=="function"&&X.then(ye,me)}catch(_e){me(_e)}finally{ae.T=H}},rt.unstable_useCacheRefresh=function(){return ae.H.useCacheRefresh()},rt.use=function(O){return ae.H.use(O)},rt.useActionState=function(O,H,ee){return ae.H.useActionState(O,H,ee)},rt.useCallback=function(O,H){return ae.H.useCallback(O,H)},rt.useContext=function(O){return ae.H.useContext(O)},rt.useDebugValue=function(){},rt.useDeferredValue=function(O,H){return ae.H.useDeferredValue(O,H)},rt.useEffect=function(O,H,ee){var X=ae.H;if(typeof ee=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return X.useEffect(O,H)},rt.useId=function(){return ae.H.useId()},rt.useImperativeHandle=function(O,H,ee){return ae.H.useImperativeHandle(O,H,ee)},rt.useInsertionEffect=function(O,H){return ae.H.useInsertionEffect(O,H)},rt.useLayoutEffect=function(O,H){return ae.H.useLayoutEffect(O,H)},rt.useMemo=function(O,H){return ae.H.useMemo(O,H)},rt.useOptimistic=function(O,H){return ae.H.useOptimistic(O,H)},rt.useReducer=function(O,H,ee){return ae.H.useReducer(O,H,ee)},rt.useRef=function(O){return ae.H.useRef(O)},rt.useState=function(O){return ae.H.useState(O)},rt.useSyncExternalStore=function(O,H,ee){return ae.H.useSyncExternalStore(O,H,ee)},rt.useTransition=function(){return ae.H.useTransition()},rt.version="19.1.1",rt}var Gx;function kg(){return Gx||(Gx=1,Nf.exports=_w()),Nf.exports}var Rf={exports:{}},Ln={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Fx;function kw(){if(Fx)return Ln;Fx=1;var s=kg();function e(p){var y="https://react.dev/errors/"+p;if(1<arguments.length){y+="?args[]="+encodeURIComponent(arguments[1]);for(var v=2;v<arguments.length;v++)y+="&args[]="+encodeURIComponent(arguments[v])}return"Minified React error #"+p+"; visit "+y+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var r={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},o=Symbol.for("react.portal");function c(p,y,v){var k=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:o,key:k==null?null:""+k,children:p,containerInfo:y,implementation:v}}var d=s.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function f(p,y){if(p==="font")return"";if(typeof y=="string")return y==="use-credentials"?y:""}return Ln.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,Ln.createPortal=function(p,y){var v=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!y||y.nodeType!==1&&y.nodeType!==9&&y.nodeType!==11)throw Error(e(299));return c(p,y,null,v)},Ln.flushSync=function(p){var y=d.T,v=r.p;try{if(d.T=null,r.p=2,p)return p()}finally{d.T=y,r.p=v,r.d.f()}},Ln.preconnect=function(p,y){typeof p=="string"&&(y?(y=y.crossOrigin,y=typeof y=="string"?y==="use-credentials"?y:"":void 0):y=null,r.d.C(p,y))},Ln.prefetchDNS=function(p){typeof p=="string"&&r.d.D(p)},Ln.preinit=function(p,y){if(typeof p=="string"&&y&&typeof y.as=="string"){var v=y.as,k=f(v,y.crossOrigin),S=typeof y.integrity=="string"?y.integrity:void 0,I=typeof y.fetchPriority=="string"?y.fetchPriority:void 0;v==="style"?r.d.S(p,typeof y.precedence=="string"?y.precedence:void 0,{crossOrigin:k,integrity:S,fetchPriority:I}):v==="script"&&r.d.X(p,{crossOrigin:k,integrity:S,fetchPriority:I,nonce:typeof y.nonce=="string"?y.nonce:void 0})}},Ln.preinitModule=function(p,y){if(typeof p=="string")if(typeof y=="object"&&y!==null){if(y.as==null||y.as==="script"){var v=f(y.as,y.crossOrigin);r.d.M(p,{crossOrigin:v,integrity:typeof y.integrity=="string"?y.integrity:void 0,nonce:typeof y.nonce=="string"?y.nonce:void 0})}}else y==null&&r.d.M(p)},Ln.preload=function(p,y){if(typeof p=="string"&&typeof y=="object"&&y!==null&&typeof y.as=="string"){var v=y.as,k=f(v,y.crossOrigin);r.d.L(p,v,{crossOrigin:k,integrity:typeof y.integrity=="string"?y.integrity:void 0,nonce:typeof y.nonce=="string"?y.nonce:void 0,type:typeof y.type=="string"?y.type:void 0,fetchPriority:typeof y.fetchPriority=="string"?y.fetchPriority:void 0,referrerPolicy:typeof y.referrerPolicy=="string"?y.referrerPolicy:void 0,imageSrcSet:typeof y.imageSrcSet=="string"?y.imageSrcSet:void 0,imageSizes:typeof y.imageSizes=="string"?y.imageSizes:void 0,media:typeof y.media=="string"?y.media:void 0})}},Ln.preloadModule=function(p,y){if(typeof p=="string")if(y){var v=f(y.as,y.crossOrigin);r.d.m(p,{as:typeof y.as=="string"&&y.as!=="script"?y.as:void 0,crossOrigin:v,integrity:typeof y.integrity=="string"?y.integrity:void 0})}else r.d.m(p)},Ln.requestFormReset=function(p){r.d.r(p)},Ln.unstable_batchedUpdates=function(p,y){return p(y)},Ln.useFormState=function(p,y,v){return d.H.useFormState(p,y,v)},Ln.useFormStatus=function(){return d.H.useHostTransitionStatus()},Ln.version="19.1.1",Ln}var qx;function Tw(){if(qx)return Rf.exports;qx=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),Rf.exports=kw(),Rf.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $x;function ww(){if($x)return ac;$x=1;var s=bw(),e=kg(),t=Tw();function r(n){var a="https://react.dev/errors/"+n;if(1<arguments.length){a+="?args[]="+encodeURIComponent(arguments[1]);for(var i=2;i<arguments.length;i++)a+="&args[]="+encodeURIComponent(arguments[i])}return"Minified React error #"+n+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function c(n){var a=n,i=n;if(n.alternate)for(;a.return;)a=a.return;else{n=a;do a=n,(a.flags&4098)!==0&&(i=a.return),n=a.return;while(n)}return a.tag===3?i:null}function d(n){if(n.tag===13){var a=n.memoizedState;if(a===null&&(n=n.alternate,n!==null&&(a=n.memoizedState)),a!==null)return a.dehydrated}return null}function f(n){if(c(n)!==n)throw Error(r(188))}function p(n){var a=n.alternate;if(!a){if(a=c(n),a===null)throw Error(r(188));return a!==n?null:n}for(var i=n,u=a;;){var m=i.return;if(m===null)break;var g=m.alternate;if(g===null){if(u=m.return,u!==null){i=u;continue}break}if(m.child===g.child){for(g=m.child;g;){if(g===i)return f(m),n;if(g===u)return f(m),a;g=g.sibling}throw Error(r(188))}if(i.return!==u.return)i=m,u=g;else{for(var _=!1,w=m.child;w;){if(w===i){_=!0,i=m,u=g;break}if(w===u){_=!0,u=m,i=g;break}w=w.sibling}if(!_){for(w=g.child;w;){if(w===i){_=!0,i=g,u=m;break}if(w===u){_=!0,u=g,i=m;break}w=w.sibling}if(!_)throw Error(r(189))}}if(i.alternate!==u)throw Error(r(190))}if(i.tag!==3)throw Error(r(188));return i.stateNode.current===i?n:a}function y(n){var a=n.tag;if(a===5||a===26||a===27||a===6)return n;for(n=n.child;n!==null;){if(a=y(n),a!==null)return a;n=n.sibling}return null}var v=Object.assign,k=Symbol.for("react.element"),S=Symbol.for("react.transitional.element"),I=Symbol.for("react.portal"),q=Symbol.for("react.fragment"),L=Symbol.for("react.strict_mode"),P=Symbol.for("react.profiler"),K=Symbol.for("react.provider"),U=Symbol.for("react.consumer"),B=Symbol.for("react.context"),F=Symbol.for("react.forward_ref"),ae=Symbol.for("react.suspense"),ne=Symbol.for("react.suspense_list"),N=Symbol.for("react.memo"),R=Symbol.for("react.lazy"),E=Symbol.for("react.activity"),C=Symbol.for("react.memo_cache_sentinel"),M=Symbol.iterator;function z(n){return n===null||typeof n!="object"?null:(n=M&&n[M]||n["@@iterator"],typeof n=="function"?n:null)}var j=Symbol.for("react.client.reference");function Ve(n){if(n==null)return null;if(typeof n=="function")return n.$$typeof===j?null:n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case q:return"Fragment";case P:return"Profiler";case L:return"StrictMode";case ae:return"Suspense";case ne:return"SuspenseList";case E:return"Activity"}if(typeof n=="object")switch(n.$$typeof){case I:return"Portal";case B:return(n.displayName||"Context")+".Provider";case U:return(n._context.displayName||"Context")+".Consumer";case F:var a=n.render;return n=n.displayName,n||(n=a.displayName||a.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case N:return a=n.displayName||null,a!==null?a:Ve(n.type)||"Memo";case R:a=n._payload,n=n._init;try{return Ve(n(a))}catch{}}return null}var le=Array.isArray,W=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,de=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,me={pending:!1,data:null,method:null,action:null},ye=[],O=-1;function H(n){return{current:n}}function ee(n){0>O||(n.current=ye[O],ye[O]=null,O--)}function X(n,a){O++,ye[O]=n.current,n.current=a}var fe=H(null),_e=H(null),Ee=H(null),$e=H(null);function je(n,a){switch(X(Ee,a),X(_e,n),X(fe,null),a.nodeType){case 9:case 11:n=(n=a.documentElement)&&(n=n.namespaceURI)?hx(n):0;break;default:if(n=a.tagName,a=a.namespaceURI)a=hx(a),n=mx(a,n);else switch(n){case"svg":n=1;break;case"math":n=2;break;default:n=0}}ee(fe),X(fe,n)}function pe(){ee(fe),ee(_e),ee(Ee)}function he(n){n.memoizedState!==null&&X($e,n);var a=fe.current,i=mx(a,n.type);a!==i&&(X(_e,n),X(fe,i))}function ge(n){_e.current===n&&(ee(fe),ee(_e)),$e.current===n&&(ee($e),Zl._currentValue=me)}var Ze=Object.prototype.hasOwnProperty,Me=s.unstable_scheduleCallback,Ie=s.unstable_cancelCallback,gt=s.unstable_shouldYield,Je=s.unstable_requestPaint,pt=s.unstable_now,kt=s.unstable_getCurrentPriorityLevel,it=s.unstable_ImmediatePriority,Mt=s.unstable_UserBlockingPriority,Gt=s.unstable_NormalPriority,En=s.unstable_LowPriority,yn=s.unstable_IdlePriority,Mn=s.log,Gn=s.unstable_setDisableYieldValue,st=null,ft=null;function Kt(n){if(typeof Mn=="function"&&Gn(n),ft&&typeof ft.setStrictMode=="function")try{ft.setStrictMode(st,n)}catch{}}var Xt=Math.clz32?Math.clz32:Ca,tr=Math.log,ys=Math.LN2;function Ca(n){return n>>>=0,n===0?32:31-(tr(n)/ys|0)|0}var ma=256,fa=4194304;function On(n){var a=n&42;if(a!==0)return a;switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return n&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return n}}function Ga(n,a,i){var u=n.pendingLanes;if(u===0)return 0;var m=0,g=n.suspendedLanes,_=n.pingedLanes;n=n.warmLanes;var w=u&134217727;return w!==0?(u=w&~g,u!==0?m=On(u):(_&=w,_!==0?m=On(_):i||(i=w&~n,i!==0&&(m=On(i))))):(w=u&~g,w!==0?m=On(w):_!==0?m=On(_):i||(i=u&~n,i!==0&&(m=On(i)))),m===0?0:a!==0&&a!==m&&(a&g)===0&&(g=m&-m,i=a&-a,g>=i||g===32&&(i&4194048)!==0)?a:m}function Ia(n,a){return(n.pendingLanes&~(n.suspendedLanes&~n.pingedLanes)&a)===0}function xs(n,a){switch(n){case 1:case 2:case 4:case 8:case 64:return a+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Fa(){var n=ma;return ma<<=1,(ma&4194048)===0&&(ma=256),n}function vs(){var n=fa;return fa<<=1,(fa&62914560)===0&&(fa=4194304),n}function sa(n){for(var a=[],i=0;31>i;i++)a.push(n);return a}function ke(n,a){n.pendingLanes|=a,a!==268435456&&(n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0)}function Oe(n,a,i,u,m,g){var _=n.pendingLanes;n.pendingLanes=i,n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0,n.expiredLanes&=i,n.entangledLanes&=i,n.errorRecoveryDisabledLanes&=i,n.shellSuspendCounter=0;var w=n.entanglements,D=n.expirationTimes,Q=n.hiddenUpdates;for(i=_&~i;0<i;){var se=31-Xt(i),ce=1<<se;w[se]=0,D[se]=-1;var Z=Q[se];if(Z!==null)for(Q[se]=null,se=0;se<Z.length;se++){var J=Z[se];J!==null&&(J.lane&=-536870913)}i&=~ce}u!==0&&Ke(n,u,0),g!==0&&m===0&&n.tag!==0&&(n.suspendedLanes|=g&~(_&~a))}function Ke(n,a,i){n.pendingLanes|=a,n.suspendedLanes&=~a;var u=31-Xt(a);n.entangledLanes|=a,n.entanglements[u]=n.entanglements[u]|1073741824|i&4194090}function et(n,a){var i=n.entangledLanes|=a;for(n=n.entanglements;i;){var u=31-Xt(i),m=1<<u;m&a|n[u]&a&&(n[u]|=a),i&=~m}}function re(n){switch(n){case 2:n=1;break;case 8:n=4;break;case 32:n=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:n=128;break;case 268435456:n=134217728;break;default:n=0}return n}function De(n){return n&=-n,2<n?8<n?(n&134217727)!==0?32:268435456:8:2}function Se(){var n=de.p;return n!==0?n:(n=window.event,n===void 0?32:Ix(n.type))}function Le(n,a){var i=de.p;try{return de.p=n,a()}finally{de.p=i}}var Ne=Math.random().toString(36).slice(2),be="__reactFiber$"+Ne,Ae="__reactProps$"+Ne,Pe="__reactContainer$"+Ne,we="__reactEvents$"+Ne,He="__reactListeners$"+Ne,yt="__reactHandles$"+Ne,Ut="__reactResources$"+Ne,Ft="__reactMarker$"+Ne;function Zt(n){delete n[be],delete n[Ae],delete n[we],delete n[He],delete n[yt]}function Wt(n){var a=n[be];if(a)return a;for(var i=n.parentNode;i;){if(a=i[Pe]||i[be]){if(i=a.alternate,a.child!==null||i!==null&&i.child!==null)for(n=yx(n);n!==null;){if(i=n[be])return i;n=yx(n)}return a}n=i,i=n.parentNode}return null}function dn(n){if(n=n[be]||n[Pe]){var a=n.tag;if(a===5||a===6||a===13||a===26||a===27||a===3)return n}return null}function xn(n){var a=n.tag;if(a===5||a===26||a===27||a===6)return n.stateNode;throw Error(r(33))}function Jt(n){var a=n[Ut];return a||(a=n[Ut]={hoistableStyles:new Map,hoistableScripts:new Map}),a}function Ot(n){n[Ft]=!0}var Ge=new Set,xe={};function nt(n,a){Pn(n,a),Pn(n+"Capture",a)}function Pn(n,a){for(xe[n]=a,n=0;n<a.length;n++)Ge.add(a[n])}var qa=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),bs={},$a={};function Jc(n){return Ze.call($a,n)?!0:Ze.call(bs,n)?!1:qa.test(n)?$a[n]=!0:(bs[n]=!0,!1)}function nr(n,a,i){if(Jc(a))if(i===null)n.removeAttribute(a);else{switch(typeof i){case"undefined":case"function":case"symbol":n.removeAttribute(a);return;case"boolean":var u=a.toLowerCase().slice(0,5);if(u!=="data-"&&u!=="aria-"){n.removeAttribute(a);return}}n.setAttribute(a,""+i)}}function Ka(n,a,i){if(i===null)n.removeAttribute(a);else{switch(typeof i){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(a);return}n.setAttribute(a,""+i)}}function Sn(n,a,i,u){if(u===null)n.removeAttribute(i);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(i);return}n.setAttributeNS(a,i,""+u)}}var Qr,eu;function _s(n){if(Qr===void 0)try{throw Error()}catch(i){var a=i.stack.trim().match(/\n( *(at )?)/);Qr=a&&a[1]||"",eu=-1<i.stack.indexOf(`
    at`)?" (<anonymous>)":-1<i.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Qr+n+eu}var Ui=!1;function Bi(n,a){if(!n||Ui)return"";Ui=!0;var i=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var u={DetermineComponentFrameRoot:function(){try{if(a){var ce=function(){throw Error()};if(Object.defineProperty(ce.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ce,[])}catch(J){var Z=J}Reflect.construct(n,[],ce)}else{try{ce.call()}catch(J){Z=J}n.call(ce.prototype)}}else{try{throw Error()}catch(J){Z=J}(ce=n())&&typeof ce.catch=="function"&&ce.catch(function(){})}}catch(J){if(J&&Z&&typeof J.stack=="string")return[J.stack,Z.stack]}return[null,null]}};u.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var m=Object.getOwnPropertyDescriptor(u.DetermineComponentFrameRoot,"name");m&&m.configurable&&Object.defineProperty(u.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var g=u.DetermineComponentFrameRoot(),_=g[0],w=g[1];if(_&&w){var D=_.split(`
`),Q=w.split(`
`);for(m=u=0;u<D.length&&!D[u].includes("DetermineComponentFrameRoot");)u++;for(;m<Q.length&&!Q[m].includes("DetermineComponentFrameRoot");)m++;if(u===D.length||m===Q.length)for(u=D.length-1,m=Q.length-1;1<=u&&0<=m&&D[u]!==Q[m];)m--;for(;1<=u&&0<=m;u--,m--)if(D[u]!==Q[m]){if(u!==1||m!==1)do if(u--,m--,0>m||D[u]!==Q[m]){var se=`
`+D[u].replace(" at new "," at ");return n.displayName&&se.includes("<anonymous>")&&(se=se.replace("<anonymous>",n.displayName)),se}while(1<=u&&0<=m);break}}}finally{Ui=!1,Error.prepareStackTrace=i}return(i=n?n.displayName||n.name:"")?_s(i):""}function sl(n){switch(n.tag){case 26:case 27:case 5:return _s(n.type);case 16:return _s("Lazy");case 13:return _s("Suspense");case 19:return _s("SuspenseList");case 0:case 15:return Bi(n.type,!1);case 11:return Bi(n.type.render,!1);case 1:return Bi(n.type,!0);case 31:return _s("Activity");default:return""}}function Hi(n){try{var a="";do a+=sl(n),n=n.return;while(n);return a}catch(i){return`
Error generating stack: `+i.message+`
`+i.stack}}function Fn(n){switch(typeof n){case"bigint":case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function rl(n){var a=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function Ah(n){var a=rl(n)?"checked":"value",i=Object.getOwnPropertyDescriptor(n.constructor.prototype,a),u=""+n[a];if(!n.hasOwnProperty(a)&&typeof i<"u"&&typeof i.get=="function"&&typeof i.set=="function"){var m=i.get,g=i.set;return Object.defineProperty(n,a,{configurable:!0,get:function(){return m.call(this)},set:function(_){u=""+_,g.call(this,_)}}),Object.defineProperty(n,a,{enumerable:i.enumerable}),{getValue:function(){return u},setValue:function(_){u=""+_},stopTracking:function(){n._valueTracker=null,delete n[a]}}}}function Gi(n){n._valueTracker||(n._valueTracker=Ah(n))}function il(n){if(!n)return!1;var a=n._valueTracker;if(!a)return!0;var i=a.getValue(),u="";return n&&(u=rl(n)?n.checked?"true":"false":n.value),n=u,n!==i?(a.setValue(n),!0):!1}function Xr(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}var Nh=/[\n"\\]/g;function an(n){return n.replace(Nh,function(a){return"\\"+a.charCodeAt(0).toString(16)+" "})}function ra(n,a,i,u,m,g,_,w){n.name="",_!=null&&typeof _!="function"&&typeof _!="symbol"&&typeof _!="boolean"?n.type=_:n.removeAttribute("type"),a!=null?_==="number"?(a===0&&n.value===""||n.value!=a)&&(n.value=""+Fn(a)):n.value!==""+Fn(a)&&(n.value=""+Fn(a)):_!=="submit"&&_!=="reset"||n.removeAttribute("value"),a!=null?ar(n,_,Fn(a)):i!=null?ar(n,_,Fn(i)):u!=null&&n.removeAttribute("value"),m==null&&g!=null&&(n.defaultChecked=!!g),m!=null&&(n.checked=m&&typeof m!="function"&&typeof m!="symbol"),w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"?n.name=""+Fn(w):n.removeAttribute("name")}function Zr(n,a,i,u,m,g,_,w){if(g!=null&&typeof g!="function"&&typeof g!="symbol"&&typeof g!="boolean"&&(n.type=g),a!=null||i!=null){if(!(g!=="submit"&&g!=="reset"||a!=null))return;i=i!=null?""+Fn(i):"",a=a!=null?""+Fn(a):i,w||a===n.value||(n.value=a),n.defaultValue=a}u=u??m,u=typeof u!="function"&&typeof u!="symbol"&&!!u,n.checked=w?n.checked:!!u,n.defaultChecked=!!u,_!=null&&typeof _!="function"&&typeof _!="symbol"&&typeof _!="boolean"&&(n.name=_)}function ar(n,a,i){a==="number"&&Xr(n.ownerDocument)===n||n.defaultValue===""+i||(n.defaultValue=""+i)}function ks(n,a,i,u){if(n=n.options,a){a={};for(var m=0;m<i.length;m++)a["$"+i[m]]=!0;for(i=0;i<n.length;i++)m=a.hasOwnProperty("$"+n[i].value),n[i].selected!==m&&(n[i].selected=m),m&&u&&(n[i].defaultSelected=!0)}else{for(i=""+Fn(i),a=null,m=0;m<n.length;m++){if(n[m].value===i){n[m].selected=!0,u&&(n[m].defaultSelected=!0);return}a!==null||n[m].disabled||(a=n[m])}a!==null&&(a.selected=!0)}}function Rt(n,a,i){if(a!=null&&(a=""+Fn(a),a!==n.value&&(n.value=a),i==null)){n.defaultValue!==a&&(n.defaultValue=a);return}n.defaultValue=i!=null?""+Fn(i):""}function Wr(n,a,i,u){if(a==null){if(u!=null){if(i!=null)throw Error(r(92));if(le(u)){if(1<u.length)throw Error(r(93));u=u[0]}i=u}i==null&&(i=""),a=i}i=Fn(a),n.defaultValue=i,u=n.textContent,u===i&&u!==""&&u!==null&&(n.value=u)}function ga(n,a){if(a){var i=n.firstChild;if(i&&i===n.lastChild&&i.nodeType===3){i.nodeValue=a;return}}n.textContent=a}var Jr=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function tu(n,a,i){var u=a.indexOf("--")===0;i==null||typeof i=="boolean"||i===""?u?n.setProperty(a,""):a==="float"?n.cssFloat="":n[a]="":u?n.setProperty(a,i):typeof i!="number"||i===0||Jr.has(a)?a==="float"?n.cssFloat=i:n[a]=(""+i).trim():n[a]=i+"px"}function ol(n,a,i){if(a!=null&&typeof a!="object")throw Error(r(62));if(n=n.style,i!=null){for(var u in i)!i.hasOwnProperty(u)||a!=null&&a.hasOwnProperty(u)||(u.indexOf("--")===0?n.setProperty(u,""):u==="float"?n.cssFloat="":n[u]="");for(var m in a)u=a[m],a.hasOwnProperty(m)&&i[m]!==u&&tu(n,m,u)}else for(var g in a)a.hasOwnProperty(g)&&tu(n,g,a[g])}function ll(n){if(n.indexOf("-")===-1)return!1;switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Rh=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),jh=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Fi(n){return jh.test(""+n)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":n}var Ts=null;function pa(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var ws=null,Es=null;function cl(n){var a=dn(n);if(a&&(n=a.stateNode)){var i=n[Ae]||null;e:switch(n=a.stateNode,a.type){case"input":if(ra(n,i.value,i.defaultValue,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name),a=i.name,i.type==="radio"&&a!=null){for(i=n;i.parentNode;)i=i.parentNode;for(i=i.querySelectorAll('input[name="'+an(""+a)+'"][type="radio"]'),a=0;a<i.length;a++){var u=i[a];if(u!==n&&u.form===n.form){var m=u[Ae]||null;if(!m)throw Error(r(90));ra(u,m.value,m.defaultValue,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name)}}for(a=0;a<i.length;a++)u=i[a],u.form===n.form&&il(u)}break e;case"textarea":Rt(n,i.value,i.defaultValue);break e;case"select":a=i.value,a!=null&&ks(n,!!i.multiple,a,!1)}}}var Ya=!1;function nu(n,a,i){if(Ya)return n(a,i);Ya=!0;try{var u=n(a);return u}finally{if(Ya=!1,(ws!==null||Es!==null)&&(Qu(),ws&&(a=ws,n=Es,Es=ws=null,cl(a),n)))for(a=0;a<n.length;a++)cl(n[a])}}function ei(n,a){var i=n.stateNode;if(i===null)return null;var u=i[Ae]||null;if(u===null)return null;i=u[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(u=!u.disabled)||(n=n.type,u=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!u;break e;default:n=!1}if(n)return null;if(i&&typeof i!="function")throw Error(r(231,a,typeof i));return i}var Da=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ya=!1;if(Da)try{var ti={};Object.defineProperty(ti,"passive",{get:function(){ya=!0}}),window.addEventListener("test",ti,ti),window.removeEventListener("test",ti,ti)}catch{ya=!1}var Qa=null,sr=null,Ss=null;function ul(){if(Ss)return Ss;var n,a=sr,i=a.length,u,m="value"in Qa?Qa.value:Qa.textContent,g=m.length;for(n=0;n<i&&a[n]===m[n];n++);var _=i-n;for(u=1;u<=_&&a[i-u]===m[g-u];u++);return Ss=m.slice(n,1<u?1-u:void 0)}function Xa(n){var a=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&a===13&&(n=13)):n=a,n===10&&(n=13),32<=n||n===13?n:0}function Za(){return!0}function dl(){return!1}function vn(n){function a(i,u,m,g,_){this._reactName=i,this._targetInst=m,this.type=u,this.nativeEvent=g,this.target=_,this.currentTarget=null;for(var w in n)n.hasOwnProperty(w)&&(i=n[w],this[w]=i?i(g):g[w]);return this.isDefaultPrevented=(g.defaultPrevented!=null?g.defaultPrevented:g.returnValue===!1)?Za:dl,this.isPropagationStopped=dl,this}return v(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var i=this.nativeEvent;i&&(i.preventDefault?i.preventDefault():typeof i.returnValue!="unknown"&&(i.returnValue=!1),this.isDefaultPrevented=Za)},stopPropagation:function(){var i=this.nativeEvent;i&&(i.stopPropagation?i.stopPropagation():typeof i.cancelBubble!="unknown"&&(i.cancelBubble=!0),this.isPropagationStopped=Za)},persist:function(){},isPersistent:Za}),a}var Et={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},qi=vn(Et),ni=v({},Et,{view:0,detail:0}),au=vn(ni),$i,Ki,Wa,ai=v({},ni,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ii,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Wa&&(Wa&&n.type==="mousemove"?($i=n.screenX-Wa.screenX,Ki=n.screenY-Wa.screenY):Ki=$i=0,Wa=n),$i)},movementY:function(n){return"movementY"in n?n.movementY:Ki}}),xa=vn(ai),su=v({},ai,{dataTransfer:0}),Ch=vn(su),si=v({},ni,{relatedTarget:0}),Yi=vn(si),hl=v({},Et,{animationName:0,elapsedTime:0,pseudoElement:0}),Qi=vn(hl),ru=v({},Et,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),Xi=vn(ru),Ih=v({},Et,{data:0}),ml=vn(Ih),ri={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},iu={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ou={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function fl(n){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(n):(n=ou[n])?!!a[n]:!1}function ii(){return fl}var lu=v({},ni,{key:function(n){if(n.key){var a=ri[n.key]||n.key;if(a!=="Unidentified")return a}return n.type==="keypress"?(n=Xa(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?iu[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ii,charCode:function(n){return n.type==="keypress"?Xa(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?Xa(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),Zi=vn(lu),cu=v({},ai,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),gl=vn(cu),As=v({},ni,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ii}),uu=vn(As),du=v({},Et,{propertyName:0,elapsedTime:0,pseudoElement:0}),hu=vn(du),mu=v({},ai,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),Wi=vn(mu),qn=v({},Et,{newState:0,oldState:0}),fu=vn(qn),gu=[9,13,27,32],Ja=Da&&"CompositionEvent"in window,h=null;Da&&"documentMode"in document&&(h=document.documentMode);var x=Da&&"TextEvent"in window&&!h,b=Da&&(!Ja||h&&8<h&&11>=h),A=" ",$=!1;function te(n,a){switch(n){case"keyup":return gu.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ve(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var xt=!1;function hn(n,a){switch(n){case"compositionend":return ve(a);case"keypress":return a.which!==32?null:($=!0,A);case"textInput":return n=a.data,n===A&&$?null:n;default:return null}}function vt(n,a){if(xt)return n==="compositionend"||!Ja&&te(n,a)?(n=ul(),Ss=sr=Qa=null,xt=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return b&&a.locale!=="ko"?null:a.data;default:return null}}var bn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function mn(n){var a=n&&n.nodeName&&n.nodeName.toLowerCase();return a==="input"?!!bn[n.type]:a==="textarea"}function Ns(n,a,i,u){ws?Es?Es.push(u):Es=[u]:ws=u,a=td(a,"onChange"),0<a.length&&(i=new qi("onChange","change",null,i,u),n.push({event:i,listeners:a}))}var An=null,es=null;function pl(n){ox(n,0)}function pu(n){var a=xn(n);if(il(a))return n}function Np(n,a){if(n==="change")return a}var Rp=!1;if(Da){var Dh;if(Da){var Mh="oninput"in document;if(!Mh){var jp=document.createElement("div");jp.setAttribute("oninput","return;"),Mh=typeof jp.oninput=="function"}Dh=Mh}else Dh=!1;Rp=Dh&&(!document.documentMode||9<document.documentMode)}function Cp(){An&&(An.detachEvent("onpropertychange",Ip),es=An=null)}function Ip(n){if(n.propertyName==="value"&&pu(es)){var a=[];Ns(a,es,n,pa(n)),nu(pl,a)}}function $k(n,a,i){n==="focusin"?(Cp(),An=a,es=i,An.attachEvent("onpropertychange",Ip)):n==="focusout"&&Cp()}function Kk(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return pu(es)}function Yk(n,a){if(n==="click")return pu(a)}function Qk(n,a){if(n==="input"||n==="change")return pu(a)}function Xk(n,a){return n===a&&(n!==0||1/n===1/a)||n!==n&&a!==a}var ia=typeof Object.is=="function"?Object.is:Xk;function yl(n,a){if(ia(n,a))return!0;if(typeof n!="object"||n===null||typeof a!="object"||a===null)return!1;var i=Object.keys(n),u=Object.keys(a);if(i.length!==u.length)return!1;for(u=0;u<i.length;u++){var m=i[u];if(!Ze.call(a,m)||!ia(n[m],a[m]))return!1}return!0}function Dp(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function Mp(n,a){var i=Dp(n);n=0;for(var u;i;){if(i.nodeType===3){if(u=n+i.textContent.length,n<=a&&u>=a)return{node:i,offset:a-n};n=u}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=Dp(i)}}function Op(n,a){return n&&a?n===a?!0:n&&n.nodeType===3?!1:a&&a.nodeType===3?Op(n,a.parentNode):"contains"in n?n.contains(a):n.compareDocumentPosition?!!(n.compareDocumentPosition(a)&16):!1:!1}function Pp(n){n=n!=null&&n.ownerDocument!=null&&n.ownerDocument.defaultView!=null?n.ownerDocument.defaultView:window;for(var a=Xr(n.document);a instanceof n.HTMLIFrameElement;){try{var i=typeof a.contentWindow.location.href=="string"}catch{i=!1}if(i)n=a.contentWindow;else break;a=Xr(n.document)}return a}function Oh(n){var a=n&&n.nodeName&&n.nodeName.toLowerCase();return a&&(a==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||a==="textarea"||n.contentEditable==="true")}var Zk=Da&&"documentMode"in document&&11>=document.documentMode,Ji=null,Ph=null,xl=null,zh=!1;function zp(n,a,i){var u=i.window===i?i.document:i.nodeType===9?i:i.ownerDocument;zh||Ji==null||Ji!==Xr(u)||(u=Ji,"selectionStart"in u&&Oh(u)?u={start:u.selectionStart,end:u.selectionEnd}:(u=(u.ownerDocument&&u.ownerDocument.defaultView||window).getSelection(),u={anchorNode:u.anchorNode,anchorOffset:u.anchorOffset,focusNode:u.focusNode,focusOffset:u.focusOffset}),xl&&yl(xl,u)||(xl=u,u=td(Ph,"onSelect"),0<u.length&&(a=new qi("onSelect","select",null,a,i),n.push({event:a,listeners:u}),a.target=Ji)))}function oi(n,a){var i={};return i[n.toLowerCase()]=a.toLowerCase(),i["Webkit"+n]="webkit"+a,i["Moz"+n]="moz"+a,i}var eo={animationend:oi("Animation","AnimationEnd"),animationiteration:oi("Animation","AnimationIteration"),animationstart:oi("Animation","AnimationStart"),transitionrun:oi("Transition","TransitionRun"),transitionstart:oi("Transition","TransitionStart"),transitioncancel:oi("Transition","TransitionCancel"),transitionend:oi("Transition","TransitionEnd")},Lh={},Lp={};Da&&(Lp=document.createElement("div").style,"AnimationEvent"in window||(delete eo.animationend.animation,delete eo.animationiteration.animation,delete eo.animationstart.animation),"TransitionEvent"in window||delete eo.transitionend.transition);function li(n){if(Lh[n])return Lh[n];if(!eo[n])return n;var a=eo[n],i;for(i in a)if(a.hasOwnProperty(i)&&i in Lp)return Lh[n]=a[i];return n}var Vp=li("animationend"),Up=li("animationiteration"),Bp=li("animationstart"),Wk=li("transitionrun"),Jk=li("transitionstart"),eT=li("transitioncancel"),Hp=li("transitionend"),Gp=new Map,Vh="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Vh.push("scrollEnd");function Ma(n,a){Gp.set(n,a),nt(a,[n])}var Fp=new WeakMap;function va(n,a){if(typeof n=="object"&&n!==null){var i=Fp.get(n);return i!==void 0?i:(a={value:n,source:a,stack:Hi(a)},Fp.set(n,a),a)}return{value:n,source:a,stack:Hi(a)}}var ba=[],to=0,Uh=0;function yu(){for(var n=to,a=Uh=to=0;a<n;){var i=ba[a];ba[a++]=null;var u=ba[a];ba[a++]=null;var m=ba[a];ba[a++]=null;var g=ba[a];if(ba[a++]=null,u!==null&&m!==null){var _=u.pending;_===null?m.next=m:(m.next=_.next,_.next=m),u.pending=m}g!==0&&qp(i,m,g)}}function xu(n,a,i,u){ba[to++]=n,ba[to++]=a,ba[to++]=i,ba[to++]=u,Uh|=u,n.lanes|=u,n=n.alternate,n!==null&&(n.lanes|=u)}function Bh(n,a,i,u){return xu(n,a,i,u),vu(n)}function no(n,a){return xu(n,null,null,a),vu(n)}function qp(n,a,i){n.lanes|=i;var u=n.alternate;u!==null&&(u.lanes|=i);for(var m=!1,g=n.return;g!==null;)g.childLanes|=i,u=g.alternate,u!==null&&(u.childLanes|=i),g.tag===22&&(n=g.stateNode,n===null||n._visibility&1||(m=!0)),n=g,g=g.return;return n.tag===3?(g=n.stateNode,m&&a!==null&&(m=31-Xt(i),n=g.hiddenUpdates,u=n[m],u===null?n[m]=[a]:u.push(a),a.lane=i|536870912),g):null}function vu(n){if(50<Gl)throw Gl=0,Km=null,Error(r(185));for(var a=n.return;a!==null;)n=a,a=n.return;return n.tag===3?n.stateNode:null}var ao={};function tT(n,a,i,u){this.tag=n,this.key=i,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=u,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function oa(n,a,i,u){return new tT(n,a,i,u)}function Hh(n){return n=n.prototype,!(!n||!n.isReactComponent)}function Rs(n,a){var i=n.alternate;return i===null?(i=oa(n.tag,a,n.key,n.mode),i.elementType=n.elementType,i.type=n.type,i.stateNode=n.stateNode,i.alternate=n,n.alternate=i):(i.pendingProps=a,i.type=n.type,i.flags=0,i.subtreeFlags=0,i.deletions=null),i.flags=n.flags&65011712,i.childLanes=n.childLanes,i.lanes=n.lanes,i.child=n.child,i.memoizedProps=n.memoizedProps,i.memoizedState=n.memoizedState,i.updateQueue=n.updateQueue,a=n.dependencies,i.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},i.sibling=n.sibling,i.index=n.index,i.ref=n.ref,i.refCleanup=n.refCleanup,i}function $p(n,a){n.flags&=65011714;var i=n.alternate;return i===null?(n.childLanes=0,n.lanes=a,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=i.childLanes,n.lanes=i.lanes,n.child=i.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=i.memoizedProps,n.memoizedState=i.memoizedState,n.updateQueue=i.updateQueue,n.type=i.type,a=i.dependencies,n.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),n}function bu(n,a,i,u,m,g){var _=0;if(u=n,typeof n=="function")Hh(n)&&(_=1);else if(typeof n=="string")_=aw(n,i,fe.current)?26:n==="html"||n==="head"||n==="body"?27:5;else e:switch(n){case E:return n=oa(31,i,a,m),n.elementType=E,n.lanes=g,n;case q:return ci(i.children,m,g,a);case L:_=8,m|=24;break;case P:return n=oa(12,i,a,m|2),n.elementType=P,n.lanes=g,n;case ae:return n=oa(13,i,a,m),n.elementType=ae,n.lanes=g,n;case ne:return n=oa(19,i,a,m),n.elementType=ne,n.lanes=g,n;default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case K:case B:_=10;break e;case U:_=9;break e;case F:_=11;break e;case N:_=14;break e;case R:_=16,u=null;break e}_=29,i=Error(r(130,n===null?"null":typeof n,"")),u=null}return a=oa(_,i,a,m),a.elementType=n,a.type=u,a.lanes=g,a}function ci(n,a,i,u){return n=oa(7,n,u,a),n.lanes=i,n}function Gh(n,a,i){return n=oa(6,n,null,a),n.lanes=i,n}function Fh(n,a,i){return a=oa(4,n.children!==null?n.children:[],n.key,a),a.lanes=i,a.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},a}var so=[],ro=0,_u=null,ku=0,_a=[],ka=0,ui=null,js=1,Cs="";function di(n,a){so[ro++]=ku,so[ro++]=_u,_u=n,ku=a}function Kp(n,a,i){_a[ka++]=js,_a[ka++]=Cs,_a[ka++]=ui,ui=n;var u=js;n=Cs;var m=32-Xt(u)-1;u&=~(1<<m),i+=1;var g=32-Xt(a)+m;if(30<g){var _=m-m%5;g=(u&(1<<_)-1).toString(32),u>>=_,m-=_,js=1<<32-Xt(a)+m|i<<m|u,Cs=g+n}else js=1<<g|i<<m|u,Cs=n}function qh(n){n.return!==null&&(di(n,1),Kp(n,1,0))}function $h(n){for(;n===_u;)_u=so[--ro],so[ro]=null,ku=so[--ro],so[ro]=null;for(;n===ui;)ui=_a[--ka],_a[ka]=null,Cs=_a[--ka],_a[ka]=null,js=_a[--ka],_a[ka]=null}var $n=null,Yt=null,wt=!1,hi=null,ts=!1,Kh=Error(r(519));function mi(n){var a=Error(r(418,""));throw _l(va(a,n)),Kh}function Yp(n){var a=n.stateNode,i=n.type,u=n.memoizedProps;switch(a[be]=n,a[Ae]=u,i){case"dialog":ut("cancel",a),ut("close",a);break;case"iframe":case"object":case"embed":ut("load",a);break;case"video":case"audio":for(i=0;i<ql.length;i++)ut(ql[i],a);break;case"source":ut("error",a);break;case"img":case"image":case"link":ut("error",a),ut("load",a);break;case"details":ut("toggle",a);break;case"input":ut("invalid",a),Zr(a,u.value,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name,!0),Gi(a);break;case"select":ut("invalid",a);break;case"textarea":ut("invalid",a),Wr(a,u.value,u.defaultValue,u.children),Gi(a)}i=u.children,typeof i!="string"&&typeof i!="number"&&typeof i!="bigint"||a.textContent===""+i||u.suppressHydrationWarning===!0||dx(a.textContent,i)?(u.popover!=null&&(ut("beforetoggle",a),ut("toggle",a)),u.onScroll!=null&&ut("scroll",a),u.onScrollEnd!=null&&ut("scrollend",a),u.onClick!=null&&(a.onclick=nd),a=!0):a=!1,a||mi(n)}function Qp(n){for($n=n.return;$n;)switch($n.tag){case 5:case 13:ts=!1;return;case 27:case 3:ts=!0;return;default:$n=$n.return}}function vl(n){if(n!==$n)return!1;if(!wt)return Qp(n),wt=!0,!1;var a=n.tag,i;if((i=a!==3&&a!==27)&&((i=a===5)&&(i=n.type,i=!(i!=="form"&&i!=="button")||uf(n.type,n.memoizedProps)),i=!i),i&&Yt&&mi(n),Qp(n),a===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(r(317));e:{for(n=n.nextSibling,a=0;n;){if(n.nodeType===8)if(i=n.data,i==="/$"){if(a===0){Yt=Pa(n.nextSibling);break e}a--}else i!=="$"&&i!=="$!"&&i!=="$?"||a++;n=n.nextSibling}Yt=null}}else a===27?(a=Yt,br(n.type)?(n=ff,ff=null,Yt=n):Yt=a):Yt=$n?Pa(n.stateNode.nextSibling):null;return!0}function bl(){Yt=$n=null,wt=!1}function Xp(){var n=hi;return n!==null&&(Xn===null?Xn=n:Xn.push.apply(Xn,n),hi=null),n}function _l(n){hi===null?hi=[n]:hi.push(n)}var Yh=H(null),fi=null,Is=null;function rr(n,a,i){X(Yh,a._currentValue),a._currentValue=i}function Ds(n){n._currentValue=Yh.current,ee(Yh)}function Qh(n,a,i){for(;n!==null;){var u=n.alternate;if((n.childLanes&a)!==a?(n.childLanes|=a,u!==null&&(u.childLanes|=a)):u!==null&&(u.childLanes&a)!==a&&(u.childLanes|=a),n===i)break;n=n.return}}function Xh(n,a,i,u){var m=n.child;for(m!==null&&(m.return=n);m!==null;){var g=m.dependencies;if(g!==null){var _=m.child;g=g.firstContext;e:for(;g!==null;){var w=g;g=m;for(var D=0;D<a.length;D++)if(w.context===a[D]){g.lanes|=i,w=g.alternate,w!==null&&(w.lanes|=i),Qh(g.return,i,n),u||(_=null);break e}g=w.next}}else if(m.tag===18){if(_=m.return,_===null)throw Error(r(341));_.lanes|=i,g=_.alternate,g!==null&&(g.lanes|=i),Qh(_,i,n),_=null}else _=m.child;if(_!==null)_.return=m;else for(_=m;_!==null;){if(_===n){_=null;break}if(m=_.sibling,m!==null){m.return=_.return,_=m;break}_=_.return}m=_}}function kl(n,a,i,u){n=null;for(var m=a,g=!1;m!==null;){if(!g){if((m.flags&524288)!==0)g=!0;else if((m.flags&262144)!==0)break}if(m.tag===10){var _=m.alternate;if(_===null)throw Error(r(387));if(_=_.memoizedProps,_!==null){var w=m.type;ia(m.pendingProps.value,_.value)||(n!==null?n.push(w):n=[w])}}else if(m===$e.current){if(_=m.alternate,_===null)throw Error(r(387));_.memoizedState.memoizedState!==m.memoizedState.memoizedState&&(n!==null?n.push(Zl):n=[Zl])}m=m.return}n!==null&&Xh(a,n,i,u),a.flags|=262144}function Tu(n){for(n=n.firstContext;n!==null;){if(!ia(n.context._currentValue,n.memoizedValue))return!0;n=n.next}return!1}function gi(n){fi=n,Is=null,n=n.dependencies,n!==null&&(n.firstContext=null)}function zn(n){return Zp(fi,n)}function wu(n,a){return fi===null&&gi(n),Zp(n,a)}function Zp(n,a){var i=a._currentValue;if(a={context:a,memoizedValue:i,next:null},Is===null){if(n===null)throw Error(r(308));Is=a,n.dependencies={lanes:0,firstContext:a},n.flags|=524288}else Is=Is.next=a;return i}var nT=typeof AbortController<"u"?AbortController:function(){var n=[],a=this.signal={aborted:!1,addEventListener:function(i,u){n.push(u)}};this.abort=function(){a.aborted=!0,n.forEach(function(i){return i()})}},aT=s.unstable_scheduleCallback,sT=s.unstable_NormalPriority,fn={$$typeof:B,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Zh(){return{controller:new nT,data:new Map,refCount:0}}function Tl(n){n.refCount--,n.refCount===0&&aT(sT,function(){n.controller.abort()})}var wl=null,Wh=0,io=0,oo=null;function rT(n,a){if(wl===null){var i=wl=[];Wh=0,io=ef(),oo={status:"pending",value:void 0,then:function(u){i.push(u)}}}return Wh++,a.then(Wp,Wp),a}function Wp(){if(--Wh===0&&wl!==null){oo!==null&&(oo.status="fulfilled");var n=wl;wl=null,io=0,oo=null;for(var a=0;a<n.length;a++)(0,n[a])()}}function iT(n,a){var i=[],u={status:"pending",value:null,reason:null,then:function(m){i.push(m)}};return n.then(function(){u.status="fulfilled",u.value=a;for(var m=0;m<i.length;m++)(0,i[m])(a)},function(m){for(u.status="rejected",u.reason=m,m=0;m<i.length;m++)(0,i[m])(void 0)}),u}var Jp=W.S;W.S=function(n,a){typeof a=="object"&&a!==null&&typeof a.then=="function"&&rT(n,a),Jp!==null&&Jp(n,a)};var pi=H(null);function Jh(){var n=pi.current;return n!==null?n:Lt.pooledCache}function Eu(n,a){a===null?X(pi,pi.current):X(pi,a.pool)}function ey(){var n=Jh();return n===null?null:{parent:fn._currentValue,pool:n}}var El=Error(r(460)),ty=Error(r(474)),Su=Error(r(542)),em={then:function(){}};function ny(n){return n=n.status,n==="fulfilled"||n==="rejected"}function Au(){}function ay(n,a,i){switch(i=n[i],i===void 0?n.push(a):i!==a&&(a.then(Au,Au),a=i),a.status){case"fulfilled":return a.value;case"rejected":throw n=a.reason,ry(n),n;default:if(typeof a.status=="string")a.then(Au,Au);else{if(n=Lt,n!==null&&100<n.shellSuspendCounter)throw Error(r(482));n=a,n.status="pending",n.then(function(u){if(a.status==="pending"){var m=a;m.status="fulfilled",m.value=u}},function(u){if(a.status==="pending"){var m=a;m.status="rejected",m.reason=u}})}switch(a.status){case"fulfilled":return a.value;case"rejected":throw n=a.reason,ry(n),n}throw Sl=a,El}}var Sl=null;function sy(){if(Sl===null)throw Error(r(459));var n=Sl;return Sl=null,n}function ry(n){if(n===El||n===Su)throw Error(r(483))}var ir=!1;function tm(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function nm(n,a){n=n.updateQueue,a.updateQueue===n&&(a.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,callbacks:null})}function or(n){return{lane:n,tag:0,payload:null,callback:null,next:null}}function lr(n,a,i){var u=n.updateQueue;if(u===null)return null;if(u=u.shared,(At&2)!==0){var m=u.pending;return m===null?a.next=a:(a.next=m.next,m.next=a),u.pending=a,a=vu(n),qp(n,null,i),a}return xu(n,u,a,i),vu(n)}function Al(n,a,i){if(a=a.updateQueue,a!==null&&(a=a.shared,(i&4194048)!==0)){var u=a.lanes;u&=n.pendingLanes,i|=u,a.lanes=i,et(n,i)}}function am(n,a){var i=n.updateQueue,u=n.alternate;if(u!==null&&(u=u.updateQueue,i===u)){var m=null,g=null;if(i=i.firstBaseUpdate,i!==null){do{var _={lane:i.lane,tag:i.tag,payload:i.payload,callback:null,next:null};g===null?m=g=_:g=g.next=_,i=i.next}while(i!==null);g===null?m=g=a:g=g.next=a}else m=g=a;i={baseState:u.baseState,firstBaseUpdate:m,lastBaseUpdate:g,shared:u.shared,callbacks:u.callbacks},n.updateQueue=i;return}n=i.lastBaseUpdate,n===null?i.firstBaseUpdate=a:n.next=a,i.lastBaseUpdate=a}var sm=!1;function Nl(){if(sm){var n=oo;if(n!==null)throw n}}function Rl(n,a,i,u){sm=!1;var m=n.updateQueue;ir=!1;var g=m.firstBaseUpdate,_=m.lastBaseUpdate,w=m.shared.pending;if(w!==null){m.shared.pending=null;var D=w,Q=D.next;D.next=null,_===null?g=Q:_.next=Q,_=D;var se=n.alternate;se!==null&&(se=se.updateQueue,w=se.lastBaseUpdate,w!==_&&(w===null?se.firstBaseUpdate=Q:w.next=Q,se.lastBaseUpdate=D))}if(g!==null){var ce=m.baseState;_=0,se=Q=D=null,w=g;do{var Z=w.lane&-536870913,J=Z!==w.lane;if(J?(bt&Z)===Z:(u&Z)===Z){Z!==0&&Z===io&&(sm=!0),se!==null&&(se=se.next={lane:0,tag:w.tag,payload:w.payload,callback:null,next:null});e:{var Xe=n,Fe=w;Z=a;var It=i;switch(Fe.tag){case 1:if(Xe=Fe.payload,typeof Xe=="function"){ce=Xe.call(It,ce,Z);break e}ce=Xe;break e;case 3:Xe.flags=Xe.flags&-65537|128;case 0:if(Xe=Fe.payload,Z=typeof Xe=="function"?Xe.call(It,ce,Z):Xe,Z==null)break e;ce=v({},ce,Z);break e;case 2:ir=!0}}Z=w.callback,Z!==null&&(n.flags|=64,J&&(n.flags|=8192),J=m.callbacks,J===null?m.callbacks=[Z]:J.push(Z))}else J={lane:Z,tag:w.tag,payload:w.payload,callback:w.callback,next:null},se===null?(Q=se=J,D=ce):se=se.next=J,_|=Z;if(w=w.next,w===null){if(w=m.shared.pending,w===null)break;J=w,w=J.next,J.next=null,m.lastBaseUpdate=J,m.shared.pending=null}}while(!0);se===null&&(D=ce),m.baseState=D,m.firstBaseUpdate=Q,m.lastBaseUpdate=se,g===null&&(m.shared.lanes=0),pr|=_,n.lanes=_,n.memoizedState=ce}}function iy(n,a){if(typeof n!="function")throw Error(r(191,n));n.call(a)}function oy(n,a){var i=n.callbacks;if(i!==null)for(n.callbacks=null,n=0;n<i.length;n++)iy(i[n],a)}var lo=H(null),Nu=H(0);function ly(n,a){n=Us,X(Nu,n),X(lo,a),Us=n|a.baseLanes}function rm(){X(Nu,Us),X(lo,lo.current)}function im(){Us=Nu.current,ee(lo),ee(Nu)}var cr=0,ot=null,jt=null,sn=null,Ru=!1,co=!1,yi=!1,ju=0,jl=0,uo=null,oT=0;function en(){throw Error(r(321))}function om(n,a){if(a===null)return!1;for(var i=0;i<a.length&&i<n.length;i++)if(!ia(n[i],a[i]))return!1;return!0}function lm(n,a,i,u,m,g){return cr=g,ot=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,W.H=n===null||n.memoizedState===null?qy:$y,yi=!1,g=i(u,m),yi=!1,co&&(g=uy(a,i,u,m)),cy(n),g}function cy(n){W.H=Pu;var a=jt!==null&&jt.next!==null;if(cr=0,sn=jt=ot=null,Ru=!1,jl=0,uo=null,a)throw Error(r(300));n===null||_n||(n=n.dependencies,n!==null&&Tu(n)&&(_n=!0))}function uy(n,a,i,u){ot=n;var m=0;do{if(co&&(uo=null),jl=0,co=!1,25<=m)throw Error(r(301));if(m+=1,sn=jt=null,n.updateQueue!=null){var g=n.updateQueue;g.lastEffect=null,g.events=null,g.stores=null,g.memoCache!=null&&(g.memoCache.index=0)}W.H=fT,g=a(i,u)}while(co);return g}function lT(){var n=W.H,a=n.useState()[0];return a=typeof a.then=="function"?Cl(a):a,n=n.useState()[0],(jt!==null?jt.memoizedState:null)!==n&&(ot.flags|=1024),a}function cm(){var n=ju!==0;return ju=0,n}function um(n,a,i){a.updateQueue=n.updateQueue,a.flags&=-2053,n.lanes&=~i}function dm(n){if(Ru){for(n=n.memoizedState;n!==null;){var a=n.queue;a!==null&&(a.pending=null),n=n.next}Ru=!1}cr=0,sn=jt=ot=null,co=!1,jl=ju=0,uo=null}function Yn(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return sn===null?ot.memoizedState=sn=n:sn=sn.next=n,sn}function rn(){if(jt===null){var n=ot.alternate;n=n!==null?n.memoizedState:null}else n=jt.next;var a=sn===null?ot.memoizedState:sn.next;if(a!==null)sn=a,jt=n;else{if(n===null)throw ot.alternate===null?Error(r(467)):Error(r(310));jt=n,n={memoizedState:jt.memoizedState,baseState:jt.baseState,baseQueue:jt.baseQueue,queue:jt.queue,next:null},sn===null?ot.memoizedState=sn=n:sn=sn.next=n}return sn}function hm(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Cl(n){var a=jl;return jl+=1,uo===null&&(uo=[]),n=ay(uo,n,a),a=ot,(sn===null?a.memoizedState:sn.next)===null&&(a=a.alternate,W.H=a===null||a.memoizedState===null?qy:$y),n}function Cu(n){if(n!==null&&typeof n=="object"){if(typeof n.then=="function")return Cl(n);if(n.$$typeof===B)return zn(n)}throw Error(r(438,String(n)))}function mm(n){var a=null,i=ot.updateQueue;if(i!==null&&(a=i.memoCache),a==null){var u=ot.alternate;u!==null&&(u=u.updateQueue,u!==null&&(u=u.memoCache,u!=null&&(a={data:u.data.map(function(m){return m.slice()}),index:0})))}if(a==null&&(a={data:[],index:0}),i===null&&(i=hm(),ot.updateQueue=i),i.memoCache=a,i=a.data[a.index],i===void 0)for(i=a.data[a.index]=Array(n),u=0;u<n;u++)i[u]=C;return a.index++,i}function Ms(n,a){return typeof a=="function"?a(n):a}function Iu(n){var a=rn();return fm(a,jt,n)}function fm(n,a,i){var u=n.queue;if(u===null)throw Error(r(311));u.lastRenderedReducer=i;var m=n.baseQueue,g=u.pending;if(g!==null){if(m!==null){var _=m.next;m.next=g.next,g.next=_}a.baseQueue=m=g,u.pending=null}if(g=n.baseState,m===null)n.memoizedState=g;else{a=m.next;var w=_=null,D=null,Q=a,se=!1;do{var ce=Q.lane&-536870913;if(ce!==Q.lane?(bt&ce)===ce:(cr&ce)===ce){var Z=Q.revertLane;if(Z===0)D!==null&&(D=D.next={lane:0,revertLane:0,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null}),ce===io&&(se=!0);else if((cr&Z)===Z){Q=Q.next,Z===io&&(se=!0);continue}else ce={lane:0,revertLane:Q.revertLane,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null},D===null?(w=D=ce,_=g):D=D.next=ce,ot.lanes|=Z,pr|=Z;ce=Q.action,yi&&i(g,ce),g=Q.hasEagerState?Q.eagerState:i(g,ce)}else Z={lane:ce,revertLane:Q.revertLane,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null},D===null?(w=D=Z,_=g):D=D.next=Z,ot.lanes|=ce,pr|=ce;Q=Q.next}while(Q!==null&&Q!==a);if(D===null?_=g:D.next=w,!ia(g,n.memoizedState)&&(_n=!0,se&&(i=oo,i!==null)))throw i;n.memoizedState=g,n.baseState=_,n.baseQueue=D,u.lastRenderedState=g}return m===null&&(u.lanes=0),[n.memoizedState,u.dispatch]}function gm(n){var a=rn(),i=a.queue;if(i===null)throw Error(r(311));i.lastRenderedReducer=n;var u=i.dispatch,m=i.pending,g=a.memoizedState;if(m!==null){i.pending=null;var _=m=m.next;do g=n(g,_.action),_=_.next;while(_!==m);ia(g,a.memoizedState)||(_n=!0),a.memoizedState=g,a.baseQueue===null&&(a.baseState=g),i.lastRenderedState=g}return[g,u]}function dy(n,a,i){var u=ot,m=rn(),g=wt;if(g){if(i===void 0)throw Error(r(407));i=i()}else i=a();var _=!ia((jt||m).memoizedState,i);_&&(m.memoizedState=i,_n=!0),m=m.queue;var w=fy.bind(null,u,m,n);if(Il(2048,8,w,[n]),m.getSnapshot!==a||_||sn!==null&&sn.memoizedState.tag&1){if(u.flags|=2048,ho(9,Du(),my.bind(null,u,m,i,a),null),Lt===null)throw Error(r(349));g||(cr&124)!==0||hy(u,a,i)}return i}function hy(n,a,i){n.flags|=16384,n={getSnapshot:a,value:i},a=ot.updateQueue,a===null?(a=hm(),ot.updateQueue=a,a.stores=[n]):(i=a.stores,i===null?a.stores=[n]:i.push(n))}function my(n,a,i,u){a.value=i,a.getSnapshot=u,gy(a)&&py(n)}function fy(n,a,i){return i(function(){gy(a)&&py(n)})}function gy(n){var a=n.getSnapshot;n=n.value;try{var i=a();return!ia(n,i)}catch{return!0}}function py(n){var a=no(n,2);a!==null&&ha(a,n,2)}function pm(n){var a=Yn();if(typeof n=="function"){var i=n;if(n=i(),yi){Kt(!0);try{i()}finally{Kt(!1)}}}return a.memoizedState=a.baseState=n,a.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ms,lastRenderedState:n},a}function yy(n,a,i,u){return n.baseState=i,fm(n,jt,typeof u=="function"?u:Ms)}function cT(n,a,i,u,m){if(Ou(n))throw Error(r(485));if(n=a.action,n!==null){var g={payload:m,action:n,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(_){g.listeners.push(_)}};W.T!==null?i(!0):g.isTransition=!1,u(g),i=a.pending,i===null?(g.next=a.pending=g,xy(a,g)):(g.next=i.next,a.pending=i.next=g)}}function xy(n,a){var i=a.action,u=a.payload,m=n.state;if(a.isTransition){var g=W.T,_={};W.T=_;try{var w=i(m,u),D=W.S;D!==null&&D(_,w),vy(n,a,w)}catch(Q){ym(n,a,Q)}finally{W.T=g}}else try{g=i(m,u),vy(n,a,g)}catch(Q){ym(n,a,Q)}}function vy(n,a,i){i!==null&&typeof i=="object"&&typeof i.then=="function"?i.then(function(u){by(n,a,u)},function(u){return ym(n,a,u)}):by(n,a,i)}function by(n,a,i){a.status="fulfilled",a.value=i,_y(a),n.state=i,a=n.pending,a!==null&&(i=a.next,i===a?n.pending=null:(i=i.next,a.next=i,xy(n,i)))}function ym(n,a,i){var u=n.pending;if(n.pending=null,u!==null){u=u.next;do a.status="rejected",a.reason=i,_y(a),a=a.next;while(a!==u)}n.action=null}function _y(n){n=n.listeners;for(var a=0;a<n.length;a++)(0,n[a])()}function ky(n,a){return a}function Ty(n,a){if(wt){var i=Lt.formState;if(i!==null){e:{var u=ot;if(wt){if(Yt){t:{for(var m=Yt,g=ts;m.nodeType!==8;){if(!g){m=null;break t}if(m=Pa(m.nextSibling),m===null){m=null;break t}}g=m.data,m=g==="F!"||g==="F"?m:null}if(m){Yt=Pa(m.nextSibling),u=m.data==="F!";break e}}mi(u)}u=!1}u&&(a=i[0])}}return i=Yn(),i.memoizedState=i.baseState=a,u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ky,lastRenderedState:a},i.queue=u,i=Hy.bind(null,ot,u),u.dispatch=i,u=pm(!1),g=km.bind(null,ot,!1,u.queue),u=Yn(),m={state:a,dispatch:null,action:n,pending:null},u.queue=m,i=cT.bind(null,ot,m,g,i),m.dispatch=i,u.memoizedState=n,[a,i,!1]}function wy(n){var a=rn();return Ey(a,jt,n)}function Ey(n,a,i){if(a=fm(n,a,ky)[0],n=Iu(Ms)[0],typeof a=="object"&&a!==null&&typeof a.then=="function")try{var u=Cl(a)}catch(_){throw _===El?Su:_}else u=a;a=rn();var m=a.queue,g=m.dispatch;return i!==a.memoizedState&&(ot.flags|=2048,ho(9,Du(),uT.bind(null,m,i),null)),[u,g,n]}function uT(n,a){n.action=a}function Sy(n){var a=rn(),i=jt;if(i!==null)return Ey(a,i,n);rn(),a=a.memoizedState,i=rn();var u=i.queue.dispatch;return i.memoizedState=n,[a,u,!1]}function ho(n,a,i,u){return n={tag:n,create:i,deps:u,inst:a,next:null},a=ot.updateQueue,a===null&&(a=hm(),ot.updateQueue=a),i=a.lastEffect,i===null?a.lastEffect=n.next=n:(u=i.next,i.next=n,n.next=u,a.lastEffect=n),n}function Du(){return{destroy:void 0,resource:void 0}}function Ay(){return rn().memoizedState}function Mu(n,a,i,u){var m=Yn();u=u===void 0?null:u,ot.flags|=n,m.memoizedState=ho(1|a,Du(),i,u)}function Il(n,a,i,u){var m=rn();u=u===void 0?null:u;var g=m.memoizedState.inst;jt!==null&&u!==null&&om(u,jt.memoizedState.deps)?m.memoizedState=ho(a,g,i,u):(ot.flags|=n,m.memoizedState=ho(1|a,g,i,u))}function Ny(n,a){Mu(8390656,8,n,a)}function Ry(n,a){Il(2048,8,n,a)}function jy(n,a){return Il(4,2,n,a)}function Cy(n,a){return Il(4,4,n,a)}function Iy(n,a){if(typeof a=="function"){n=n();var i=a(n);return function(){typeof i=="function"?i():a(null)}}if(a!=null)return n=n(),a.current=n,function(){a.current=null}}function Dy(n,a,i){i=i!=null?i.concat([n]):null,Il(4,4,Iy.bind(null,a,n),i)}function xm(){}function My(n,a){var i=rn();a=a===void 0?null:a;var u=i.memoizedState;return a!==null&&om(a,u[1])?u[0]:(i.memoizedState=[n,a],n)}function Oy(n,a){var i=rn();a=a===void 0?null:a;var u=i.memoizedState;if(a!==null&&om(a,u[1]))return u[0];if(u=n(),yi){Kt(!0);try{n()}finally{Kt(!1)}}return i.memoizedState=[u,a],u}function vm(n,a,i){return i===void 0||(cr&1073741824)!==0?n.memoizedState=a:(n.memoizedState=i,n=L0(),ot.lanes|=n,pr|=n,i)}function Py(n,a,i,u){return ia(i,a)?i:lo.current!==null?(n=vm(n,i,u),ia(n,a)||(_n=!0),n):(cr&42)===0?(_n=!0,n.memoizedState=i):(n=L0(),ot.lanes|=n,pr|=n,a)}function zy(n,a,i,u,m){var g=de.p;de.p=g!==0&&8>g?g:8;var _=W.T,w={};W.T=w,km(n,!1,a,i);try{var D=m(),Q=W.S;if(Q!==null&&Q(w,D),D!==null&&typeof D=="object"&&typeof D.then=="function"){var se=iT(D,u);Dl(n,a,se,da(n))}else Dl(n,a,u,da(n))}catch(ce){Dl(n,a,{then:function(){},status:"rejected",reason:ce},da())}finally{de.p=g,W.T=_}}function dT(){}function bm(n,a,i,u){if(n.tag!==5)throw Error(r(476));var m=Ly(n).queue;zy(n,m,a,me,i===null?dT:function(){return Vy(n),i(u)})}function Ly(n){var a=n.memoizedState;if(a!==null)return a;a={memoizedState:me,baseState:me,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ms,lastRenderedState:me},next:null};var i={};return a.next={memoizedState:i,baseState:i,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ms,lastRenderedState:i},next:null},n.memoizedState=a,n=n.alternate,n!==null&&(n.memoizedState=a),a}function Vy(n){var a=Ly(n).next.queue;Dl(n,a,{},da())}function _m(){return zn(Zl)}function Uy(){return rn().memoizedState}function By(){return rn().memoizedState}function hT(n){for(var a=n.return;a!==null;){switch(a.tag){case 24:case 3:var i=da();n=or(i);var u=lr(a,n,i);u!==null&&(ha(u,a,i),Al(u,a,i)),a={cache:Zh()},n.payload=a;return}a=a.return}}function mT(n,a,i){var u=da();i={lane:u,revertLane:0,action:i,hasEagerState:!1,eagerState:null,next:null},Ou(n)?Gy(a,i):(i=Bh(n,a,i,u),i!==null&&(ha(i,n,u),Fy(i,a,u)))}function Hy(n,a,i){var u=da();Dl(n,a,i,u)}function Dl(n,a,i,u){var m={lane:u,revertLane:0,action:i,hasEagerState:!1,eagerState:null,next:null};if(Ou(n))Gy(a,m);else{var g=n.alternate;if(n.lanes===0&&(g===null||g.lanes===0)&&(g=a.lastRenderedReducer,g!==null))try{var _=a.lastRenderedState,w=g(_,i);if(m.hasEagerState=!0,m.eagerState=w,ia(w,_))return xu(n,a,m,0),Lt===null&&yu(),!1}catch{}finally{}if(i=Bh(n,a,m,u),i!==null)return ha(i,n,u),Fy(i,a,u),!0}return!1}function km(n,a,i,u){if(u={lane:2,revertLane:ef(),action:u,hasEagerState:!1,eagerState:null,next:null},Ou(n)){if(a)throw Error(r(479))}else a=Bh(n,i,u,2),a!==null&&ha(a,n,2)}function Ou(n){var a=n.alternate;return n===ot||a!==null&&a===ot}function Gy(n,a){co=Ru=!0;var i=n.pending;i===null?a.next=a:(a.next=i.next,i.next=a),n.pending=a}function Fy(n,a,i){if((i&4194048)!==0){var u=a.lanes;u&=n.pendingLanes,i|=u,a.lanes=i,et(n,i)}}var Pu={readContext:zn,use:Cu,useCallback:en,useContext:en,useEffect:en,useImperativeHandle:en,useLayoutEffect:en,useInsertionEffect:en,useMemo:en,useReducer:en,useRef:en,useState:en,useDebugValue:en,useDeferredValue:en,useTransition:en,useSyncExternalStore:en,useId:en,useHostTransitionStatus:en,useFormState:en,useActionState:en,useOptimistic:en,useMemoCache:en,useCacheRefresh:en},qy={readContext:zn,use:Cu,useCallback:function(n,a){return Yn().memoizedState=[n,a===void 0?null:a],n},useContext:zn,useEffect:Ny,useImperativeHandle:function(n,a,i){i=i!=null?i.concat([n]):null,Mu(4194308,4,Iy.bind(null,a,n),i)},useLayoutEffect:function(n,a){return Mu(4194308,4,n,a)},useInsertionEffect:function(n,a){Mu(4,2,n,a)},useMemo:function(n,a){var i=Yn();a=a===void 0?null:a;var u=n();if(yi){Kt(!0);try{n()}finally{Kt(!1)}}return i.memoizedState=[u,a],u},useReducer:function(n,a,i){var u=Yn();if(i!==void 0){var m=i(a);if(yi){Kt(!0);try{i(a)}finally{Kt(!1)}}}else m=a;return u.memoizedState=u.baseState=m,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:m},u.queue=n,n=n.dispatch=mT.bind(null,ot,n),[u.memoizedState,n]},useRef:function(n){var a=Yn();return n={current:n},a.memoizedState=n},useState:function(n){n=pm(n);var a=n.queue,i=Hy.bind(null,ot,a);return a.dispatch=i,[n.memoizedState,i]},useDebugValue:xm,useDeferredValue:function(n,a){var i=Yn();return vm(i,n,a)},useTransition:function(){var n=pm(!1);return n=zy.bind(null,ot,n.queue,!0,!1),Yn().memoizedState=n,[!1,n]},useSyncExternalStore:function(n,a,i){var u=ot,m=Yn();if(wt){if(i===void 0)throw Error(r(407));i=i()}else{if(i=a(),Lt===null)throw Error(r(349));(bt&124)!==0||hy(u,a,i)}m.memoizedState=i;var g={value:i,getSnapshot:a};return m.queue=g,Ny(fy.bind(null,u,g,n),[n]),u.flags|=2048,ho(9,Du(),my.bind(null,u,g,i,a),null),i},useId:function(){var n=Yn(),a=Lt.identifierPrefix;if(wt){var i=Cs,u=js;i=(u&~(1<<32-Xt(u)-1)).toString(32)+i,a="«"+a+"R"+i,i=ju++,0<i&&(a+="H"+i.toString(32)),a+="»"}else i=oT++,a="«"+a+"r"+i.toString(32)+"»";return n.memoizedState=a},useHostTransitionStatus:_m,useFormState:Ty,useActionState:Ty,useOptimistic:function(n){var a=Yn();a.memoizedState=a.baseState=n;var i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return a.queue=i,a=km.bind(null,ot,!0,i),i.dispatch=a,[n,a]},useMemoCache:mm,useCacheRefresh:function(){return Yn().memoizedState=hT.bind(null,ot)}},$y={readContext:zn,use:Cu,useCallback:My,useContext:zn,useEffect:Ry,useImperativeHandle:Dy,useInsertionEffect:jy,useLayoutEffect:Cy,useMemo:Oy,useReducer:Iu,useRef:Ay,useState:function(){return Iu(Ms)},useDebugValue:xm,useDeferredValue:function(n,a){var i=rn();return Py(i,jt.memoizedState,n,a)},useTransition:function(){var n=Iu(Ms)[0],a=rn().memoizedState;return[typeof n=="boolean"?n:Cl(n),a]},useSyncExternalStore:dy,useId:Uy,useHostTransitionStatus:_m,useFormState:wy,useActionState:wy,useOptimistic:function(n,a){var i=rn();return yy(i,jt,n,a)},useMemoCache:mm,useCacheRefresh:By},fT={readContext:zn,use:Cu,useCallback:My,useContext:zn,useEffect:Ry,useImperativeHandle:Dy,useInsertionEffect:jy,useLayoutEffect:Cy,useMemo:Oy,useReducer:gm,useRef:Ay,useState:function(){return gm(Ms)},useDebugValue:xm,useDeferredValue:function(n,a){var i=rn();return jt===null?vm(i,n,a):Py(i,jt.memoizedState,n,a)},useTransition:function(){var n=gm(Ms)[0],a=rn().memoizedState;return[typeof n=="boolean"?n:Cl(n),a]},useSyncExternalStore:dy,useId:Uy,useHostTransitionStatus:_m,useFormState:Sy,useActionState:Sy,useOptimistic:function(n,a){var i=rn();return jt!==null?yy(i,jt,n,a):(i.baseState=n,[n,i.queue.dispatch])},useMemoCache:mm,useCacheRefresh:By},mo=null,Ml=0;function zu(n){var a=Ml;return Ml+=1,mo===null&&(mo=[]),ay(mo,n,a)}function Ol(n,a){a=a.props.ref,n.ref=a!==void 0?a:null}function Lu(n,a){throw a.$$typeof===k?Error(r(525)):(n=Object.prototype.toString.call(a),Error(r(31,n==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":n)))}function Ky(n){var a=n._init;return a(n._payload)}function Yy(n){function a(G,V){if(n){var Y=G.deletions;Y===null?(G.deletions=[V],G.flags|=16):Y.push(V)}}function i(G,V){if(!n)return null;for(;V!==null;)a(G,V),V=V.sibling;return null}function u(G){for(var V=new Map;G!==null;)G.key!==null?V.set(G.key,G):V.set(G.index,G),G=G.sibling;return V}function m(G,V){return G=Rs(G,V),G.index=0,G.sibling=null,G}function g(G,V,Y){return G.index=Y,n?(Y=G.alternate,Y!==null?(Y=Y.index,Y<V?(G.flags|=67108866,V):Y):(G.flags|=67108866,V)):(G.flags|=1048576,V)}function _(G){return n&&G.alternate===null&&(G.flags|=67108866),G}function w(G,V,Y,ie){return V===null||V.tag!==6?(V=Gh(Y,G.mode,ie),V.return=G,V):(V=m(V,Y),V.return=G,V)}function D(G,V,Y,ie){var Ce=Y.type;return Ce===q?se(G,V,Y.props.children,ie,Y.key):V!==null&&(V.elementType===Ce||typeof Ce=="object"&&Ce!==null&&Ce.$$typeof===R&&Ky(Ce)===V.type)?(V=m(V,Y.props),Ol(V,Y),V.return=G,V):(V=bu(Y.type,Y.key,Y.props,null,G.mode,ie),Ol(V,Y),V.return=G,V)}function Q(G,V,Y,ie){return V===null||V.tag!==4||V.stateNode.containerInfo!==Y.containerInfo||V.stateNode.implementation!==Y.implementation?(V=Fh(Y,G.mode,ie),V.return=G,V):(V=m(V,Y.children||[]),V.return=G,V)}function se(G,V,Y,ie,Ce){return V===null||V.tag!==7?(V=ci(Y,G.mode,ie,Ce),V.return=G,V):(V=m(V,Y),V.return=G,V)}function ce(G,V,Y){if(typeof V=="string"&&V!==""||typeof V=="number"||typeof V=="bigint")return V=Gh(""+V,G.mode,Y),V.return=G,V;if(typeof V=="object"&&V!==null){switch(V.$$typeof){case S:return Y=bu(V.type,V.key,V.props,null,G.mode,Y),Ol(Y,V),Y.return=G,Y;case I:return V=Fh(V,G.mode,Y),V.return=G,V;case R:var ie=V._init;return V=ie(V._payload),ce(G,V,Y)}if(le(V)||z(V))return V=ci(V,G.mode,Y,null),V.return=G,V;if(typeof V.then=="function")return ce(G,zu(V),Y);if(V.$$typeof===B)return ce(G,wu(G,V),Y);Lu(G,V)}return null}function Z(G,V,Y,ie){var Ce=V!==null?V.key:null;if(typeof Y=="string"&&Y!==""||typeof Y=="number"||typeof Y=="bigint")return Ce!==null?null:w(G,V,""+Y,ie);if(typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case S:return Y.key===Ce?D(G,V,Y,ie):null;case I:return Y.key===Ce?Q(G,V,Y,ie):null;case R:return Ce=Y._init,Y=Ce(Y._payload),Z(G,V,Y,ie)}if(le(Y)||z(Y))return Ce!==null?null:se(G,V,Y,ie,null);if(typeof Y.then=="function")return Z(G,V,zu(Y),ie);if(Y.$$typeof===B)return Z(G,V,wu(G,Y),ie);Lu(G,Y)}return null}function J(G,V,Y,ie,Ce){if(typeof ie=="string"&&ie!==""||typeof ie=="number"||typeof ie=="bigint")return G=G.get(Y)||null,w(V,G,""+ie,Ce);if(typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case S:return G=G.get(ie.key===null?Y:ie.key)||null,D(V,G,ie,Ce);case I:return G=G.get(ie.key===null?Y:ie.key)||null,Q(V,G,ie,Ce);case R:var lt=ie._init;return ie=lt(ie._payload),J(G,V,Y,ie,Ce)}if(le(ie)||z(ie))return G=G.get(Y)||null,se(V,G,ie,Ce,null);if(typeof ie.then=="function")return J(G,V,Y,zu(ie),Ce);if(ie.$$typeof===B)return J(G,V,Y,wu(V,ie),Ce);Lu(V,ie)}return null}function Xe(G,V,Y,ie){for(var Ce=null,lt=null,ze=V,qe=V=0,Tn=null;ze!==null&&qe<Y.length;qe++){ze.index>qe?(Tn=ze,ze=null):Tn=ze.sibling;var Tt=Z(G,ze,Y[qe],ie);if(Tt===null){ze===null&&(ze=Tn);break}n&&ze&&Tt.alternate===null&&a(G,ze),V=g(Tt,V,qe),lt===null?Ce=Tt:lt.sibling=Tt,lt=Tt,ze=Tn}if(qe===Y.length)return i(G,ze),wt&&di(G,qe),Ce;if(ze===null){for(;qe<Y.length;qe++)ze=ce(G,Y[qe],ie),ze!==null&&(V=g(ze,V,qe),lt===null?Ce=ze:lt.sibling=ze,lt=ze);return wt&&di(G,qe),Ce}for(ze=u(ze);qe<Y.length;qe++)Tn=J(ze,G,qe,Y[qe],ie),Tn!==null&&(n&&Tn.alternate!==null&&ze.delete(Tn.key===null?qe:Tn.key),V=g(Tn,V,qe),lt===null?Ce=Tn:lt.sibling=Tn,lt=Tn);return n&&ze.forEach(function(Er){return a(G,Er)}),wt&&di(G,qe),Ce}function Fe(G,V,Y,ie){if(Y==null)throw Error(r(151));for(var Ce=null,lt=null,ze=V,qe=V=0,Tn=null,Tt=Y.next();ze!==null&&!Tt.done;qe++,Tt=Y.next()){ze.index>qe?(Tn=ze,ze=null):Tn=ze.sibling;var Er=Z(G,ze,Tt.value,ie);if(Er===null){ze===null&&(ze=Tn);break}n&&ze&&Er.alternate===null&&a(G,ze),V=g(Er,V,qe),lt===null?Ce=Er:lt.sibling=Er,lt=Er,ze=Tn}if(Tt.done)return i(G,ze),wt&&di(G,qe),Ce;if(ze===null){for(;!Tt.done;qe++,Tt=Y.next())Tt=ce(G,Tt.value,ie),Tt!==null&&(V=g(Tt,V,qe),lt===null?Ce=Tt:lt.sibling=Tt,lt=Tt);return wt&&di(G,qe),Ce}for(ze=u(ze);!Tt.done;qe++,Tt=Y.next())Tt=J(ze,G,qe,Tt.value,ie),Tt!==null&&(n&&Tt.alternate!==null&&ze.delete(Tt.key===null?qe:Tt.key),V=g(Tt,V,qe),lt===null?Ce=Tt:lt.sibling=Tt,lt=Tt);return n&&ze.forEach(function(gw){return a(G,gw)}),wt&&di(G,qe),Ce}function It(G,V,Y,ie){if(typeof Y=="object"&&Y!==null&&Y.type===q&&Y.key===null&&(Y=Y.props.children),typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case S:e:{for(var Ce=Y.key;V!==null;){if(V.key===Ce){if(Ce=Y.type,Ce===q){if(V.tag===7){i(G,V.sibling),ie=m(V,Y.props.children),ie.return=G,G=ie;break e}}else if(V.elementType===Ce||typeof Ce=="object"&&Ce!==null&&Ce.$$typeof===R&&Ky(Ce)===V.type){i(G,V.sibling),ie=m(V,Y.props),Ol(ie,Y),ie.return=G,G=ie;break e}i(G,V);break}else a(G,V);V=V.sibling}Y.type===q?(ie=ci(Y.props.children,G.mode,ie,Y.key),ie.return=G,G=ie):(ie=bu(Y.type,Y.key,Y.props,null,G.mode,ie),Ol(ie,Y),ie.return=G,G=ie)}return _(G);case I:e:{for(Ce=Y.key;V!==null;){if(V.key===Ce)if(V.tag===4&&V.stateNode.containerInfo===Y.containerInfo&&V.stateNode.implementation===Y.implementation){i(G,V.sibling),ie=m(V,Y.children||[]),ie.return=G,G=ie;break e}else{i(G,V);break}else a(G,V);V=V.sibling}ie=Fh(Y,G.mode,ie),ie.return=G,G=ie}return _(G);case R:return Ce=Y._init,Y=Ce(Y._payload),It(G,V,Y,ie)}if(le(Y))return Xe(G,V,Y,ie);if(z(Y)){if(Ce=z(Y),typeof Ce!="function")throw Error(r(150));return Y=Ce.call(Y),Fe(G,V,Y,ie)}if(typeof Y.then=="function")return It(G,V,zu(Y),ie);if(Y.$$typeof===B)return It(G,V,wu(G,Y),ie);Lu(G,Y)}return typeof Y=="string"&&Y!==""||typeof Y=="number"||typeof Y=="bigint"?(Y=""+Y,V!==null&&V.tag===6?(i(G,V.sibling),ie=m(V,Y),ie.return=G,G=ie):(i(G,V),ie=Gh(Y,G.mode,ie),ie.return=G,G=ie),_(G)):i(G,V)}return function(G,V,Y,ie){try{Ml=0;var Ce=It(G,V,Y,ie);return mo=null,Ce}catch(ze){if(ze===El||ze===Su)throw ze;var lt=oa(29,ze,null,G.mode);return lt.lanes=ie,lt.return=G,lt}finally{}}}var fo=Yy(!0),Qy=Yy(!1),Ta=H(null),ns=null;function ur(n){var a=n.alternate;X(gn,gn.current&1),X(Ta,n),ns===null&&(a===null||lo.current!==null||a.memoizedState!==null)&&(ns=n)}function Xy(n){if(n.tag===22){if(X(gn,gn.current),X(Ta,n),ns===null){var a=n.alternate;a!==null&&a.memoizedState!==null&&(ns=n)}}else dr()}function dr(){X(gn,gn.current),X(Ta,Ta.current)}function Os(n){ee(Ta),ns===n&&(ns=null),ee(gn)}var gn=H(0);function Vu(n){for(var a=n;a!==null;){if(a.tag===13){var i=a.memoizedState;if(i!==null&&(i=i.dehydrated,i===null||i.data==="$?"||mf(i)))return a}else if(a.tag===19&&a.memoizedProps.revealOrder!==void 0){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===n)break;for(;a.sibling===null;){if(a.return===null||a.return===n)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}function Tm(n,a,i,u){a=n.memoizedState,i=i(u,a),i=i==null?a:v({},a,i),n.memoizedState=i,n.lanes===0&&(n.updateQueue.baseState=i)}var wm={enqueueSetState:function(n,a,i){n=n._reactInternals;var u=da(),m=or(u);m.payload=a,i!=null&&(m.callback=i),a=lr(n,m,u),a!==null&&(ha(a,n,u),Al(a,n,u))},enqueueReplaceState:function(n,a,i){n=n._reactInternals;var u=da(),m=or(u);m.tag=1,m.payload=a,i!=null&&(m.callback=i),a=lr(n,m,u),a!==null&&(ha(a,n,u),Al(a,n,u))},enqueueForceUpdate:function(n,a){n=n._reactInternals;var i=da(),u=or(i);u.tag=2,a!=null&&(u.callback=a),a=lr(n,u,i),a!==null&&(ha(a,n,i),Al(a,n,i))}};function Zy(n,a,i,u,m,g,_){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(u,g,_):a.prototype&&a.prototype.isPureReactComponent?!yl(i,u)||!yl(m,g):!0}function Wy(n,a,i,u){n=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(i,u),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(i,u),a.state!==n&&wm.enqueueReplaceState(a,a.state,null)}function xi(n,a){var i=a;if("ref"in a){i={};for(var u in a)u!=="ref"&&(i[u]=a[u])}if(n=n.defaultProps){i===a&&(i=v({},i));for(var m in n)i[m]===void 0&&(i[m]=n[m])}return i}var Uu=typeof reportError=="function"?reportError:function(n){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var a=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof n=="object"&&n!==null&&typeof n.message=="string"?String(n.message):String(n),error:n});if(!window.dispatchEvent(a))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",n);return}console.error(n)};function Jy(n){Uu(n)}function e0(n){console.error(n)}function t0(n){Uu(n)}function Bu(n,a){try{var i=n.onUncaughtError;i(a.value,{componentStack:a.stack})}catch(u){setTimeout(function(){throw u})}}function n0(n,a,i){try{var u=n.onCaughtError;u(i.value,{componentStack:i.stack,errorBoundary:a.tag===1?a.stateNode:null})}catch(m){setTimeout(function(){throw m})}}function Em(n,a,i){return i=or(i),i.tag=3,i.payload={element:null},i.callback=function(){Bu(n,a)},i}function a0(n){return n=or(n),n.tag=3,n}function s0(n,a,i,u){var m=i.type.getDerivedStateFromError;if(typeof m=="function"){var g=u.value;n.payload=function(){return m(g)},n.callback=function(){n0(a,i,u)}}var _=i.stateNode;_!==null&&typeof _.componentDidCatch=="function"&&(n.callback=function(){n0(a,i,u),typeof m!="function"&&(yr===null?yr=new Set([this]):yr.add(this));var w=u.stack;this.componentDidCatch(u.value,{componentStack:w!==null?w:""})})}function gT(n,a,i,u,m){if(i.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){if(a=i.alternate,a!==null&&kl(a,i,m,!0),i=Ta.current,i!==null){switch(i.tag){case 13:return ns===null?Qm():i.alternate===null&&Qt===0&&(Qt=3),i.flags&=-257,i.flags|=65536,i.lanes=m,u===em?i.flags|=16384:(a=i.updateQueue,a===null?i.updateQueue=new Set([u]):a.add(u),Zm(n,u,m)),!1;case 22:return i.flags|=65536,u===em?i.flags|=16384:(a=i.updateQueue,a===null?(a={transitions:null,markerInstances:null,retryQueue:new Set([u])},i.updateQueue=a):(i=a.retryQueue,i===null?a.retryQueue=new Set([u]):i.add(u)),Zm(n,u,m)),!1}throw Error(r(435,i.tag))}return Zm(n,u,m),Qm(),!1}if(wt)return a=Ta.current,a!==null?((a.flags&65536)===0&&(a.flags|=256),a.flags|=65536,a.lanes=m,u!==Kh&&(n=Error(r(422),{cause:u}),_l(va(n,i)))):(u!==Kh&&(a=Error(r(423),{cause:u}),_l(va(a,i))),n=n.current.alternate,n.flags|=65536,m&=-m,n.lanes|=m,u=va(u,i),m=Em(n.stateNode,u,m),am(n,m),Qt!==4&&(Qt=2)),!1;var g=Error(r(520),{cause:u});if(g=va(g,i),Hl===null?Hl=[g]:Hl.push(g),Qt!==4&&(Qt=2),a===null)return!0;u=va(u,i),i=a;do{switch(i.tag){case 3:return i.flags|=65536,n=m&-m,i.lanes|=n,n=Em(i.stateNode,u,n),am(i,n),!1;case 1:if(a=i.type,g=i.stateNode,(i.flags&128)===0&&(typeof a.getDerivedStateFromError=="function"||g!==null&&typeof g.componentDidCatch=="function"&&(yr===null||!yr.has(g))))return i.flags|=65536,m&=-m,i.lanes|=m,m=a0(m),s0(m,n,i,u),am(i,m),!1}i=i.return}while(i!==null);return!1}var r0=Error(r(461)),_n=!1;function Nn(n,a,i,u){a.child=n===null?Qy(a,null,i,u):fo(a,n.child,i,u)}function i0(n,a,i,u,m){i=i.render;var g=a.ref;if("ref"in u){var _={};for(var w in u)w!=="ref"&&(_[w]=u[w])}else _=u;return gi(a),u=lm(n,a,i,_,g,m),w=cm(),n!==null&&!_n?(um(n,a,m),Ps(n,a,m)):(wt&&w&&qh(a),a.flags|=1,Nn(n,a,u,m),a.child)}function o0(n,a,i,u,m){if(n===null){var g=i.type;return typeof g=="function"&&!Hh(g)&&g.defaultProps===void 0&&i.compare===null?(a.tag=15,a.type=g,l0(n,a,g,u,m)):(n=bu(i.type,null,u,a,a.mode,m),n.ref=a.ref,n.return=a,a.child=n)}if(g=n.child,!Dm(n,m)){var _=g.memoizedProps;if(i=i.compare,i=i!==null?i:yl,i(_,u)&&n.ref===a.ref)return Ps(n,a,m)}return a.flags|=1,n=Rs(g,u),n.ref=a.ref,n.return=a,a.child=n}function l0(n,a,i,u,m){if(n!==null){var g=n.memoizedProps;if(yl(g,u)&&n.ref===a.ref)if(_n=!1,a.pendingProps=u=g,Dm(n,m))(n.flags&131072)!==0&&(_n=!0);else return a.lanes=n.lanes,Ps(n,a,m)}return Sm(n,a,i,u,m)}function c0(n,a,i){var u=a.pendingProps,m=u.children,g=n!==null?n.memoizedState:null;if(u.mode==="hidden"){if((a.flags&128)!==0){if(u=g!==null?g.baseLanes|i:i,n!==null){for(m=a.child=n.child,g=0;m!==null;)g=g|m.lanes|m.childLanes,m=m.sibling;a.childLanes=g&~u}else a.childLanes=0,a.child=null;return u0(n,a,u,i)}if((i&536870912)!==0)a.memoizedState={baseLanes:0,cachePool:null},n!==null&&Eu(a,g!==null?g.cachePool:null),g!==null?ly(a,g):rm(),Xy(a);else return a.lanes=a.childLanes=536870912,u0(n,a,g!==null?g.baseLanes|i:i,i)}else g!==null?(Eu(a,g.cachePool),ly(a,g),dr(),a.memoizedState=null):(n!==null&&Eu(a,null),rm(),dr());return Nn(n,a,m,i),a.child}function u0(n,a,i,u){var m=Jh();return m=m===null?null:{parent:fn._currentValue,pool:m},a.memoizedState={baseLanes:i,cachePool:m},n!==null&&Eu(a,null),rm(),Xy(a),n!==null&&kl(n,a,u,!0),null}function Hu(n,a){var i=a.ref;if(i===null)n!==null&&n.ref!==null&&(a.flags|=4194816);else{if(typeof i!="function"&&typeof i!="object")throw Error(r(284));(n===null||n.ref!==i)&&(a.flags|=4194816)}}function Sm(n,a,i,u,m){return gi(a),i=lm(n,a,i,u,void 0,m),u=cm(),n!==null&&!_n?(um(n,a,m),Ps(n,a,m)):(wt&&u&&qh(a),a.flags|=1,Nn(n,a,i,m),a.child)}function d0(n,a,i,u,m,g){return gi(a),a.updateQueue=null,i=uy(a,u,i,m),cy(n),u=cm(),n!==null&&!_n?(um(n,a,g),Ps(n,a,g)):(wt&&u&&qh(a),a.flags|=1,Nn(n,a,i,g),a.child)}function h0(n,a,i,u,m){if(gi(a),a.stateNode===null){var g=ao,_=i.contextType;typeof _=="object"&&_!==null&&(g=zn(_)),g=new i(u,g),a.memoizedState=g.state!==null&&g.state!==void 0?g.state:null,g.updater=wm,a.stateNode=g,g._reactInternals=a,g=a.stateNode,g.props=u,g.state=a.memoizedState,g.refs={},tm(a),_=i.contextType,g.context=typeof _=="object"&&_!==null?zn(_):ao,g.state=a.memoizedState,_=i.getDerivedStateFromProps,typeof _=="function"&&(Tm(a,i,_,u),g.state=a.memoizedState),typeof i.getDerivedStateFromProps=="function"||typeof g.getSnapshotBeforeUpdate=="function"||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(_=g.state,typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount(),_!==g.state&&wm.enqueueReplaceState(g,g.state,null),Rl(a,u,g,m),Nl(),g.state=a.memoizedState),typeof g.componentDidMount=="function"&&(a.flags|=4194308),u=!0}else if(n===null){g=a.stateNode;var w=a.memoizedProps,D=xi(i,w);g.props=D;var Q=g.context,se=i.contextType;_=ao,typeof se=="object"&&se!==null&&(_=zn(se));var ce=i.getDerivedStateFromProps;se=typeof ce=="function"||typeof g.getSnapshotBeforeUpdate=="function",w=a.pendingProps!==w,se||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(w||Q!==_)&&Wy(a,g,u,_),ir=!1;var Z=a.memoizedState;g.state=Z,Rl(a,u,g,m),Nl(),Q=a.memoizedState,w||Z!==Q||ir?(typeof ce=="function"&&(Tm(a,i,ce,u),Q=a.memoizedState),(D=ir||Zy(a,i,D,u,Z,Q,_))?(se||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount()),typeof g.componentDidMount=="function"&&(a.flags|=4194308)):(typeof g.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=u,a.memoizedState=Q),g.props=u,g.state=Q,g.context=_,u=D):(typeof g.componentDidMount=="function"&&(a.flags|=4194308),u=!1)}else{g=a.stateNode,nm(n,a),_=a.memoizedProps,se=xi(i,_),g.props=se,ce=a.pendingProps,Z=g.context,Q=i.contextType,D=ao,typeof Q=="object"&&Q!==null&&(D=zn(Q)),w=i.getDerivedStateFromProps,(Q=typeof w=="function"||typeof g.getSnapshotBeforeUpdate=="function")||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(_!==ce||Z!==D)&&Wy(a,g,u,D),ir=!1,Z=a.memoizedState,g.state=Z,Rl(a,u,g,m),Nl();var J=a.memoizedState;_!==ce||Z!==J||ir||n!==null&&n.dependencies!==null&&Tu(n.dependencies)?(typeof w=="function"&&(Tm(a,i,w,u),J=a.memoizedState),(se=ir||Zy(a,i,se,u,Z,J,D)||n!==null&&n.dependencies!==null&&Tu(n.dependencies))?(Q||typeof g.UNSAFE_componentWillUpdate!="function"&&typeof g.componentWillUpdate!="function"||(typeof g.componentWillUpdate=="function"&&g.componentWillUpdate(u,J,D),typeof g.UNSAFE_componentWillUpdate=="function"&&g.UNSAFE_componentWillUpdate(u,J,D)),typeof g.componentDidUpdate=="function"&&(a.flags|=4),typeof g.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof g.componentDidUpdate!="function"||_===n.memoizedProps&&Z===n.memoizedState||(a.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||_===n.memoizedProps&&Z===n.memoizedState||(a.flags|=1024),a.memoizedProps=u,a.memoizedState=J),g.props=u,g.state=J,g.context=D,u=se):(typeof g.componentDidUpdate!="function"||_===n.memoizedProps&&Z===n.memoizedState||(a.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||_===n.memoizedProps&&Z===n.memoizedState||(a.flags|=1024),u=!1)}return g=u,Hu(n,a),u=(a.flags&128)!==0,g||u?(g=a.stateNode,i=u&&typeof i.getDerivedStateFromError!="function"?null:g.render(),a.flags|=1,n!==null&&u?(a.child=fo(a,n.child,null,m),a.child=fo(a,null,i,m)):Nn(n,a,i,m),a.memoizedState=g.state,n=a.child):n=Ps(n,a,m),n}function m0(n,a,i,u){return bl(),a.flags|=256,Nn(n,a,i,u),a.child}var Am={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Nm(n){return{baseLanes:n,cachePool:ey()}}function Rm(n,a,i){return n=n!==null?n.childLanes&~i:0,a&&(n|=wa),n}function f0(n,a,i){var u=a.pendingProps,m=!1,g=(a.flags&128)!==0,_;if((_=g)||(_=n!==null&&n.memoizedState===null?!1:(gn.current&2)!==0),_&&(m=!0,a.flags&=-129),_=(a.flags&32)!==0,a.flags&=-33,n===null){if(wt){if(m?ur(a):dr(),wt){var w=Yt,D;if(D=w){e:{for(D=w,w=ts;D.nodeType!==8;){if(!w){w=null;break e}if(D=Pa(D.nextSibling),D===null){w=null;break e}}w=D}w!==null?(a.memoizedState={dehydrated:w,treeContext:ui!==null?{id:js,overflow:Cs}:null,retryLane:536870912,hydrationErrors:null},D=oa(18,null,null,0),D.stateNode=w,D.return=a,a.child=D,$n=a,Yt=null,D=!0):D=!1}D||mi(a)}if(w=a.memoizedState,w!==null&&(w=w.dehydrated,w!==null))return mf(w)?a.lanes=32:a.lanes=536870912,null;Os(a)}return w=u.children,u=u.fallback,m?(dr(),m=a.mode,w=Gu({mode:"hidden",children:w},m),u=ci(u,m,i,null),w.return=a,u.return=a,w.sibling=u,a.child=w,m=a.child,m.memoizedState=Nm(i),m.childLanes=Rm(n,_,i),a.memoizedState=Am,u):(ur(a),jm(a,w))}if(D=n.memoizedState,D!==null&&(w=D.dehydrated,w!==null)){if(g)a.flags&256?(ur(a),a.flags&=-257,a=Cm(n,a,i)):a.memoizedState!==null?(dr(),a.child=n.child,a.flags|=128,a=null):(dr(),m=u.fallback,w=a.mode,u=Gu({mode:"visible",children:u.children},w),m=ci(m,w,i,null),m.flags|=2,u.return=a,m.return=a,u.sibling=m,a.child=u,fo(a,n.child,null,i),u=a.child,u.memoizedState=Nm(i),u.childLanes=Rm(n,_,i),a.memoizedState=Am,a=m);else if(ur(a),mf(w)){if(_=w.nextSibling&&w.nextSibling.dataset,_)var Q=_.dgst;_=Q,u=Error(r(419)),u.stack="",u.digest=_,_l({value:u,source:null,stack:null}),a=Cm(n,a,i)}else if(_n||kl(n,a,i,!1),_=(i&n.childLanes)!==0,_n||_){if(_=Lt,_!==null&&(u=i&-i,u=(u&42)!==0?1:re(u),u=(u&(_.suspendedLanes|i))!==0?0:u,u!==0&&u!==D.retryLane))throw D.retryLane=u,no(n,u),ha(_,n,u),r0;w.data==="$?"||Qm(),a=Cm(n,a,i)}else w.data==="$?"?(a.flags|=192,a.child=n.child,a=null):(n=D.treeContext,Yt=Pa(w.nextSibling),$n=a,wt=!0,hi=null,ts=!1,n!==null&&(_a[ka++]=js,_a[ka++]=Cs,_a[ka++]=ui,js=n.id,Cs=n.overflow,ui=a),a=jm(a,u.children),a.flags|=4096);return a}return m?(dr(),m=u.fallback,w=a.mode,D=n.child,Q=D.sibling,u=Rs(D,{mode:"hidden",children:u.children}),u.subtreeFlags=D.subtreeFlags&65011712,Q!==null?m=Rs(Q,m):(m=ci(m,w,i,null),m.flags|=2),m.return=a,u.return=a,u.sibling=m,a.child=u,u=m,m=a.child,w=n.child.memoizedState,w===null?w=Nm(i):(D=w.cachePool,D!==null?(Q=fn._currentValue,D=D.parent!==Q?{parent:Q,pool:Q}:D):D=ey(),w={baseLanes:w.baseLanes|i,cachePool:D}),m.memoizedState=w,m.childLanes=Rm(n,_,i),a.memoizedState=Am,u):(ur(a),i=n.child,n=i.sibling,i=Rs(i,{mode:"visible",children:u.children}),i.return=a,i.sibling=null,n!==null&&(_=a.deletions,_===null?(a.deletions=[n],a.flags|=16):_.push(n)),a.child=i,a.memoizedState=null,i)}function jm(n,a){return a=Gu({mode:"visible",children:a},n.mode),a.return=n,n.child=a}function Gu(n,a){return n=oa(22,n,null,a),n.lanes=0,n.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},n}function Cm(n,a,i){return fo(a,n.child,null,i),n=jm(a,a.pendingProps.children),n.flags|=2,a.memoizedState=null,n}function g0(n,a,i){n.lanes|=a;var u=n.alternate;u!==null&&(u.lanes|=a),Qh(n.return,a,i)}function Im(n,a,i,u,m){var g=n.memoizedState;g===null?n.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:u,tail:i,tailMode:m}:(g.isBackwards=a,g.rendering=null,g.renderingStartTime=0,g.last=u,g.tail=i,g.tailMode=m)}function p0(n,a,i){var u=a.pendingProps,m=u.revealOrder,g=u.tail;if(Nn(n,a,u.children,i),u=gn.current,(u&2)!==0)u=u&1|2,a.flags|=128;else{if(n!==null&&(n.flags&128)!==0)e:for(n=a.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&g0(n,i,a);else if(n.tag===19)g0(n,i,a);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===a)break e;for(;n.sibling===null;){if(n.return===null||n.return===a)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}u&=1}switch(X(gn,u),m){case"forwards":for(i=a.child,m=null;i!==null;)n=i.alternate,n!==null&&Vu(n)===null&&(m=i),i=i.sibling;i=m,i===null?(m=a.child,a.child=null):(m=i.sibling,i.sibling=null),Im(a,!1,m,i,g);break;case"backwards":for(i=null,m=a.child,a.child=null;m!==null;){if(n=m.alternate,n!==null&&Vu(n)===null){a.child=m;break}n=m.sibling,m.sibling=i,i=m,m=n}Im(a,!0,i,null,g);break;case"together":Im(a,!1,null,null,void 0);break;default:a.memoizedState=null}return a.child}function Ps(n,a,i){if(n!==null&&(a.dependencies=n.dependencies),pr|=a.lanes,(i&a.childLanes)===0)if(n!==null){if(kl(n,a,i,!1),(i&a.childLanes)===0)return null}else return null;if(n!==null&&a.child!==n.child)throw Error(r(153));if(a.child!==null){for(n=a.child,i=Rs(n,n.pendingProps),a.child=i,i.return=a;n.sibling!==null;)n=n.sibling,i=i.sibling=Rs(n,n.pendingProps),i.return=a;i.sibling=null}return a.child}function Dm(n,a){return(n.lanes&a)!==0?!0:(n=n.dependencies,!!(n!==null&&Tu(n)))}function pT(n,a,i){switch(a.tag){case 3:je(a,a.stateNode.containerInfo),rr(a,fn,n.memoizedState.cache),bl();break;case 27:case 5:he(a);break;case 4:je(a,a.stateNode.containerInfo);break;case 10:rr(a,a.type,a.memoizedProps.value);break;case 13:var u=a.memoizedState;if(u!==null)return u.dehydrated!==null?(ur(a),a.flags|=128,null):(i&a.child.childLanes)!==0?f0(n,a,i):(ur(a),n=Ps(n,a,i),n!==null?n.sibling:null);ur(a);break;case 19:var m=(n.flags&128)!==0;if(u=(i&a.childLanes)!==0,u||(kl(n,a,i,!1),u=(i&a.childLanes)!==0),m){if(u)return p0(n,a,i);a.flags|=128}if(m=a.memoizedState,m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),X(gn,gn.current),u)break;return null;case 22:case 23:return a.lanes=0,c0(n,a,i);case 24:rr(a,fn,n.memoizedState.cache)}return Ps(n,a,i)}function y0(n,a,i){if(n!==null)if(n.memoizedProps!==a.pendingProps)_n=!0;else{if(!Dm(n,i)&&(a.flags&128)===0)return _n=!1,pT(n,a,i);_n=(n.flags&131072)!==0}else _n=!1,wt&&(a.flags&1048576)!==0&&Kp(a,ku,a.index);switch(a.lanes=0,a.tag){case 16:e:{n=a.pendingProps;var u=a.elementType,m=u._init;if(u=m(u._payload),a.type=u,typeof u=="function")Hh(u)?(n=xi(u,n),a.tag=1,a=h0(null,a,u,n,i)):(a.tag=0,a=Sm(null,a,u,n,i));else{if(u!=null){if(m=u.$$typeof,m===F){a.tag=11,a=i0(null,a,u,n,i);break e}else if(m===N){a.tag=14,a=o0(null,a,u,n,i);break e}}throw a=Ve(u)||u,Error(r(306,a,""))}}return a;case 0:return Sm(n,a,a.type,a.pendingProps,i);case 1:return u=a.type,m=xi(u,a.pendingProps),h0(n,a,u,m,i);case 3:e:{if(je(a,a.stateNode.containerInfo),n===null)throw Error(r(387));u=a.pendingProps;var g=a.memoizedState;m=g.element,nm(n,a),Rl(a,u,null,i);var _=a.memoizedState;if(u=_.cache,rr(a,fn,u),u!==g.cache&&Xh(a,[fn],i,!0),Nl(),u=_.element,g.isDehydrated)if(g={element:u,isDehydrated:!1,cache:_.cache},a.updateQueue.baseState=g,a.memoizedState=g,a.flags&256){a=m0(n,a,u,i);break e}else if(u!==m){m=va(Error(r(424)),a),_l(m),a=m0(n,a,u,i);break e}else{switch(n=a.stateNode.containerInfo,n.nodeType){case 9:n=n.body;break;default:n=n.nodeName==="HTML"?n.ownerDocument.body:n}for(Yt=Pa(n.firstChild),$n=a,wt=!0,hi=null,ts=!0,i=Qy(a,null,u,i),a.child=i;i;)i.flags=i.flags&-3|4096,i=i.sibling}else{if(bl(),u===m){a=Ps(n,a,i);break e}Nn(n,a,u,i)}a=a.child}return a;case 26:return Hu(n,a),n===null?(i=_x(a.type,null,a.pendingProps,null))?a.memoizedState=i:wt||(i=a.type,n=a.pendingProps,u=ad(Ee.current).createElement(i),u[be]=a,u[Ae]=n,jn(u,i,n),Ot(u),a.stateNode=u):a.memoizedState=_x(a.type,n.memoizedProps,a.pendingProps,n.memoizedState),null;case 27:return he(a),n===null&&wt&&(u=a.stateNode=xx(a.type,a.pendingProps,Ee.current),$n=a,ts=!0,m=Yt,br(a.type)?(ff=m,Yt=Pa(u.firstChild)):Yt=m),Nn(n,a,a.pendingProps.children,i),Hu(n,a),n===null&&(a.flags|=4194304),a.child;case 5:return n===null&&wt&&((m=u=Yt)&&(u=FT(u,a.type,a.pendingProps,ts),u!==null?(a.stateNode=u,$n=a,Yt=Pa(u.firstChild),ts=!1,m=!0):m=!1),m||mi(a)),he(a),m=a.type,g=a.pendingProps,_=n!==null?n.memoizedProps:null,u=g.children,uf(m,g)?u=null:_!==null&&uf(m,_)&&(a.flags|=32),a.memoizedState!==null&&(m=lm(n,a,lT,null,null,i),Zl._currentValue=m),Hu(n,a),Nn(n,a,u,i),a.child;case 6:return n===null&&wt&&((n=i=Yt)&&(i=qT(i,a.pendingProps,ts),i!==null?(a.stateNode=i,$n=a,Yt=null,n=!0):n=!1),n||mi(a)),null;case 13:return f0(n,a,i);case 4:return je(a,a.stateNode.containerInfo),u=a.pendingProps,n===null?a.child=fo(a,null,u,i):Nn(n,a,u,i),a.child;case 11:return i0(n,a,a.type,a.pendingProps,i);case 7:return Nn(n,a,a.pendingProps,i),a.child;case 8:return Nn(n,a,a.pendingProps.children,i),a.child;case 12:return Nn(n,a,a.pendingProps.children,i),a.child;case 10:return u=a.pendingProps,rr(a,a.type,u.value),Nn(n,a,u.children,i),a.child;case 9:return m=a.type._context,u=a.pendingProps.children,gi(a),m=zn(m),u=u(m),a.flags|=1,Nn(n,a,u,i),a.child;case 14:return o0(n,a,a.type,a.pendingProps,i);case 15:return l0(n,a,a.type,a.pendingProps,i);case 19:return p0(n,a,i);case 31:return u=a.pendingProps,i=a.mode,u={mode:u.mode,children:u.children},n===null?(i=Gu(u,i),i.ref=a.ref,a.child=i,i.return=a,a=i):(i=Rs(n.child,u),i.ref=a.ref,a.child=i,i.return=a,a=i),a;case 22:return c0(n,a,i);case 24:return gi(a),u=zn(fn),n===null?(m=Jh(),m===null&&(m=Lt,g=Zh(),m.pooledCache=g,g.refCount++,g!==null&&(m.pooledCacheLanes|=i),m=g),a.memoizedState={parent:u,cache:m},tm(a),rr(a,fn,m)):((n.lanes&i)!==0&&(nm(n,a),Rl(a,null,null,i),Nl()),m=n.memoizedState,g=a.memoizedState,m.parent!==u?(m={parent:u,cache:u},a.memoizedState=m,a.lanes===0&&(a.memoizedState=a.updateQueue.baseState=m),rr(a,fn,u)):(u=g.cache,rr(a,fn,u),u!==m.cache&&Xh(a,[fn],i,!0))),Nn(n,a,a.pendingProps.children,i),a.child;case 29:throw a.pendingProps}throw Error(r(156,a.tag))}function zs(n){n.flags|=4}function x0(n,a){if(a.type!=="stylesheet"||(a.state.loading&4)!==0)n.flags&=-16777217;else if(n.flags|=16777216,!Sx(a)){if(a=Ta.current,a!==null&&((bt&4194048)===bt?ns!==null:(bt&62914560)!==bt&&(bt&536870912)===0||a!==ns))throw Sl=em,ty;n.flags|=8192}}function Fu(n,a){a!==null&&(n.flags|=4),n.flags&16384&&(a=n.tag!==22?vs():536870912,n.lanes|=a,xo|=a)}function Pl(n,a){if(!wt)switch(n.tailMode){case"hidden":a=n.tail;for(var i=null;a!==null;)a.alternate!==null&&(i=a),a=a.sibling;i===null?n.tail=null:i.sibling=null;break;case"collapsed":i=n.tail;for(var u=null;i!==null;)i.alternate!==null&&(u=i),i=i.sibling;u===null?a||n.tail===null?n.tail=null:n.tail.sibling=null:u.sibling=null}}function qt(n){var a=n.alternate!==null&&n.alternate.child===n.child,i=0,u=0;if(a)for(var m=n.child;m!==null;)i|=m.lanes|m.childLanes,u|=m.subtreeFlags&65011712,u|=m.flags&65011712,m.return=n,m=m.sibling;else for(m=n.child;m!==null;)i|=m.lanes|m.childLanes,u|=m.subtreeFlags,u|=m.flags,m.return=n,m=m.sibling;return n.subtreeFlags|=u,n.childLanes=i,a}function yT(n,a,i){var u=a.pendingProps;switch($h(a),a.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return qt(a),null;case 1:return qt(a),null;case 3:return i=a.stateNode,u=null,n!==null&&(u=n.memoizedState.cache),a.memoizedState.cache!==u&&(a.flags|=2048),Ds(fn),pe(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(n===null||n.child===null)&&(vl(a)?zs(a):n===null||n.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,Xp())),qt(a),null;case 26:return i=a.memoizedState,n===null?(zs(a),i!==null?(qt(a),x0(a,i)):(qt(a),a.flags&=-16777217)):i?i!==n.memoizedState?(zs(a),qt(a),x0(a,i)):(qt(a),a.flags&=-16777217):(n.memoizedProps!==u&&zs(a),qt(a),a.flags&=-16777217),null;case 27:ge(a),i=Ee.current;var m=a.type;if(n!==null&&a.stateNode!=null)n.memoizedProps!==u&&zs(a);else{if(!u){if(a.stateNode===null)throw Error(r(166));return qt(a),null}n=fe.current,vl(a)?Yp(a):(n=xx(m,u,i),a.stateNode=n,zs(a))}return qt(a),null;case 5:if(ge(a),i=a.type,n!==null&&a.stateNode!=null)n.memoizedProps!==u&&zs(a);else{if(!u){if(a.stateNode===null)throw Error(r(166));return qt(a),null}if(n=fe.current,vl(a))Yp(a);else{switch(m=ad(Ee.current),n){case 1:n=m.createElementNS("http://www.w3.org/2000/svg",i);break;case 2:n=m.createElementNS("http://www.w3.org/1998/Math/MathML",i);break;default:switch(i){case"svg":n=m.createElementNS("http://www.w3.org/2000/svg",i);break;case"math":n=m.createElementNS("http://www.w3.org/1998/Math/MathML",i);break;case"script":n=m.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild);break;case"select":n=typeof u.is=="string"?m.createElement("select",{is:u.is}):m.createElement("select"),u.multiple?n.multiple=!0:u.size&&(n.size=u.size);break;default:n=typeof u.is=="string"?m.createElement(i,{is:u.is}):m.createElement(i)}}n[be]=a,n[Ae]=u;e:for(m=a.child;m!==null;){if(m.tag===5||m.tag===6)n.appendChild(m.stateNode);else if(m.tag!==4&&m.tag!==27&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===a)break e;for(;m.sibling===null;){if(m.return===null||m.return===a)break e;m=m.return}m.sibling.return=m.return,m=m.sibling}a.stateNode=n;e:switch(jn(n,i,u),i){case"button":case"input":case"select":case"textarea":n=!!u.autoFocus;break e;case"img":n=!0;break e;default:n=!1}n&&zs(a)}}return qt(a),a.flags&=-16777217,null;case 6:if(n&&a.stateNode!=null)n.memoizedProps!==u&&zs(a);else{if(typeof u!="string"&&a.stateNode===null)throw Error(r(166));if(n=Ee.current,vl(a)){if(n=a.stateNode,i=a.memoizedProps,u=null,m=$n,m!==null)switch(m.tag){case 27:case 5:u=m.memoizedProps}n[be]=a,n=!!(n.nodeValue===i||u!==null&&u.suppressHydrationWarning===!0||dx(n.nodeValue,i)),n||mi(a)}else n=ad(n).createTextNode(u),n[be]=a,a.stateNode=n}return qt(a),null;case 13:if(u=a.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(m=vl(a),u!==null&&u.dehydrated!==null){if(n===null){if(!m)throw Error(r(318));if(m=a.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(r(317));m[be]=a}else bl(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;qt(a),m=!1}else m=Xp(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=m),m=!0;if(!m)return a.flags&256?(Os(a),a):(Os(a),null)}if(Os(a),(a.flags&128)!==0)return a.lanes=i,a;if(i=u!==null,n=n!==null&&n.memoizedState!==null,i){u=a.child,m=null,u.alternate!==null&&u.alternate.memoizedState!==null&&u.alternate.memoizedState.cachePool!==null&&(m=u.alternate.memoizedState.cachePool.pool);var g=null;u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(g=u.memoizedState.cachePool.pool),g!==m&&(u.flags|=2048)}return i!==n&&i&&(a.child.flags|=8192),Fu(a,a.updateQueue),qt(a),null;case 4:return pe(),n===null&&sf(a.stateNode.containerInfo),qt(a),null;case 10:return Ds(a.type),qt(a),null;case 19:if(ee(gn),m=a.memoizedState,m===null)return qt(a),null;if(u=(a.flags&128)!==0,g=m.rendering,g===null)if(u)Pl(m,!1);else{if(Qt!==0||n!==null&&(n.flags&128)!==0)for(n=a.child;n!==null;){if(g=Vu(n),g!==null){for(a.flags|=128,Pl(m,!1),n=g.updateQueue,a.updateQueue=n,Fu(a,n),a.subtreeFlags=0,n=i,i=a.child;i!==null;)$p(i,n),i=i.sibling;return X(gn,gn.current&1|2),a.child}n=n.sibling}m.tail!==null&&pt()>Ku&&(a.flags|=128,u=!0,Pl(m,!1),a.lanes=4194304)}else{if(!u)if(n=Vu(g),n!==null){if(a.flags|=128,u=!0,n=n.updateQueue,a.updateQueue=n,Fu(a,n),Pl(m,!0),m.tail===null&&m.tailMode==="hidden"&&!g.alternate&&!wt)return qt(a),null}else 2*pt()-m.renderingStartTime>Ku&&i!==536870912&&(a.flags|=128,u=!0,Pl(m,!1),a.lanes=4194304);m.isBackwards?(g.sibling=a.child,a.child=g):(n=m.last,n!==null?n.sibling=g:a.child=g,m.last=g)}return m.tail!==null?(a=m.tail,m.rendering=a,m.tail=a.sibling,m.renderingStartTime=pt(),a.sibling=null,n=gn.current,X(gn,u?n&1|2:n&1),a):(qt(a),null);case 22:case 23:return Os(a),im(),u=a.memoizedState!==null,n!==null?n.memoizedState!==null!==u&&(a.flags|=8192):u&&(a.flags|=8192),u?(i&536870912)!==0&&(a.flags&128)===0&&(qt(a),a.subtreeFlags&6&&(a.flags|=8192)):qt(a),i=a.updateQueue,i!==null&&Fu(a,i.retryQueue),i=null,n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(i=n.memoizedState.cachePool.pool),u=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(u=a.memoizedState.cachePool.pool),u!==i&&(a.flags|=2048),n!==null&&ee(pi),null;case 24:return i=null,n!==null&&(i=n.memoizedState.cache),a.memoizedState.cache!==i&&(a.flags|=2048),Ds(fn),qt(a),null;case 25:return null;case 30:return null}throw Error(r(156,a.tag))}function xT(n,a){switch($h(a),a.tag){case 1:return n=a.flags,n&65536?(a.flags=n&-65537|128,a):null;case 3:return Ds(fn),pe(),n=a.flags,(n&65536)!==0&&(n&128)===0?(a.flags=n&-65537|128,a):null;case 26:case 27:case 5:return ge(a),null;case 13:if(Os(a),n=a.memoizedState,n!==null&&n.dehydrated!==null){if(a.alternate===null)throw Error(r(340));bl()}return n=a.flags,n&65536?(a.flags=n&-65537|128,a):null;case 19:return ee(gn),null;case 4:return pe(),null;case 10:return Ds(a.type),null;case 22:case 23:return Os(a),im(),n!==null&&ee(pi),n=a.flags,n&65536?(a.flags=n&-65537|128,a):null;case 24:return Ds(fn),null;case 25:return null;default:return null}}function v0(n,a){switch($h(a),a.tag){case 3:Ds(fn),pe();break;case 26:case 27:case 5:ge(a);break;case 4:pe();break;case 13:Os(a);break;case 19:ee(gn);break;case 10:Ds(a.type);break;case 22:case 23:Os(a),im(),n!==null&&ee(pi);break;case 24:Ds(fn)}}function zl(n,a){try{var i=a.updateQueue,u=i!==null?i.lastEffect:null;if(u!==null){var m=u.next;i=m;do{if((i.tag&n)===n){u=void 0;var g=i.create,_=i.inst;u=g(),_.destroy=u}i=i.next}while(i!==m)}}catch(w){Pt(a,a.return,w)}}function hr(n,a,i){try{var u=a.updateQueue,m=u!==null?u.lastEffect:null;if(m!==null){var g=m.next;u=g;do{if((u.tag&n)===n){var _=u.inst,w=_.destroy;if(w!==void 0){_.destroy=void 0,m=a;var D=i,Q=w;try{Q()}catch(se){Pt(m,D,se)}}}u=u.next}while(u!==g)}}catch(se){Pt(a,a.return,se)}}function b0(n){var a=n.updateQueue;if(a!==null){var i=n.stateNode;try{oy(a,i)}catch(u){Pt(n,n.return,u)}}}function _0(n,a,i){i.props=xi(n.type,n.memoizedProps),i.state=n.memoizedState;try{i.componentWillUnmount()}catch(u){Pt(n,a,u)}}function Ll(n,a){try{var i=n.ref;if(i!==null){switch(n.tag){case 26:case 27:case 5:var u=n.stateNode;break;case 30:u=n.stateNode;break;default:u=n.stateNode}typeof i=="function"?n.refCleanup=i(u):i.current=u}}catch(m){Pt(n,a,m)}}function as(n,a){var i=n.ref,u=n.refCleanup;if(i!==null)if(typeof u=="function")try{u()}catch(m){Pt(n,a,m)}finally{n.refCleanup=null,n=n.alternate,n!=null&&(n.refCleanup=null)}else if(typeof i=="function")try{i(null)}catch(m){Pt(n,a,m)}else i.current=null}function k0(n){var a=n.type,i=n.memoizedProps,u=n.stateNode;try{e:switch(a){case"button":case"input":case"select":case"textarea":i.autoFocus&&u.focus();break e;case"img":i.src?u.src=i.src:i.srcSet&&(u.srcset=i.srcSet)}}catch(m){Pt(n,n.return,m)}}function Mm(n,a,i){try{var u=n.stateNode;VT(u,n.type,i,a),u[Ae]=a}catch(m){Pt(n,n.return,m)}}function T0(n){return n.tag===5||n.tag===3||n.tag===26||n.tag===27&&br(n.type)||n.tag===4}function Om(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||T0(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.tag===27&&br(n.type)||n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function Pm(n,a,i){var u=n.tag;if(u===5||u===6)n=n.stateNode,a?(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i).insertBefore(n,a):(a=i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,a.appendChild(n),i=i._reactRootContainer,i!=null||a.onclick!==null||(a.onclick=nd));else if(u!==4&&(u===27&&br(n.type)&&(i=n.stateNode,a=null),n=n.child,n!==null))for(Pm(n,a,i),n=n.sibling;n!==null;)Pm(n,a,i),n=n.sibling}function qu(n,a,i){var u=n.tag;if(u===5||u===6)n=n.stateNode,a?i.insertBefore(n,a):i.appendChild(n);else if(u!==4&&(u===27&&br(n.type)&&(i=n.stateNode),n=n.child,n!==null))for(qu(n,a,i),n=n.sibling;n!==null;)qu(n,a,i),n=n.sibling}function w0(n){var a=n.stateNode,i=n.memoizedProps;try{for(var u=n.type,m=a.attributes;m.length;)a.removeAttributeNode(m[0]);jn(a,u,i),a[be]=n,a[Ae]=i}catch(g){Pt(n,n.return,g)}}var Ls=!1,tn=!1,zm=!1,E0=typeof WeakSet=="function"?WeakSet:Set,kn=null;function vT(n,a){if(n=n.containerInfo,lf=cd,n=Pp(n),Oh(n)){if("selectionStart"in n)var i={start:n.selectionStart,end:n.selectionEnd};else e:{i=(i=n.ownerDocument)&&i.defaultView||window;var u=i.getSelection&&i.getSelection();if(u&&u.rangeCount!==0){i=u.anchorNode;var m=u.anchorOffset,g=u.focusNode;u=u.focusOffset;try{i.nodeType,g.nodeType}catch{i=null;break e}var _=0,w=-1,D=-1,Q=0,se=0,ce=n,Z=null;t:for(;;){for(var J;ce!==i||m!==0&&ce.nodeType!==3||(w=_+m),ce!==g||u!==0&&ce.nodeType!==3||(D=_+u),ce.nodeType===3&&(_+=ce.nodeValue.length),(J=ce.firstChild)!==null;)Z=ce,ce=J;for(;;){if(ce===n)break t;if(Z===i&&++Q===m&&(w=_),Z===g&&++se===u&&(D=_),(J=ce.nextSibling)!==null)break;ce=Z,Z=ce.parentNode}ce=J}i=w===-1||D===-1?null:{start:w,end:D}}else i=null}i=i||{start:0,end:0}}else i=null;for(cf={focusedElem:n,selectionRange:i},cd=!1,kn=a;kn!==null;)if(a=kn,n=a.child,(a.subtreeFlags&1024)!==0&&n!==null)n.return=a,kn=n;else for(;kn!==null;){switch(a=kn,g=a.alternate,n=a.flags,a.tag){case 0:break;case 11:case 15:break;case 1:if((n&1024)!==0&&g!==null){n=void 0,i=a,m=g.memoizedProps,g=g.memoizedState,u=i.stateNode;try{var Xe=xi(i.type,m,i.elementType===i.type);n=u.getSnapshotBeforeUpdate(Xe,g),u.__reactInternalSnapshotBeforeUpdate=n}catch(Fe){Pt(i,i.return,Fe)}}break;case 3:if((n&1024)!==0){if(n=a.stateNode.containerInfo,i=n.nodeType,i===9)hf(n);else if(i===1)switch(n.nodeName){case"HEAD":case"HTML":case"BODY":hf(n);break;default:n.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((n&1024)!==0)throw Error(r(163))}if(n=a.sibling,n!==null){n.return=a.return,kn=n;break}kn=a.return}}function S0(n,a,i){var u=i.flags;switch(i.tag){case 0:case 11:case 15:mr(n,i),u&4&&zl(5,i);break;case 1:if(mr(n,i),u&4)if(n=i.stateNode,a===null)try{n.componentDidMount()}catch(_){Pt(i,i.return,_)}else{var m=xi(i.type,a.memoizedProps);a=a.memoizedState;try{n.componentDidUpdate(m,a,n.__reactInternalSnapshotBeforeUpdate)}catch(_){Pt(i,i.return,_)}}u&64&&b0(i),u&512&&Ll(i,i.return);break;case 3:if(mr(n,i),u&64&&(n=i.updateQueue,n!==null)){if(a=null,i.child!==null)switch(i.child.tag){case 27:case 5:a=i.child.stateNode;break;case 1:a=i.child.stateNode}try{oy(n,a)}catch(_){Pt(i,i.return,_)}}break;case 27:a===null&&u&4&&w0(i);case 26:case 5:mr(n,i),a===null&&u&4&&k0(i),u&512&&Ll(i,i.return);break;case 12:mr(n,i);break;case 13:mr(n,i),u&4&&R0(n,i),u&64&&(n=i.memoizedState,n!==null&&(n=n.dehydrated,n!==null&&(i=NT.bind(null,i),$T(n,i))));break;case 22:if(u=i.memoizedState!==null||Ls,!u){a=a!==null&&a.memoizedState!==null||tn,m=Ls;var g=tn;Ls=u,(tn=a)&&!g?fr(n,i,(i.subtreeFlags&8772)!==0):mr(n,i),Ls=m,tn=g}break;case 30:break;default:mr(n,i)}}function A0(n){var a=n.alternate;a!==null&&(n.alternate=null,A0(a)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(a=n.stateNode,a!==null&&Zt(a)),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}var Bt=null,Qn=!1;function Vs(n,a,i){for(i=i.child;i!==null;)N0(n,a,i),i=i.sibling}function N0(n,a,i){if(ft&&typeof ft.onCommitFiberUnmount=="function")try{ft.onCommitFiberUnmount(st,i)}catch{}switch(i.tag){case 26:tn||as(i,a),Vs(n,a,i),i.memoizedState?i.memoizedState.count--:i.stateNode&&(i=i.stateNode,i.parentNode.removeChild(i));break;case 27:tn||as(i,a);var u=Bt,m=Qn;br(i.type)&&(Bt=i.stateNode,Qn=!1),Vs(n,a,i),Kl(i.stateNode),Bt=u,Qn=m;break;case 5:tn||as(i,a);case 6:if(u=Bt,m=Qn,Bt=null,Vs(n,a,i),Bt=u,Qn=m,Bt!==null)if(Qn)try{(Bt.nodeType===9?Bt.body:Bt.nodeName==="HTML"?Bt.ownerDocument.body:Bt).removeChild(i.stateNode)}catch(g){Pt(i,a,g)}else try{Bt.removeChild(i.stateNode)}catch(g){Pt(i,a,g)}break;case 18:Bt!==null&&(Qn?(n=Bt,px(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,i.stateNode),tc(n)):px(Bt,i.stateNode));break;case 4:u=Bt,m=Qn,Bt=i.stateNode.containerInfo,Qn=!0,Vs(n,a,i),Bt=u,Qn=m;break;case 0:case 11:case 14:case 15:tn||hr(2,i,a),tn||hr(4,i,a),Vs(n,a,i);break;case 1:tn||(as(i,a),u=i.stateNode,typeof u.componentWillUnmount=="function"&&_0(i,a,u)),Vs(n,a,i);break;case 21:Vs(n,a,i);break;case 22:tn=(u=tn)||i.memoizedState!==null,Vs(n,a,i),tn=u;break;default:Vs(n,a,i)}}function R0(n,a){if(a.memoizedState===null&&(n=a.alternate,n!==null&&(n=n.memoizedState,n!==null&&(n=n.dehydrated,n!==null))))try{tc(n)}catch(i){Pt(a,a.return,i)}}function bT(n){switch(n.tag){case 13:case 19:var a=n.stateNode;return a===null&&(a=n.stateNode=new E0),a;case 22:return n=n.stateNode,a=n._retryCache,a===null&&(a=n._retryCache=new E0),a;default:throw Error(r(435,n.tag))}}function Lm(n,a){var i=bT(n);a.forEach(function(u){var m=RT.bind(null,n,u);i.has(u)||(i.add(u),u.then(m,m))})}function la(n,a){var i=a.deletions;if(i!==null)for(var u=0;u<i.length;u++){var m=i[u],g=n,_=a,w=_;e:for(;w!==null;){switch(w.tag){case 27:if(br(w.type)){Bt=w.stateNode,Qn=!1;break e}break;case 5:Bt=w.stateNode,Qn=!1;break e;case 3:case 4:Bt=w.stateNode.containerInfo,Qn=!0;break e}w=w.return}if(Bt===null)throw Error(r(160));N0(g,_,m),Bt=null,Qn=!1,g=m.alternate,g!==null&&(g.return=null),m.return=null}if(a.subtreeFlags&13878)for(a=a.child;a!==null;)j0(a,n),a=a.sibling}var Oa=null;function j0(n,a){var i=n.alternate,u=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:la(a,n),ca(n),u&4&&(hr(3,n,n.return),zl(3,n),hr(5,n,n.return));break;case 1:la(a,n),ca(n),u&512&&(tn||i===null||as(i,i.return)),u&64&&Ls&&(n=n.updateQueue,n!==null&&(u=n.callbacks,u!==null&&(i=n.shared.hiddenCallbacks,n.shared.hiddenCallbacks=i===null?u:i.concat(u))));break;case 26:var m=Oa;if(la(a,n),ca(n),u&512&&(tn||i===null||as(i,i.return)),u&4){var g=i!==null?i.memoizedState:null;if(u=n.memoizedState,i===null)if(u===null)if(n.stateNode===null){e:{u=n.type,i=n.memoizedProps,m=m.ownerDocument||m;t:switch(u){case"title":g=m.getElementsByTagName("title")[0],(!g||g[Ft]||g[be]||g.namespaceURI==="http://www.w3.org/2000/svg"||g.hasAttribute("itemprop"))&&(g=m.createElement(u),m.head.insertBefore(g,m.querySelector("head > title"))),jn(g,u,i),g[be]=n,Ot(g),u=g;break e;case"link":var _=wx("link","href",m).get(u+(i.href||""));if(_){for(var w=0;w<_.length;w++)if(g=_[w],g.getAttribute("href")===(i.href==null||i.href===""?null:i.href)&&g.getAttribute("rel")===(i.rel==null?null:i.rel)&&g.getAttribute("title")===(i.title==null?null:i.title)&&g.getAttribute("crossorigin")===(i.crossOrigin==null?null:i.crossOrigin)){_.splice(w,1);break t}}g=m.createElement(u),jn(g,u,i),m.head.appendChild(g);break;case"meta":if(_=wx("meta","content",m).get(u+(i.content||""))){for(w=0;w<_.length;w++)if(g=_[w],g.getAttribute("content")===(i.content==null?null:""+i.content)&&g.getAttribute("name")===(i.name==null?null:i.name)&&g.getAttribute("property")===(i.property==null?null:i.property)&&g.getAttribute("http-equiv")===(i.httpEquiv==null?null:i.httpEquiv)&&g.getAttribute("charset")===(i.charSet==null?null:i.charSet)){_.splice(w,1);break t}}g=m.createElement(u),jn(g,u,i),m.head.appendChild(g);break;default:throw Error(r(468,u))}g[be]=n,Ot(g),u=g}n.stateNode=u}else Ex(m,n.type,n.stateNode);else n.stateNode=Tx(m,u,n.memoizedProps);else g!==u?(g===null?i.stateNode!==null&&(i=i.stateNode,i.parentNode.removeChild(i)):g.count--,u===null?Ex(m,n.type,n.stateNode):Tx(m,u,n.memoizedProps)):u===null&&n.stateNode!==null&&Mm(n,n.memoizedProps,i.memoizedProps)}break;case 27:la(a,n),ca(n),u&512&&(tn||i===null||as(i,i.return)),i!==null&&u&4&&Mm(n,n.memoizedProps,i.memoizedProps);break;case 5:if(la(a,n),ca(n),u&512&&(tn||i===null||as(i,i.return)),n.flags&32){m=n.stateNode;try{ga(m,"")}catch(J){Pt(n,n.return,J)}}u&4&&n.stateNode!=null&&(m=n.memoizedProps,Mm(n,m,i!==null?i.memoizedProps:m)),u&1024&&(zm=!0);break;case 6:if(la(a,n),ca(n),u&4){if(n.stateNode===null)throw Error(r(162));u=n.memoizedProps,i=n.stateNode;try{i.nodeValue=u}catch(J){Pt(n,n.return,J)}}break;case 3:if(id=null,m=Oa,Oa=sd(a.containerInfo),la(a,n),Oa=m,ca(n),u&4&&i!==null&&i.memoizedState.isDehydrated)try{tc(a.containerInfo)}catch(J){Pt(n,n.return,J)}zm&&(zm=!1,C0(n));break;case 4:u=Oa,Oa=sd(n.stateNode.containerInfo),la(a,n),ca(n),Oa=u;break;case 12:la(a,n),ca(n);break;case 13:la(a,n),ca(n),n.child.flags&8192&&n.memoizedState!==null!=(i!==null&&i.memoizedState!==null)&&(Fm=pt()),u&4&&(u=n.updateQueue,u!==null&&(n.updateQueue=null,Lm(n,u)));break;case 22:m=n.memoizedState!==null;var D=i!==null&&i.memoizedState!==null,Q=Ls,se=tn;if(Ls=Q||m,tn=se||D,la(a,n),tn=se,Ls=Q,ca(n),u&8192)e:for(a=n.stateNode,a._visibility=m?a._visibility&-2:a._visibility|1,m&&(i===null||D||Ls||tn||vi(n)),i=null,a=n;;){if(a.tag===5||a.tag===26){if(i===null){D=i=a;try{if(g=D.stateNode,m)_=g.style,typeof _.setProperty=="function"?_.setProperty("display","none","important"):_.display="none";else{w=D.stateNode;var ce=D.memoizedProps.style,Z=ce!=null&&ce.hasOwnProperty("display")?ce.display:null;w.style.display=Z==null||typeof Z=="boolean"?"":(""+Z).trim()}}catch(J){Pt(D,D.return,J)}}}else if(a.tag===6){if(i===null){D=a;try{D.stateNode.nodeValue=m?"":D.memoizedProps}catch(J){Pt(D,D.return,J)}}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===n)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===n)break e;for(;a.sibling===null;){if(a.return===null||a.return===n)break e;i===a&&(i=null),a=a.return}i===a&&(i=null),a.sibling.return=a.return,a=a.sibling}u&4&&(u=n.updateQueue,u!==null&&(i=u.retryQueue,i!==null&&(u.retryQueue=null,Lm(n,i))));break;case 19:la(a,n),ca(n),u&4&&(u=n.updateQueue,u!==null&&(n.updateQueue=null,Lm(n,u)));break;case 30:break;case 21:break;default:la(a,n),ca(n)}}function ca(n){var a=n.flags;if(a&2){try{for(var i,u=n.return;u!==null;){if(T0(u)){i=u;break}u=u.return}if(i==null)throw Error(r(160));switch(i.tag){case 27:var m=i.stateNode,g=Om(n);qu(n,g,m);break;case 5:var _=i.stateNode;i.flags&32&&(ga(_,""),i.flags&=-33);var w=Om(n);qu(n,w,_);break;case 3:case 4:var D=i.stateNode.containerInfo,Q=Om(n);Pm(n,Q,D);break;default:throw Error(r(161))}}catch(se){Pt(n,n.return,se)}n.flags&=-3}a&4096&&(n.flags&=-4097)}function C0(n){if(n.subtreeFlags&1024)for(n=n.child;n!==null;){var a=n;C0(a),a.tag===5&&a.flags&1024&&a.stateNode.reset(),n=n.sibling}}function mr(n,a){if(a.subtreeFlags&8772)for(a=a.child;a!==null;)S0(n,a.alternate,a),a=a.sibling}function vi(n){for(n=n.child;n!==null;){var a=n;switch(a.tag){case 0:case 11:case 14:case 15:hr(4,a,a.return),vi(a);break;case 1:as(a,a.return);var i=a.stateNode;typeof i.componentWillUnmount=="function"&&_0(a,a.return,i),vi(a);break;case 27:Kl(a.stateNode);case 26:case 5:as(a,a.return),vi(a);break;case 22:a.memoizedState===null&&vi(a);break;case 30:vi(a);break;default:vi(a)}n=n.sibling}}function fr(n,a,i){for(i=i&&(a.subtreeFlags&8772)!==0,a=a.child;a!==null;){var u=a.alternate,m=n,g=a,_=g.flags;switch(g.tag){case 0:case 11:case 15:fr(m,g,i),zl(4,g);break;case 1:if(fr(m,g,i),u=g,m=u.stateNode,typeof m.componentDidMount=="function")try{m.componentDidMount()}catch(Q){Pt(u,u.return,Q)}if(u=g,m=u.updateQueue,m!==null){var w=u.stateNode;try{var D=m.shared.hiddenCallbacks;if(D!==null)for(m.shared.hiddenCallbacks=null,m=0;m<D.length;m++)iy(D[m],w)}catch(Q){Pt(u,u.return,Q)}}i&&_&64&&b0(g),Ll(g,g.return);break;case 27:w0(g);case 26:case 5:fr(m,g,i),i&&u===null&&_&4&&k0(g),Ll(g,g.return);break;case 12:fr(m,g,i);break;case 13:fr(m,g,i),i&&_&4&&R0(m,g);break;case 22:g.memoizedState===null&&fr(m,g,i),Ll(g,g.return);break;case 30:break;default:fr(m,g,i)}a=a.sibling}}function Vm(n,a){var i=null;n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(i=n.memoizedState.cachePool.pool),n=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(n=a.memoizedState.cachePool.pool),n!==i&&(n!=null&&n.refCount++,i!=null&&Tl(i))}function Um(n,a){n=null,a.alternate!==null&&(n=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==n&&(a.refCount++,n!=null&&Tl(n))}function ss(n,a,i,u){if(a.subtreeFlags&10256)for(a=a.child;a!==null;)I0(n,a,i,u),a=a.sibling}function I0(n,a,i,u){var m=a.flags;switch(a.tag){case 0:case 11:case 15:ss(n,a,i,u),m&2048&&zl(9,a);break;case 1:ss(n,a,i,u);break;case 3:ss(n,a,i,u),m&2048&&(n=null,a.alternate!==null&&(n=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==n&&(a.refCount++,n!=null&&Tl(n)));break;case 12:if(m&2048){ss(n,a,i,u),n=a.stateNode;try{var g=a.memoizedProps,_=g.id,w=g.onPostCommit;typeof w=="function"&&w(_,a.alternate===null?"mount":"update",n.passiveEffectDuration,-0)}catch(D){Pt(a,a.return,D)}}else ss(n,a,i,u);break;case 13:ss(n,a,i,u);break;case 23:break;case 22:g=a.stateNode,_=a.alternate,a.memoizedState!==null?g._visibility&2?ss(n,a,i,u):Vl(n,a):g._visibility&2?ss(n,a,i,u):(g._visibility|=2,go(n,a,i,u,(a.subtreeFlags&10256)!==0)),m&2048&&Vm(_,a);break;case 24:ss(n,a,i,u),m&2048&&Um(a.alternate,a);break;default:ss(n,a,i,u)}}function go(n,a,i,u,m){for(m=m&&(a.subtreeFlags&10256)!==0,a=a.child;a!==null;){var g=n,_=a,w=i,D=u,Q=_.flags;switch(_.tag){case 0:case 11:case 15:go(g,_,w,D,m),zl(8,_);break;case 23:break;case 22:var se=_.stateNode;_.memoizedState!==null?se._visibility&2?go(g,_,w,D,m):Vl(g,_):(se._visibility|=2,go(g,_,w,D,m)),m&&Q&2048&&Vm(_.alternate,_);break;case 24:go(g,_,w,D,m),m&&Q&2048&&Um(_.alternate,_);break;default:go(g,_,w,D,m)}a=a.sibling}}function Vl(n,a){if(a.subtreeFlags&10256)for(a=a.child;a!==null;){var i=n,u=a,m=u.flags;switch(u.tag){case 22:Vl(i,u),m&2048&&Vm(u.alternate,u);break;case 24:Vl(i,u),m&2048&&Um(u.alternate,u);break;default:Vl(i,u)}a=a.sibling}}var Ul=8192;function po(n){if(n.subtreeFlags&Ul)for(n=n.child;n!==null;)D0(n),n=n.sibling}function D0(n){switch(n.tag){case 26:po(n),n.flags&Ul&&n.memoizedState!==null&&rw(Oa,n.memoizedState,n.memoizedProps);break;case 5:po(n);break;case 3:case 4:var a=Oa;Oa=sd(n.stateNode.containerInfo),po(n),Oa=a;break;case 22:n.memoizedState===null&&(a=n.alternate,a!==null&&a.memoizedState!==null?(a=Ul,Ul=16777216,po(n),Ul=a):po(n));break;default:po(n)}}function M0(n){var a=n.alternate;if(a!==null&&(n=a.child,n!==null)){a.child=null;do a=n.sibling,n.sibling=null,n=a;while(n!==null)}}function Bl(n){var a=n.deletions;if((n.flags&16)!==0){if(a!==null)for(var i=0;i<a.length;i++){var u=a[i];kn=u,P0(u,n)}M0(n)}if(n.subtreeFlags&10256)for(n=n.child;n!==null;)O0(n),n=n.sibling}function O0(n){switch(n.tag){case 0:case 11:case 15:Bl(n),n.flags&2048&&hr(9,n,n.return);break;case 3:Bl(n);break;case 12:Bl(n);break;case 22:var a=n.stateNode;n.memoizedState!==null&&a._visibility&2&&(n.return===null||n.return.tag!==13)?(a._visibility&=-3,$u(n)):Bl(n);break;default:Bl(n)}}function $u(n){var a=n.deletions;if((n.flags&16)!==0){if(a!==null)for(var i=0;i<a.length;i++){var u=a[i];kn=u,P0(u,n)}M0(n)}for(n=n.child;n!==null;){switch(a=n,a.tag){case 0:case 11:case 15:hr(8,a,a.return),$u(a);break;case 22:i=a.stateNode,i._visibility&2&&(i._visibility&=-3,$u(a));break;default:$u(a)}n=n.sibling}}function P0(n,a){for(;kn!==null;){var i=kn;switch(i.tag){case 0:case 11:case 15:hr(8,i,a);break;case 23:case 22:if(i.memoizedState!==null&&i.memoizedState.cachePool!==null){var u=i.memoizedState.cachePool.pool;u!=null&&u.refCount++}break;case 24:Tl(i.memoizedState.cache)}if(u=i.child,u!==null)u.return=i,kn=u;else e:for(i=n;kn!==null;){u=kn;var m=u.sibling,g=u.return;if(A0(u),u===i){kn=null;break e}if(m!==null){m.return=g,kn=m;break e}kn=g}}}var _T={getCacheForType:function(n){var a=zn(fn),i=a.data.get(n);return i===void 0&&(i=n(),a.data.set(n,i)),i}},kT=typeof WeakMap=="function"?WeakMap:Map,At=0,Lt=null,ct=null,bt=0,Nt=0,ua=null,gr=!1,yo=!1,Bm=!1,Us=0,Qt=0,pr=0,bi=0,Hm=0,wa=0,xo=0,Hl=null,Xn=null,Gm=!1,Fm=0,Ku=1/0,Yu=null,yr=null,Rn=0,xr=null,vo=null,bo=0,qm=0,$m=null,z0=null,Gl=0,Km=null;function da(){if((At&2)!==0&&bt!==0)return bt&-bt;if(W.T!==null){var n=io;return n!==0?n:ef()}return Se()}function L0(){wa===0&&(wa=(bt&536870912)===0||wt?Fa():536870912);var n=Ta.current;return n!==null&&(n.flags|=32),wa}function ha(n,a,i){(n===Lt&&(Nt===2||Nt===9)||n.cancelPendingCommit!==null)&&(_o(n,0),vr(n,bt,wa,!1)),ke(n,i),((At&2)===0||n!==Lt)&&(n===Lt&&((At&2)===0&&(bi|=i),Qt===4&&vr(n,bt,wa,!1)),rs(n))}function V0(n,a,i){if((At&6)!==0)throw Error(r(327));var u=!i&&(a&124)===0&&(a&n.expiredLanes)===0||Ia(n,a),m=u?ET(n,a):Xm(n,a,!0),g=u;do{if(m===0){yo&&!u&&vr(n,a,0,!1);break}else{if(i=n.current.alternate,g&&!TT(i)){m=Xm(n,a,!1),g=!1;continue}if(m===2){if(g=a,n.errorRecoveryDisabledLanes&g)var _=0;else _=n.pendingLanes&-536870913,_=_!==0?_:_&536870912?536870912:0;if(_!==0){a=_;e:{var w=n;m=Hl;var D=w.current.memoizedState.isDehydrated;if(D&&(_o(w,_).flags|=256),_=Xm(w,_,!1),_!==2){if(Bm&&!D){w.errorRecoveryDisabledLanes|=g,bi|=g,m=4;break e}g=Xn,Xn=m,g!==null&&(Xn===null?Xn=g:Xn.push.apply(Xn,g))}m=_}if(g=!1,m!==2)continue}}if(m===1){_o(n,0),vr(n,a,0,!0);break}e:{switch(u=n,g=m,g){case 0:case 1:throw Error(r(345));case 4:if((a&4194048)!==a)break;case 6:vr(u,a,wa,!gr);break e;case 2:Xn=null;break;case 3:case 5:break;default:throw Error(r(329))}if((a&62914560)===a&&(m=Fm+300-pt(),10<m)){if(vr(u,a,wa,!gr),Ga(u,0,!0)!==0)break e;u.timeoutHandle=fx(U0.bind(null,u,i,Xn,Yu,Gm,a,wa,bi,xo,gr,g,2,-0,0),m);break e}U0(u,i,Xn,Yu,Gm,a,wa,bi,xo,gr,g,0,-0,0)}}break}while(!0);rs(n)}function U0(n,a,i,u,m,g,_,w,D,Q,se,ce,Z,J){if(n.timeoutHandle=-1,ce=a.subtreeFlags,(ce&8192||(ce&16785408)===16785408)&&(Xl={stylesheets:null,count:0,unsuspend:sw},D0(a),ce=iw(),ce!==null)){n.cancelPendingCommit=ce(K0.bind(null,n,a,g,i,u,m,_,w,D,se,1,Z,J)),vr(n,g,_,!Q);return}K0(n,a,g,i,u,m,_,w,D)}function TT(n){for(var a=n;;){var i=a.tag;if((i===0||i===11||i===15)&&a.flags&16384&&(i=a.updateQueue,i!==null&&(i=i.stores,i!==null)))for(var u=0;u<i.length;u++){var m=i[u],g=m.getSnapshot;m=m.value;try{if(!ia(g(),m))return!1}catch{return!1}}if(i=a.child,a.subtreeFlags&16384&&i!==null)i.return=a,a=i;else{if(a===n)break;for(;a.sibling===null;){if(a.return===null||a.return===n)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function vr(n,a,i,u){a&=~Hm,a&=~bi,n.suspendedLanes|=a,n.pingedLanes&=~a,u&&(n.warmLanes|=a),u=n.expirationTimes;for(var m=a;0<m;){var g=31-Xt(m),_=1<<g;u[g]=-1,m&=~_}i!==0&&Ke(n,i,a)}function Qu(){return(At&6)===0?(Fl(0),!1):!0}function Ym(){if(ct!==null){if(Nt===0)var n=ct.return;else n=ct,Is=fi=null,dm(n),mo=null,Ml=0,n=ct;for(;n!==null;)v0(n.alternate,n),n=n.return;ct=null}}function _o(n,a){var i=n.timeoutHandle;i!==-1&&(n.timeoutHandle=-1,BT(i)),i=n.cancelPendingCommit,i!==null&&(n.cancelPendingCommit=null,i()),Ym(),Lt=n,ct=i=Rs(n.current,null),bt=a,Nt=0,ua=null,gr=!1,yo=Ia(n,a),Bm=!1,xo=wa=Hm=bi=pr=Qt=0,Xn=Hl=null,Gm=!1,(a&8)!==0&&(a|=a&32);var u=n.entangledLanes;if(u!==0)for(n=n.entanglements,u&=a;0<u;){var m=31-Xt(u),g=1<<m;a|=n[m],u&=~g}return Us=a,yu(),i}function B0(n,a){ot=null,W.H=Pu,a===El||a===Su?(a=sy(),Nt=3):a===ty?(a=sy(),Nt=4):Nt=a===r0?8:a!==null&&typeof a=="object"&&typeof a.then=="function"?6:1,ua=a,ct===null&&(Qt=1,Bu(n,va(a,n.current)))}function H0(){var n=W.H;return W.H=Pu,n===null?Pu:n}function G0(){var n=W.A;return W.A=_T,n}function Qm(){Qt=4,gr||(bt&4194048)!==bt&&Ta.current!==null||(yo=!0),(pr&134217727)===0&&(bi&134217727)===0||Lt===null||vr(Lt,bt,wa,!1)}function Xm(n,a,i){var u=At;At|=2;var m=H0(),g=G0();(Lt!==n||bt!==a)&&(Yu=null,_o(n,a)),a=!1;var _=Qt;e:do try{if(Nt!==0&&ct!==null){var w=ct,D=ua;switch(Nt){case 8:Ym(),_=6;break e;case 3:case 2:case 9:case 6:Ta.current===null&&(a=!0);var Q=Nt;if(Nt=0,ua=null,ko(n,w,D,Q),i&&yo){_=0;break e}break;default:Q=Nt,Nt=0,ua=null,ko(n,w,D,Q)}}wT(),_=Qt;break}catch(se){B0(n,se)}while(!0);return a&&n.shellSuspendCounter++,Is=fi=null,At=u,W.H=m,W.A=g,ct===null&&(Lt=null,bt=0,yu()),_}function wT(){for(;ct!==null;)F0(ct)}function ET(n,a){var i=At;At|=2;var u=H0(),m=G0();Lt!==n||bt!==a?(Yu=null,Ku=pt()+500,_o(n,a)):yo=Ia(n,a);e:do try{if(Nt!==0&&ct!==null){a=ct;var g=ua;t:switch(Nt){case 1:Nt=0,ua=null,ko(n,a,g,1);break;case 2:case 9:if(ny(g)){Nt=0,ua=null,q0(a);break}a=function(){Nt!==2&&Nt!==9||Lt!==n||(Nt=7),rs(n)},g.then(a,a);break e;case 3:Nt=7;break e;case 4:Nt=5;break e;case 7:ny(g)?(Nt=0,ua=null,q0(a)):(Nt=0,ua=null,ko(n,a,g,7));break;case 5:var _=null;switch(ct.tag){case 26:_=ct.memoizedState;case 5:case 27:var w=ct;if(!_||Sx(_)){Nt=0,ua=null;var D=w.sibling;if(D!==null)ct=D;else{var Q=w.return;Q!==null?(ct=Q,Xu(Q)):ct=null}break t}}Nt=0,ua=null,ko(n,a,g,5);break;case 6:Nt=0,ua=null,ko(n,a,g,6);break;case 8:Ym(),Qt=6;break e;default:throw Error(r(462))}}ST();break}catch(se){B0(n,se)}while(!0);return Is=fi=null,W.H=u,W.A=m,At=i,ct!==null?0:(Lt=null,bt=0,yu(),Qt)}function ST(){for(;ct!==null&&!gt();)F0(ct)}function F0(n){var a=y0(n.alternate,n,Us);n.memoizedProps=n.pendingProps,a===null?Xu(n):ct=a}function q0(n){var a=n,i=a.alternate;switch(a.tag){case 15:case 0:a=d0(i,a,a.pendingProps,a.type,void 0,bt);break;case 11:a=d0(i,a,a.pendingProps,a.type.render,a.ref,bt);break;case 5:dm(a);default:v0(i,a),a=ct=$p(a,Us),a=y0(i,a,Us)}n.memoizedProps=n.pendingProps,a===null?Xu(n):ct=a}function ko(n,a,i,u){Is=fi=null,dm(a),mo=null,Ml=0;var m=a.return;try{if(gT(n,m,a,i,bt)){Qt=1,Bu(n,va(i,n.current)),ct=null;return}}catch(g){if(m!==null)throw ct=m,g;Qt=1,Bu(n,va(i,n.current)),ct=null;return}a.flags&32768?(wt||u===1?n=!0:yo||(bt&536870912)!==0?n=!1:(gr=n=!0,(u===2||u===9||u===3||u===6)&&(u=Ta.current,u!==null&&u.tag===13&&(u.flags|=16384))),$0(a,n)):Xu(a)}function Xu(n){var a=n;do{if((a.flags&32768)!==0){$0(a,gr);return}n=a.return;var i=yT(a.alternate,a,Us);if(i!==null){ct=i;return}if(a=a.sibling,a!==null){ct=a;return}ct=a=n}while(a!==null);Qt===0&&(Qt=5)}function $0(n,a){do{var i=xT(n.alternate,n);if(i!==null){i.flags&=32767,ct=i;return}if(i=n.return,i!==null&&(i.flags|=32768,i.subtreeFlags=0,i.deletions=null),!a&&(n=n.sibling,n!==null)){ct=n;return}ct=n=i}while(n!==null);Qt=6,ct=null}function K0(n,a,i,u,m,g,_,w,D){n.cancelPendingCommit=null;do Zu();while(Rn!==0);if((At&6)!==0)throw Error(r(327));if(a!==null){if(a===n.current)throw Error(r(177));if(g=a.lanes|a.childLanes,g|=Uh,Oe(n,i,g,_,w,D),n===Lt&&(ct=Lt=null,bt=0),vo=a,xr=n,bo=i,qm=g,$m=m,z0=u,(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?(n.callbackNode=null,n.callbackPriority=0,jT(Gt,function(){return W0(),null})):(n.callbackNode=null,n.callbackPriority=0),u=(a.flags&13878)!==0,(a.subtreeFlags&13878)!==0||u){u=W.T,W.T=null,m=de.p,de.p=2,_=At,At|=4;try{vT(n,a,i)}finally{At=_,de.p=m,W.T=u}}Rn=1,Y0(),Q0(),X0()}}function Y0(){if(Rn===1){Rn=0;var n=xr,a=vo,i=(a.flags&13878)!==0;if((a.subtreeFlags&13878)!==0||i){i=W.T,W.T=null;var u=de.p;de.p=2;var m=At;At|=4;try{j0(a,n);var g=cf,_=Pp(n.containerInfo),w=g.focusedElem,D=g.selectionRange;if(_!==w&&w&&w.ownerDocument&&Op(w.ownerDocument.documentElement,w)){if(D!==null&&Oh(w)){var Q=D.start,se=D.end;if(se===void 0&&(se=Q),"selectionStart"in w)w.selectionStart=Q,w.selectionEnd=Math.min(se,w.value.length);else{var ce=w.ownerDocument||document,Z=ce&&ce.defaultView||window;if(Z.getSelection){var J=Z.getSelection(),Xe=w.textContent.length,Fe=Math.min(D.start,Xe),It=D.end===void 0?Fe:Math.min(D.end,Xe);!J.extend&&Fe>It&&(_=It,It=Fe,Fe=_);var G=Mp(w,Fe),V=Mp(w,It);if(G&&V&&(J.rangeCount!==1||J.anchorNode!==G.node||J.anchorOffset!==G.offset||J.focusNode!==V.node||J.focusOffset!==V.offset)){var Y=ce.createRange();Y.setStart(G.node,G.offset),J.removeAllRanges(),Fe>It?(J.addRange(Y),J.extend(V.node,V.offset)):(Y.setEnd(V.node,V.offset),J.addRange(Y))}}}}for(ce=[],J=w;J=J.parentNode;)J.nodeType===1&&ce.push({element:J,left:J.scrollLeft,top:J.scrollTop});for(typeof w.focus=="function"&&w.focus(),w=0;w<ce.length;w++){var ie=ce[w];ie.element.scrollLeft=ie.left,ie.element.scrollTop=ie.top}}cd=!!lf,cf=lf=null}finally{At=m,de.p=u,W.T=i}}n.current=a,Rn=2}}function Q0(){if(Rn===2){Rn=0;var n=xr,a=vo,i=(a.flags&8772)!==0;if((a.subtreeFlags&8772)!==0||i){i=W.T,W.T=null;var u=de.p;de.p=2;var m=At;At|=4;try{S0(n,a.alternate,a)}finally{At=m,de.p=u,W.T=i}}Rn=3}}function X0(){if(Rn===4||Rn===3){Rn=0,Je();var n=xr,a=vo,i=bo,u=z0;(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?Rn=5:(Rn=0,vo=xr=null,Z0(n,n.pendingLanes));var m=n.pendingLanes;if(m===0&&(yr=null),De(i),a=a.stateNode,ft&&typeof ft.onCommitFiberRoot=="function")try{ft.onCommitFiberRoot(st,a,void 0,(a.current.flags&128)===128)}catch{}if(u!==null){a=W.T,m=de.p,de.p=2,W.T=null;try{for(var g=n.onRecoverableError,_=0;_<u.length;_++){var w=u[_];g(w.value,{componentStack:w.stack})}}finally{W.T=a,de.p=m}}(bo&3)!==0&&Zu(),rs(n),m=n.pendingLanes,(i&4194090)!==0&&(m&42)!==0?n===Km?Gl++:(Gl=0,Km=n):Gl=0,Fl(0)}}function Z0(n,a){(n.pooledCacheLanes&=a)===0&&(a=n.pooledCache,a!=null&&(n.pooledCache=null,Tl(a)))}function Zu(n){return Y0(),Q0(),X0(),W0()}function W0(){if(Rn!==5)return!1;var n=xr,a=qm;qm=0;var i=De(bo),u=W.T,m=de.p;try{de.p=32>i?32:i,W.T=null,i=$m,$m=null;var g=xr,_=bo;if(Rn=0,vo=xr=null,bo=0,(At&6)!==0)throw Error(r(331));var w=At;if(At|=4,O0(g.current),I0(g,g.current,_,i),At=w,Fl(0,!1),ft&&typeof ft.onPostCommitFiberRoot=="function")try{ft.onPostCommitFiberRoot(st,g)}catch{}return!0}finally{de.p=m,W.T=u,Z0(n,a)}}function J0(n,a,i){a=va(i,a),a=Em(n.stateNode,a,2),n=lr(n,a,2),n!==null&&(ke(n,2),rs(n))}function Pt(n,a,i){if(n.tag===3)J0(n,n,i);else for(;a!==null;){if(a.tag===3){J0(a,n,i);break}else if(a.tag===1){var u=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof u.componentDidCatch=="function"&&(yr===null||!yr.has(u))){n=va(i,n),i=a0(2),u=lr(a,i,2),u!==null&&(s0(i,u,a,n),ke(u,2),rs(u));break}}a=a.return}}function Zm(n,a,i){var u=n.pingCache;if(u===null){u=n.pingCache=new kT;var m=new Set;u.set(a,m)}else m=u.get(a),m===void 0&&(m=new Set,u.set(a,m));m.has(i)||(Bm=!0,m.add(i),n=AT.bind(null,n,a,i),a.then(n,n))}function AT(n,a,i){var u=n.pingCache;u!==null&&u.delete(a),n.pingedLanes|=n.suspendedLanes&i,n.warmLanes&=~i,Lt===n&&(bt&i)===i&&(Qt===4||Qt===3&&(bt&62914560)===bt&&300>pt()-Fm?(At&2)===0&&_o(n,0):Hm|=i,xo===bt&&(xo=0)),rs(n)}function ex(n,a){a===0&&(a=vs()),n=no(n,a),n!==null&&(ke(n,a),rs(n))}function NT(n){var a=n.memoizedState,i=0;a!==null&&(i=a.retryLane),ex(n,i)}function RT(n,a){var i=0;switch(n.tag){case 13:var u=n.stateNode,m=n.memoizedState;m!==null&&(i=m.retryLane);break;case 19:u=n.stateNode;break;case 22:u=n.stateNode._retryCache;break;default:throw Error(r(314))}u!==null&&u.delete(a),ex(n,i)}function jT(n,a){return Me(n,a)}var Wu=null,To=null,Wm=!1,Ju=!1,Jm=!1,_i=0;function rs(n){n!==To&&n.next===null&&(To===null?Wu=To=n:To=To.next=n),Ju=!0,Wm||(Wm=!0,IT())}function Fl(n,a){if(!Jm&&Ju){Jm=!0;do for(var i=!1,u=Wu;u!==null;){if(n!==0){var m=u.pendingLanes;if(m===0)var g=0;else{var _=u.suspendedLanes,w=u.pingedLanes;g=(1<<31-Xt(42|n)+1)-1,g&=m&~(_&~w),g=g&201326741?g&201326741|1:g?g|2:0}g!==0&&(i=!0,sx(u,g))}else g=bt,g=Ga(u,u===Lt?g:0,u.cancelPendingCommit!==null||u.timeoutHandle!==-1),(g&3)===0||Ia(u,g)||(i=!0,sx(u,g));u=u.next}while(i);Jm=!1}}function CT(){tx()}function tx(){Ju=Wm=!1;var n=0;_i!==0&&(UT()&&(n=_i),_i=0);for(var a=pt(),i=null,u=Wu;u!==null;){var m=u.next,g=nx(u,a);g===0?(u.next=null,i===null?Wu=m:i.next=m,m===null&&(To=i)):(i=u,(n!==0||(g&3)!==0)&&(Ju=!0)),u=m}Fl(n)}function nx(n,a){for(var i=n.suspendedLanes,u=n.pingedLanes,m=n.expirationTimes,g=n.pendingLanes&-62914561;0<g;){var _=31-Xt(g),w=1<<_,D=m[_];D===-1?((w&i)===0||(w&u)!==0)&&(m[_]=xs(w,a)):D<=a&&(n.expiredLanes|=w),g&=~w}if(a=Lt,i=bt,i=Ga(n,n===a?i:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),u=n.callbackNode,i===0||n===a&&(Nt===2||Nt===9)||n.cancelPendingCommit!==null)return u!==null&&u!==null&&Ie(u),n.callbackNode=null,n.callbackPriority=0;if((i&3)===0||Ia(n,i)){if(a=i&-i,a===n.callbackPriority)return a;switch(u!==null&&Ie(u),De(i)){case 2:case 8:i=Mt;break;case 32:i=Gt;break;case 268435456:i=yn;break;default:i=Gt}return u=ax.bind(null,n),i=Me(i,u),n.callbackPriority=a,n.callbackNode=i,a}return u!==null&&u!==null&&Ie(u),n.callbackPriority=2,n.callbackNode=null,2}function ax(n,a){if(Rn!==0&&Rn!==5)return n.callbackNode=null,n.callbackPriority=0,null;var i=n.callbackNode;if(Zu()&&n.callbackNode!==i)return null;var u=bt;return u=Ga(n,n===Lt?u:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),u===0?null:(V0(n,u,a),nx(n,pt()),n.callbackNode!=null&&n.callbackNode===i?ax.bind(null,n):null)}function sx(n,a){if(Zu())return null;V0(n,a,!0)}function IT(){HT(function(){(At&6)!==0?Me(it,CT):tx()})}function ef(){return _i===0&&(_i=Fa()),_i}function rx(n){return n==null||typeof n=="symbol"||typeof n=="boolean"?null:typeof n=="function"?n:Fi(""+n)}function ix(n,a){var i=a.ownerDocument.createElement("input");return i.name=a.name,i.value=a.value,n.id&&i.setAttribute("form",n.id),a.parentNode.insertBefore(i,a),n=new FormData(n),i.parentNode.removeChild(i),n}function DT(n,a,i,u,m){if(a==="submit"&&i&&i.stateNode===m){var g=rx((m[Ae]||null).action),_=u.submitter;_&&(a=(a=_[Ae]||null)?rx(a.formAction):_.getAttribute("formAction"),a!==null&&(g=a,_=null));var w=new qi("action","action",null,u,m);n.push({event:w,listeners:[{instance:null,listener:function(){if(u.defaultPrevented){if(_i!==0){var D=_?ix(m,_):new FormData(m);bm(i,{pending:!0,data:D,method:m.method,action:g},null,D)}}else typeof g=="function"&&(w.preventDefault(),D=_?ix(m,_):new FormData(m),bm(i,{pending:!0,data:D,method:m.method,action:g},g,D))},currentTarget:m}]})}}for(var tf=0;tf<Vh.length;tf++){var nf=Vh[tf],MT=nf.toLowerCase(),OT=nf[0].toUpperCase()+nf.slice(1);Ma(MT,"on"+OT)}Ma(Vp,"onAnimationEnd"),Ma(Up,"onAnimationIteration"),Ma(Bp,"onAnimationStart"),Ma("dblclick","onDoubleClick"),Ma("focusin","onFocus"),Ma("focusout","onBlur"),Ma(Wk,"onTransitionRun"),Ma(Jk,"onTransitionStart"),Ma(eT,"onTransitionCancel"),Ma(Hp,"onTransitionEnd"),Pn("onMouseEnter",["mouseout","mouseover"]),Pn("onMouseLeave",["mouseout","mouseover"]),Pn("onPointerEnter",["pointerout","pointerover"]),Pn("onPointerLeave",["pointerout","pointerover"]),nt("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),nt("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),nt("onBeforeInput",["compositionend","keypress","textInput","paste"]),nt("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),nt("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),nt("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ql="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),PT=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(ql));function ox(n,a){a=(a&4)!==0;for(var i=0;i<n.length;i++){var u=n[i],m=u.event;u=u.listeners;e:{var g=void 0;if(a)for(var _=u.length-1;0<=_;_--){var w=u[_],D=w.instance,Q=w.currentTarget;if(w=w.listener,D!==g&&m.isPropagationStopped())break e;g=w,m.currentTarget=Q;try{g(m)}catch(se){Uu(se)}m.currentTarget=null,g=D}else for(_=0;_<u.length;_++){if(w=u[_],D=w.instance,Q=w.currentTarget,w=w.listener,D!==g&&m.isPropagationStopped())break e;g=w,m.currentTarget=Q;try{g(m)}catch(se){Uu(se)}m.currentTarget=null,g=D}}}}function ut(n,a){var i=a[we];i===void 0&&(i=a[we]=new Set);var u=n+"__bubble";i.has(u)||(lx(a,n,2,!1),i.add(u))}function af(n,a,i){var u=0;a&&(u|=4),lx(i,n,u,a)}var ed="_reactListening"+Math.random().toString(36).slice(2);function sf(n){if(!n[ed]){n[ed]=!0,Ge.forEach(function(i){i!=="selectionchange"&&(PT.has(i)||af(i,!1,n),af(i,!0,n))});var a=n.nodeType===9?n:n.ownerDocument;a===null||a[ed]||(a[ed]=!0,af("selectionchange",!1,a))}}function lx(n,a,i,u){switch(Ix(a)){case 2:var m=cw;break;case 8:m=uw;break;default:m=vf}i=m.bind(null,a,i,n),m=void 0,!ya||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(m=!0),u?m!==void 0?n.addEventListener(a,i,{capture:!0,passive:m}):n.addEventListener(a,i,!0):m!==void 0?n.addEventListener(a,i,{passive:m}):n.addEventListener(a,i,!1)}function rf(n,a,i,u,m){var g=u;if((a&1)===0&&(a&2)===0&&u!==null)e:for(;;){if(u===null)return;var _=u.tag;if(_===3||_===4){var w=u.stateNode.containerInfo;if(w===m)break;if(_===4)for(_=u.return;_!==null;){var D=_.tag;if((D===3||D===4)&&_.stateNode.containerInfo===m)return;_=_.return}for(;w!==null;){if(_=Wt(w),_===null)return;if(D=_.tag,D===5||D===6||D===26||D===27){u=g=_;continue e}w=w.parentNode}}u=u.return}nu(function(){var Q=g,se=pa(i),ce=[];e:{var Z=Gp.get(n);if(Z!==void 0){var J=qi,Xe=n;switch(n){case"keypress":if(Xa(i)===0)break e;case"keydown":case"keyup":J=Zi;break;case"focusin":Xe="focus",J=Yi;break;case"focusout":Xe="blur",J=Yi;break;case"beforeblur":case"afterblur":J=Yi;break;case"click":if(i.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":J=xa;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":J=Ch;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":J=uu;break;case Vp:case Up:case Bp:J=Qi;break;case Hp:J=hu;break;case"scroll":case"scrollend":J=au;break;case"wheel":J=Wi;break;case"copy":case"cut":case"paste":J=Xi;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":J=gl;break;case"toggle":case"beforetoggle":J=fu}var Fe=(a&4)!==0,It=!Fe&&(n==="scroll"||n==="scrollend"),G=Fe?Z!==null?Z+"Capture":null:Z;Fe=[];for(var V=Q,Y;V!==null;){var ie=V;if(Y=ie.stateNode,ie=ie.tag,ie!==5&&ie!==26&&ie!==27||Y===null||G===null||(ie=ei(V,G),ie!=null&&Fe.push($l(V,ie,Y))),It)break;V=V.return}0<Fe.length&&(Z=new J(Z,Xe,null,i,se),ce.push({event:Z,listeners:Fe}))}}if((a&7)===0){e:{if(Z=n==="mouseover"||n==="pointerover",J=n==="mouseout"||n==="pointerout",Z&&i!==Ts&&(Xe=i.relatedTarget||i.fromElement)&&(Wt(Xe)||Xe[Pe]))break e;if((J||Z)&&(Z=se.window===se?se:(Z=se.ownerDocument)?Z.defaultView||Z.parentWindow:window,J?(Xe=i.relatedTarget||i.toElement,J=Q,Xe=Xe?Wt(Xe):null,Xe!==null&&(It=c(Xe),Fe=Xe.tag,Xe!==It||Fe!==5&&Fe!==27&&Fe!==6)&&(Xe=null)):(J=null,Xe=Q),J!==Xe)){if(Fe=xa,ie="onMouseLeave",G="onMouseEnter",V="mouse",(n==="pointerout"||n==="pointerover")&&(Fe=gl,ie="onPointerLeave",G="onPointerEnter",V="pointer"),It=J==null?Z:xn(J),Y=Xe==null?Z:xn(Xe),Z=new Fe(ie,V+"leave",J,i,se),Z.target=It,Z.relatedTarget=Y,ie=null,Wt(se)===Q&&(Fe=new Fe(G,V+"enter",Xe,i,se),Fe.target=Y,Fe.relatedTarget=It,ie=Fe),It=ie,J&&Xe)t:{for(Fe=J,G=Xe,V=0,Y=Fe;Y;Y=wo(Y))V++;for(Y=0,ie=G;ie;ie=wo(ie))Y++;for(;0<V-Y;)Fe=wo(Fe),V--;for(;0<Y-V;)G=wo(G),Y--;for(;V--;){if(Fe===G||G!==null&&Fe===G.alternate)break t;Fe=wo(Fe),G=wo(G)}Fe=null}else Fe=null;J!==null&&cx(ce,Z,J,Fe,!1),Xe!==null&&It!==null&&cx(ce,It,Xe,Fe,!0)}}e:{if(Z=Q?xn(Q):window,J=Z.nodeName&&Z.nodeName.toLowerCase(),J==="select"||J==="input"&&Z.type==="file")var Ce=Np;else if(mn(Z))if(Rp)Ce=Qk;else{Ce=Kk;var lt=$k}else J=Z.nodeName,!J||J.toLowerCase()!=="input"||Z.type!=="checkbox"&&Z.type!=="radio"?Q&&ll(Q.elementType)&&(Ce=Np):Ce=Yk;if(Ce&&(Ce=Ce(n,Q))){Ns(ce,Ce,i,se);break e}lt&&lt(n,Z,Q),n==="focusout"&&Q&&Z.type==="number"&&Q.memoizedProps.value!=null&&ar(Z,"number",Z.value)}switch(lt=Q?xn(Q):window,n){case"focusin":(mn(lt)||lt.contentEditable==="true")&&(Ji=lt,Ph=Q,xl=null);break;case"focusout":xl=Ph=Ji=null;break;case"mousedown":zh=!0;break;case"contextmenu":case"mouseup":case"dragend":zh=!1,zp(ce,i,se);break;case"selectionchange":if(Zk)break;case"keydown":case"keyup":zp(ce,i,se)}var ze;if(Ja)e:{switch(n){case"compositionstart":var qe="onCompositionStart";break e;case"compositionend":qe="onCompositionEnd";break e;case"compositionupdate":qe="onCompositionUpdate";break e}qe=void 0}else xt?te(n,i)&&(qe="onCompositionEnd"):n==="keydown"&&i.keyCode===229&&(qe="onCompositionStart");qe&&(b&&i.locale!=="ko"&&(xt||qe!=="onCompositionStart"?qe==="onCompositionEnd"&&xt&&(ze=ul()):(Qa=se,sr="value"in Qa?Qa.value:Qa.textContent,xt=!0)),lt=td(Q,qe),0<lt.length&&(qe=new ml(qe,n,null,i,se),ce.push({event:qe,listeners:lt}),ze?qe.data=ze:(ze=ve(i),ze!==null&&(qe.data=ze)))),(ze=x?hn(n,i):vt(n,i))&&(qe=td(Q,"onBeforeInput"),0<qe.length&&(lt=new ml("onBeforeInput","beforeinput",null,i,se),ce.push({event:lt,listeners:qe}),lt.data=ze)),DT(ce,n,Q,i,se)}ox(ce,a)})}function $l(n,a,i){return{instance:n,listener:a,currentTarget:i}}function td(n,a){for(var i=a+"Capture",u=[];n!==null;){var m=n,g=m.stateNode;if(m=m.tag,m!==5&&m!==26&&m!==27||g===null||(m=ei(n,i),m!=null&&u.unshift($l(n,m,g)),m=ei(n,a),m!=null&&u.push($l(n,m,g))),n.tag===3)return u;n=n.return}return[]}function wo(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5&&n.tag!==27);return n||null}function cx(n,a,i,u,m){for(var g=a._reactName,_=[];i!==null&&i!==u;){var w=i,D=w.alternate,Q=w.stateNode;if(w=w.tag,D!==null&&D===u)break;w!==5&&w!==26&&w!==27||Q===null||(D=Q,m?(Q=ei(i,g),Q!=null&&_.unshift($l(i,Q,D))):m||(Q=ei(i,g),Q!=null&&_.push($l(i,Q,D)))),i=i.return}_.length!==0&&n.push({event:a,listeners:_})}var zT=/\r\n?/g,LT=/\u0000|\uFFFD/g;function ux(n){return(typeof n=="string"?n:""+n).replace(zT,`
`).replace(LT,"")}function dx(n,a){return a=ux(a),ux(n)===a}function nd(){}function Ct(n,a,i,u,m,g){switch(i){case"children":typeof u=="string"?a==="body"||a==="textarea"&&u===""||ga(n,u):(typeof u=="number"||typeof u=="bigint")&&a!=="body"&&ga(n,""+u);break;case"className":Ka(n,"class",u);break;case"tabIndex":Ka(n,"tabindex",u);break;case"dir":case"role":case"viewBox":case"width":case"height":Ka(n,i,u);break;case"style":ol(n,u,g);break;case"data":if(a!=="object"){Ka(n,"data",u);break}case"src":case"href":if(u===""&&(a!=="a"||i!=="href")){n.removeAttribute(i);break}if(u==null||typeof u=="function"||typeof u=="symbol"||typeof u=="boolean"){n.removeAttribute(i);break}u=Fi(""+u),n.setAttribute(i,u);break;case"action":case"formAction":if(typeof u=="function"){n.setAttribute(i,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof g=="function"&&(i==="formAction"?(a!=="input"&&Ct(n,a,"name",m.name,m,null),Ct(n,a,"formEncType",m.formEncType,m,null),Ct(n,a,"formMethod",m.formMethod,m,null),Ct(n,a,"formTarget",m.formTarget,m,null)):(Ct(n,a,"encType",m.encType,m,null),Ct(n,a,"method",m.method,m,null),Ct(n,a,"target",m.target,m,null)));if(u==null||typeof u=="symbol"||typeof u=="boolean"){n.removeAttribute(i);break}u=Fi(""+u),n.setAttribute(i,u);break;case"onClick":u!=null&&(n.onclick=nd);break;case"onScroll":u!=null&&ut("scroll",n);break;case"onScrollEnd":u!=null&&ut("scrollend",n);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(r(61));if(i=u.__html,i!=null){if(m.children!=null)throw Error(r(60));n.innerHTML=i}}break;case"multiple":n.multiple=u&&typeof u!="function"&&typeof u!="symbol";break;case"muted":n.muted=u&&typeof u!="function"&&typeof u!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(u==null||typeof u=="function"||typeof u=="boolean"||typeof u=="symbol"){n.removeAttribute("xlink:href");break}i=Fi(""+u),n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",i);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":u!=null&&typeof u!="function"&&typeof u!="symbol"?n.setAttribute(i,""+u):n.removeAttribute(i);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":u&&typeof u!="function"&&typeof u!="symbol"?n.setAttribute(i,""):n.removeAttribute(i);break;case"capture":case"download":u===!0?n.setAttribute(i,""):u!==!1&&u!=null&&typeof u!="function"&&typeof u!="symbol"?n.setAttribute(i,u):n.removeAttribute(i);break;case"cols":case"rows":case"size":case"span":u!=null&&typeof u!="function"&&typeof u!="symbol"&&!isNaN(u)&&1<=u?n.setAttribute(i,u):n.removeAttribute(i);break;case"rowSpan":case"start":u==null||typeof u=="function"||typeof u=="symbol"||isNaN(u)?n.removeAttribute(i):n.setAttribute(i,u);break;case"popover":ut("beforetoggle",n),ut("toggle",n),nr(n,"popover",u);break;case"xlinkActuate":Sn(n,"http://www.w3.org/1999/xlink","xlink:actuate",u);break;case"xlinkArcrole":Sn(n,"http://www.w3.org/1999/xlink","xlink:arcrole",u);break;case"xlinkRole":Sn(n,"http://www.w3.org/1999/xlink","xlink:role",u);break;case"xlinkShow":Sn(n,"http://www.w3.org/1999/xlink","xlink:show",u);break;case"xlinkTitle":Sn(n,"http://www.w3.org/1999/xlink","xlink:title",u);break;case"xlinkType":Sn(n,"http://www.w3.org/1999/xlink","xlink:type",u);break;case"xmlBase":Sn(n,"http://www.w3.org/XML/1998/namespace","xml:base",u);break;case"xmlLang":Sn(n,"http://www.w3.org/XML/1998/namespace","xml:lang",u);break;case"xmlSpace":Sn(n,"http://www.w3.org/XML/1998/namespace","xml:space",u);break;case"is":nr(n,"is",u);break;case"innerText":case"textContent":break;default:(!(2<i.length)||i[0]!=="o"&&i[0]!=="O"||i[1]!=="n"&&i[1]!=="N")&&(i=Rh.get(i)||i,nr(n,i,u))}}function of(n,a,i,u,m,g){switch(i){case"style":ol(n,u,g);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(r(61));if(i=u.__html,i!=null){if(m.children!=null)throw Error(r(60));n.innerHTML=i}}break;case"children":typeof u=="string"?ga(n,u):(typeof u=="number"||typeof u=="bigint")&&ga(n,""+u);break;case"onScroll":u!=null&&ut("scroll",n);break;case"onScrollEnd":u!=null&&ut("scrollend",n);break;case"onClick":u!=null&&(n.onclick=nd);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!xe.hasOwnProperty(i))e:{if(i[0]==="o"&&i[1]==="n"&&(m=i.endsWith("Capture"),a=i.slice(2,m?i.length-7:void 0),g=n[Ae]||null,g=g!=null?g[i]:null,typeof g=="function"&&n.removeEventListener(a,g,m),typeof u=="function")){typeof g!="function"&&g!==null&&(i in n?n[i]=null:n.hasAttribute(i)&&n.removeAttribute(i)),n.addEventListener(a,u,m);break e}i in n?n[i]=u:u===!0?n.setAttribute(i,""):nr(n,i,u)}}}function jn(n,a,i){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":ut("error",n),ut("load",n);var u=!1,m=!1,g;for(g in i)if(i.hasOwnProperty(g)){var _=i[g];if(_!=null)switch(g){case"src":u=!0;break;case"srcSet":m=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,a));default:Ct(n,a,g,_,i,null)}}m&&Ct(n,a,"srcSet",i.srcSet,i,null),u&&Ct(n,a,"src",i.src,i,null);return;case"input":ut("invalid",n);var w=g=_=m=null,D=null,Q=null;for(u in i)if(i.hasOwnProperty(u)){var se=i[u];if(se!=null)switch(u){case"name":m=se;break;case"type":_=se;break;case"checked":D=se;break;case"defaultChecked":Q=se;break;case"value":g=se;break;case"defaultValue":w=se;break;case"children":case"dangerouslySetInnerHTML":if(se!=null)throw Error(r(137,a));break;default:Ct(n,a,u,se,i,null)}}Zr(n,g,w,D,Q,_,m,!1),Gi(n);return;case"select":ut("invalid",n),u=_=g=null;for(m in i)if(i.hasOwnProperty(m)&&(w=i[m],w!=null))switch(m){case"value":g=w;break;case"defaultValue":_=w;break;case"multiple":u=w;default:Ct(n,a,m,w,i,null)}a=g,i=_,n.multiple=!!u,a!=null?ks(n,!!u,a,!1):i!=null&&ks(n,!!u,i,!0);return;case"textarea":ut("invalid",n),g=m=u=null;for(_ in i)if(i.hasOwnProperty(_)&&(w=i[_],w!=null))switch(_){case"value":u=w;break;case"defaultValue":m=w;break;case"children":g=w;break;case"dangerouslySetInnerHTML":if(w!=null)throw Error(r(91));break;default:Ct(n,a,_,w,i,null)}Wr(n,u,m,g),Gi(n);return;case"option":for(D in i)if(i.hasOwnProperty(D)&&(u=i[D],u!=null))switch(D){case"selected":n.selected=u&&typeof u!="function"&&typeof u!="symbol";break;default:Ct(n,a,D,u,i,null)}return;case"dialog":ut("beforetoggle",n),ut("toggle",n),ut("cancel",n),ut("close",n);break;case"iframe":case"object":ut("load",n);break;case"video":case"audio":for(u=0;u<ql.length;u++)ut(ql[u],n);break;case"image":ut("error",n),ut("load",n);break;case"details":ut("toggle",n);break;case"embed":case"source":case"link":ut("error",n),ut("load",n);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Q in i)if(i.hasOwnProperty(Q)&&(u=i[Q],u!=null))switch(Q){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,a));default:Ct(n,a,Q,u,i,null)}return;default:if(ll(a)){for(se in i)i.hasOwnProperty(se)&&(u=i[se],u!==void 0&&of(n,a,se,u,i,void 0));return}}for(w in i)i.hasOwnProperty(w)&&(u=i[w],u!=null&&Ct(n,a,w,u,i,null))}function VT(n,a,i,u){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var m=null,g=null,_=null,w=null,D=null,Q=null,se=null;for(J in i){var ce=i[J];if(i.hasOwnProperty(J)&&ce!=null)switch(J){case"checked":break;case"value":break;case"defaultValue":D=ce;default:u.hasOwnProperty(J)||Ct(n,a,J,null,u,ce)}}for(var Z in u){var J=u[Z];if(ce=i[Z],u.hasOwnProperty(Z)&&(J!=null||ce!=null))switch(Z){case"type":g=J;break;case"name":m=J;break;case"checked":Q=J;break;case"defaultChecked":se=J;break;case"value":_=J;break;case"defaultValue":w=J;break;case"children":case"dangerouslySetInnerHTML":if(J!=null)throw Error(r(137,a));break;default:J!==ce&&Ct(n,a,Z,J,u,ce)}}ra(n,_,w,D,Q,se,g,m);return;case"select":J=_=w=Z=null;for(g in i)if(D=i[g],i.hasOwnProperty(g)&&D!=null)switch(g){case"value":break;case"multiple":J=D;default:u.hasOwnProperty(g)||Ct(n,a,g,null,u,D)}for(m in u)if(g=u[m],D=i[m],u.hasOwnProperty(m)&&(g!=null||D!=null))switch(m){case"value":Z=g;break;case"defaultValue":w=g;break;case"multiple":_=g;default:g!==D&&Ct(n,a,m,g,u,D)}a=w,i=_,u=J,Z!=null?ks(n,!!i,Z,!1):!!u!=!!i&&(a!=null?ks(n,!!i,a,!0):ks(n,!!i,i?[]:"",!1));return;case"textarea":J=Z=null;for(w in i)if(m=i[w],i.hasOwnProperty(w)&&m!=null&&!u.hasOwnProperty(w))switch(w){case"value":break;case"children":break;default:Ct(n,a,w,null,u,m)}for(_ in u)if(m=u[_],g=i[_],u.hasOwnProperty(_)&&(m!=null||g!=null))switch(_){case"value":Z=m;break;case"defaultValue":J=m;break;case"children":break;case"dangerouslySetInnerHTML":if(m!=null)throw Error(r(91));break;default:m!==g&&Ct(n,a,_,m,u,g)}Rt(n,Z,J);return;case"option":for(var Xe in i)if(Z=i[Xe],i.hasOwnProperty(Xe)&&Z!=null&&!u.hasOwnProperty(Xe))switch(Xe){case"selected":n.selected=!1;break;default:Ct(n,a,Xe,null,u,Z)}for(D in u)if(Z=u[D],J=i[D],u.hasOwnProperty(D)&&Z!==J&&(Z!=null||J!=null))switch(D){case"selected":n.selected=Z&&typeof Z!="function"&&typeof Z!="symbol";break;default:Ct(n,a,D,Z,u,J)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Fe in i)Z=i[Fe],i.hasOwnProperty(Fe)&&Z!=null&&!u.hasOwnProperty(Fe)&&Ct(n,a,Fe,null,u,Z);for(Q in u)if(Z=u[Q],J=i[Q],u.hasOwnProperty(Q)&&Z!==J&&(Z!=null||J!=null))switch(Q){case"children":case"dangerouslySetInnerHTML":if(Z!=null)throw Error(r(137,a));break;default:Ct(n,a,Q,Z,u,J)}return;default:if(ll(a)){for(var It in i)Z=i[It],i.hasOwnProperty(It)&&Z!==void 0&&!u.hasOwnProperty(It)&&of(n,a,It,void 0,u,Z);for(se in u)Z=u[se],J=i[se],!u.hasOwnProperty(se)||Z===J||Z===void 0&&J===void 0||of(n,a,se,Z,u,J);return}}for(var G in i)Z=i[G],i.hasOwnProperty(G)&&Z!=null&&!u.hasOwnProperty(G)&&Ct(n,a,G,null,u,Z);for(ce in u)Z=u[ce],J=i[ce],!u.hasOwnProperty(ce)||Z===J||Z==null&&J==null||Ct(n,a,ce,Z,u,J)}var lf=null,cf=null;function ad(n){return n.nodeType===9?n:n.ownerDocument}function hx(n){switch(n){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function mx(n,a){if(n===0)switch(a){case"svg":return 1;case"math":return 2;default:return 0}return n===1&&a==="foreignObject"?0:n}function uf(n,a){return n==="textarea"||n==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.children=="bigint"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var df=null;function UT(){var n=window.event;return n&&n.type==="popstate"?n===df?!1:(df=n,!0):(df=null,!1)}var fx=typeof setTimeout=="function"?setTimeout:void 0,BT=typeof clearTimeout=="function"?clearTimeout:void 0,gx=typeof Promise=="function"?Promise:void 0,HT=typeof queueMicrotask=="function"?queueMicrotask:typeof gx<"u"?function(n){return gx.resolve(null).then(n).catch(GT)}:fx;function GT(n){setTimeout(function(){throw n})}function br(n){return n==="head"}function px(n,a){var i=a,u=0,m=0;do{var g=i.nextSibling;if(n.removeChild(i),g&&g.nodeType===8)if(i=g.data,i==="/$"){if(0<u&&8>u){i=u;var _=n.ownerDocument;if(i&1&&Kl(_.documentElement),i&2&&Kl(_.body),i&4)for(i=_.head,Kl(i),_=i.firstChild;_;){var w=_.nextSibling,D=_.nodeName;_[Ft]||D==="SCRIPT"||D==="STYLE"||D==="LINK"&&_.rel.toLowerCase()==="stylesheet"||i.removeChild(_),_=w}}if(m===0){n.removeChild(g),tc(a);return}m--}else i==="$"||i==="$?"||i==="$!"?m++:u=i.charCodeAt(0)-48;else u=0;i=g}while(i);tc(a)}function hf(n){var a=n.firstChild;for(a&&a.nodeType===10&&(a=a.nextSibling);a;){var i=a;switch(a=a.nextSibling,i.nodeName){case"HTML":case"HEAD":case"BODY":hf(i),Zt(i);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(i.rel.toLowerCase()==="stylesheet")continue}n.removeChild(i)}}function FT(n,a,i,u){for(;n.nodeType===1;){var m=i;if(n.nodeName.toLowerCase()!==a.toLowerCase()){if(!u&&(n.nodeName!=="INPUT"||n.type!=="hidden"))break}else if(u){if(!n[Ft])switch(a){case"meta":if(!n.hasAttribute("itemprop"))break;return n;case"link":if(g=n.getAttribute("rel"),g==="stylesheet"&&n.hasAttribute("data-precedence"))break;if(g!==m.rel||n.getAttribute("href")!==(m.href==null||m.href===""?null:m.href)||n.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin)||n.getAttribute("title")!==(m.title==null?null:m.title))break;return n;case"style":if(n.hasAttribute("data-precedence"))break;return n;case"script":if(g=n.getAttribute("src"),(g!==(m.src==null?null:m.src)||n.getAttribute("type")!==(m.type==null?null:m.type)||n.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin))&&g&&n.hasAttribute("async")&&!n.hasAttribute("itemprop"))break;return n;default:return n}}else if(a==="input"&&n.type==="hidden"){var g=m.name==null?null:""+m.name;if(m.type==="hidden"&&n.getAttribute("name")===g)return n}else return n;if(n=Pa(n.nextSibling),n===null)break}return null}function qT(n,a,i){if(a==="")return null;for(;n.nodeType!==3;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!i||(n=Pa(n.nextSibling),n===null))return null;return n}function mf(n){return n.data==="$!"||n.data==="$?"&&n.ownerDocument.readyState==="complete"}function $T(n,a){var i=n.ownerDocument;if(n.data!=="$?"||i.readyState==="complete")a();else{var u=function(){a(),i.removeEventListener("DOMContentLoaded",u)};i.addEventListener("DOMContentLoaded",u),n._reactRetry=u}}function Pa(n){for(;n!=null;n=n.nextSibling){var a=n.nodeType;if(a===1||a===3)break;if(a===8){if(a=n.data,a==="$"||a==="$!"||a==="$?"||a==="F!"||a==="F")break;if(a==="/$")return null}}return n}var ff=null;function yx(n){n=n.previousSibling;for(var a=0;n;){if(n.nodeType===8){var i=n.data;if(i==="$"||i==="$!"||i==="$?"){if(a===0)return n;a--}else i==="/$"&&a++}n=n.previousSibling}return null}function xx(n,a,i){switch(a=ad(i),n){case"html":if(n=a.documentElement,!n)throw Error(r(452));return n;case"head":if(n=a.head,!n)throw Error(r(453));return n;case"body":if(n=a.body,!n)throw Error(r(454));return n;default:throw Error(r(451))}}function Kl(n){for(var a=n.attributes;a.length;)n.removeAttributeNode(a[0]);Zt(n)}var Ea=new Map,vx=new Set;function sd(n){return typeof n.getRootNode=="function"?n.getRootNode():n.nodeType===9?n:n.ownerDocument}var Bs=de.d;de.d={f:KT,r:YT,D:QT,C:XT,L:ZT,m:WT,X:ew,S:JT,M:tw};function KT(){var n=Bs.f(),a=Qu();return n||a}function YT(n){var a=dn(n);a!==null&&a.tag===5&&a.type==="form"?Vy(a):Bs.r(n)}var Eo=typeof document>"u"?null:document;function bx(n,a,i){var u=Eo;if(u&&typeof a=="string"&&a){var m=an(a);m='link[rel="'+n+'"][href="'+m+'"]',typeof i=="string"&&(m+='[crossorigin="'+i+'"]'),vx.has(m)||(vx.add(m),n={rel:n,crossOrigin:i,href:a},u.querySelector(m)===null&&(a=u.createElement("link"),jn(a,"link",n),Ot(a),u.head.appendChild(a)))}}function QT(n){Bs.D(n),bx("dns-prefetch",n,null)}function XT(n,a){Bs.C(n,a),bx("preconnect",n,a)}function ZT(n,a,i){Bs.L(n,a,i);var u=Eo;if(u&&n&&a){var m='link[rel="preload"][as="'+an(a)+'"]';a==="image"&&i&&i.imageSrcSet?(m+='[imagesrcset="'+an(i.imageSrcSet)+'"]',typeof i.imageSizes=="string"&&(m+='[imagesizes="'+an(i.imageSizes)+'"]')):m+='[href="'+an(n)+'"]';var g=m;switch(a){case"style":g=So(n);break;case"script":g=Ao(n)}Ea.has(g)||(n=v({rel:"preload",href:a==="image"&&i&&i.imageSrcSet?void 0:n,as:a},i),Ea.set(g,n),u.querySelector(m)!==null||a==="style"&&u.querySelector(Yl(g))||a==="script"&&u.querySelector(Ql(g))||(a=u.createElement("link"),jn(a,"link",n),Ot(a),u.head.appendChild(a)))}}function WT(n,a){Bs.m(n,a);var i=Eo;if(i&&n){var u=a&&typeof a.as=="string"?a.as:"script",m='link[rel="modulepreload"][as="'+an(u)+'"][href="'+an(n)+'"]',g=m;switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":g=Ao(n)}if(!Ea.has(g)&&(n=v({rel:"modulepreload",href:n},a),Ea.set(g,n),i.querySelector(m)===null)){switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(i.querySelector(Ql(g)))return}u=i.createElement("link"),jn(u,"link",n),Ot(u),i.head.appendChild(u)}}}function JT(n,a,i){Bs.S(n,a,i);var u=Eo;if(u&&n){var m=Jt(u).hoistableStyles,g=So(n);a=a||"default";var _=m.get(g);if(!_){var w={loading:0,preload:null};if(_=u.querySelector(Yl(g)))w.loading=5;else{n=v({rel:"stylesheet",href:n,"data-precedence":a},i),(i=Ea.get(g))&&gf(n,i);var D=_=u.createElement("link");Ot(D),jn(D,"link",n),D._p=new Promise(function(Q,se){D.onload=Q,D.onerror=se}),D.addEventListener("load",function(){w.loading|=1}),D.addEventListener("error",function(){w.loading|=2}),w.loading|=4,rd(_,a,u)}_={type:"stylesheet",instance:_,count:1,state:w},m.set(g,_)}}}function ew(n,a){Bs.X(n,a);var i=Eo;if(i&&n){var u=Jt(i).hoistableScripts,m=Ao(n),g=u.get(m);g||(g=i.querySelector(Ql(m)),g||(n=v({src:n,async:!0},a),(a=Ea.get(m))&&pf(n,a),g=i.createElement("script"),Ot(g),jn(g,"link",n),i.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},u.set(m,g))}}function tw(n,a){Bs.M(n,a);var i=Eo;if(i&&n){var u=Jt(i).hoistableScripts,m=Ao(n),g=u.get(m);g||(g=i.querySelector(Ql(m)),g||(n=v({src:n,async:!0,type:"module"},a),(a=Ea.get(m))&&pf(n,a),g=i.createElement("script"),Ot(g),jn(g,"link",n),i.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},u.set(m,g))}}function _x(n,a,i,u){var m=(m=Ee.current)?sd(m):null;if(!m)throw Error(r(446));switch(n){case"meta":case"title":return null;case"style":return typeof i.precedence=="string"&&typeof i.href=="string"?(a=So(i.href),i=Jt(m).hoistableStyles,u=i.get(a),u||(u={type:"style",instance:null,count:0,state:null},i.set(a,u)),u):{type:"void",instance:null,count:0,state:null};case"link":if(i.rel==="stylesheet"&&typeof i.href=="string"&&typeof i.precedence=="string"){n=So(i.href);var g=Jt(m).hoistableStyles,_=g.get(n);if(_||(m=m.ownerDocument||m,_={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},g.set(n,_),(g=m.querySelector(Yl(n)))&&!g._p&&(_.instance=g,_.state.loading=5),Ea.has(n)||(i={rel:"preload",as:"style",href:i.href,crossOrigin:i.crossOrigin,integrity:i.integrity,media:i.media,hrefLang:i.hrefLang,referrerPolicy:i.referrerPolicy},Ea.set(n,i),g||nw(m,n,i,_.state))),a&&u===null)throw Error(r(528,""));return _}if(a&&u!==null)throw Error(r(529,""));return null;case"script":return a=i.async,i=i.src,typeof i=="string"&&a&&typeof a!="function"&&typeof a!="symbol"?(a=Ao(i),i=Jt(m).hoistableScripts,u=i.get(a),u||(u={type:"script",instance:null,count:0,state:null},i.set(a,u)),u):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,n))}}function So(n){return'href="'+an(n)+'"'}function Yl(n){return'link[rel="stylesheet"]['+n+"]"}function kx(n){return v({},n,{"data-precedence":n.precedence,precedence:null})}function nw(n,a,i,u){n.querySelector('link[rel="preload"][as="style"]['+a+"]")?u.loading=1:(a=n.createElement("link"),u.preload=a,a.addEventListener("load",function(){return u.loading|=1}),a.addEventListener("error",function(){return u.loading|=2}),jn(a,"link",i),Ot(a),n.head.appendChild(a))}function Ao(n){return'[src="'+an(n)+'"]'}function Ql(n){return"script[async]"+n}function Tx(n,a,i){if(a.count++,a.instance===null)switch(a.type){case"style":var u=n.querySelector('style[data-href~="'+an(i.href)+'"]');if(u)return a.instance=u,Ot(u),u;var m=v({},i,{"data-href":i.href,"data-precedence":i.precedence,href:null,precedence:null});return u=(n.ownerDocument||n).createElement("style"),Ot(u),jn(u,"style",m),rd(u,i.precedence,n),a.instance=u;case"stylesheet":m=So(i.href);var g=n.querySelector(Yl(m));if(g)return a.state.loading|=4,a.instance=g,Ot(g),g;u=kx(i),(m=Ea.get(m))&&gf(u,m),g=(n.ownerDocument||n).createElement("link"),Ot(g);var _=g;return _._p=new Promise(function(w,D){_.onload=w,_.onerror=D}),jn(g,"link",u),a.state.loading|=4,rd(g,i.precedence,n),a.instance=g;case"script":return g=Ao(i.src),(m=n.querySelector(Ql(g)))?(a.instance=m,Ot(m),m):(u=i,(m=Ea.get(g))&&(u=v({},i),pf(u,m)),n=n.ownerDocument||n,m=n.createElement("script"),Ot(m),jn(m,"link",u),n.head.appendChild(m),a.instance=m);case"void":return null;default:throw Error(r(443,a.type))}else a.type==="stylesheet"&&(a.state.loading&4)===0&&(u=a.instance,a.state.loading|=4,rd(u,i.precedence,n));return a.instance}function rd(n,a,i){for(var u=i.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),m=u.length?u[u.length-1]:null,g=m,_=0;_<u.length;_++){var w=u[_];if(w.dataset.precedence===a)g=w;else if(g!==m)break}g?g.parentNode.insertBefore(n,g.nextSibling):(a=i.nodeType===9?i.head:i,a.insertBefore(n,a.firstChild))}function gf(n,a){n.crossOrigin==null&&(n.crossOrigin=a.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=a.referrerPolicy),n.title==null&&(n.title=a.title)}function pf(n,a){n.crossOrigin==null&&(n.crossOrigin=a.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=a.referrerPolicy),n.integrity==null&&(n.integrity=a.integrity)}var id=null;function wx(n,a,i){if(id===null){var u=new Map,m=id=new Map;m.set(i,u)}else m=id,u=m.get(i),u||(u=new Map,m.set(i,u));if(u.has(n))return u;for(u.set(n,null),i=i.getElementsByTagName(n),m=0;m<i.length;m++){var g=i[m];if(!(g[Ft]||g[be]||n==="link"&&g.getAttribute("rel")==="stylesheet")&&g.namespaceURI!=="http://www.w3.org/2000/svg"){var _=g.getAttribute(a)||"";_=n+_;var w=u.get(_);w?w.push(g):u.set(_,[g])}}return u}function Ex(n,a,i){n=n.ownerDocument||n,n.head.insertBefore(i,a==="title"?n.querySelector("head > title"):null)}function aw(n,a,i){if(i===1||a.itemProp!=null)return!1;switch(n){case"meta":case"title":return!0;case"style":if(typeof a.precedence!="string"||typeof a.href!="string"||a.href==="")break;return!0;case"link":if(typeof a.rel!="string"||typeof a.href!="string"||a.href===""||a.onLoad||a.onError)break;switch(a.rel){case"stylesheet":return n=a.disabled,typeof a.precedence=="string"&&n==null;default:return!0}case"script":if(a.async&&typeof a.async!="function"&&typeof a.async!="symbol"&&!a.onLoad&&!a.onError&&a.src&&typeof a.src=="string")return!0}return!1}function Sx(n){return!(n.type==="stylesheet"&&(n.state.loading&3)===0)}var Xl=null;function sw(){}function rw(n,a,i){if(Xl===null)throw Error(r(475));var u=Xl;if(a.type==="stylesheet"&&(typeof i.media!="string"||matchMedia(i.media).matches!==!1)&&(a.state.loading&4)===0){if(a.instance===null){var m=So(i.href),g=n.querySelector(Yl(m));if(g){n=g._p,n!==null&&typeof n=="object"&&typeof n.then=="function"&&(u.count++,u=od.bind(u),n.then(u,u)),a.state.loading|=4,a.instance=g,Ot(g);return}g=n.ownerDocument||n,i=kx(i),(m=Ea.get(m))&&gf(i,m),g=g.createElement("link"),Ot(g);var _=g;_._p=new Promise(function(w,D){_.onload=w,_.onerror=D}),jn(g,"link",i),a.instance=g}u.stylesheets===null&&(u.stylesheets=new Map),u.stylesheets.set(a,n),(n=a.state.preload)&&(a.state.loading&3)===0&&(u.count++,a=od.bind(u),n.addEventListener("load",a),n.addEventListener("error",a))}}function iw(){if(Xl===null)throw Error(r(475));var n=Xl;return n.stylesheets&&n.count===0&&yf(n,n.stylesheets),0<n.count?function(a){var i=setTimeout(function(){if(n.stylesheets&&yf(n,n.stylesheets),n.unsuspend){var u=n.unsuspend;n.unsuspend=null,u()}},6e4);return n.unsuspend=a,function(){n.unsuspend=null,clearTimeout(i)}}:null}function od(){if(this.count--,this.count===0){if(this.stylesheets)yf(this,this.stylesheets);else if(this.unsuspend){var n=this.unsuspend;this.unsuspend=null,n()}}}var ld=null;function yf(n,a){n.stylesheets=null,n.unsuspend!==null&&(n.count++,ld=new Map,a.forEach(ow,n),ld=null,od.call(n))}function ow(n,a){if(!(a.state.loading&4)){var i=ld.get(n);if(i)var u=i.get(null);else{i=new Map,ld.set(n,i);for(var m=n.querySelectorAll("link[data-precedence],style[data-precedence]"),g=0;g<m.length;g++){var _=m[g];(_.nodeName==="LINK"||_.getAttribute("media")!=="not all")&&(i.set(_.dataset.precedence,_),u=_)}u&&i.set(null,u)}m=a.instance,_=m.getAttribute("data-precedence"),g=i.get(_)||u,g===u&&i.set(null,m),i.set(_,m),this.count++,u=od.bind(this),m.addEventListener("load",u),m.addEventListener("error",u),g?g.parentNode.insertBefore(m,g.nextSibling):(n=n.nodeType===9?n.head:n,n.insertBefore(m,n.firstChild)),a.state.loading|=4}}var Zl={$$typeof:B,Provider:null,Consumer:null,_currentValue:me,_currentValue2:me,_threadCount:0};function lw(n,a,i,u,m,g,_,w){this.tag=1,this.containerInfo=n,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=sa(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=sa(0),this.hiddenUpdates=sa(null),this.identifierPrefix=u,this.onUncaughtError=m,this.onCaughtError=g,this.onRecoverableError=_,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=w,this.incompleteTransitions=new Map}function Ax(n,a,i,u,m,g,_,w,D,Q,se,ce){return n=new lw(n,a,i,_,w,D,Q,ce),a=1,g===!0&&(a|=24),g=oa(3,null,null,a),n.current=g,g.stateNode=n,a=Zh(),a.refCount++,n.pooledCache=a,a.refCount++,g.memoizedState={element:u,isDehydrated:i,cache:a},tm(g),n}function Nx(n){return n?(n=ao,n):ao}function Rx(n,a,i,u,m,g){m=Nx(m),u.context===null?u.context=m:u.pendingContext=m,u=or(a),u.payload={element:i},g=g===void 0?null:g,g!==null&&(u.callback=g),i=lr(n,u,a),i!==null&&(ha(i,n,a),Al(i,n,a))}function jx(n,a){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var i=n.retryLane;n.retryLane=i!==0&&i<a?i:a}}function xf(n,a){jx(n,a),(n=n.alternate)&&jx(n,a)}function Cx(n){if(n.tag===13){var a=no(n,67108864);a!==null&&ha(a,n,67108864),xf(n,67108864)}}var cd=!0;function cw(n,a,i,u){var m=W.T;W.T=null;var g=de.p;try{de.p=2,vf(n,a,i,u)}finally{de.p=g,W.T=m}}function uw(n,a,i,u){var m=W.T;W.T=null;var g=de.p;try{de.p=8,vf(n,a,i,u)}finally{de.p=g,W.T=m}}function vf(n,a,i,u){if(cd){var m=bf(u);if(m===null)rf(n,a,u,ud,i),Dx(n,u);else if(hw(m,n,a,i,u))u.stopPropagation();else if(Dx(n,u),a&4&&-1<dw.indexOf(n)){for(;m!==null;){var g=dn(m);if(g!==null)switch(g.tag){case 3:if(g=g.stateNode,g.current.memoizedState.isDehydrated){var _=On(g.pendingLanes);if(_!==0){var w=g;for(w.pendingLanes|=2,w.entangledLanes|=2;_;){var D=1<<31-Xt(_);w.entanglements[1]|=D,_&=~D}rs(g),(At&6)===0&&(Ku=pt()+500,Fl(0))}}break;case 13:w=no(g,2),w!==null&&ha(w,g,2),Qu(),xf(g,2)}if(g=bf(u),g===null&&rf(n,a,u,ud,i),g===m)break;m=g}m!==null&&u.stopPropagation()}else rf(n,a,u,null,i)}}function bf(n){return n=pa(n),_f(n)}var ud=null;function _f(n){if(ud=null,n=Wt(n),n!==null){var a=c(n);if(a===null)n=null;else{var i=a.tag;if(i===13){if(n=d(a),n!==null)return n;n=null}else if(i===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;n=null}else a!==n&&(n=null)}}return ud=n,null}function Ix(n){switch(n){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(kt()){case it:return 2;case Mt:return 8;case Gt:case En:return 32;case yn:return 268435456;default:return 32}default:return 32}}var kf=!1,_r=null,kr=null,Tr=null,Wl=new Map,Jl=new Map,wr=[],dw="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Dx(n,a){switch(n){case"focusin":case"focusout":_r=null;break;case"dragenter":case"dragleave":kr=null;break;case"mouseover":case"mouseout":Tr=null;break;case"pointerover":case"pointerout":Wl.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":Jl.delete(a.pointerId)}}function ec(n,a,i,u,m,g){return n===null||n.nativeEvent!==g?(n={blockedOn:a,domEventName:i,eventSystemFlags:u,nativeEvent:g,targetContainers:[m]},a!==null&&(a=dn(a),a!==null&&Cx(a)),n):(n.eventSystemFlags|=u,a=n.targetContainers,m!==null&&a.indexOf(m)===-1&&a.push(m),n)}function hw(n,a,i,u,m){switch(a){case"focusin":return _r=ec(_r,n,a,i,u,m),!0;case"dragenter":return kr=ec(kr,n,a,i,u,m),!0;case"mouseover":return Tr=ec(Tr,n,a,i,u,m),!0;case"pointerover":var g=m.pointerId;return Wl.set(g,ec(Wl.get(g)||null,n,a,i,u,m)),!0;case"gotpointercapture":return g=m.pointerId,Jl.set(g,ec(Jl.get(g)||null,n,a,i,u,m)),!0}return!1}function Mx(n){var a=Wt(n.target);if(a!==null){var i=c(a);if(i!==null){if(a=i.tag,a===13){if(a=d(i),a!==null){n.blockedOn=a,Le(n.priority,function(){if(i.tag===13){var u=da();u=re(u);var m=no(i,u);m!==null&&ha(m,i,u),xf(i,u)}});return}}else if(a===3&&i.stateNode.current.memoizedState.isDehydrated){n.blockedOn=i.tag===3?i.stateNode.containerInfo:null;return}}}n.blockedOn=null}function dd(n){if(n.blockedOn!==null)return!1;for(var a=n.targetContainers;0<a.length;){var i=bf(n.nativeEvent);if(i===null){i=n.nativeEvent;var u=new i.constructor(i.type,i);Ts=u,i.target.dispatchEvent(u),Ts=null}else return a=dn(i),a!==null&&Cx(a),n.blockedOn=i,!1;a.shift()}return!0}function Ox(n,a,i){dd(n)&&i.delete(a)}function mw(){kf=!1,_r!==null&&dd(_r)&&(_r=null),kr!==null&&dd(kr)&&(kr=null),Tr!==null&&dd(Tr)&&(Tr=null),Wl.forEach(Ox),Jl.forEach(Ox)}function hd(n,a){n.blockedOn===a&&(n.blockedOn=null,kf||(kf=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,mw)))}var md=null;function Px(n){md!==n&&(md=n,s.unstable_scheduleCallback(s.unstable_NormalPriority,function(){md===n&&(md=null);for(var a=0;a<n.length;a+=3){var i=n[a],u=n[a+1],m=n[a+2];if(typeof u!="function"){if(_f(u||i)===null)continue;break}var g=dn(i);g!==null&&(n.splice(a,3),a-=3,bm(g,{pending:!0,data:m,method:i.method,action:u},u,m))}}))}function tc(n){function a(D){return hd(D,n)}_r!==null&&hd(_r,n),kr!==null&&hd(kr,n),Tr!==null&&hd(Tr,n),Wl.forEach(a),Jl.forEach(a);for(var i=0;i<wr.length;i++){var u=wr[i];u.blockedOn===n&&(u.blockedOn=null)}for(;0<wr.length&&(i=wr[0],i.blockedOn===null);)Mx(i),i.blockedOn===null&&wr.shift();if(i=(n.ownerDocument||n).$$reactFormReplay,i!=null)for(u=0;u<i.length;u+=3){var m=i[u],g=i[u+1],_=m[Ae]||null;if(typeof g=="function")_||Px(i);else if(_){var w=null;if(g&&g.hasAttribute("formAction")){if(m=g,_=g[Ae]||null)w=_.formAction;else if(_f(m)!==null)continue}else w=_.action;typeof w=="function"?i[u+1]=w:(i.splice(u,3),u-=3),Px(i)}}}function Tf(n){this._internalRoot=n}fd.prototype.render=Tf.prototype.render=function(n){var a=this._internalRoot;if(a===null)throw Error(r(409));var i=a.current,u=da();Rx(i,u,n,a,null,null)},fd.prototype.unmount=Tf.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var a=n.containerInfo;Rx(n.current,2,null,n,null,null),Qu(),a[Pe]=null}};function fd(n){this._internalRoot=n}fd.prototype.unstable_scheduleHydration=function(n){if(n){var a=Se();n={blockedOn:null,target:n,priority:a};for(var i=0;i<wr.length&&a!==0&&a<wr[i].priority;i++);wr.splice(i,0,n),i===0&&Mx(n)}};var zx=e.version;if(zx!=="19.1.1")throw Error(r(527,zx,"19.1.1"));de.findDOMNode=function(n){var a=n._reactInternals;if(a===void 0)throw typeof n.render=="function"?Error(r(188)):(n=Object.keys(n).join(","),Error(r(268,n)));return n=p(a),n=n!==null?y(n):null,n=n===null?null:n.stateNode,n};var fw={bundleType:0,version:"19.1.1",rendererPackageName:"react-dom",currentDispatcherRef:W,reconcilerVersion:"19.1.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var gd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!gd.isDisabled&&gd.supportsFiber)try{st=gd.inject(fw),ft=gd}catch{}}return ac.createRoot=function(n,a){if(!o(n))throw Error(r(299));var i=!1,u="",m=Jy,g=e0,_=t0,w=null;return a!=null&&(a.unstable_strictMode===!0&&(i=!0),a.identifierPrefix!==void 0&&(u=a.identifierPrefix),a.onUncaughtError!==void 0&&(m=a.onUncaughtError),a.onCaughtError!==void 0&&(g=a.onCaughtError),a.onRecoverableError!==void 0&&(_=a.onRecoverableError),a.unstable_transitionCallbacks!==void 0&&(w=a.unstable_transitionCallbacks)),a=Ax(n,1,!1,null,null,i,u,m,g,_,w,null),n[Pe]=a.current,sf(n),new Tf(a)},ac.hydrateRoot=function(n,a,i){if(!o(n))throw Error(r(299));var u=!1,m="",g=Jy,_=e0,w=t0,D=null,Q=null;return i!=null&&(i.unstable_strictMode===!0&&(u=!0),i.identifierPrefix!==void 0&&(m=i.identifierPrefix),i.onUncaughtError!==void 0&&(g=i.onUncaughtError),i.onCaughtError!==void 0&&(_=i.onCaughtError),i.onRecoverableError!==void 0&&(w=i.onRecoverableError),i.unstable_transitionCallbacks!==void 0&&(D=i.unstable_transitionCallbacks),i.formState!==void 0&&(Q=i.formState)),a=Ax(n,1,!0,a,i??null,u,m,g,_,w,D,Q),a.context=Nx(null),i=a.current,u=da(),u=re(u),m=or(u),m.callback=null,lr(i,m,u),i=u,a.current.lanes=i,ke(a,i),rs(a),n[Pe]=a.current,sf(n),new fd(a)},ac.version="19.1.1",ac}var Kx;function Ew(){if(Kx)return Ef.exports;Kx=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),Ef.exports=ww(),Ef.exports}var Sw=Ew();const Aw=pw(Sw);var T=kg();/**
 * react-router v7.9.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var Yx="popstate";function Nw(s={}){function e(r,o){let{pathname:c,search:d,hash:f}=r.location;return Ff("",{pathname:c,search:d,hash:f},o.state&&o.state.usr||null,o.state&&o.state.key||"default")}function t(r,o){return typeof o=="string"?o:yc(o)}return jw(e,t,null,s)}function Ht(s,e){if(s===!1||s===null||typeof s>"u")throw new Error(e)}function Va(s,e){if(!s){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function Rw(){return Math.random().toString(36).substring(2,10)}function Qx(s,e){return{usr:s.state,key:s.key,idx:e}}function Ff(s,e,t=null,r){return{pathname:typeof s=="string"?s:s.pathname,search:"",hash:"",...typeof e=="string"?$o(e):e,state:t,key:e&&e.key||r||Rw()}}function yc({pathname:s="/",search:e="",hash:t=""}){return e&&e!=="?"&&(s+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(s+=t.charAt(0)==="#"?t:"#"+t),s}function $o(s){let e={};if(s){let t=s.indexOf("#");t>=0&&(e.hash=s.substring(t),s=s.substring(0,t));let r=s.indexOf("?");r>=0&&(e.search=s.substring(r),s=s.substring(0,r)),s&&(e.pathname=s)}return e}function jw(s,e,t,r={}){let{window:o=document.defaultView,v5Compat:c=!1}=r,d=o.history,f="POP",p=null,y=v();y==null&&(y=0,d.replaceState({...d.state,idx:y},""));function v(){return(d.state||{idx:null}).idx}function k(){f="POP";let P=v(),K=P==null?null:P-y;y=P,p&&p({action:f,location:L.location,delta:K})}function S(P,K){f="PUSH";let U=Ff(L.location,P,K);y=v()+1;let B=Qx(U,y),F=L.createHref(U);try{d.pushState(B,"",F)}catch(ae){if(ae instanceof DOMException&&ae.name==="DataCloneError")throw ae;o.location.assign(F)}c&&p&&p({action:f,location:L.location,delta:1})}function I(P,K){f="REPLACE";let U=Ff(L.location,P,K);y=v();let B=Qx(U,y),F=L.createHref(U);d.replaceState(B,"",F),c&&p&&p({action:f,location:L.location,delta:0})}function q(P){return Cw(P)}let L={get action(){return f},get location(){return s(o,d)},listen(P){if(p)throw new Error("A history only accepts one active listener");return o.addEventListener(Yx,k),p=P,()=>{o.removeEventListener(Yx,k),p=null}},createHref(P){return e(o,P)},createURL:q,encodeLocation(P){let K=q(P);return{pathname:K.pathname,search:K.search,hash:K.hash}},push:S,replace:I,go(P){return d.go(P)}};return L}function Cw(s,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),Ht(t,"No window.location.(origin|href) available to create URL");let r=typeof s=="string"?s:yc(s);return r=r.replace(/ $/,"%20"),!e&&r.startsWith("//")&&(r=t+r),new URL(r,t)}function Vb(s,e,t="/"){return Iw(s,e,t,!1)}function Iw(s,e,t,r){let o=typeof e=="string"?$o(e):e,c=Ys(o.pathname||"/",t);if(c==null)return null;let d=Ub(s);Dw(d);let f=null;for(let p=0;f==null&&p<d.length;++p){let y=Fw(c);f=Hw(d[p],y,r)}return f}function Ub(s,e=[],t=[],r="",o=!1){let c=(d,f,p=o,y)=>{let v={relativePath:y===void 0?d.path||"":y,caseSensitive:d.caseSensitive===!0,childrenIndex:f,route:d};if(v.relativePath.startsWith("/")){if(!v.relativePath.startsWith(r)&&p)return;Ht(v.relativePath.startsWith(r),`Absolute route path "${v.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),v.relativePath=v.relativePath.slice(r.length)}let k=qs([r,v.relativePath]),S=t.concat(v);d.children&&d.children.length>0&&(Ht(d.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${k}".`),Ub(d.children,e,S,k,p)),!(d.path==null&&!d.index)&&e.push({path:k,score:Uw(k,d.index),routesMeta:S})};return s.forEach((d,f)=>{if(d.path===""||!d.path?.includes("?"))c(d,f);else for(let p of Bb(d.path))c(d,f,!0,p)}),e}function Bb(s){let e=s.split("/");if(e.length===0)return[];let[t,...r]=e,o=t.endsWith("?"),c=t.replace(/\?$/,"");if(r.length===0)return o?[c,""]:[c];let d=Bb(r.join("/")),f=[];return f.push(...d.map(p=>p===""?c:[c,p].join("/"))),o&&f.push(...d),f.map(p=>s.startsWith("/")&&p===""?"/":p)}function Dw(s){s.sort((e,t)=>e.score!==t.score?t.score-e.score:Bw(e.routesMeta.map(r=>r.childrenIndex),t.routesMeta.map(r=>r.childrenIndex)))}var Mw=/^:[\w-]+$/,Ow=3,Pw=2,zw=1,Lw=10,Vw=-2,Xx=s=>s==="*";function Uw(s,e){let t=s.split("/"),r=t.length;return t.some(Xx)&&(r+=Vw),e&&(r+=Pw),t.filter(o=>!Xx(o)).reduce((o,c)=>o+(Mw.test(c)?Ow:c===""?zw:Lw),r)}function Bw(s,e){return s.length===e.length&&s.slice(0,-1).every((r,o)=>r===e[o])?s[s.length-1]-e[e.length-1]:0}function Hw(s,e,t=!1){let{routesMeta:r}=s,o={},c="/",d=[];for(let f=0;f<r.length;++f){let p=r[f],y=f===r.length-1,v=c==="/"?e:e.slice(c.length)||"/",k=Ld({path:p.relativePath,caseSensitive:p.caseSensitive,end:y},v),S=p.route;if(!k&&y&&t&&!r[r.length-1].route.index&&(k=Ld({path:p.relativePath,caseSensitive:p.caseSensitive,end:!1},v)),!k)return null;Object.assign(o,k.params),d.push({params:o,pathname:qs([c,k.pathname]),pathnameBase:Yw(qs([c,k.pathnameBase])),route:S}),k.pathnameBase!=="/"&&(c=qs([c,k.pathnameBase]))}return d}function Ld(s,e){typeof s=="string"&&(s={path:s,caseSensitive:!1,end:!0});let[t,r]=Gw(s.path,s.caseSensitive,s.end),o=e.match(t);if(!o)return null;let c=o[0],d=c.replace(/(.)\/+$/,"$1"),f=o.slice(1);return{params:r.reduce((y,{paramName:v,isOptional:k},S)=>{if(v==="*"){let q=f[S]||"";d=c.slice(0,c.length-q.length).replace(/(.)\/+$/,"$1")}const I=f[S];return k&&!I?y[v]=void 0:y[v]=(I||"").replace(/%2F/g,"/"),y},{}),pathname:c,pathnameBase:d,pattern:s}}function Gw(s,e=!1,t=!0){Va(s==="*"||!s.endsWith("*")||s.endsWith("/*"),`Route path "${s}" will be treated as if it were "${s.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${s.replace(/\*$/,"/*")}".`);let r=[],o="^"+s.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(d,f,p)=>(r.push({paramName:f,isOptional:p!=null}),p?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return s.endsWith("*")?(r.push({paramName:"*"}),o+=s==="*"||s==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?o+="\\/*$":s!==""&&s!=="/"&&(o+="(?:(?=\\/|$))"),[new RegExp(o,e?void 0:"i"),r]}function Fw(s){try{return s.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Va(!1,`The URL path "${s}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),s}}function Ys(s,e){if(e==="/")return s;if(!s.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,r=s.charAt(t);return r&&r!=="/"?null:s.slice(t)||"/"}function qw(s,e="/"){let{pathname:t,search:r="",hash:o=""}=typeof s=="string"?$o(s):s;return{pathname:t?t.startsWith("/")?t:$w(t,e):e,search:Qw(r),hash:Xw(o)}}function $w(s,e){let t=e.replace(/\/+$/,"").split("/");return s.split("/").forEach(o=>{o===".."?t.length>1&&t.pop():o!=="."&&t.push(o)}),t.length>1?t.join("/"):"/"}function jf(s,e,t,r){return`Cannot include a '${s}' character in a manually specified \`to.${e}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function Kw(s){return s.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function Tg(s){let e=Kw(s);return e.map((t,r)=>r===e.length-1?t.pathname:t.pathnameBase)}function wg(s,e,t,r=!1){let o;typeof s=="string"?o=$o(s):(o={...s},Ht(!o.pathname||!o.pathname.includes("?"),jf("?","pathname","search",o)),Ht(!o.pathname||!o.pathname.includes("#"),jf("#","pathname","hash",o)),Ht(!o.search||!o.search.includes("#"),jf("#","search","hash",o)));let c=s===""||o.pathname==="",d=c?"/":o.pathname,f;if(d==null)f=t;else{let k=e.length-1;if(!r&&d.startsWith("..")){let S=d.split("/");for(;S[0]==="..";)S.shift(),k-=1;o.pathname=S.join("/")}f=k>=0?e[k]:"/"}let p=qw(o,f),y=d&&d!=="/"&&d.endsWith("/"),v=(c||d===".")&&t.endsWith("/");return!p.pathname.endsWith("/")&&(y||v)&&(p.pathname+="/"),p}var qs=s=>s.join("/").replace(/\/\/+/g,"/"),Yw=s=>s.replace(/\/+$/,"").replace(/^\/*/,"/"),Qw=s=>!s||s==="?"?"":s.startsWith("?")?s:"?"+s,Xw=s=>!s||s==="#"?"":s.startsWith("#")?s:"#"+s;function Zw(s){return s!=null&&typeof s.status=="number"&&typeof s.statusText=="string"&&typeof s.internal=="boolean"&&"data"in s}var Hb=["POST","PUT","PATCH","DELETE"];new Set(Hb);var Ww=["GET",...Hb];new Set(Ww);var Ko=T.createContext(null);Ko.displayName="DataRouter";var sh=T.createContext(null);sh.displayName="DataRouterState";T.createContext(!1);var Gb=T.createContext({isTransitioning:!1});Gb.displayName="ViewTransition";var Jw=T.createContext(new Map);Jw.displayName="Fetchers";var eE=T.createContext(null);eE.displayName="Await";var Ha=T.createContext(null);Ha.displayName="Navigation";var Oc=T.createContext(null);Oc.displayName="Location";var ps=T.createContext({outlet:null,matches:[],isDataRoute:!1});ps.displayName="Route";var Eg=T.createContext(null);Eg.displayName="RouteError";function tE(s,{relative:e}={}){Ht(Yo(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:r}=T.useContext(Ha),{hash:o,pathname:c,search:d}=Pc(s,{relative:e}),f=c;return t!=="/"&&(f=c==="/"?t:qs([t,c])),r.createHref({pathname:f,search:d,hash:o})}function Yo(){return T.useContext(Oc)!=null}function Js(){return Ht(Yo(),"useLocation() may be used only in the context of a <Router> component."),T.useContext(Oc).location}var Fb="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function qb(s){T.useContext(Ha).static||T.useLayoutEffect(s)}function $r(){let{isDataRoute:s}=T.useContext(ps);return s?fE():nE()}function nE(){Ht(Yo(),"useNavigate() may be used only in the context of a <Router> component.");let s=T.useContext(Ko),{basename:e,navigator:t}=T.useContext(Ha),{matches:r}=T.useContext(ps),{pathname:o}=Js(),c=JSON.stringify(Tg(r)),d=T.useRef(!1);return qb(()=>{d.current=!0}),T.useCallback((p,y={})=>{if(Va(d.current,Fb),!d.current)return;if(typeof p=="number"){t.go(p);return}let v=wg(p,JSON.parse(c),o,y.relative==="path");s==null&&e!=="/"&&(v.pathname=v.pathname==="/"?e:qs([e,v.pathname])),(y.replace?t.replace:t.push)(v,y.state,y)},[e,t,c,o,s])}T.createContext(null);function Pc(s,{relative:e}={}){let{matches:t}=T.useContext(ps),{pathname:r}=Js(),o=JSON.stringify(Tg(t));return T.useMemo(()=>wg(s,JSON.parse(o),r,e==="path"),[s,o,r,e])}function aE(s,e){return $b(s,e)}function $b(s,e,t,r,o){Ht(Yo(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:c}=T.useContext(Ha),{matches:d}=T.useContext(ps),f=d[d.length-1],p=f?f.params:{},y=f?f.pathname:"/",v=f?f.pathnameBase:"/",k=f&&f.route;{let U=k&&k.path||"";Kb(y,!k||U.endsWith("*")||U.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${y}" (under <Route path="${U}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${U}"> to <Route path="${U==="/"?"*":`${U}/*`}">.`)}let S=Js(),I;if(e){let U=typeof e=="string"?$o(e):e;Ht(v==="/"||U.pathname?.startsWith(v),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${v}" but pathname "${U.pathname}" was given in the \`location\` prop.`),I=U}else I=S;let q=I.pathname||"/",L=q;if(v!=="/"){let U=v.replace(/^\//,"").split("/");L="/"+q.replace(/^\//,"").split("/").slice(U.length).join("/")}let P=Vb(s,{pathname:L});Va(k||P!=null,`No routes matched location "${I.pathname}${I.search}${I.hash}" `),Va(P==null||P[P.length-1].route.element!==void 0||P[P.length-1].route.Component!==void 0||P[P.length-1].route.lazy!==void 0,`Matched leaf route at location "${I.pathname}${I.search}${I.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let K=lE(P&&P.map(U=>Object.assign({},U,{params:Object.assign({},p,U.params),pathname:qs([v,c.encodeLocation?c.encodeLocation(U.pathname).pathname:U.pathname]),pathnameBase:U.pathnameBase==="/"?v:qs([v,c.encodeLocation?c.encodeLocation(U.pathnameBase).pathname:U.pathnameBase])})),d,t,r,o);return e&&K?T.createElement(Oc.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...I},navigationType:"POP"}},K):K}function sE(){let s=mE(),e=Zw(s)?`${s.status} ${s.statusText}`:s instanceof Error?s.message:JSON.stringify(s),t=s instanceof Error?s.stack:null,r="rgba(200,200,200, 0.5)",o={padding:"0.5rem",backgroundColor:r},c={padding:"2px 4px",backgroundColor:r},d=null;return console.error("Error handled by React Router default ErrorBoundary:",s),d=T.createElement(T.Fragment,null,T.createElement("p",null,"💿 Hey developer 👋"),T.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",T.createElement("code",{style:c},"ErrorBoundary")," or"," ",T.createElement("code",{style:c},"errorElement")," prop on your route.")),T.createElement(T.Fragment,null,T.createElement("h2",null,"Unexpected Application Error!"),T.createElement("h3",{style:{fontStyle:"italic"}},e),t?T.createElement("pre",{style:o},t):null,d)}var rE=T.createElement(sE,null),iE=class extends T.Component{constructor(s){super(s),this.state={location:s.location,revalidation:s.revalidation,error:s.error}}static getDerivedStateFromError(s){return{error:s}}static getDerivedStateFromProps(s,e){return e.location!==s.location||e.revalidation!=="idle"&&s.revalidation==="idle"?{error:s.error,location:s.location,revalidation:s.revalidation}:{error:s.error!==void 0?s.error:e.error,location:e.location,revalidation:s.revalidation||e.revalidation}}componentDidCatch(s,e){this.props.unstable_onError?this.props.unstable_onError(s,e):console.error("React Router caught the following error during render",s)}render(){return this.state.error!==void 0?T.createElement(ps.Provider,{value:this.props.routeContext},T.createElement(Eg.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function oE({routeContext:s,match:e,children:t}){let r=T.useContext(Ko);return r&&r.static&&r.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=e.route.id),T.createElement(ps.Provider,{value:s},t)}function lE(s,e=[],t=null,r=null,o=null){if(s==null){if(!t)return null;if(t.errors)s=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)s=t.matches;else return null}let c=s,d=t?.errors;if(d!=null){let y=c.findIndex(v=>v.route.id&&d?.[v.route.id]!==void 0);Ht(y>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(d).join(",")}`),c=c.slice(0,Math.min(c.length,y+1))}let f=!1,p=-1;if(t)for(let y=0;y<c.length;y++){let v=c[y];if((v.route.HydrateFallback||v.route.hydrateFallbackElement)&&(p=y),v.route.id){let{loaderData:k,errors:S}=t,I=v.route.loader&&!k.hasOwnProperty(v.route.id)&&(!S||S[v.route.id]===void 0);if(v.route.lazy||I){f=!0,p>=0?c=c.slice(0,p+1):c=[c[0]];break}}}return c.reduceRight((y,v,k)=>{let S,I=!1,q=null,L=null;t&&(S=d&&v.route.id?d[v.route.id]:void 0,q=v.route.errorElement||rE,f&&(p<0&&k===0?(Kb("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),I=!0,L=null):p===k&&(I=!0,L=v.route.hydrateFallbackElement||null)));let P=e.concat(c.slice(0,k+1)),K=()=>{let U;return S?U=q:I?U=L:v.route.Component?U=T.createElement(v.route.Component,null):v.route.element?U=v.route.element:U=y,T.createElement(oE,{match:v,routeContext:{outlet:y,matches:P,isDataRoute:t!=null},children:U})};return t&&(v.route.ErrorBoundary||v.route.errorElement||k===0)?T.createElement(iE,{location:t.location,revalidation:t.revalidation,component:q,error:S,children:K(),routeContext:{outlet:null,matches:P,isDataRoute:!0},unstable_onError:r}):K()},null)}function Sg(s){return`${s} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function cE(s){let e=T.useContext(Ko);return Ht(e,Sg(s)),e}function uE(s){let e=T.useContext(sh);return Ht(e,Sg(s)),e}function dE(s){let e=T.useContext(ps);return Ht(e,Sg(s)),e}function Ag(s){let e=dE(s),t=e.matches[e.matches.length-1];return Ht(t.route.id,`${s} can only be used on routes that contain a unique "id"`),t.route.id}function hE(){return Ag("useRouteId")}function mE(){let s=T.useContext(Eg),e=uE("useRouteError"),t=Ag("useRouteError");return s!==void 0?s:e.errors?.[t]}function fE(){let{router:s}=cE("useNavigate"),e=Ag("useNavigate"),t=T.useRef(!1);return qb(()=>{t.current=!0}),T.useCallback(async(o,c={})=>{Va(t.current,Fb),t.current&&(typeof o=="number"?s.navigate(o):await s.navigate(o,{fromRouteId:e,...c}))},[s,e])}var Zx={};function Kb(s,e,t){!e&&!Zx[s]&&(Zx[s]=!0,Va(!1,t))}T.memo(gE);function gE({routes:s,future:e,state:t,unstable_onError:r}){return $b(s,void 0,t,r,e)}function Dr({to:s,replace:e,state:t,relative:r}){Ht(Yo(),"<Navigate> may be used only in the context of a <Router> component.");let{static:o}=T.useContext(Ha);Va(!o,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:c}=T.useContext(ps),{pathname:d}=Js(),f=$r(),p=wg(s,Tg(c),d,r==="path"),y=JSON.stringify(p);return T.useEffect(()=>{f(JSON.parse(y),{replace:e,state:t,relative:r})},[f,y,r,e,t]),null}function Hs(s){Ht(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function pE({basename:s="/",children:e=null,location:t,navigationType:r="POP",navigator:o,static:c=!1}){Ht(!Yo(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let d=s.replace(/^\/*/,"/"),f=T.useMemo(()=>({basename:d,navigator:o,static:c,future:{}}),[d,o,c]);typeof t=="string"&&(t=$o(t));let{pathname:p="/",search:y="",hash:v="",state:k=null,key:S="default"}=t,I=T.useMemo(()=>{let q=Ys(p,d);return q==null?null:{location:{pathname:q,search:y,hash:v,state:k,key:S},navigationType:r}},[d,p,y,v,k,S,r]);return Va(I!=null,`<Router basename="${d}"> is not able to match the URL "${p}${y}${v}" because it does not start with the basename, so the <Router> won't render anything.`),I==null?null:T.createElement(Ha.Provider,{value:f},T.createElement(Oc.Provider,{children:e,value:I}))}function yE({children:s,location:e}){return aE(qf(s),e)}function qf(s,e=[]){let t=[];return T.Children.forEach(s,(r,o)=>{if(!T.isValidElement(r))return;let c=[...e,o];if(r.type===T.Fragment){t.push.apply(t,qf(r.props.children,c));return}Ht(r.type===Hs,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Ht(!r.props.index||!r.props.children,"An index route cannot have child routes.");let d={id:r.props.id||c.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(d.children=qf(r.props.children,c)),t.push(d)}),t}var wd="get",Ed="application/x-www-form-urlencoded";function rh(s){return s!=null&&typeof s.tagName=="string"}function xE(s){return rh(s)&&s.tagName.toLowerCase()==="button"}function vE(s){return rh(s)&&s.tagName.toLowerCase()==="form"}function bE(s){return rh(s)&&s.tagName.toLowerCase()==="input"}function _E(s){return!!(s.metaKey||s.altKey||s.ctrlKey||s.shiftKey)}function kE(s,e){return s.button===0&&(!e||e==="_self")&&!_E(s)}var pd=null;function TE(){if(pd===null)try{new FormData(document.createElement("form"),0),pd=!1}catch{pd=!0}return pd}var wE=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Cf(s){return s!=null&&!wE.has(s)?(Va(!1,`"${s}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Ed}"`),null):s}function EE(s,e){let t,r,o,c,d;if(vE(s)){let f=s.getAttribute("action");r=f?Ys(f,e):null,t=s.getAttribute("method")||wd,o=Cf(s.getAttribute("enctype"))||Ed,c=new FormData(s)}else if(xE(s)||bE(s)&&(s.type==="submit"||s.type==="image")){let f=s.form;if(f==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let p=s.getAttribute("formaction")||f.getAttribute("action");if(r=p?Ys(p,e):null,t=s.getAttribute("formmethod")||f.getAttribute("method")||wd,o=Cf(s.getAttribute("formenctype"))||Cf(f.getAttribute("enctype"))||Ed,c=new FormData(f,s),!TE()){let{name:y,type:v,value:k}=s;if(v==="image"){let S=y?`${y}.`:"";c.append(`${S}x`,"0"),c.append(`${S}y`,"0")}else y&&c.append(y,k)}}else{if(rh(s))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=wd,r=null,o=Ed,d=s}return c&&o==="text/plain"&&(d=c,c=void 0),{action:r,method:t.toLowerCase(),encType:o,formData:c,body:d}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Ng(s,e){if(s===!1||s===null||typeof s>"u")throw new Error(e)}function SE(s,e,t){let r=typeof s=="string"?new URL(s,typeof window>"u"?"server://singlefetch/":window.location.origin):s;return r.pathname==="/"?r.pathname=`_root.${t}`:e&&Ys(r.pathname,e)==="/"?r.pathname=`${e.replace(/\/$/,"")}/_root.${t}`:r.pathname=`${r.pathname.replace(/\/$/,"")}.${t}`,r}async function AE(s,e){if(s.id in e)return e[s.id];try{let t=await import(s.module);return e[s.id]=t,t}catch(t){return console.error(`Error loading route module \`${s.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function NE(s){return s==null?!1:s.href==null?s.rel==="preload"&&typeof s.imageSrcSet=="string"&&typeof s.imageSizes=="string":typeof s.rel=="string"&&typeof s.href=="string"}async function RE(s,e,t){let r=await Promise.all(s.map(async o=>{let c=e.routes[o.route.id];if(c){let d=await AE(c,t);return d.links?d.links():[]}return[]}));return DE(r.flat(1).filter(NE).filter(o=>o.rel==="stylesheet"||o.rel==="preload").map(o=>o.rel==="stylesheet"?{...o,rel:"prefetch",as:"style"}:{...o,rel:"prefetch"}))}function Wx(s,e,t,r,o,c){let d=(p,y)=>t[y]?p.route.id!==t[y].route.id:!0,f=(p,y)=>t[y].pathname!==p.pathname||t[y].route.path?.endsWith("*")&&t[y].params["*"]!==p.params["*"];return c==="assets"?e.filter((p,y)=>d(p,y)||f(p,y)):c==="data"?e.filter((p,y)=>{let v=r.routes[p.route.id];if(!v||!v.hasLoader)return!1;if(d(p,y)||f(p,y))return!0;if(p.route.shouldRevalidate){let k=p.route.shouldRevalidate({currentUrl:new URL(o.pathname+o.search+o.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(s,window.origin),nextParams:p.params,defaultShouldRevalidate:!0});if(typeof k=="boolean")return k}return!0}):[]}function jE(s,e,{includeHydrateFallback:t}={}){return CE(s.map(r=>{let o=e.routes[r.route.id];if(!o)return[];let c=[o.module];return o.clientActionModule&&(c=c.concat(o.clientActionModule)),o.clientLoaderModule&&(c=c.concat(o.clientLoaderModule)),t&&o.hydrateFallbackModule&&(c=c.concat(o.hydrateFallbackModule)),o.imports&&(c=c.concat(o.imports)),c}).flat(1))}function CE(s){return[...new Set(s)]}function IE(s){let e={},t=Object.keys(s).sort();for(let r of t)e[r]=s[r];return e}function DE(s,e){let t=new Set;return new Set(e),s.reduce((r,o)=>{let c=JSON.stringify(IE(o));return t.has(c)||(t.add(c),r.push({key:c,link:o})),r},[])}function Yb(){let s=T.useContext(Ko);return Ng(s,"You must render this element inside a <DataRouterContext.Provider> element"),s}function ME(){let s=T.useContext(sh);return Ng(s,"You must render this element inside a <DataRouterStateContext.Provider> element"),s}var Rg=T.createContext(void 0);Rg.displayName="FrameworkContext";function Qb(){let s=T.useContext(Rg);return Ng(s,"You must render this element inside a <HydratedRouter> element"),s}function OE(s,e){let t=T.useContext(Rg),[r,o]=T.useState(!1),[c,d]=T.useState(!1),{onFocus:f,onBlur:p,onMouseEnter:y,onMouseLeave:v,onTouchStart:k}=e,S=T.useRef(null);T.useEffect(()=>{if(s==="render"&&d(!0),s==="viewport"){let L=K=>{K.forEach(U=>{d(U.isIntersecting)})},P=new IntersectionObserver(L,{threshold:.5});return S.current&&P.observe(S.current),()=>{P.disconnect()}}},[s]),T.useEffect(()=>{if(r){let L=setTimeout(()=>{d(!0)},100);return()=>{clearTimeout(L)}}},[r]);let I=()=>{o(!0)},q=()=>{o(!1),d(!1)};return t?s!=="intent"?[c,S,{}]:[c,S,{onFocus:sc(f,I),onBlur:sc(p,q),onMouseEnter:sc(y,I),onMouseLeave:sc(v,q),onTouchStart:sc(k,I)}]:[!1,S,{}]}function sc(s,e){return t=>{s&&s(t),t.defaultPrevented||e(t)}}function PE({page:s,...e}){let{router:t}=Yb(),r=T.useMemo(()=>Vb(t.routes,s,t.basename),[t.routes,s,t.basename]);return r?T.createElement(LE,{page:s,matches:r,...e}):null}function zE(s){let{manifest:e,routeModules:t}=Qb(),[r,o]=T.useState([]);return T.useEffect(()=>{let c=!1;return RE(s,e,t).then(d=>{c||o(d)}),()=>{c=!0}},[s,e,t]),r}function LE({page:s,matches:e,...t}){let r=Js(),{manifest:o,routeModules:c}=Qb(),{basename:d}=Yb(),{loaderData:f,matches:p}=ME(),y=T.useMemo(()=>Wx(s,e,p,o,r,"data"),[s,e,p,o,r]),v=T.useMemo(()=>Wx(s,e,p,o,r,"assets"),[s,e,p,o,r]),k=T.useMemo(()=>{if(s===r.pathname+r.search+r.hash)return[];let q=new Set,L=!1;if(e.forEach(K=>{let U=o.routes[K.route.id];!U||!U.hasLoader||(!y.some(B=>B.route.id===K.route.id)&&K.route.id in f&&c[K.route.id]?.shouldRevalidate||U.hasClientLoader?L=!0:q.add(K.route.id))}),q.size===0)return[];let P=SE(s,d,"data");return L&&q.size>0&&P.searchParams.set("_routes",e.filter(K=>q.has(K.route.id)).map(K=>K.route.id).join(",")),[P.pathname+P.search]},[d,f,r,o,y,e,s,c]),S=T.useMemo(()=>jE(v,o),[v,o]),I=zE(v);return T.createElement(T.Fragment,null,k.map(q=>T.createElement("link",{key:q,rel:"prefetch",as:"fetch",href:q,...t})),S.map(q=>T.createElement("link",{key:q,rel:"modulepreload",href:q,...t})),I.map(({key:q,link:L})=>T.createElement("link",{key:q,nonce:t.nonce,...L})))}function VE(...s){return e=>{s.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var Xb=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{Xb&&(window.__reactRouterVersion="7.9.1")}catch{}function UE({basename:s,children:e,window:t}){let r=T.useRef();r.current==null&&(r.current=Nw({window:t,v5Compat:!0}));let o=r.current,[c,d]=T.useState({action:o.action,location:o.location}),f=T.useCallback(p=>{T.startTransition(()=>d(p))},[d]);return T.useLayoutEffect(()=>o.listen(f),[o,f]),T.createElement(pE,{basename:s,children:e,location:c.location,navigationType:c.action,navigator:o})}var Zb=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Wb=T.forwardRef(function({onClick:e,discover:t="render",prefetch:r="none",relative:o,reloadDocument:c,replace:d,state:f,target:p,to:y,preventScrollReset:v,viewTransition:k,...S},I){let{basename:q}=T.useContext(Ha),L=typeof y=="string"&&Zb.test(y),P,K=!1;if(typeof y=="string"&&L&&(P=y,Xb))try{let E=new URL(window.location.href),C=y.startsWith("//")?new URL(E.protocol+y):new URL(y),M=Ys(C.pathname,q);C.origin===E.origin&&M!=null?y=M+C.search+C.hash:K=!0}catch{Va(!1,`<Link to="${y}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let U=tE(y,{relative:o}),[B,F,ae]=OE(r,S),ne=FE(y,{replace:d,state:f,target:p,preventScrollReset:v,relative:o,viewTransition:k});function N(E){e&&e(E),E.defaultPrevented||ne(E)}let R=T.createElement("a",{...S,...ae,href:P||U,onClick:K||c?e:N,ref:VE(I,F),target:p,"data-discover":!L&&t==="render"?"true":void 0});return B&&!L?T.createElement(T.Fragment,null,R,T.createElement(PE,{page:U})):R});Wb.displayName="Link";var BE=T.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:r="",end:o=!1,style:c,to:d,viewTransition:f,children:p,...y},v){let k=Pc(d,{relative:y.relative}),S=Js(),I=T.useContext(sh),{navigator:q,basename:L}=T.useContext(Ha),P=I!=null&&QE(k)&&f===!0,K=q.encodeLocation?q.encodeLocation(k).pathname:k.pathname,U=S.pathname,B=I&&I.navigation&&I.navigation.location?I.navigation.location.pathname:null;t||(U=U.toLowerCase(),B=B?B.toLowerCase():null,K=K.toLowerCase()),B&&L&&(B=Ys(B,L)||B);const F=K!=="/"&&K.endsWith("/")?K.length-1:K.length;let ae=U===K||!o&&U.startsWith(K)&&U.charAt(F)==="/",ne=B!=null&&(B===K||!o&&B.startsWith(K)&&B.charAt(K.length)==="/"),N={isActive:ae,isPending:ne,isTransitioning:P},R=ae?e:void 0,E;typeof r=="function"?E=r(N):E=[r,ae?"active":null,ne?"pending":null,P?"transitioning":null].filter(Boolean).join(" ");let C=typeof c=="function"?c(N):c;return T.createElement(Wb,{...y,"aria-current":R,className:E,ref:v,style:C,to:d,viewTransition:f},typeof p=="function"?p(N):p)});BE.displayName="NavLink";var HE=T.forwardRef(({discover:s="render",fetcherKey:e,navigate:t,reloadDocument:r,replace:o,state:c,method:d=wd,action:f,onSubmit:p,relative:y,preventScrollReset:v,viewTransition:k,...S},I)=>{let q=KE(),L=YE(f,{relative:y}),P=d.toLowerCase()==="get"?"get":"post",K=typeof f=="string"&&Zb.test(f),U=B=>{if(p&&p(B),B.defaultPrevented)return;B.preventDefault();let F=B.nativeEvent.submitter,ae=F?.getAttribute("formmethod")||d;q(F||B.currentTarget,{fetcherKey:e,method:ae,navigate:t,replace:o,state:c,relative:y,preventScrollReset:v,viewTransition:k})};return T.createElement("form",{ref:I,method:P,action:L,onSubmit:r?p:U,...S,"data-discover":!K&&s==="render"?"true":void 0})});HE.displayName="Form";function GE(s){return`${s} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Jb(s){let e=T.useContext(Ko);return Ht(e,GE(s)),e}function FE(s,{target:e,replace:t,state:r,preventScrollReset:o,relative:c,viewTransition:d}={}){let f=$r(),p=Js(),y=Pc(s,{relative:c});return T.useCallback(v=>{if(kE(v,e)){v.preventDefault();let k=t!==void 0?t:yc(p)===yc(y);f(s,{replace:k,state:r,preventScrollReset:o,relative:c,viewTransition:d})}},[p,f,y,t,r,e,s,o,c,d])}var qE=0,$E=()=>`__${String(++qE)}__`;function KE(){let{router:s}=Jb("useSubmit"),{basename:e}=T.useContext(Ha),t=hE();return T.useCallback(async(r,o={})=>{let{action:c,method:d,encType:f,formData:p,body:y}=EE(r,e);if(o.navigate===!1){let v=o.fetcherKey||$E();await s.fetch(v,t,o.action||c,{preventScrollReset:o.preventScrollReset,formData:p,body:y,formMethod:o.method||d,formEncType:o.encType||f,flushSync:o.flushSync})}else await s.navigate(o.action||c,{preventScrollReset:o.preventScrollReset,formData:p,body:y,formMethod:o.method||d,formEncType:o.encType||f,replace:o.replace,state:o.state,fromRouteId:t,flushSync:o.flushSync,viewTransition:o.viewTransition})},[s,e,t])}function YE(s,{relative:e}={}){let{basename:t}=T.useContext(Ha),r=T.useContext(ps);Ht(r,"useFormAction must be used inside a RouteContext");let[o]=r.matches.slice(-1),c={...Pc(s||".",{relative:e})},d=Js();if(s==null){c.search=d.search;let f=new URLSearchParams(c.search),p=f.getAll("index");if(p.some(v=>v==="")){f.delete("index"),p.filter(k=>k).forEach(k=>f.append("index",k));let v=f.toString();c.search=v?`?${v}`:""}}return(!s||s===".")&&o.route.index&&(c.search=c.search?c.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(c.pathname=c.pathname==="/"?t:qs([t,c.pathname])),yc(c)}function QE(s,{relative:e}={}){let t=T.useContext(Gb);Ht(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=Jb("useViewTransitionState"),o=Pc(s,{relative:e});if(!t.isTransitioning)return!1;let c=Ys(t.currentLocation.pathname,r)||t.currentLocation.pathname,d=Ys(t.nextLocation.pathname,r)||t.nextLocation.pathname;return Ld(o.pathname,d)!=null||Ld(o.pathname,c)!=null}const XE=()=>{};var Jx={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e1=function(s){const e=[];let t=0;for(let r=0;r<s.length;r++){let o=s.charCodeAt(r);o<128?e[t++]=o:o<2048?(e[t++]=o>>6|192,e[t++]=o&63|128):(o&64512)===55296&&r+1<s.length&&(s.charCodeAt(r+1)&64512)===56320?(o=65536+((o&1023)<<10)+(s.charCodeAt(++r)&1023),e[t++]=o>>18|240,e[t++]=o>>12&63|128,e[t++]=o>>6&63|128,e[t++]=o&63|128):(e[t++]=o>>12|224,e[t++]=o>>6&63|128,e[t++]=o&63|128)}return e},ZE=function(s){const e=[];let t=0,r=0;for(;t<s.length;){const o=s[t++];if(o<128)e[r++]=String.fromCharCode(o);else if(o>191&&o<224){const c=s[t++];e[r++]=String.fromCharCode((o&31)<<6|c&63)}else if(o>239&&o<365){const c=s[t++],d=s[t++],f=s[t++],p=((o&7)<<18|(c&63)<<12|(d&63)<<6|f&63)-65536;e[r++]=String.fromCharCode(55296+(p>>10)),e[r++]=String.fromCharCode(56320+(p&1023))}else{const c=s[t++],d=s[t++];e[r++]=String.fromCharCode((o&15)<<12|(c&63)<<6|d&63)}}return e.join("")},t1={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(s,e){if(!Array.isArray(s))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let o=0;o<s.length;o+=3){const c=s[o],d=o+1<s.length,f=d?s[o+1]:0,p=o+2<s.length,y=p?s[o+2]:0,v=c>>2,k=(c&3)<<4|f>>4;let S=(f&15)<<2|y>>6,I=y&63;p||(I=64,d||(S=64)),r.push(t[v],t[k],t[S],t[I])}return r.join("")},encodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(s):this.encodeByteArray(e1(s),e)},decodeString(s,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(s):ZE(this.decodeStringToByteArray(s,e))},decodeStringToByteArray(s,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let o=0;o<s.length;){const c=t[s.charAt(o++)],f=o<s.length?t[s.charAt(o)]:0;++o;const y=o<s.length?t[s.charAt(o)]:64;++o;const k=o<s.length?t[s.charAt(o)]:64;if(++o,c==null||f==null||y==null||k==null)throw new WE;const S=c<<2|f>>4;if(r.push(S),y!==64){const I=f<<4&240|y>>2;if(r.push(I),k!==64){const q=y<<6&192|k;r.push(q)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let s=0;s<this.ENCODED_VALS.length;s++)this.byteToCharMap_[s]=this.ENCODED_VALS.charAt(s),this.charToByteMap_[this.byteToCharMap_[s]]=s,this.byteToCharMapWebSafe_[s]=this.ENCODED_VALS_WEBSAFE.charAt(s),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[s]]=s,s>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(s)]=s,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(s)]=s)}}};class WE extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const JE=function(s){const e=e1(s);return t1.encodeByteArray(e,!0)},n1=function(s){return JE(s).replace(/\./g,"")},a1=function(s){try{return t1.decodeString(s,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eS(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tS=()=>eS().__FIREBASE_DEFAULTS__,nS=()=>{if(typeof process>"u"||typeof Jx>"u")return;const s=Jx.__FIREBASE_DEFAULTS__;if(s)return JSON.parse(s)},aS=()=>{if(typeof document>"u")return;let s;try{s=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=s&&a1(s[1]);return e&&JSON.parse(e)},ih=()=>{try{return XE()||tS()||nS()||aS()}catch(s){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${s}`);return}},sS=s=>ih()?.emulatorHosts?.[s],s1=()=>ih()?.config,r1=s=>ih()?.[`_${s}`];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rS{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qo(s){try{return(s.startsWith("http://")||s.startsWith("https://")?new URL(s).hostname:s).endsWith(".cloudworkstations.dev")}catch{return!1}}async function i1(s){return(await fetch(s,{credentials:"include"})).ok}const dc={};function iS(){const s={prod:[],emulator:[]};for(const e of Object.keys(dc))dc[e]?s.emulator.push(e):s.prod.push(e);return s}function oS(s){let e=document.getElementById(s),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",s),t=!0),{created:t,element:e}}let ev=!1;function lS(s,e){if(typeof window>"u"||typeof document>"u"||!Qo(window.location.host)||dc[s]===e||dc[s]||ev)return;dc[s]=e;function t(S){return`__firebase__banner__${S}`}const r="__firebase__banner",c=iS().prod.length>0;function d(){const S=document.getElementById(r);S&&S.remove()}function f(S){S.style.display="flex",S.style.background="#7faaf0",S.style.position="fixed",S.style.bottom="5px",S.style.left="5px",S.style.padding=".5em",S.style.borderRadius="5px",S.style.alignItems="center"}function p(S,I){S.setAttribute("width","24"),S.setAttribute("id",I),S.setAttribute("height","24"),S.setAttribute("viewBox","0 0 24 24"),S.setAttribute("fill","none"),S.style.marginLeft="-6px"}function y(){const S=document.createElement("span");return S.style.cursor="pointer",S.style.marginLeft="16px",S.style.fontSize="24px",S.innerHTML=" &times;",S.onclick=()=>{ev=!0,d()},S}function v(S,I){S.setAttribute("id",I),S.innerText="Learn more",S.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",S.setAttribute("target","__blank"),S.style.paddingLeft="5px",S.style.textDecoration="underline"}function k(){const S=oS(r),I=t("text"),q=document.getElementById(I)||document.createElement("span"),L=t("learnmore"),P=document.getElementById(L)||document.createElement("a"),K=t("preprendIcon"),U=document.getElementById(K)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(S.created){const B=S.element;f(B),v(P,L);const F=y();p(U,K),B.append(U,q,P,F),document.body.appendChild(B)}c?(q.innerText="Preview backend disconnected.",U.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(U.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,q.innerText="Preview backend running in this workspace."),q.setAttribute("id",I)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",k):k()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function cS(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Hn())}function uS(){const s=ih()?.forceEnvironment;if(s==="node")return!0;if(s==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function dS(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function hS(){const s=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof s=="object"&&s.id!==void 0}function mS(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function fS(){const s=Hn();return s.indexOf("MSIE ")>=0||s.indexOf("Trident/")>=0}function gS(){return!uS()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function pS(){try{return typeof indexedDB=="object"}catch{return!1}}function yS(){return new Promise((s,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",o=self.indexedDB.open(r);o.onsuccess=()=>{o.result.close(),t||self.indexedDB.deleteDatabase(r),s(!0)},o.onupgradeneeded=()=>{t=!1},o.onerror=()=>{e(o.error?.message||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xS="FirebaseError";class er extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=xS,Object.setPrototypeOf(this,er.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,zc.prototype.create)}}class zc{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},o=`${this.service}/${e}`,c=this.errors[e],d=c?vS(c,r):"Error",f=`${this.serviceName}: ${d} (${o}).`;return new er(o,f,r)}}function vS(s,e){return s.replace(bS,(t,r)=>{const o=e[r];return o!=null?String(o):`<${r}?>`})}const bS=/\{\$([^}]+)}/g;function _S(s){for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e))return!1;return!0}function Ei(s,e){if(s===e)return!0;const t=Object.keys(s),r=Object.keys(e);for(const o of t){if(!r.includes(o))return!1;const c=s[o],d=e[o];if(tv(c)&&tv(d)){if(!Ei(c,d))return!1}else if(c!==d)return!1}for(const o of r)if(!t.includes(o))return!1;return!0}function tv(s){return s!==null&&typeof s=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lc(s){const e=[];for(const[t,r]of Object.entries(s))Array.isArray(r)?r.forEach(o=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(o))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function rc(s){const e={};return s.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[o,c]=r.split("=");e[decodeURIComponent(o)]=decodeURIComponent(c)}}),e}function ic(s){const e=s.indexOf("?");if(!e)return"";const t=s.indexOf("#",e);return s.substring(e,t>0?t:void 0)}function kS(s,e){const t=new TS(s,e);return t.subscribe.bind(t)}class TS{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let o;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");wS(e,["next","error","complete"])?o=e:o={next:e,error:t,complete:r},o.next===void 0&&(o.next=If),o.error===void 0&&(o.error=If),o.complete===void 0&&(o.complete=If);const c=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?o.error(this.finalError):o.complete()}catch{}}),this.observers.push(o),c}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function wS(s,e){if(typeof s!="object"||s===null)return!1;for(const t of e)if(t in s&&typeof s[t]=="function")return!0;return!1}function If(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kn(s){return s&&s._delegate?s._delegate:s}class Si{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ki="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ES{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new rS;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const o=this.getOrInitializeService({instanceIdentifier:t});o&&r.resolve(o)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),r=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(o){if(r)return null;throw o}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(AS(e))try{this.getOrInitializeService({instanceIdentifier:ki})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(t);try{const c=this.getOrInitializeService({instanceIdentifier:o});r.resolve(c)}catch{}}}}clearInstance(e=ki){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ki){return this.instances.has(e)}getOptions(e=ki){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const o=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[c,d]of this.instancesDeferred.entries()){const f=this.normalizeInstanceIdentifier(c);r===f&&d.resolve(o)}return o}onInit(e,t){const r=this.normalizeInstanceIdentifier(t),o=this.onInitCallbacks.get(r)??new Set;o.add(e),this.onInitCallbacks.set(r,o);const c=this.instances.get(r);return c&&e(c,r),()=>{o.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const o of r)try{o(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:SS(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=ki){return this.component?this.component.multipleInstances?e:ki:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function SS(s){return s===ki?void 0:s}function AS(s){return s.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NS{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new ES(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var dt;(function(s){s[s.DEBUG=0]="DEBUG",s[s.VERBOSE=1]="VERBOSE",s[s.INFO=2]="INFO",s[s.WARN=3]="WARN",s[s.ERROR=4]="ERROR",s[s.SILENT=5]="SILENT"})(dt||(dt={}));const RS={debug:dt.DEBUG,verbose:dt.VERBOSE,info:dt.INFO,warn:dt.WARN,error:dt.ERROR,silent:dt.SILENT},jS=dt.INFO,CS={[dt.DEBUG]:"log",[dt.VERBOSE]:"log",[dt.INFO]:"info",[dt.WARN]:"warn",[dt.ERROR]:"error"},IS=(s,e,...t)=>{if(e<s.logLevel)return;const r=new Date().toISOString(),o=CS[e];if(o)console[o](`[${r}]  ${s.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class jg{constructor(e){this.name=e,this._logLevel=jS,this._logHandler=IS,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in dt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?RS[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,dt.DEBUG,...e),this._logHandler(this,dt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,dt.VERBOSE,...e),this._logHandler(this,dt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,dt.INFO,...e),this._logHandler(this,dt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,dt.WARN,...e),this._logHandler(this,dt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,dt.ERROR,...e),this._logHandler(this,dt.ERROR,...e)}}const DS=(s,e)=>e.some(t=>s instanceof t);let nv,av;function MS(){return nv||(nv=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function OS(){return av||(av=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const o1=new WeakMap,$f=new WeakMap,l1=new WeakMap,Df=new WeakMap,Cg=new WeakMap;function PS(s){const e=new Promise((t,r)=>{const o=()=>{s.removeEventListener("success",c),s.removeEventListener("error",d)},c=()=>{t(Mr(s.result)),o()},d=()=>{r(s.error),o()};s.addEventListener("success",c),s.addEventListener("error",d)});return e.then(t=>{t instanceof IDBCursor&&o1.set(t,s)}).catch(()=>{}),Cg.set(e,s),e}function zS(s){if($f.has(s))return;const e=new Promise((t,r)=>{const o=()=>{s.removeEventListener("complete",c),s.removeEventListener("error",d),s.removeEventListener("abort",d)},c=()=>{t(),o()},d=()=>{r(s.error||new DOMException("AbortError","AbortError")),o()};s.addEventListener("complete",c),s.addEventListener("error",d),s.addEventListener("abort",d)});$f.set(s,e)}let Kf={get(s,e,t){if(s instanceof IDBTransaction){if(e==="done")return $f.get(s);if(e==="objectStoreNames")return s.objectStoreNames||l1.get(s);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Mr(s[e])},set(s,e,t){return s[e]=t,!0},has(s,e){return s instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in s}};function LS(s){Kf=s(Kf)}function VS(s){return s===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=s.call(Mf(this),e,...t);return l1.set(r,e.sort?e.sort():[e]),Mr(r)}:OS().includes(s)?function(...e){return s.apply(Mf(this),e),Mr(o1.get(this))}:function(...e){return Mr(s.apply(Mf(this),e))}}function US(s){return typeof s=="function"?VS(s):(s instanceof IDBTransaction&&zS(s),DS(s,MS())?new Proxy(s,Kf):s)}function Mr(s){if(s instanceof IDBRequest)return PS(s);if(Df.has(s))return Df.get(s);const e=US(s);return e!==s&&(Df.set(s,e),Cg.set(e,s)),e}const Mf=s=>Cg.get(s);function BS(s,e,{blocked:t,upgrade:r,blocking:o,terminated:c}={}){const d=indexedDB.open(s,e),f=Mr(d);return r&&d.addEventListener("upgradeneeded",p=>{r(Mr(d.result),p.oldVersion,p.newVersion,Mr(d.transaction),p)}),t&&d.addEventListener("blocked",p=>t(p.oldVersion,p.newVersion,p)),f.then(p=>{c&&p.addEventListener("close",()=>c()),o&&p.addEventListener("versionchange",y=>o(y.oldVersion,y.newVersion,y))}).catch(()=>{}),f}const HS=["get","getKey","getAll","getAllKeys","count"],GS=["put","add","delete","clear"],Of=new Map;function sv(s,e){if(!(s instanceof IDBDatabase&&!(e in s)&&typeof e=="string"))return;if(Of.get(e))return Of.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,o=GS.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(o||HS.includes(t)))return;const c=async function(d,...f){const p=this.transaction(d,o?"readwrite":"readonly");let y=p.store;return r&&(y=y.index(f.shift())),(await Promise.all([y[t](...f),o&&p.done]))[0]};return Of.set(e,c),c}LS(s=>({...s,get:(e,t,r)=>sv(e,t)||s.get(e,t,r),has:(e,t)=>!!sv(e,t)||s.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FS{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(qS(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function qS(s){return s.getComponent()?.type==="VERSION"}const Yf="@firebase/app",rv="0.14.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qs=new jg("@firebase/app"),$S="@firebase/app-compat",KS="@firebase/analytics-compat",YS="@firebase/analytics",QS="@firebase/app-check-compat",XS="@firebase/app-check",ZS="@firebase/auth",WS="@firebase/auth-compat",JS="@firebase/database",eA="@firebase/data-connect",tA="@firebase/database-compat",nA="@firebase/functions",aA="@firebase/functions-compat",sA="@firebase/installations",rA="@firebase/installations-compat",iA="@firebase/messaging",oA="@firebase/messaging-compat",lA="@firebase/performance",cA="@firebase/performance-compat",uA="@firebase/remote-config",dA="@firebase/remote-config-compat",hA="@firebase/storage",mA="@firebase/storage-compat",fA="@firebase/firestore",gA="@firebase/ai",pA="@firebase/firestore-compat",yA="firebase",xA="12.2.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qf="[DEFAULT]",vA={[Yf]:"fire-core",[$S]:"fire-core-compat",[YS]:"fire-analytics",[KS]:"fire-analytics-compat",[XS]:"fire-app-check",[QS]:"fire-app-check-compat",[ZS]:"fire-auth",[WS]:"fire-auth-compat",[JS]:"fire-rtdb",[eA]:"fire-data-connect",[tA]:"fire-rtdb-compat",[nA]:"fire-fn",[aA]:"fire-fn-compat",[sA]:"fire-iid",[rA]:"fire-iid-compat",[iA]:"fire-fcm",[oA]:"fire-fcm-compat",[lA]:"fire-perf",[cA]:"fire-perf-compat",[uA]:"fire-rc",[dA]:"fire-rc-compat",[hA]:"fire-gcs",[mA]:"fire-gcs-compat",[fA]:"fire-fst",[pA]:"fire-fst-compat",[gA]:"fire-vertex","fire-js":"fire-js",[yA]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xc=new Map,bA=new Map,Xf=new Map;function iv(s,e){try{s.container.addComponent(e)}catch(t){Qs.debug(`Component ${e.name} failed to register with FirebaseApp ${s.name}`,t)}}function Vo(s){const e=s.name;if(Xf.has(e))return Qs.debug(`There were multiple attempts to register component ${e}.`),!1;Xf.set(e,s);for(const t of xc.values())iv(t,s);for(const t of bA.values())iv(t,s);return!0}function Ig(s,e){const t=s.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),s.container.getProvider(e)}function Aa(s){return s==null?!1:s.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _A={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Or=new zc("app","Firebase",_A);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kA{constructor(e,t,r){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Si("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Or.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xo=xA;function c1(s,e={}){let t=s;typeof e!="object"&&(e={name:e});const r={name:Qf,automaticDataCollectionEnabled:!0,...e},o=r.name;if(typeof o!="string"||!o)throw Or.create("bad-app-name",{appName:String(o)});if(t||(t=s1()),!t)throw Or.create("no-options");const c=xc.get(o);if(c){if(Ei(t,c.options)&&Ei(r,c.config))return c;throw Or.create("duplicate-app",{appName:o})}const d=new NS(o);for(const p of Xf.values())d.addComponent(p);const f=new kA(t,r,d);return xc.set(o,f),f}function u1(s=Qf){const e=xc.get(s);if(!e&&s===Qf&&s1())return c1();if(!e)throw Or.create("no-app",{appName:s});return e}function TA(){return Array.from(xc.values())}function Pr(s,e,t){let r=vA[s]??s;t&&(r+=`-${t}`);const o=r.match(/\s|\//),c=e.match(/\s|\//);if(o||c){const d=[`Unable to register library "${r}" with version "${e}":`];o&&d.push(`library name "${r}" contains illegal characters (whitespace or "/")`),o&&c&&d.push("and"),c&&d.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Qs.warn(d.join(" "));return}Vo(new Si(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wA="firebase-heartbeat-database",EA=1,vc="firebase-heartbeat-store";let Pf=null;function d1(){return Pf||(Pf=BS(wA,EA,{upgrade:(s,e)=>{switch(e){case 0:try{s.createObjectStore(vc)}catch(t){console.warn(t)}}}}).catch(s=>{throw Or.create("idb-open",{originalErrorMessage:s.message})})),Pf}async function SA(s){try{const t=(await d1()).transaction(vc),r=await t.objectStore(vc).get(h1(s));return await t.done,r}catch(e){if(e instanceof er)Qs.warn(e.message);else{const t=Or.create("idb-get",{originalErrorMessage:e?.message});Qs.warn(t.message)}}}async function ov(s,e){try{const r=(await d1()).transaction(vc,"readwrite");await r.objectStore(vc).put(e,h1(s)),await r.done}catch(t){if(t instanceof er)Qs.warn(t.message);else{const r=Or.create("idb-set",{originalErrorMessage:t?.message});Qs.warn(r.message)}}}function h1(s){return`${s.name}!${s.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AA=1024,NA=30;class RA{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new CA(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=lv();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(o=>o.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:t}),this._heartbeatsCache.heartbeats.length>NA){const o=IA(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Qs.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=lv(),{heartbeatsToSend:t,unsentEntries:r}=jA(this._heartbeatsCache.heartbeats),o=n1(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(e){return Qs.warn(e),""}}}function lv(){return new Date().toISOString().substring(0,10)}function jA(s,e=AA){const t=[];let r=s.slice();for(const o of s){const c=t.find(d=>d.agent===o.agent);if(c){if(c.dates.push(o.date),cv(t)>e){c.dates.pop();break}}else if(t.push({agent:o.agent,dates:[o.date]}),cv(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class CA{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return pS()?yS().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await SA(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return ov(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return ov(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function cv(s){return n1(JSON.stringify({version:2,heartbeats:s})).length}function IA(s){if(s.length===0)return-1;let e=0,t=s[0].date;for(let r=1;r<s.length;r++)s[r].date<t&&(t=s[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DA(s){Vo(new Si("platform-logger",e=>new FS(e),"PRIVATE")),Vo(new Si("heartbeat",e=>new RA(e),"PRIVATE")),Pr(Yf,rv,s),Pr(Yf,rv,"esm2020"),Pr("fire-js","")}DA("");function m1(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const MA=m1,f1=new zc("auth","Firebase",m1());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vd=new jg("@firebase/auth");function OA(s,...e){Vd.logLevel<=dt.WARN&&Vd.warn(`Auth (${Xo}): ${s}`,...e)}function Sd(s,...e){Vd.logLevel<=dt.ERROR&&Vd.error(`Auth (${Xo}): ${s}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ua(s,...e){throw Dg(s,...e)}function ls(s,...e){return Dg(s,...e)}function g1(s,e,t){const r={...MA(),[e]:t};return new zc("auth","Firebase",r).create(e,{appName:s.name})}function $s(s){return g1(s,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Dg(s,...e){if(typeof s!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=s.name),s._errorFactory.create(t,...r)}return f1.create(s,...e)}function Ye(s,e,...t){if(!s)throw Dg(e,...t)}function Gs(s){const e="INTERNAL ASSERTION FAILED: "+s;throw Sd(e),new Error(e)}function Xs(s,e){s||Gs(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zf(){return typeof self<"u"&&self.location?.href||""}function PA(){return uv()==="http:"||uv()==="https:"}function uv(){return typeof self<"u"&&self.location?.protocol||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zA(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(PA()||hS()||"connection"in navigator)?navigator.onLine:!0}function LA(){if(typeof navigator>"u")return null;const s=navigator;return s.languages&&s.languages[0]||s.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vc{constructor(e,t){this.shortDelay=e,this.longDelay=t,Xs(t>e,"Short delay should be less than long delay!"),this.isMobile=cS()||mS()}get(){return zA()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mg(s,e){Xs(s.emulator,"Emulator should always be set here");const{url:t}=s.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p1{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Gs("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Gs("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Gs("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VA={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UA=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],BA=new Vc(3e4,6e4);function Kr(s,e){return s.tenantId&&!e.tenantId?{...e,tenantId:s.tenantId}:e}async function Yr(s,e,t,r,o={}){return y1(s,o,async()=>{let c={},d={};r&&(e==="GET"?d=r:c={body:JSON.stringify(r)});const f=Lc({key:s.config.apiKey,...d}).slice(1),p=await s._getAdditionalHeaders();p["Content-Type"]="application/json",s.languageCode&&(p["X-Firebase-Locale"]=s.languageCode);const y={method:e,headers:p,...c};return dS()||(y.referrerPolicy="no-referrer"),s.emulatorConfig&&Qo(s.emulatorConfig.host)&&(y.credentials="include"),p1.fetch()(await x1(s,s.config.apiHost,t,f),y)})}async function y1(s,e,t){s._canInitEmulator=!1;const r={...VA,...e};try{const o=new GA(s),c=await Promise.race([t(),o.promise]);o.clearNetworkTimeout();const d=await c.json();if("needConfirmation"in d)throw yd(s,"account-exists-with-different-credential",d);if(c.ok&&!("errorMessage"in d))return d;{const f=c.ok?d.errorMessage:d.error.message,[p,y]=f.split(" : ");if(p==="FEDERATED_USER_ID_ALREADY_LINKED")throw yd(s,"credential-already-in-use",d);if(p==="EMAIL_EXISTS")throw yd(s,"email-already-in-use",d);if(p==="USER_DISABLED")throw yd(s,"user-disabled",d);const v=r[p]||p.toLowerCase().replace(/[_\s]+/g,"-");if(y)throw g1(s,v,y);Ua(s,v)}}catch(o){if(o instanceof er)throw o;Ua(s,"network-request-failed",{message:String(o)})}}async function Uc(s,e,t,r,o={}){const c=await Yr(s,e,t,r,o);return"mfaPendingCredential"in c&&Ua(s,"multi-factor-auth-required",{_serverResponse:c}),c}async function x1(s,e,t,r){const o=`${e}${t}?${r}`,c=s,d=c.config.emulator?Mg(s.config,o):`${s.config.apiScheme}://${o}`;return UA.includes(t)&&(await c._persistenceManagerAvailable,c._getPersistenceType()==="COOKIE")?c._getPersistence()._getFinalTarget(d).toString():d}function HA(s){switch(s){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class GA{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(ls(this.auth,"network-request-failed")),BA.get())})}}function yd(s,e,t){const r={appName:s.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const o=ls(s,e,r);return o.customData._tokenResponse=t,o}function dv(s){return s!==void 0&&s.enterprise!==void 0}class FA{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return HA(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function qA(s,e){return Yr(s,"GET","/v2/recaptchaConfig",Kr(s,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $A(s,e){return Yr(s,"POST","/v1/accounts:delete",e)}async function Ud(s,e){return Yr(s,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hc(s){if(s)try{const e=new Date(Number(s));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function KA(s,e=!1){const t=Kn(s),r=await t.getIdToken(e),o=Og(r);Ye(o&&o.exp&&o.auth_time&&o.iat,t.auth,"internal-error");const c=typeof o.firebase=="object"?o.firebase:void 0,d=c?.sign_in_provider;return{claims:o,token:r,authTime:hc(zf(o.auth_time)),issuedAtTime:hc(zf(o.iat)),expirationTime:hc(zf(o.exp)),signInProvider:d||null,signInSecondFactor:c?.sign_in_second_factor||null}}function zf(s){return Number(s)*1e3}function Og(s){const[e,t,r]=s.split(".");if(e===void 0||t===void 0||r===void 0)return Sd("JWT malformed, contained fewer than 3 sections"),null;try{const o=a1(t);return o?JSON.parse(o):(Sd("Failed to decode base64 JWT payload"),null)}catch(o){return Sd("Caught error parsing JWT payload as JSON",o?.toString()),null}}function hv(s){const e=Og(s);return Ye(e,"internal-error"),Ye(typeof e.exp<"u","internal-error"),Ye(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bc(s,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof er&&YA(r)&&s.auth.currentUser===s&&await s.auth.signOut(),r}}function YA({code:s}){return s==="auth/user-disabled"||s==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QA{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wf{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=hc(this.lastLoginAt),this.creationTime=hc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Bd(s){const e=s.auth,t=await s.getIdToken(),r=await bc(s,Ud(e,{idToken:t}));Ye(r?.users.length,e,"internal-error");const o=r.users[0];s._notifyReloadListener(o);const c=o.providerUserInfo?.length?v1(o.providerUserInfo):[],d=ZA(s.providerData,c),f=s.isAnonymous,p=!(s.email&&o.passwordHash)&&!d?.length,y=f?p:!1,v={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:d,metadata:new Wf(o.createdAt,o.lastLoginAt),isAnonymous:y};Object.assign(s,v)}async function XA(s){const e=Kn(s);await Bd(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function ZA(s,e){return[...s.filter(r=>!e.some(o=>o.providerId===r.providerId)),...e]}function v1(s){return s.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function WA(s,e){const t=await y1(s,{},async()=>{const r=Lc({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:o,apiKey:c}=s.config,d=await x1(s,o,"/v1/token",`key=${c}`),f=await s._getAdditionalHeaders();f["Content-Type"]="application/x-www-form-urlencoded";const p={method:"POST",headers:f,body:r};return s.emulatorConfig&&Qo(s.emulatorConfig.host)&&(p.credentials="include"),p1.fetch()(d,p)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function JA(s,e){return Yr(s,"POST","/v2/accounts:revokeToken",Kr(s,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mo{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ye(e.idToken,"internal-error"),Ye(typeof e.idToken<"u","internal-error"),Ye(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):hv(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Ye(e.length!==0,"internal-error");const t=hv(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Ye(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:o,expiresIn:c}=await WA(e,t);this.updateTokensAndExpiration(r,o,Number(c))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:o,expirationTime:c}=t,d=new Mo;return r&&(Ye(typeof r=="string","internal-error",{appName:e}),d.refreshToken=r),o&&(Ye(typeof o=="string","internal-error",{appName:e}),d.accessToken=o),c&&(Ye(typeof c=="number","internal-error",{appName:e}),d.expirationTime=c),d}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Mo,this.toJSON())}_performRefresh(){return Gs("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sr(s,e){Ye(typeof s=="string"||typeof s>"u","internal-error",{appName:e})}class za{constructor({uid:e,auth:t,stsTokenManager:r,...o}){this.providerId="firebase",this.proactiveRefresh=new QA(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new Wf(o.createdAt||void 0,o.lastLoginAt||void 0)}async getIdToken(e){const t=await bc(this,this.stsTokenManager.getToken(this.auth,e));return Ye(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return KA(this,e)}reload(){return XA(this)}_assign(e){this!==e&&(Ye(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new za({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Ye(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await Bd(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Aa(this.auth.app))return Promise.reject($s(this.auth));const e=await this.getIdToken();return await bc(this,$A(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const r=t.displayName??void 0,o=t.email??void 0,c=t.phoneNumber??void 0,d=t.photoURL??void 0,f=t.tenantId??void 0,p=t._redirectEventId??void 0,y=t.createdAt??void 0,v=t.lastLoginAt??void 0,{uid:k,emailVerified:S,isAnonymous:I,providerData:q,stsTokenManager:L}=t;Ye(k&&L,e,"internal-error");const P=Mo.fromJSON(this.name,L);Ye(typeof k=="string",e,"internal-error"),Sr(r,e.name),Sr(o,e.name),Ye(typeof S=="boolean",e,"internal-error"),Ye(typeof I=="boolean",e,"internal-error"),Sr(c,e.name),Sr(d,e.name),Sr(f,e.name),Sr(p,e.name),Sr(y,e.name),Sr(v,e.name);const K=new za({uid:k,auth:e,email:o,emailVerified:S,displayName:r,isAnonymous:I,photoURL:d,phoneNumber:c,tenantId:f,stsTokenManager:P,createdAt:y,lastLoginAt:v});return q&&Array.isArray(q)&&(K.providerData=q.map(U=>({...U}))),p&&(K._redirectEventId=p),K}static async _fromIdTokenResponse(e,t,r=!1){const o=new Mo;o.updateFromServerResponse(t);const c=new za({uid:t.localId,auth:e,stsTokenManager:o,isAnonymous:r});return await Bd(c),c}static async _fromGetAccountInfoResponse(e,t,r){const o=t.users[0];Ye(o.localId!==void 0,"internal-error");const c=o.providerUserInfo!==void 0?v1(o.providerUserInfo):[],d=!(o.email&&o.passwordHash)&&!c?.length,f=new Mo;f.updateFromIdToken(r);const p=new za({uid:o.localId,auth:e,stsTokenManager:f,isAnonymous:d}),y={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:c,metadata:new Wf(o.createdAt,o.lastLoginAt),isAnonymous:!(o.email&&o.passwordHash)&&!c?.length};return Object.assign(p,y),p}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mv=new Map;function Fs(s){Xs(s instanceof Function,"Expected a class definition");let e=mv.get(s);return e?(Xs(e instanceof s,"Instance stored in cache mismatched with class"),e):(e=new s,mv.set(s,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b1{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}b1.type="NONE";const fv=b1;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ad(s,e,t){return`firebase:${s}:${e}:${t}`}class Oo{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:o,name:c}=this.auth;this.fullUserKey=Ad(this.userKey,o.apiKey,c),this.fullPersistenceKey=Ad("persistence",o.apiKey,c),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Ud(this.auth,{idToken:e}).catch(()=>{});return t?za._fromGetAccountInfoResponse(this.auth,t,e):null}return za._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new Oo(Fs(fv),e,r);const o=(await Promise.all(t.map(async y=>{if(await y._isAvailable())return y}))).filter(y=>y);let c=o[0]||Fs(fv);const d=Ad(r,e.config.apiKey,e.name);let f=null;for(const y of t)try{const v=await y._get(d);if(v){let k;if(typeof v=="string"){const S=await Ud(e,{idToken:v}).catch(()=>{});if(!S)break;k=await za._fromGetAccountInfoResponse(e,S,v)}else k=za._fromJSON(e,v);y!==c&&(f=k),c=y;break}}catch{}const p=o.filter(y=>y._shouldAllowMigration);return!c._shouldAllowMigration||!p.length?new Oo(c,e,r):(c=p[0],f&&await c._set(d,f.toJSON()),await Promise.all(t.map(async y=>{if(y!==c)try{await y._remove(d)}catch{}})),new Oo(c,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gv(s){const e=s.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(w1(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(_1(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(S1(e))return"Blackberry";if(A1(e))return"Webos";if(k1(e))return"Safari";if((e.includes("chrome/")||T1(e))&&!e.includes("edge/"))return"Chrome";if(E1(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=s.match(t);if(r?.length===2)return r[1]}return"Other"}function _1(s=Hn()){return/firefox\//i.test(s)}function k1(s=Hn()){const e=s.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function T1(s=Hn()){return/crios\//i.test(s)}function w1(s=Hn()){return/iemobile/i.test(s)}function E1(s=Hn()){return/android/i.test(s)}function S1(s=Hn()){return/blackberry/i.test(s)}function A1(s=Hn()){return/webos/i.test(s)}function Pg(s=Hn()){return/iphone|ipad|ipod/i.test(s)||/macintosh/i.test(s)&&/mobile/i.test(s)}function eN(s=Hn()){return Pg(s)&&!!window.navigator?.standalone}function tN(){return fS()&&document.documentMode===10}function N1(s=Hn()){return Pg(s)||E1(s)||A1(s)||S1(s)||/windows phone/i.test(s)||w1(s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function R1(s,e=[]){let t;switch(s){case"Browser":t=gv(Hn());break;case"Worker":t=`${gv(Hn())}-${s}`;break;default:t=s}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Xo}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nN{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=c=>new Promise((d,f)=>{try{const p=e(c);d(p)}catch(p){f(p)}});r.onAbort=t,this.queue.push(r);const o=this.queue.length-1;return()=>{this.queue[o]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const o of t)try{o()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function aN(s,e={}){return Yr(s,"GET","/v2/passwordPolicy",Kr(s,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sN=6;class rN{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??sN,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,o=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),o&&(t.meetsMaxPasswordLength=e.length<=o)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let o=0;o<e.length;o++)r=e.charAt(o),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,o,c){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=o)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=c))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iN{constructor(e,t,r,o){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=o,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new pv(this),this.idTokenSubscription=new pv(this),this.beforeStateQueue=new nN(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=f1,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=o.sdkClientVersion,this._persistenceManagerAvailable=new Promise(c=>this._resolvePersistenceManagerAvailable=c)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Fs(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Oo.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Ud(this,{idToken:e}),r=await za._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Aa(this.app)){const c=this.app.settings.authIdToken;return c?new Promise(d=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(c).then(d,d))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let r=t,o=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const c=this.redirectUser?._redirectEventId,d=r?._redirectEventId,f=await this.tryRedirectSignIn(e);(!c||c===d)&&f?.user&&(r=f.user,o=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(o)try{await this.beforeStateQueue.runMiddleware(r)}catch(c){r=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(c))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return Ye(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Bd(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=LA()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Aa(this.app))return Promise.reject($s(this));const t=e?Kn(e):null;return t&&Ye(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Ye(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Aa(this.app)?Promise.reject($s(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Aa(this.app)?Promise.reject($s(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Fs(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await aN(this),t=new rN(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new zc("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await JA(this,r)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Fs(e)||this._popupRedirectResolver;Ye(t,this,"argument-error"),this.redirectPersistenceManager=await Oo.create(this,[Fs(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,o){if(this._deleted)return()=>{};const c=typeof t=="function"?t:t.next.bind(t);let d=!1;const f=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ye(f,this,"internal-error"),f.then(()=>{d||c(this.currentUser)}),typeof t=="function"){const p=e.addObserver(t,r,o);return()=>{d=!0,p()}}else{const p=e.addObserver(t);return()=>{d=!0,p()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ye(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=R1(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){if(Aa(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&OA(`Error while retrieving App Check token: ${e.error}`),e?.token}}function Oi(s){return Kn(s)}class pv{constructor(e){this.auth=e,this.observer=null,this.addObserver=kS(t=>this.observer=t)}get next(){return Ye(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let oh={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function oN(s){oh=s}function j1(s){return oh.loadJS(s)}function lN(){return oh.recaptchaEnterpriseScript}function cN(){return oh.gapiScript}function uN(s){return`__${s}${Math.floor(Math.random()*1e6)}`}class dN{constructor(){this.enterprise=new hN}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class hN{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const mN="recaptcha-enterprise",C1="NO_RECAPTCHA";class fN{constructor(e){this.type=mN,this.auth=Oi(e)}async verify(e="verify",t=!1){async function r(c){if(!t){if(c.tenantId==null&&c._agentRecaptchaConfig!=null)return c._agentRecaptchaConfig.siteKey;if(c.tenantId!=null&&c._tenantRecaptchaConfigs[c.tenantId]!==void 0)return c._tenantRecaptchaConfigs[c.tenantId].siteKey}return new Promise(async(d,f)=>{qA(c,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(p=>{if(p.recaptchaKey===void 0)f(new Error("recaptcha Enterprise site key undefined"));else{const y=new FA(p);return c.tenantId==null?c._agentRecaptchaConfig=y:c._tenantRecaptchaConfigs[c.tenantId]=y,d(y.siteKey)}}).catch(p=>{f(p)})})}function o(c,d,f){const p=window.grecaptcha;dv(p)?p.enterprise.ready(()=>{p.enterprise.execute(c,{action:e}).then(y=>{d(y)}).catch(()=>{d(C1)})}):f(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new dN().execute("siteKey",{action:"verify"}):new Promise((c,d)=>{r(this.auth).then(f=>{if(!t&&dv(window.grecaptcha))o(f,c,d);else{if(typeof window>"u"){d(new Error("RecaptchaVerifier is only supported in browser"));return}let p=lN();p.length!==0&&(p+=f),j1(p).then(()=>{o(f,c,d)}).catch(y=>{d(y)})}}).catch(f=>{d(f)})})}}async function yv(s,e,t,r=!1,o=!1){const c=new fN(s);let d;if(o)d=C1;else try{d=await c.verify(t)}catch{d=await c.verify(t,!0)}const f={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in f){const p=f.phoneEnrollmentInfo.phoneNumber,y=f.phoneEnrollmentInfo.recaptchaToken;Object.assign(f,{phoneEnrollmentInfo:{phoneNumber:p,recaptchaToken:y,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in f){const p=f.phoneSignInInfo.recaptchaToken;Object.assign(f,{phoneSignInInfo:{recaptchaToken:p,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return f}return r?Object.assign(f,{captchaResp:d}):Object.assign(f,{captchaResponse:d}),Object.assign(f,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(f,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),f}async function Jf(s,e,t,r,o){if(s._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const c=await yv(s,e,t,t==="getOobCode");return r(s,c)}else return r(s,e).catch(async c=>{if(c.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const d=await yv(s,e,t,t==="getOobCode");return r(s,d)}else return Promise.reject(c)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gN(s,e){const t=Ig(s,"auth");if(t.isInitialized()){const o=t.getImmediate(),c=t.getOptions();if(Ei(c,e??{}))return o;Ua(o,"already-initialized")}return t.initialize({options:e})}function pN(s,e){const t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(Fs);e?.errorMap&&s._updateErrorMap(e.errorMap),s._initializeWithPersistence(r,e?.popupRedirectResolver)}function yN(s,e,t){const r=Oi(s);Ye(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const o=!1,c=I1(e),{host:d,port:f}=xN(e),p=f===null?"":`:${f}`,y={url:`${c}//${d}${p}/`},v=Object.freeze({host:d,port:f,protocol:c.replace(":",""),options:Object.freeze({disableWarnings:o})});if(!r._canInitEmulator){Ye(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),Ye(Ei(y,r.config.emulator)&&Ei(v,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=y,r.emulatorConfig=v,r.settings.appVerificationDisabledForTesting=!0,Qo(d)?(i1(`${c}//${d}${p}`),lS("Auth",!0)):vN()}function I1(s){const e=s.indexOf(":");return e<0?"":s.substr(0,e+1)}function xN(s){const e=I1(s),t=/(\/\/)?([^?#/]+)/.exec(s.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",o=/^(\[[^\]]+\])(:|$)/.exec(r);if(o){const c=o[1];return{host:c,port:xv(r.substr(c.length+1))}}else{const[c,d]=r.split(":");return{host:c,port:xv(d)}}}function xv(s){if(!s)return null;const e=Number(s);return isNaN(e)?null:e}function vN(){function s(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",s):s())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zg{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Gs("not implemented")}_getIdTokenResponse(e){return Gs("not implemented")}_linkToIdToken(e,t){return Gs("not implemented")}_getReauthenticationResolver(e){return Gs("not implemented")}}async function bN(s,e){return Yr(s,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _N(s,e){return Uc(s,"POST","/v1/accounts:signInWithPassword",Kr(s,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kN(s,e){return Uc(s,"POST","/v1/accounts:signInWithEmailLink",Kr(s,e))}async function TN(s,e){return Uc(s,"POST","/v1/accounts:signInWithEmailLink",Kr(s,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _c extends zg{constructor(e,t,r,o=null){super("password",r),this._email=e,this._password=t,this._tenantId=o}static _fromEmailAndPassword(e,t){return new _c(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new _c(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Jf(e,t,"signInWithPassword",_N);case"emailLink":return kN(e,{email:this._email,oobCode:this._password});default:Ua(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Jf(e,r,"signUpPassword",bN);case"emailLink":return TN(e,{idToken:t,email:this._email,oobCode:this._password});default:Ua(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Po(s,e){return Uc(s,"POST","/v1/accounts:signInWithIdp",Kr(s,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wN="http://localhost";class Ai extends zg{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Ai(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Ua("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:o,...c}=t;if(!r||!o)return null;const d=new Ai(r,o);return d.idToken=c.idToken||void 0,d.accessToken=c.accessToken||void 0,d.secret=c.secret,d.nonce=c.nonce,d.pendingToken=c.pendingToken||null,d}_getIdTokenResponse(e){const t=this.buildRequest();return Po(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,Po(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Po(e,t)}buildRequest(){const e={requestUri:wN,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Lc(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EN(s){switch(s){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function SN(s){const e=rc(ic(s)).link,t=e?rc(ic(e)).deep_link_id:null,r=rc(ic(s)).deep_link_id;return(r?rc(ic(r)).link:null)||r||t||e||s}class Lg{constructor(e){const t=rc(ic(e)),r=t.apiKey??null,o=t.oobCode??null,c=EN(t.mode??null);Ye(r&&o&&c,"argument-error"),this.apiKey=r,this.operation=c,this.code=o,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=SN(e);try{return new Lg(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zo{constructor(){this.providerId=Zo.PROVIDER_ID}static credential(e,t){return _c._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const r=Lg.parseLink(t);return Ye(r,"argument-error"),_c._fromEmailAndCode(e,r.code,r.tenantId)}}Zo.PROVIDER_ID="password";Zo.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Zo.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D1{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bc extends D1{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nr extends Bc{constructor(){super("facebook.com")}static credential(e){return Ai._fromParams({providerId:Nr.PROVIDER_ID,signInMethod:Nr.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Nr.credentialFromTaggedObject(e)}static credentialFromError(e){return Nr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Nr.credential(e.oauthAccessToken)}catch{return null}}}Nr.FACEBOOK_SIGN_IN_METHOD="facebook.com";Nr.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rr extends Bc{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Ai._fromParams({providerId:Rr.PROVIDER_ID,signInMethod:Rr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Rr.credentialFromTaggedObject(e)}static credentialFromError(e){return Rr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return Rr.credential(t,r)}catch{return null}}}Rr.GOOGLE_SIGN_IN_METHOD="google.com";Rr.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jr extends Bc{constructor(){super("github.com")}static credential(e){return Ai._fromParams({providerId:jr.PROVIDER_ID,signInMethod:jr.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return jr.credentialFromTaggedObject(e)}static credentialFromError(e){return jr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return jr.credential(e.oauthAccessToken)}catch{return null}}}jr.GITHUB_SIGN_IN_METHOD="github.com";jr.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cr extends Bc{constructor(){super("twitter.com")}static credential(e,t){return Ai._fromParams({providerId:Cr.PROVIDER_ID,signInMethod:Cr.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Cr.credentialFromTaggedObject(e)}static credentialFromError(e){return Cr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return Cr.credential(t,r)}catch{return null}}}Cr.TWITTER_SIGN_IN_METHOD="twitter.com";Cr.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function AN(s,e){return Uc(s,"POST","/v1/accounts:signUp",Kr(s,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ni{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,o=!1){const c=await za._fromIdTokenResponse(e,r,o),d=vv(r);return new Ni({user:c,providerId:d,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const o=vv(r);return new Ni({user:e,providerId:o,_tokenResponse:r,operationType:t})}}function vv(s){return s.providerId?s.providerId:"phoneNumber"in s?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hd extends er{constructor(e,t,r,o){super(t.code,t.message),this.operationType=r,this.user=o,Object.setPrototypeOf(this,Hd.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,o){return new Hd(e,t,r,o)}}function M1(s,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(s):t._getIdTokenResponse(s)).catch(c=>{throw c.code==="auth/multi-factor-auth-required"?Hd._fromErrorAndOperation(s,c,e,r):c})}async function NN(s,e,t=!1){const r=await bc(s,e._linkToIdToken(s.auth,await s.getIdToken()),t);return Ni._forOperation(s,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function RN(s,e,t=!1){const{auth:r}=s;if(Aa(r.app))return Promise.reject($s(r));const o="reauthenticate";try{const c=await bc(s,M1(r,o,e,s),t);Ye(c.idToken,r,"internal-error");const d=Og(c.idToken);Ye(d,r,"internal-error");const{sub:f}=d;return Ye(s.uid===f,r,"user-mismatch"),Ni._forOperation(s,o,c)}catch(c){throw c?.code==="auth/user-not-found"&&Ua(r,"user-mismatch"),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function O1(s,e,t=!1){if(Aa(s.app))return Promise.reject($s(s));const r="signIn",o=await M1(s,r,e),c=await Ni._fromIdTokenResponse(s,r,o);return t||await s._updateCurrentUser(c.user),c}async function jN(s,e){return O1(Oi(s),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function P1(s){const e=Oi(s);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function CN(s,e,t){if(Aa(s.app))return Promise.reject($s(s));const r=Oi(s),d=await Jf(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",AN).catch(p=>{throw p.code==="auth/password-does-not-meet-requirements"&&P1(s),p}),f=await Ni._fromIdTokenResponse(r,"signIn",d);return await r._updateCurrentUser(f.user),f}function IN(s,e,t){return Aa(s.app)?Promise.reject($s(s)):jN(Kn(s),Zo.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&P1(s),r})}function DN(s,e,t,r){return Kn(s).onIdTokenChanged(e,t,r)}function MN(s,e,t){return Kn(s).beforeAuthStateChanged(e,t)}function ON(s,e,t,r){return Kn(s).onAuthStateChanged(e,t,r)}function PN(s){return Kn(s).signOut()}const Gd="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z1{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Gd,"1"),this.storage.removeItem(Gd),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zN=1e3,LN=10;class L1 extends z1{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=N1(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),o=this.localCache[t];r!==o&&e(t,o,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((d,f,p)=>{this.notifyListeners(d,p)});return}const r=e.key;t?this.detachListener():this.stopPolling();const o=()=>{const d=this.storage.getItem(r);!t&&this.localCache[r]===d||this.notifyListeners(r,d)},c=this.storage.getItem(r);tN()&&c!==e.newValue&&e.newValue!==e.oldValue?setTimeout(o,LN):o()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const o of Array.from(r))o(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},zN)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}L1.type="LOCAL";const VN=L1;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V1 extends z1{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}V1.type="SESSION";const U1=V1;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UN(s){return Promise.all(s.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lh{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(o=>o.isListeningto(e));if(t)return t;const r=new lh(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:o,data:c}=t.data,d=this.handlersMap[o];if(!d?.size)return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:o});const f=Array.from(d).map(async y=>y(t.origin,c)),p=await UN(f);t.ports[0].postMessage({status:"done",eventId:r,eventType:o,response:p})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}lh.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vg(s="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return s+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BN{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const o=typeof MessageChannel<"u"?new MessageChannel:null;if(!o)throw new Error("connection_unavailable");let c,d;return new Promise((f,p)=>{const y=Vg("",20);o.port1.start();const v=setTimeout(()=>{p(new Error("unsupported_event"))},r);d={messageChannel:o,onMessage(k){const S=k;if(S.data.eventId===y)switch(S.data.status){case"ack":clearTimeout(v),c=setTimeout(()=>{p(new Error("timeout"))},3e3);break;case"done":clearTimeout(c),f(S.data.response);break;default:clearTimeout(v),clearTimeout(c),p(new Error("invalid_response"));break}}},this.handlers.add(d),o.port1.addEventListener("message",d.onMessage),this.target.postMessage({eventType:e,eventId:y,data:t},[o.port2])}).finally(()=>{d&&this.removeMessageHandler(d)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cs(){return window}function HN(s){cs().location.href=s}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B1(){return typeof cs().WorkerGlobalScope<"u"&&typeof cs().importScripts=="function"}async function GN(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function FN(){return navigator?.serviceWorker?.controller||null}function qN(){return B1()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H1="firebaseLocalStorageDb",$N=1,Fd="firebaseLocalStorage",G1="fbase_key";class Hc{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function ch(s,e){return s.transaction([Fd],e?"readwrite":"readonly").objectStore(Fd)}function KN(){const s=indexedDB.deleteDatabase(H1);return new Hc(s).toPromise()}function eg(){const s=indexedDB.open(H1,$N);return new Promise((e,t)=>{s.addEventListener("error",()=>{t(s.error)}),s.addEventListener("upgradeneeded",()=>{const r=s.result;try{r.createObjectStore(Fd,{keyPath:G1})}catch(o){t(o)}}),s.addEventListener("success",async()=>{const r=s.result;r.objectStoreNames.contains(Fd)?e(r):(r.close(),await KN(),e(await eg()))})})}async function bv(s,e,t){const r=ch(s,!0).put({[G1]:e,value:t});return new Hc(r).toPromise()}async function YN(s,e){const t=ch(s,!1).get(e),r=await new Hc(t).toPromise();return r===void 0?null:r.value}function _v(s,e){const t=ch(s,!0).delete(e);return new Hc(t).toPromise()}const QN=800,XN=3;class F1{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await eg(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>XN)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return B1()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=lh._getInstance(qN()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await GN(),!this.activeServiceWorker)return;this.sender=new BN(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||FN()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await eg();return await bv(e,Gd,"1"),await _v(e,Gd),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>bv(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>YN(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>_v(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(o=>{const c=ch(o,!1).getAll();return new Hc(c).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:o,value:c}of e)r.add(o),JSON.stringify(this.localCache[o])!==JSON.stringify(c)&&(this.notifyListeners(o,c),t.push(o));for(const o of Object.keys(this.localCache))this.localCache[o]&&!r.has(o)&&(this.notifyListeners(o,null),t.push(o));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const o of Array.from(r))o(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),QN)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}F1.type="LOCAL";const ZN=F1;new Vc(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WN(s,e){return e?Fs(e):(Ye(s._popupRedirectResolver,s,"argument-error"),s._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ug extends zg{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Po(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Po(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Po(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function JN(s){return O1(s.auth,new Ug(s),s.bypassAuthState)}function e2(s){const{auth:e,user:t}=s;return Ye(t,e,"internal-error"),RN(t,new Ug(s),s.bypassAuthState)}async function t2(s){const{auth:e,user:t}=s;return Ye(t,e,"internal-error"),NN(t,new Ug(s),s.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q1{constructor(e,t,r,o,c=!1){this.auth=e,this.resolver=r,this.user=o,this.bypassAuthState=c,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:o,tenantId:c,error:d,type:f}=e;if(d){this.reject(d);return}const p={auth:this.auth,requestUri:t,sessionId:r,tenantId:c||void 0,postBody:o||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(f)(p))}catch(y){this.reject(y)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return JN;case"linkViaPopup":case"linkViaRedirect":return t2;case"reauthViaPopup":case"reauthViaRedirect":return e2;default:Ua(this.auth,"internal-error")}}resolve(e){Xs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Xs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n2=new Vc(2e3,1e4);class Do extends q1{constructor(e,t,r,o,c){super(e,t,o,c),this.provider=r,this.authWindow=null,this.pollId=null,Do.currentPopupAction&&Do.currentPopupAction.cancel(),Do.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Ye(e,this.auth,"internal-error"),e}async onExecution(){Xs(this.filter.length===1,"Popup operations only handle one event");const e=Vg();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(ls(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(ls(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Do.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(ls(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,n2.get())};e()}}Do.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a2="pendingRedirect",Nd=new Map;class s2 extends q1{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=Nd.get(this.auth._key());if(!e){try{const r=await r2(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Nd.set(this.auth._key(),e)}return this.bypassAuthState||Nd.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function r2(s,e){const t=l2(e),r=o2(s);if(!await r._isAvailable())return!1;const o=await r._get(t)==="true";return await r._remove(t),o}function i2(s,e){Nd.set(s._key(),e)}function o2(s){return Fs(s._redirectPersistence)}function l2(s){return Ad(a2,s.config.apiKey,s.name)}async function c2(s,e,t=!1){if(Aa(s.app))return Promise.reject($s(s));const r=Oi(s),o=WN(r,e),d=await new s2(r,o,t).execute();return d&&!t&&(delete d.user._redirectEventId,await r._persistUserIfCurrent(d.user),await r._setRedirectUser(null,e)),d}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u2=600*1e3;class d2{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!h2(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!$1(e)){const r=e.error.code?.split("auth/")[1]||"internal-error";t.onError(ls(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=u2&&this.cachedEventUids.clear(),this.cachedEventUids.has(kv(e))}saveEventToCache(e){this.cachedEventUids.add(kv(e)),this.lastProcessedEventTime=Date.now()}}function kv(s){return[s.type,s.eventId,s.sessionId,s.tenantId].filter(e=>e).join("-")}function $1({type:s,error:e}){return s==="unknown"&&e?.code==="auth/no-auth-event"}function h2(s){switch(s.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return $1(s);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function m2(s,e={}){return Yr(s,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f2=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,g2=/^https?/;async function p2(s){if(s.config.emulator)return;const{authorizedDomains:e}=await m2(s);for(const t of e)try{if(y2(t))return}catch{}Ua(s,"unauthorized-domain")}function y2(s){const e=Zf(),{protocol:t,hostname:r}=new URL(e);if(s.startsWith("chrome-extension://")){const d=new URL(s);return d.hostname===""&&r===""?t==="chrome-extension:"&&s.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&d.hostname===r}if(!g2.test(t))return!1;if(f2.test(s))return r===s;const o=s.replace(/\./g,"\\.");return new RegExp("^(.+\\."+o+"|"+o+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x2=new Vc(3e4,6e4);function Tv(){const s=cs().___jsl;if(s?.H){for(const e of Object.keys(s.H))if(s.H[e].r=s.H[e].r||[],s.H[e].L=s.H[e].L||[],s.H[e].r=[...s.H[e].L],s.CP)for(let t=0;t<s.CP.length;t++)s.CP[t]=null}}function v2(s){return new Promise((e,t)=>{function r(){Tv(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Tv(),t(ls(s,"network-request-failed"))},timeout:x2.get()})}if(cs().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(cs().gapi?.load)r();else{const o=uN("iframefcb");return cs()[o]=()=>{gapi.load?r():t(ls(s,"network-request-failed"))},j1(`${cN()}?onload=${o}`).catch(c=>t(c))}}).catch(e=>{throw Rd=null,e})}let Rd=null;function b2(s){return Rd=Rd||v2(s),Rd}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _2=new Vc(5e3,15e3),k2="__/auth/iframe",T2="emulator/auth/iframe",w2={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},E2=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function S2(s){const e=s.config;Ye(e.authDomain,s,"auth-domain-config-required");const t=e.emulator?Mg(e,T2):`https://${s.config.authDomain}/${k2}`,r={apiKey:e.apiKey,appName:s.name,v:Xo},o=E2.get(s.config.apiHost);o&&(r.eid=o);const c=s._getFrameworks();return c.length&&(r.fw=c.join(",")),`${t}?${Lc(r).slice(1)}`}async function A2(s){const e=await b2(s),t=cs().gapi;return Ye(t,s,"internal-error"),e.open({where:document.body,url:S2(s),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:w2,dontclear:!0},r=>new Promise(async(o,c)=>{await r.restyle({setHideOnLeave:!1});const d=ls(s,"network-request-failed"),f=cs().setTimeout(()=>{c(d)},_2.get());function p(){cs().clearTimeout(f),o(r)}r.ping(p).then(p,()=>{c(d)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N2={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},R2=500,j2=600,C2="_blank",I2="http://localhost";class wv{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function D2(s,e,t,r=R2,o=j2){const c=Math.max((window.screen.availHeight-o)/2,0).toString(),d=Math.max((window.screen.availWidth-r)/2,0).toString();let f="";const p={...N2,width:r.toString(),height:o.toString(),top:c,left:d},y=Hn().toLowerCase();t&&(f=T1(y)?C2:t),_1(y)&&(e=e||I2,p.scrollbars="yes");const v=Object.entries(p).reduce((S,[I,q])=>`${S}${I}=${q},`,"");if(eN(y)&&f!=="_self")return M2(e||"",f),new wv(null);const k=window.open(e||"",f,v);Ye(k,s,"popup-blocked");try{k.focus()}catch{}return new wv(k)}function M2(s,e){const t=document.createElement("a");t.href=s,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O2="__/auth/handler",P2="emulator/auth/handler",z2=encodeURIComponent("fac");async function Ev(s,e,t,r,o,c){Ye(s.config.authDomain,s,"auth-domain-config-required"),Ye(s.config.apiKey,s,"invalid-api-key");const d={apiKey:s.config.apiKey,appName:s.name,authType:t,redirectUrl:r,v:Xo,eventId:o};if(e instanceof D1){e.setDefaultLanguage(s.languageCode),d.providerId=e.providerId||"",_S(e.getCustomParameters())||(d.customParameters=JSON.stringify(e.getCustomParameters()));for(const[v,k]of Object.entries({}))d[v]=k}if(e instanceof Bc){const v=e.getScopes().filter(k=>k!=="");v.length>0&&(d.scopes=v.join(","))}s.tenantId&&(d.tid=s.tenantId);const f=d;for(const v of Object.keys(f))f[v]===void 0&&delete f[v];const p=await s._getAppCheckToken(),y=p?`#${z2}=${encodeURIComponent(p)}`:"";return`${L2(s)}?${Lc(f).slice(1)}${y}`}function L2({config:s}){return s.emulator?Mg(s,P2):`https://${s.authDomain}/${O2}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lf="webStorageSupport";class V2{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=U1,this._completeRedirectFn=c2,this._overrideRedirectResult=i2}async _openPopup(e,t,r,o){Xs(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const c=await Ev(e,t,r,Zf(),o);return D2(e,c,Vg())}async _openRedirect(e,t,r,o){await this._originValidation(e);const c=await Ev(e,t,r,Zf(),o);return HN(c),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:o,promise:c}=this.eventManagers[t];return o?Promise.resolve(o):(Xs(c,"If manager is not set, promise should be"),c)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await A2(e),r=new d2(e);return t.register("authEvent",o=>(Ye(o?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(o.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Lf,{type:Lf},o=>{const c=o?.[0]?.[Lf];c!==void 0&&t(!!c),Ua(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=p2(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return N1()||k1()||Pg()}}const U2=V2;var Sv="@firebase/auth",Av="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B2{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Ye(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function H2(s){switch(s){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function G2(s){Vo(new Si("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),o=e.getProvider("heartbeat"),c=e.getProvider("app-check-internal"),{apiKey:d,authDomain:f}=r.options;Ye(d&&!d.includes(":"),"invalid-api-key",{appName:r.name});const p={apiKey:d,authDomain:f,clientPlatform:s,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:R1(s)},y=new iN(r,o,c,p);return pN(y,t),y},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),Vo(new Si("auth-internal",e=>{const t=Oi(e.getProvider("auth").getImmediate());return(r=>new B2(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Pr(Sv,Av,H2(s)),Pr(Sv,Av,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F2=300,q2=r1("authIdTokenMaxAge")||F2;let Nv=null;const $2=s=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>q2)return;const o=t?.token;Nv!==o&&(Nv=o,await fetch(s,{method:o?"POST":"DELETE",headers:o?{Authorization:`Bearer ${o}`}:{}}))};function K2(s=u1()){const e=Ig(s,"auth");if(e.isInitialized())return e.getImmediate();const t=gN(s,{popupRedirectResolver:U2,persistence:[ZN,VN,U1]}),r=r1("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const c=new URL(r,location.origin);if(location.origin===c.origin){const d=$2(c.toString());MN(t,d,()=>d(t.currentUser)),DN(t,f=>d(f))}}const o=sS("auth");return o&&yN(t,`http://${o}`),t}function Y2(){return document.getElementsByTagName("head")?.[0]??document}oN({loadJS(s){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",s),r.onload=e,r.onerror=o=>{const c=ls("internal-error");c.customData=o,t(c)},r.type="text/javascript",r.charset="UTF-8",Y2().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});G2("Browser");var Q2="firebase",X2="12.2.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Pr(Q2,X2,"app");var Rv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var zr,K1;(function(){var s;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(N,R){function E(){}E.prototype=R.prototype,N.D=R.prototype,N.prototype=new E,N.prototype.constructor=N,N.C=function(C,M,z){for(var j=Array(arguments.length-2),Ve=2;Ve<arguments.length;Ve++)j[Ve-2]=arguments[Ve];return R.prototype[M].apply(C,j)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function o(N,R,E){E||(E=0);var C=Array(16);if(typeof R=="string")for(var M=0;16>M;++M)C[M]=R.charCodeAt(E++)|R.charCodeAt(E++)<<8|R.charCodeAt(E++)<<16|R.charCodeAt(E++)<<24;else for(M=0;16>M;++M)C[M]=R[E++]|R[E++]<<8|R[E++]<<16|R[E++]<<24;R=N.g[0],E=N.g[1],M=N.g[2];var z=N.g[3],j=R+(z^E&(M^z))+C[0]+3614090360&4294967295;R=E+(j<<7&4294967295|j>>>25),j=z+(M^R&(E^M))+C[1]+3905402710&4294967295,z=R+(j<<12&4294967295|j>>>20),j=M+(E^z&(R^E))+C[2]+606105819&4294967295,M=z+(j<<17&4294967295|j>>>15),j=E+(R^M&(z^R))+C[3]+3250441966&4294967295,E=M+(j<<22&4294967295|j>>>10),j=R+(z^E&(M^z))+C[4]+4118548399&4294967295,R=E+(j<<7&4294967295|j>>>25),j=z+(M^R&(E^M))+C[5]+1200080426&4294967295,z=R+(j<<12&4294967295|j>>>20),j=M+(E^z&(R^E))+C[6]+2821735955&4294967295,M=z+(j<<17&4294967295|j>>>15),j=E+(R^M&(z^R))+C[7]+4249261313&4294967295,E=M+(j<<22&4294967295|j>>>10),j=R+(z^E&(M^z))+C[8]+1770035416&4294967295,R=E+(j<<7&4294967295|j>>>25),j=z+(M^R&(E^M))+C[9]+2336552879&4294967295,z=R+(j<<12&4294967295|j>>>20),j=M+(E^z&(R^E))+C[10]+4294925233&4294967295,M=z+(j<<17&4294967295|j>>>15),j=E+(R^M&(z^R))+C[11]+2304563134&4294967295,E=M+(j<<22&4294967295|j>>>10),j=R+(z^E&(M^z))+C[12]+1804603682&4294967295,R=E+(j<<7&4294967295|j>>>25),j=z+(M^R&(E^M))+C[13]+4254626195&4294967295,z=R+(j<<12&4294967295|j>>>20),j=M+(E^z&(R^E))+C[14]+2792965006&4294967295,M=z+(j<<17&4294967295|j>>>15),j=E+(R^M&(z^R))+C[15]+1236535329&4294967295,E=M+(j<<22&4294967295|j>>>10),j=R+(M^z&(E^M))+C[1]+4129170786&4294967295,R=E+(j<<5&4294967295|j>>>27),j=z+(E^M&(R^E))+C[6]+3225465664&4294967295,z=R+(j<<9&4294967295|j>>>23),j=M+(R^E&(z^R))+C[11]+643717713&4294967295,M=z+(j<<14&4294967295|j>>>18),j=E+(z^R&(M^z))+C[0]+3921069994&4294967295,E=M+(j<<20&4294967295|j>>>12),j=R+(M^z&(E^M))+C[5]+3593408605&4294967295,R=E+(j<<5&4294967295|j>>>27),j=z+(E^M&(R^E))+C[10]+38016083&4294967295,z=R+(j<<9&4294967295|j>>>23),j=M+(R^E&(z^R))+C[15]+3634488961&4294967295,M=z+(j<<14&4294967295|j>>>18),j=E+(z^R&(M^z))+C[4]+3889429448&4294967295,E=M+(j<<20&4294967295|j>>>12),j=R+(M^z&(E^M))+C[9]+568446438&4294967295,R=E+(j<<5&4294967295|j>>>27),j=z+(E^M&(R^E))+C[14]+3275163606&4294967295,z=R+(j<<9&4294967295|j>>>23),j=M+(R^E&(z^R))+C[3]+4107603335&4294967295,M=z+(j<<14&4294967295|j>>>18),j=E+(z^R&(M^z))+C[8]+1163531501&4294967295,E=M+(j<<20&4294967295|j>>>12),j=R+(M^z&(E^M))+C[13]+2850285829&4294967295,R=E+(j<<5&4294967295|j>>>27),j=z+(E^M&(R^E))+C[2]+4243563512&4294967295,z=R+(j<<9&4294967295|j>>>23),j=M+(R^E&(z^R))+C[7]+1735328473&4294967295,M=z+(j<<14&4294967295|j>>>18),j=E+(z^R&(M^z))+C[12]+2368359562&4294967295,E=M+(j<<20&4294967295|j>>>12),j=R+(E^M^z)+C[5]+4294588738&4294967295,R=E+(j<<4&4294967295|j>>>28),j=z+(R^E^M)+C[8]+2272392833&4294967295,z=R+(j<<11&4294967295|j>>>21),j=M+(z^R^E)+C[11]+1839030562&4294967295,M=z+(j<<16&4294967295|j>>>16),j=E+(M^z^R)+C[14]+4259657740&4294967295,E=M+(j<<23&4294967295|j>>>9),j=R+(E^M^z)+C[1]+2763975236&4294967295,R=E+(j<<4&4294967295|j>>>28),j=z+(R^E^M)+C[4]+1272893353&4294967295,z=R+(j<<11&4294967295|j>>>21),j=M+(z^R^E)+C[7]+4139469664&4294967295,M=z+(j<<16&4294967295|j>>>16),j=E+(M^z^R)+C[10]+3200236656&4294967295,E=M+(j<<23&4294967295|j>>>9),j=R+(E^M^z)+C[13]+681279174&4294967295,R=E+(j<<4&4294967295|j>>>28),j=z+(R^E^M)+C[0]+3936430074&4294967295,z=R+(j<<11&4294967295|j>>>21),j=M+(z^R^E)+C[3]+3572445317&4294967295,M=z+(j<<16&4294967295|j>>>16),j=E+(M^z^R)+C[6]+76029189&4294967295,E=M+(j<<23&4294967295|j>>>9),j=R+(E^M^z)+C[9]+3654602809&4294967295,R=E+(j<<4&4294967295|j>>>28),j=z+(R^E^M)+C[12]+3873151461&4294967295,z=R+(j<<11&4294967295|j>>>21),j=M+(z^R^E)+C[15]+530742520&4294967295,M=z+(j<<16&4294967295|j>>>16),j=E+(M^z^R)+C[2]+3299628645&4294967295,E=M+(j<<23&4294967295|j>>>9),j=R+(M^(E|~z))+C[0]+4096336452&4294967295,R=E+(j<<6&4294967295|j>>>26),j=z+(E^(R|~M))+C[7]+1126891415&4294967295,z=R+(j<<10&4294967295|j>>>22),j=M+(R^(z|~E))+C[14]+2878612391&4294967295,M=z+(j<<15&4294967295|j>>>17),j=E+(z^(M|~R))+C[5]+4237533241&4294967295,E=M+(j<<21&4294967295|j>>>11),j=R+(M^(E|~z))+C[12]+1700485571&4294967295,R=E+(j<<6&4294967295|j>>>26),j=z+(E^(R|~M))+C[3]+2399980690&4294967295,z=R+(j<<10&4294967295|j>>>22),j=M+(R^(z|~E))+C[10]+4293915773&4294967295,M=z+(j<<15&4294967295|j>>>17),j=E+(z^(M|~R))+C[1]+2240044497&4294967295,E=M+(j<<21&4294967295|j>>>11),j=R+(M^(E|~z))+C[8]+1873313359&4294967295,R=E+(j<<6&4294967295|j>>>26),j=z+(E^(R|~M))+C[15]+4264355552&4294967295,z=R+(j<<10&4294967295|j>>>22),j=M+(R^(z|~E))+C[6]+2734768916&4294967295,M=z+(j<<15&4294967295|j>>>17),j=E+(z^(M|~R))+C[13]+1309151649&4294967295,E=M+(j<<21&4294967295|j>>>11),j=R+(M^(E|~z))+C[4]+4149444226&4294967295,R=E+(j<<6&4294967295|j>>>26),j=z+(E^(R|~M))+C[11]+3174756917&4294967295,z=R+(j<<10&4294967295|j>>>22),j=M+(R^(z|~E))+C[2]+718787259&4294967295,M=z+(j<<15&4294967295|j>>>17),j=E+(z^(M|~R))+C[9]+3951481745&4294967295,N.g[0]=N.g[0]+R&4294967295,N.g[1]=N.g[1]+(M+(j<<21&4294967295|j>>>11))&4294967295,N.g[2]=N.g[2]+M&4294967295,N.g[3]=N.g[3]+z&4294967295}r.prototype.u=function(N,R){R===void 0&&(R=N.length);for(var E=R-this.blockSize,C=this.B,M=this.h,z=0;z<R;){if(M==0)for(;z<=E;)o(this,N,z),z+=this.blockSize;if(typeof N=="string"){for(;z<R;)if(C[M++]=N.charCodeAt(z++),M==this.blockSize){o(this,C),M=0;break}}else for(;z<R;)if(C[M++]=N[z++],M==this.blockSize){o(this,C),M=0;break}}this.h=M,this.o+=R},r.prototype.v=function(){var N=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);N[0]=128;for(var R=1;R<N.length-8;++R)N[R]=0;var E=8*this.o;for(R=N.length-8;R<N.length;++R)N[R]=E&255,E/=256;for(this.u(N),N=Array(16),R=E=0;4>R;++R)for(var C=0;32>C;C+=8)N[E++]=this.g[R]>>>C&255;return N};function c(N,R){var E=f;return Object.prototype.hasOwnProperty.call(E,N)?E[N]:E[N]=R(N)}function d(N,R){this.h=R;for(var E=[],C=!0,M=N.length-1;0<=M;M--){var z=N[M]|0;C&&z==R||(E[M]=z,C=!1)}this.g=E}var f={};function p(N){return-128<=N&&128>N?c(N,function(R){return new d([R|0],0>R?-1:0)}):new d([N|0],0>N?-1:0)}function y(N){if(isNaN(N)||!isFinite(N))return k;if(0>N)return P(y(-N));for(var R=[],E=1,C=0;N>=E;C++)R[C]=N/E|0,E*=4294967296;return new d(R,0)}function v(N,R){if(N.length==0)throw Error("number format error: empty string");if(R=R||10,2>R||36<R)throw Error("radix out of range: "+R);if(N.charAt(0)=="-")return P(v(N.substring(1),R));if(0<=N.indexOf("-"))throw Error('number format error: interior "-" character');for(var E=y(Math.pow(R,8)),C=k,M=0;M<N.length;M+=8){var z=Math.min(8,N.length-M),j=parseInt(N.substring(M,M+z),R);8>z?(z=y(Math.pow(R,z)),C=C.j(z).add(y(j))):(C=C.j(E),C=C.add(y(j)))}return C}var k=p(0),S=p(1),I=p(16777216);s=d.prototype,s.m=function(){if(L(this))return-P(this).m();for(var N=0,R=1,E=0;E<this.g.length;E++){var C=this.i(E);N+=(0<=C?C:4294967296+C)*R,R*=4294967296}return N},s.toString=function(N){if(N=N||10,2>N||36<N)throw Error("radix out of range: "+N);if(q(this))return"0";if(L(this))return"-"+P(this).toString(N);for(var R=y(Math.pow(N,6)),E=this,C="";;){var M=F(E,R).g;E=K(E,M.j(R));var z=((0<E.g.length?E.g[0]:E.h)>>>0).toString(N);if(E=M,q(E))return z+C;for(;6>z.length;)z="0"+z;C=z+C}},s.i=function(N){return 0>N?0:N<this.g.length?this.g[N]:this.h};function q(N){if(N.h!=0)return!1;for(var R=0;R<N.g.length;R++)if(N.g[R]!=0)return!1;return!0}function L(N){return N.h==-1}s.l=function(N){return N=K(this,N),L(N)?-1:q(N)?0:1};function P(N){for(var R=N.g.length,E=[],C=0;C<R;C++)E[C]=~N.g[C];return new d(E,~N.h).add(S)}s.abs=function(){return L(this)?P(this):this},s.add=function(N){for(var R=Math.max(this.g.length,N.g.length),E=[],C=0,M=0;M<=R;M++){var z=C+(this.i(M)&65535)+(N.i(M)&65535),j=(z>>>16)+(this.i(M)>>>16)+(N.i(M)>>>16);C=j>>>16,z&=65535,j&=65535,E[M]=j<<16|z}return new d(E,E[E.length-1]&-2147483648?-1:0)};function K(N,R){return N.add(P(R))}s.j=function(N){if(q(this)||q(N))return k;if(L(this))return L(N)?P(this).j(P(N)):P(P(this).j(N));if(L(N))return P(this.j(P(N)));if(0>this.l(I)&&0>N.l(I))return y(this.m()*N.m());for(var R=this.g.length+N.g.length,E=[],C=0;C<2*R;C++)E[C]=0;for(C=0;C<this.g.length;C++)for(var M=0;M<N.g.length;M++){var z=this.i(C)>>>16,j=this.i(C)&65535,Ve=N.i(M)>>>16,le=N.i(M)&65535;E[2*C+2*M]+=j*le,U(E,2*C+2*M),E[2*C+2*M+1]+=z*le,U(E,2*C+2*M+1),E[2*C+2*M+1]+=j*Ve,U(E,2*C+2*M+1),E[2*C+2*M+2]+=z*Ve,U(E,2*C+2*M+2)}for(C=0;C<R;C++)E[C]=E[2*C+1]<<16|E[2*C];for(C=R;C<2*R;C++)E[C]=0;return new d(E,0)};function U(N,R){for(;(N[R]&65535)!=N[R];)N[R+1]+=N[R]>>>16,N[R]&=65535,R++}function B(N,R){this.g=N,this.h=R}function F(N,R){if(q(R))throw Error("division by zero");if(q(N))return new B(k,k);if(L(N))return R=F(P(N),R),new B(P(R.g),P(R.h));if(L(R))return R=F(N,P(R)),new B(P(R.g),R.h);if(30<N.g.length){if(L(N)||L(R))throw Error("slowDivide_ only works with positive integers.");for(var E=S,C=R;0>=C.l(N);)E=ae(E),C=ae(C);var M=ne(E,1),z=ne(C,1);for(C=ne(C,2),E=ne(E,2);!q(C);){var j=z.add(C);0>=j.l(N)&&(M=M.add(E),z=j),C=ne(C,1),E=ne(E,1)}return R=K(N,M.j(R)),new B(M,R)}for(M=k;0<=N.l(R);){for(E=Math.max(1,Math.floor(N.m()/R.m())),C=Math.ceil(Math.log(E)/Math.LN2),C=48>=C?1:Math.pow(2,C-48),z=y(E),j=z.j(R);L(j)||0<j.l(N);)E-=C,z=y(E),j=z.j(R);q(z)&&(z=S),M=M.add(z),N=K(N,j)}return new B(M,N)}s.A=function(N){return F(this,N).h},s.and=function(N){for(var R=Math.max(this.g.length,N.g.length),E=[],C=0;C<R;C++)E[C]=this.i(C)&N.i(C);return new d(E,this.h&N.h)},s.or=function(N){for(var R=Math.max(this.g.length,N.g.length),E=[],C=0;C<R;C++)E[C]=this.i(C)|N.i(C);return new d(E,this.h|N.h)},s.xor=function(N){for(var R=Math.max(this.g.length,N.g.length),E=[],C=0;C<R;C++)E[C]=this.i(C)^N.i(C);return new d(E,this.h^N.h)};function ae(N){for(var R=N.g.length+1,E=[],C=0;C<R;C++)E[C]=N.i(C)<<1|N.i(C-1)>>>31;return new d(E,N.h)}function ne(N,R){var E=R>>5;R%=32;for(var C=N.g.length-E,M=[],z=0;z<C;z++)M[z]=0<R?N.i(z+E)>>>R|N.i(z+E+1)<<32-R:N.i(z+E);return new d(M,N.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,K1=r,d.prototype.add=d.prototype.add,d.prototype.multiply=d.prototype.j,d.prototype.modulo=d.prototype.A,d.prototype.compare=d.prototype.l,d.prototype.toNumber=d.prototype.m,d.prototype.toString=d.prototype.toString,d.prototype.getBits=d.prototype.i,d.fromNumber=y,d.fromString=v,zr=d}).apply(typeof Rv<"u"?Rv:typeof self<"u"?self:typeof window<"u"?window:{});var xd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Y1,oc,Q1,jd,tg,X1,Z1,W1;(function(){var s,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(h,x,b){return h==Array.prototype||h==Object.prototype||(h[x]=b.value),h};function t(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof xd=="object"&&xd];for(var x=0;x<h.length;++x){var b=h[x];if(b&&b.Math==Math)return b}throw Error("Cannot find global object")}var r=t(this);function o(h,x){if(x)e:{var b=r;h=h.split(".");for(var A=0;A<h.length-1;A++){var $=h[A];if(!($ in b))break e;b=b[$]}h=h[h.length-1],A=b[h],x=x(A),x!=A&&x!=null&&e(b,h,{configurable:!0,writable:!0,value:x})}}function c(h,x){h instanceof String&&(h+="");var b=0,A=!1,$={next:function(){if(!A&&b<h.length){var te=b++;return{value:x(te,h[te]),done:!1}}return A=!0,{done:!0,value:void 0}}};return $[Symbol.iterator]=function(){return $},$}o("Array.prototype.values",function(h){return h||function(){return c(this,function(x,b){return b})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var d=d||{},f=this||self;function p(h){var x=typeof h;return x=x!="object"?x:h?Array.isArray(h)?"array":x:"null",x=="array"||x=="object"&&typeof h.length=="number"}function y(h){var x=typeof h;return x=="object"&&h!=null||x=="function"}function v(h,x,b){return h.call.apply(h.bind,arguments)}function k(h,x,b){if(!h)throw Error();if(2<arguments.length){var A=Array.prototype.slice.call(arguments,2);return function(){var $=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply($,A),h.apply(x,$)}}return function(){return h.apply(x,arguments)}}function S(h,x,b){return S=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?v:k,S.apply(null,arguments)}function I(h,x){var b=Array.prototype.slice.call(arguments,1);return function(){var A=b.slice();return A.push.apply(A,arguments),h.apply(this,A)}}function q(h,x){function b(){}b.prototype=x.prototype,h.aa=x.prototype,h.prototype=new b,h.prototype.constructor=h,h.Qb=function(A,$,te){for(var ve=Array(arguments.length-2),xt=2;xt<arguments.length;xt++)ve[xt-2]=arguments[xt];return x.prototype[$].apply(A,ve)}}function L(h){const x=h.length;if(0<x){const b=Array(x);for(let A=0;A<x;A++)b[A]=h[A];return b}return[]}function P(h,x){for(let b=1;b<arguments.length;b++){const A=arguments[b];if(p(A)){const $=h.length||0,te=A.length||0;h.length=$+te;for(let ve=0;ve<te;ve++)h[$+ve]=A[ve]}else h.push(A)}}class K{constructor(x,b){this.i=x,this.j=b,this.h=0,this.g=null}get(){let x;return 0<this.h?(this.h--,x=this.g,this.g=x.next,x.next=null):x=this.i(),x}}function U(h){return/^[\s\xa0]*$/.test(h)}function B(){var h=f.navigator;return h&&(h=h.userAgent)?h:""}function F(h){return F[" "](h),h}F[" "]=function(){};var ae=B().indexOf("Gecko")!=-1&&!(B().toLowerCase().indexOf("webkit")!=-1&&B().indexOf("Edge")==-1)&&!(B().indexOf("Trident")!=-1||B().indexOf("MSIE")!=-1)&&B().indexOf("Edge")==-1;function ne(h,x,b){for(const A in h)x.call(b,h[A],A,h)}function N(h,x){for(const b in h)x.call(void 0,h[b],b,h)}function R(h){const x={};for(const b in h)x[b]=h[b];return x}const E="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function C(h,x){let b,A;for(let $=1;$<arguments.length;$++){A=arguments[$];for(b in A)h[b]=A[b];for(let te=0;te<E.length;te++)b=E[te],Object.prototype.hasOwnProperty.call(A,b)&&(h[b]=A[b])}}function M(h){var x=1;h=h.split(":");const b=[];for(;0<x&&h.length;)b.push(h.shift()),x--;return h.length&&b.push(h.join(":")),b}function z(h){f.setTimeout(()=>{throw h},0)}function j(){var h=ye;let x=null;return h.g&&(x=h.g,h.g=h.g.next,h.g||(h.h=null),x.next=null),x}class Ve{constructor(){this.h=this.g=null}add(x,b){const A=le.get();A.set(x,b),this.h?this.h.next=A:this.g=A,this.h=A}}var le=new K(()=>new W,h=>h.reset());class W{constructor(){this.next=this.g=this.h=null}set(x,b){this.h=x,this.g=b,this.next=null}reset(){this.next=this.g=this.h=null}}let de,me=!1,ye=new Ve,O=()=>{const h=f.Promise.resolve(void 0);de=()=>{h.then(H)}};var H=()=>{for(var h;h=j();){try{h.h.call(h.g)}catch(b){z(b)}var x=le;x.j(h),100>x.h&&(x.h++,h.next=x.g,x.g=h)}me=!1};function ee(){this.s=this.s,this.C=this.C}ee.prototype.s=!1,ee.prototype.ma=function(){this.s||(this.s=!0,this.N())},ee.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function X(h,x){this.type=h,this.g=this.target=x,this.defaultPrevented=!1}X.prototype.h=function(){this.defaultPrevented=!0};var fe=(function(){if(!f.addEventListener||!Object.defineProperty)return!1;var h=!1,x=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const b=()=>{};f.addEventListener("test",b,x),f.removeEventListener("test",b,x)}catch{}return h})();function _e(h,x){if(X.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h){var b=this.type=h.type,A=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;if(this.target=h.target||h.srcElement,this.g=x,x=h.relatedTarget){if(ae){e:{try{F(x.nodeName);var $=!0;break e}catch{}$=!1}$||(x=null)}}else b=="mouseover"?x=h.fromElement:b=="mouseout"&&(x=h.toElement);this.relatedTarget=x,A?(this.clientX=A.clientX!==void 0?A.clientX:A.pageX,this.clientY=A.clientY!==void 0?A.clientY:A.pageY,this.screenX=A.screenX||0,this.screenY=A.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=typeof h.pointerType=="string"?h.pointerType:Ee[h.pointerType]||"",this.state=h.state,this.i=h,h.defaultPrevented&&_e.aa.h.call(this)}}q(_e,X);var Ee={2:"touch",3:"pen",4:"mouse"};_e.prototype.h=function(){_e.aa.h.call(this);var h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var $e="closure_listenable_"+(1e6*Math.random()|0),je=0;function pe(h,x,b,A,$){this.listener=h,this.proxy=null,this.src=x,this.type=b,this.capture=!!A,this.ha=$,this.key=++je,this.da=this.fa=!1}function he(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function ge(h){this.src=h,this.g={},this.h=0}ge.prototype.add=function(h,x,b,A,$){var te=h.toString();h=this.g[te],h||(h=this.g[te]=[],this.h++);var ve=Me(h,x,A,$);return-1<ve?(x=h[ve],b||(x.fa=!1)):(x=new pe(x,this.src,te,!!A,$),x.fa=b,h.push(x)),x};function Ze(h,x){var b=x.type;if(b in h.g){var A=h.g[b],$=Array.prototype.indexOf.call(A,x,void 0),te;(te=0<=$)&&Array.prototype.splice.call(A,$,1),te&&(he(x),h.g[b].length==0&&(delete h.g[b],h.h--))}}function Me(h,x,b,A){for(var $=0;$<h.length;++$){var te=h[$];if(!te.da&&te.listener==x&&te.capture==!!b&&te.ha==A)return $}return-1}var Ie="closure_lm_"+(1e6*Math.random()|0),gt={};function Je(h,x,b,A,$){if(Array.isArray(x)){for(var te=0;te<x.length;te++)Je(h,x[te],b,A,$);return null}return b=Gn(b),h&&h[$e]?h.K(x,b,y(A)?!!A.capture:!1,$):pt(h,x,b,!1,A,$)}function pt(h,x,b,A,$,te){if(!x)throw Error("Invalid event type");var ve=y($)?!!$.capture:!!$,xt=yn(h);if(xt||(h[Ie]=xt=new ge(h)),b=xt.add(x,b,A,ve,te),b.proxy)return b;if(A=kt(),b.proxy=A,A.src=h,A.listener=b,h.addEventListener)fe||($=ve),$===void 0&&($=!1),h.addEventListener(x.toString(),A,$);else if(h.attachEvent)h.attachEvent(Gt(x.toString()),A);else if(h.addListener&&h.removeListener)h.addListener(A);else throw Error("addEventListener and attachEvent are unavailable.");return b}function kt(){function h(b){return x.call(h.src,h.listener,b)}const x=En;return h}function it(h,x,b,A,$){if(Array.isArray(x))for(var te=0;te<x.length;te++)it(h,x[te],b,A,$);else A=y(A)?!!A.capture:!!A,b=Gn(b),h&&h[$e]?(h=h.i,x=String(x).toString(),x in h.g&&(te=h.g[x],b=Me(te,b,A,$),-1<b&&(he(te[b]),Array.prototype.splice.call(te,b,1),te.length==0&&(delete h.g[x],h.h--)))):h&&(h=yn(h))&&(x=h.g[x.toString()],h=-1,x&&(h=Me(x,b,A,$)),(b=-1<h?x[h]:null)&&Mt(b))}function Mt(h){if(typeof h!="number"&&h&&!h.da){var x=h.src;if(x&&x[$e])Ze(x.i,h);else{var b=h.type,A=h.proxy;x.removeEventListener?x.removeEventListener(b,A,h.capture):x.detachEvent?x.detachEvent(Gt(b),A):x.addListener&&x.removeListener&&x.removeListener(A),(b=yn(x))?(Ze(b,h),b.h==0&&(b.src=null,x[Ie]=null)):he(h)}}}function Gt(h){return h in gt?gt[h]:gt[h]="on"+h}function En(h,x){if(h.da)h=!0;else{x=new _e(x,this);var b=h.listener,A=h.ha||h.src;h.fa&&Mt(h),h=b.call(A,x)}return h}function yn(h){return h=h[Ie],h instanceof ge?h:null}var Mn="__closure_events_fn_"+(1e9*Math.random()>>>0);function Gn(h){return typeof h=="function"?h:(h[Mn]||(h[Mn]=function(x){return h.handleEvent(x)}),h[Mn])}function st(){ee.call(this),this.i=new ge(this),this.M=this,this.F=null}q(st,ee),st.prototype[$e]=!0,st.prototype.removeEventListener=function(h,x,b,A){it(this,h,x,b,A)};function ft(h,x){var b,A=h.F;if(A)for(b=[];A;A=A.F)b.push(A);if(h=h.M,A=x.type||x,typeof x=="string")x=new X(x,h);else if(x instanceof X)x.target=x.target||h;else{var $=x;x=new X(A,h),C(x,$)}if($=!0,b)for(var te=b.length-1;0<=te;te--){var ve=x.g=b[te];$=Kt(ve,A,!0,x)&&$}if(ve=x.g=h,$=Kt(ve,A,!0,x)&&$,$=Kt(ve,A,!1,x)&&$,b)for(te=0;te<b.length;te++)ve=x.g=b[te],$=Kt(ve,A,!1,x)&&$}st.prototype.N=function(){if(st.aa.N.call(this),this.i){var h=this.i,x;for(x in h.g){for(var b=h.g[x],A=0;A<b.length;A++)he(b[A]);delete h.g[x],h.h--}}this.F=null},st.prototype.K=function(h,x,b,A){return this.i.add(String(h),x,!1,b,A)},st.prototype.L=function(h,x,b,A){return this.i.add(String(h),x,!0,b,A)};function Kt(h,x,b,A){if(x=h.i.g[String(x)],!x)return!0;x=x.concat();for(var $=!0,te=0;te<x.length;++te){var ve=x[te];if(ve&&!ve.da&&ve.capture==b){var xt=ve.listener,hn=ve.ha||ve.src;ve.fa&&Ze(h.i,ve),$=xt.call(hn,A)!==!1&&$}}return $&&!A.defaultPrevented}function Xt(h,x,b){if(typeof h=="function")b&&(h=S(h,b));else if(h&&typeof h.handleEvent=="function")h=S(h.handleEvent,h);else throw Error("Invalid listener argument");return 2147483647<Number(x)?-1:f.setTimeout(h,x||0)}function tr(h){h.g=Xt(()=>{h.g=null,h.i&&(h.i=!1,tr(h))},h.l);const x=h.h;h.h=null,h.m.apply(null,x)}class ys extends ee{constructor(x,b){super(),this.m=x,this.l=b,this.h=null,this.i=!1,this.g=null}j(x){this.h=arguments,this.g?this.i=!0:tr(this)}N(){super.N(),this.g&&(f.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ca(h){ee.call(this),this.h=h,this.g={}}q(Ca,ee);var ma=[];function fa(h){ne(h.g,function(x,b){this.g.hasOwnProperty(b)&&Mt(x)},h),h.g={}}Ca.prototype.N=function(){Ca.aa.N.call(this),fa(this)},Ca.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var On=f.JSON.stringify,Ga=f.JSON.parse,Ia=class{stringify(h){return f.JSON.stringify(h,void 0)}parse(h){return f.JSON.parse(h,void 0)}};function xs(){}xs.prototype.h=null;function Fa(h){return h.h||(h.h=h.i())}function vs(){}var sa={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function ke(){X.call(this,"d")}q(ke,X);function Oe(){X.call(this,"c")}q(Oe,X);var Ke={},et=null;function re(){return et=et||new st}Ke.La="serverreachability";function De(h){X.call(this,Ke.La,h)}q(De,X);function Se(h){const x=re();ft(x,new De(x))}Ke.STAT_EVENT="statevent";function Le(h,x){X.call(this,Ke.STAT_EVENT,h),this.stat=x}q(Le,X);function Ne(h){const x=re();ft(x,new Le(x,h))}Ke.Ma="timingevent";function be(h,x){X.call(this,Ke.Ma,h),this.size=x}q(be,X);function Ae(h,x){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return f.setTimeout(function(){h()},x)}function Pe(){this.g=!0}Pe.prototype.xa=function(){this.g=!1};function we(h,x,b,A,$,te){h.info(function(){if(h.g)if(te)for(var ve="",xt=te.split("&"),hn=0;hn<xt.length;hn++){var vt=xt[hn].split("=");if(1<vt.length){var bn=vt[0];vt=vt[1];var mn=bn.split("_");ve=2<=mn.length&&mn[1]=="type"?ve+(bn+"="+vt+"&"):ve+(bn+"=redacted&")}}else ve=null;else ve=te;return"XMLHTTP REQ ("+A+") [attempt "+$+"]: "+x+`
`+b+`
`+ve})}function He(h,x,b,A,$,te,ve){h.info(function(){return"XMLHTTP RESP ("+A+") [ attempt "+$+"]: "+x+`
`+b+`
`+te+" "+ve})}function yt(h,x,b,A){h.info(function(){return"XMLHTTP TEXT ("+x+"): "+Ft(h,b)+(A?" "+A:"")})}function Ut(h,x){h.info(function(){return"TIMEOUT: "+x})}Pe.prototype.info=function(){};function Ft(h,x){if(!h.g)return x;if(!x)return null;try{var b=JSON.parse(x);if(b){for(h=0;h<b.length;h++)if(Array.isArray(b[h])){var A=b[h];if(!(2>A.length)){var $=A[1];if(Array.isArray($)&&!(1>$.length)){var te=$[0];if(te!="noop"&&te!="stop"&&te!="close")for(var ve=1;ve<$.length;ve++)$[ve]=""}}}}return On(b)}catch{return x}}var Zt={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Wt={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},dn;function xn(){}q(xn,xs),xn.prototype.g=function(){return new XMLHttpRequest},xn.prototype.i=function(){return{}},dn=new xn;function Jt(h,x,b,A){this.j=h,this.i=x,this.l=b,this.R=A||1,this.U=new Ca(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Ot}function Ot(){this.i=null,this.g="",this.h=!1}var Ge={},xe={};function nt(h,x,b){h.L=1,h.v=Wr(ra(x)),h.m=b,h.P=!0,Pn(h,null)}function Pn(h,x){h.F=Date.now(),$a(h),h.A=ra(h.v);var b=h.A,A=h.R;Array.isArray(A)||(A=[String(A)]),cl(b.i,"t",A),h.C=0,b=h.j.J,h.h=new Ot,h.g=hu(h.j,b?x:null,!h.m),0<h.O&&(h.M=new ys(S(h.Y,h,h.g),h.O)),x=h.U,b=h.g,A=h.ca;var $="readystatechange";Array.isArray($)||($&&(ma[0]=$.toString()),$=ma);for(var te=0;te<$.length;te++){var ve=Je(b,$[te],A||x.handleEvent,!1,x.h||x);if(!ve)break;x.g[ve.key]=ve}x=h.H?R(h.H):{},h.m?(h.u||(h.u="POST"),x["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.A,h.u,h.m,x)):(h.u="GET",h.g.ea(h.A,h.u,null,x)),Se(),we(h.i,h.u,h.A,h.l,h.R,h.m)}Jt.prototype.ca=function(h){h=h.target;const x=this.M;x&&xa(h)==3?x.j():this.Y(h)},Jt.prototype.Y=function(h){try{if(h==this.g)e:{const mn=xa(this.g);var x=this.g.Ba();const Ns=this.g.Z();if(!(3>mn)&&(mn!=3||this.g&&(this.h.h||this.g.oa()||su(this.g)))){this.J||mn!=4||x==7||(x==8||0>=Ns?Se(3):Se(2)),nr(this);var b=this.g.Z();this.X=b;t:if(qa(this)){var A=su(this.g);h="";var $=A.length,te=xa(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Sn(this),Ka(this);var ve="";break t}this.h.i=new f.TextDecoder}for(x=0;x<$;x++)this.h.h=!0,h+=this.h.i.decode(A[x],{stream:!(te&&x==$-1)});A.length=0,this.h.g+=h,this.C=0,ve=this.h.g}else ve=this.g.oa();if(this.o=b==200,He(this.i,this.u,this.A,this.l,this.R,mn,b),this.o){if(this.T&&!this.K){t:{if(this.g){var xt,hn=this.g;if((xt=hn.g?hn.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!U(xt)){var vt=xt;break t}}vt=null}if(b=vt)yt(this.i,this.l,b,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Qr(this,b);else{this.o=!1,this.s=3,Ne(12),Sn(this),Ka(this);break e}}if(this.P){b=!0;let An;for(;!this.J&&this.C<ve.length;)if(An=bs(this,ve),An==xe){mn==4&&(this.s=4,Ne(14),b=!1),yt(this.i,this.l,null,"[Incomplete Response]");break}else if(An==Ge){this.s=4,Ne(15),yt(this.i,this.l,ve,"[Invalid Chunk]"),b=!1;break}else yt(this.i,this.l,An,null),Qr(this,An);if(qa(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),mn!=4||ve.length!=0||this.h.h||(this.s=1,Ne(16),b=!1),this.o=this.o&&b,!b)yt(this.i,this.l,ve,"[Invalid Chunked Response]"),Sn(this),Ka(this);else if(0<ve.length&&!this.W){this.W=!0;var bn=this.j;bn.g==this&&bn.ba&&!bn.M&&(bn.j.info("Great, no buffering proxy detected. Bytes received: "+ve.length),ii(bn),bn.M=!0,Ne(11))}}else yt(this.i,this.l,ve,null),Qr(this,ve);mn==4&&Sn(this),this.o&&!this.J&&(mn==4?cu(this.j,this):(this.o=!1,$a(this)))}else Ch(this.g),b==400&&0<ve.indexOf("Unknown SID")?(this.s=3,Ne(12)):(this.s=0,Ne(13)),Sn(this),Ka(this)}}}catch{}finally{}};function qa(h){return h.g?h.u=="GET"&&h.L!=2&&h.j.Ca:!1}function bs(h,x){var b=h.C,A=x.indexOf(`
`,b);return A==-1?xe:(b=Number(x.substring(b,A)),isNaN(b)?Ge:(A+=1,A+b>x.length?xe:(x=x.slice(A,A+b),h.C=A+b,x)))}Jt.prototype.cancel=function(){this.J=!0,Sn(this)};function $a(h){h.S=Date.now()+h.I,Jc(h,h.I)}function Jc(h,x){if(h.B!=null)throw Error("WatchDog timer not null");h.B=Ae(S(h.ba,h),x)}function nr(h){h.B&&(f.clearTimeout(h.B),h.B=null)}Jt.prototype.ba=function(){this.B=null;const h=Date.now();0<=h-this.S?(Ut(this.i,this.A),this.L!=2&&(Se(),Ne(17)),Sn(this),this.s=2,Ka(this)):Jc(this,this.S-h)};function Ka(h){h.j.G==0||h.J||cu(h.j,h)}function Sn(h){nr(h);var x=h.M;x&&typeof x.ma=="function"&&x.ma(),h.M=null,fa(h.U),h.g&&(x=h.g,h.g=null,x.abort(),x.ma())}function Qr(h,x){try{var b=h.j;if(b.G!=0&&(b.g==h||sl(b.h,h))){if(!h.K&&sl(b.h,h)&&b.G==3){try{var A=b.Da.g.parse(x)}catch{A=null}if(Array.isArray(A)&&A.length==3){var $=A;if($[0]==0){e:if(!b.u){if(b.g)if(b.g.F+3e3<h.F)Zi(b),Qi(b);else break e;fl(b),Ne(18)}}else b.za=$[1],0<b.za-b.T&&37500>$[2]&&b.F&&b.v==0&&!b.C&&(b.C=Ae(S(b.Za,b),6e3));if(1>=Bi(b.h)&&b.ca){try{b.ca()}catch{}b.ca=void 0}}else As(b,11)}else if((h.K||b.g==h)&&Zi(b),!U(x))for($=b.Da.g.parse(x),x=0;x<$.length;x++){let vt=$[x];if(b.T=vt[0],vt=vt[1],b.G==2)if(vt[0]=="c"){b.K=vt[1],b.ia=vt[2];const bn=vt[3];bn!=null&&(b.la=bn,b.j.info("VER="+b.la));const mn=vt[4];mn!=null&&(b.Aa=mn,b.j.info("SVER="+b.Aa));const Ns=vt[5];Ns!=null&&typeof Ns=="number"&&0<Ns&&(A=1.5*Ns,b.L=A,b.j.info("backChannelRequestTimeoutMs_="+A)),A=b;const An=h.g;if(An){const es=An.g?An.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(es){var te=A.h;te.g||es.indexOf("spdy")==-1&&es.indexOf("quic")==-1&&es.indexOf("h2")==-1||(te.j=te.l,te.g=new Set,te.h&&(Hi(te,te.h),te.h=null))}if(A.D){const pl=An.g?An.g.getResponseHeader("X-HTTP-Session-Id"):null;pl&&(A.ya=pl,Rt(A.I,A.D,pl))}}b.G=3,b.l&&b.l.ua(),b.ba&&(b.R=Date.now()-h.F,b.j.info("Handshake RTT: "+b.R+"ms")),A=b;var ve=h;if(A.qa=du(A,A.J?A.ia:null,A.W),ve.K){Fn(A.h,ve);var xt=ve,hn=A.L;hn&&(xt.I=hn),xt.B&&(nr(xt),$a(xt)),A.g=ve}else ou(A);0<b.i.length&&Xi(b)}else vt[0]!="stop"&&vt[0]!="close"||As(b,7);else b.G==3&&(vt[0]=="stop"||vt[0]=="close"?vt[0]=="stop"?As(b,7):hl(b):vt[0]!="noop"&&b.l&&b.l.ta(vt),b.v=0)}}Se(4)}catch{}}var eu=class{constructor(h,x){this.g=h,this.map=x}};function _s(h){this.l=h||10,f.PerformanceNavigationTiming?(h=f.performance.getEntriesByType("navigation"),h=0<h.length&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(f.chrome&&f.chrome.loadTimes&&f.chrome.loadTimes()&&f.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Ui(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function Bi(h){return h.h?1:h.g?h.g.size:0}function sl(h,x){return h.h?h.h==x:h.g?h.g.has(x):!1}function Hi(h,x){h.g?h.g.add(x):h.h=x}function Fn(h,x){h.h&&h.h==x?h.h=null:h.g&&h.g.has(x)&&h.g.delete(x)}_s.prototype.cancel=function(){if(this.i=rl(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function rl(h){if(h.h!=null)return h.i.concat(h.h.D);if(h.g!=null&&h.g.size!==0){let x=h.i;for(const b of h.g.values())x=x.concat(b.D);return x}return L(h.i)}function Ah(h){if(h.V&&typeof h.V=="function")return h.V();if(typeof Map<"u"&&h instanceof Map||typeof Set<"u"&&h instanceof Set)return Array.from(h.values());if(typeof h=="string")return h.split("");if(p(h)){for(var x=[],b=h.length,A=0;A<b;A++)x.push(h[A]);return x}x=[],b=0;for(A in h)x[b++]=h[A];return x}function Gi(h){if(h.na&&typeof h.na=="function")return h.na();if(!h.V||typeof h.V!="function"){if(typeof Map<"u"&&h instanceof Map)return Array.from(h.keys());if(!(typeof Set<"u"&&h instanceof Set)){if(p(h)||typeof h=="string"){var x=[];h=h.length;for(var b=0;b<h;b++)x.push(b);return x}x=[],b=0;for(const A in h)x[b++]=A;return x}}}function il(h,x){if(h.forEach&&typeof h.forEach=="function")h.forEach(x,void 0);else if(p(h)||typeof h=="string")Array.prototype.forEach.call(h,x,void 0);else for(var b=Gi(h),A=Ah(h),$=A.length,te=0;te<$;te++)x.call(void 0,A[te],b&&b[te],h)}var Xr=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Nh(h,x){if(h){h=h.split("&");for(var b=0;b<h.length;b++){var A=h[b].indexOf("="),$=null;if(0<=A){var te=h[b].substring(0,A);$=h[b].substring(A+1)}else te=h[b];x(te,$?decodeURIComponent($.replace(/\+/g," ")):"")}}}function an(h){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,h instanceof an){this.h=h.h,Zr(this,h.j),this.o=h.o,this.g=h.g,ar(this,h.s),this.l=h.l;var x=h.i,b=new Ts;b.i=x.i,x.g&&(b.g=new Map(x.g),b.h=x.h),ks(this,b),this.m=h.m}else h&&(x=String(h).match(Xr))?(this.h=!1,Zr(this,x[1]||"",!0),this.o=ga(x[2]||""),this.g=ga(x[3]||"",!0),ar(this,x[4]),this.l=ga(x[5]||"",!0),ks(this,x[6]||"",!0),this.m=ga(x[7]||"")):(this.h=!1,this.i=new Ts(null,this.h))}an.prototype.toString=function(){var h=[],x=this.j;x&&h.push(Jr(x,ol,!0),":");var b=this.g;return(b||x=="file")&&(h.push("//"),(x=this.o)&&h.push(Jr(x,ol,!0),"@"),h.push(encodeURIComponent(String(b)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),b=this.s,b!=null&&h.push(":",String(b))),(b=this.l)&&(this.g&&b.charAt(0)!="/"&&h.push("/"),h.push(Jr(b,b.charAt(0)=="/"?Rh:ll,!0))),(b=this.i.toString())&&h.push("?",b),(b=this.m)&&h.push("#",Jr(b,Fi)),h.join("")};function ra(h){return new an(h)}function Zr(h,x,b){h.j=b?ga(x,!0):x,h.j&&(h.j=h.j.replace(/:$/,""))}function ar(h,x){if(x){if(x=Number(x),isNaN(x)||0>x)throw Error("Bad port number "+x);h.s=x}else h.s=null}function ks(h,x,b){x instanceof Ts?(h.i=x,nu(h.i,h.h)):(b||(x=Jr(x,jh)),h.i=new Ts(x,h.h))}function Rt(h,x,b){h.i.set(x,b)}function Wr(h){return Rt(h,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),h}function ga(h,x){return h?x?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function Jr(h,x,b){return typeof h=="string"?(h=encodeURI(h).replace(x,tu),b&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function tu(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var ol=/[#\/\?@]/g,ll=/[#\?:]/g,Rh=/[#\?]/g,jh=/[#\?@]/g,Fi=/#/g;function Ts(h,x){this.h=this.g=null,this.i=h||null,this.j=!!x}function pa(h){h.g||(h.g=new Map,h.h=0,h.i&&Nh(h.i,function(x,b){h.add(decodeURIComponent(x.replace(/\+/g," ")),b)}))}s=Ts.prototype,s.add=function(h,x){pa(this),this.i=null,h=Ya(this,h);var b=this.g.get(h);return b||this.g.set(h,b=[]),b.push(x),this.h+=1,this};function ws(h,x){pa(h),x=Ya(h,x),h.g.has(x)&&(h.i=null,h.h-=h.g.get(x).length,h.g.delete(x))}function Es(h,x){return pa(h),x=Ya(h,x),h.g.has(x)}s.forEach=function(h,x){pa(this),this.g.forEach(function(b,A){b.forEach(function($){h.call(x,$,A,this)},this)},this)},s.na=function(){pa(this);const h=Array.from(this.g.values()),x=Array.from(this.g.keys()),b=[];for(let A=0;A<x.length;A++){const $=h[A];for(let te=0;te<$.length;te++)b.push(x[A])}return b},s.V=function(h){pa(this);let x=[];if(typeof h=="string")Es(this,h)&&(x=x.concat(this.g.get(Ya(this,h))));else{h=Array.from(this.g.values());for(let b=0;b<h.length;b++)x=x.concat(h[b])}return x},s.set=function(h,x){return pa(this),this.i=null,h=Ya(this,h),Es(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[x]),this.h+=1,this},s.get=function(h,x){return h?(h=this.V(h),0<h.length?String(h[0]):x):x};function cl(h,x,b){ws(h,x),0<b.length&&(h.i=null,h.g.set(Ya(h,x),L(b)),h.h+=b.length)}s.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],x=Array.from(this.g.keys());for(var b=0;b<x.length;b++){var A=x[b];const te=encodeURIComponent(String(A)),ve=this.V(A);for(A=0;A<ve.length;A++){var $=te;ve[A]!==""&&($+="="+encodeURIComponent(String(ve[A]))),h.push($)}}return this.i=h.join("&")};function Ya(h,x){return x=String(x),h.j&&(x=x.toLowerCase()),x}function nu(h,x){x&&!h.j&&(pa(h),h.i=null,h.g.forEach(function(b,A){var $=A.toLowerCase();A!=$&&(ws(this,A),cl(this,$,b))},h)),h.j=x}function ei(h,x){const b=new Pe;if(f.Image){const A=new Image;A.onload=I(ya,b,"TestLoadImage: loaded",!0,x,A),A.onerror=I(ya,b,"TestLoadImage: error",!1,x,A),A.onabort=I(ya,b,"TestLoadImage: abort",!1,x,A),A.ontimeout=I(ya,b,"TestLoadImage: timeout",!1,x,A),f.setTimeout(function(){A.ontimeout&&A.ontimeout()},1e4),A.src=h}else x(!1)}function Da(h,x){const b=new Pe,A=new AbortController,$=setTimeout(()=>{A.abort(),ya(b,"TestPingServer: timeout",!1,x)},1e4);fetch(h,{signal:A.signal}).then(te=>{clearTimeout($),te.ok?ya(b,"TestPingServer: ok",!0,x):ya(b,"TestPingServer: server error",!1,x)}).catch(()=>{clearTimeout($),ya(b,"TestPingServer: error",!1,x)})}function ya(h,x,b,A,$){try{$&&($.onload=null,$.onerror=null,$.onabort=null,$.ontimeout=null),A(b)}catch{}}function ti(){this.g=new Ia}function Qa(h,x,b){const A=b||"";try{il(h,function($,te){let ve=$;y($)&&(ve=On($)),x.push(A+te+"="+encodeURIComponent(ve))})}catch($){throw x.push(A+"type="+encodeURIComponent("_badmap")),$}}function sr(h){this.l=h.Ub||null,this.j=h.eb||!1}q(sr,xs),sr.prototype.g=function(){return new Ss(this.l,this.j)},sr.prototype.i=(function(h){return function(){return h}})({});function Ss(h,x){st.call(this),this.D=h,this.o=x,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}q(Ss,st),s=Ss.prototype,s.open=function(h,x){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=h,this.A=x,this.readyState=1,Za(this)},s.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const x={headers:this.u,method:this.B,credentials:this.m,cache:void 0};h&&(x.body=h),(this.D||f).fetch(new Request(this.A,x)).then(this.Sa.bind(this),this.ga.bind(this))},s.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Xa(this)),this.readyState=0},s.Sa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,Za(this)),this.g&&(this.readyState=3,Za(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof f.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;ul(this)}else h.text().then(this.Ra.bind(this),this.ga.bind(this))};function ul(h){h.j.read().then(h.Pa.bind(h)).catch(h.ga.bind(h))}s.Pa=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var x=h.value?h.value:new Uint8Array(0);(x=this.v.decode(x,{stream:!h.done}))&&(this.response=this.responseText+=x)}h.done?Xa(this):Za(this),this.readyState==3&&ul(this)}},s.Ra=function(h){this.g&&(this.response=this.responseText=h,Xa(this))},s.Qa=function(h){this.g&&(this.response=h,Xa(this))},s.ga=function(){this.g&&Xa(this)};function Xa(h){h.readyState=4,h.l=null,h.j=null,h.v=null,Za(h)}s.setRequestHeader=function(h,x){this.u.append(h,x)},s.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},s.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],x=this.h.entries();for(var b=x.next();!b.done;)b=b.value,h.push(b[0]+": "+b[1]),b=x.next();return h.join(`\r
`)};function Za(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(Ss.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function dl(h){let x="";return ne(h,function(b,A){x+=A,x+=":",x+=b,x+=`\r
`}),x}function vn(h,x,b){e:{for(A in b){var A=!1;break e}A=!0}A||(b=dl(b),typeof h=="string"?b!=null&&encodeURIComponent(String(b)):Rt(h,x,b))}function Et(h){st.call(this),this.headers=new Map,this.o=h||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}q(Et,st);var qi=/^https?$/i,ni=["POST","PUT"];s=Et.prototype,s.Ha=function(h){this.J=h},s.ea=function(h,x,b,A){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);x=x?x.toUpperCase():"GET",this.D=h,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():dn.g(),this.v=this.o?Fa(this.o):Fa(dn),this.g.onreadystatechange=S(this.Ea,this);try{this.B=!0,this.g.open(x,String(h),!0),this.B=!1}catch(te){au(this,te);return}if(h=b||"",b=new Map(this.headers),A)if(Object.getPrototypeOf(A)===Object.prototype)for(var $ in A)b.set($,A[$]);else if(typeof A.keys=="function"&&typeof A.get=="function")for(const te of A.keys())b.set(te,A.get(te));else throw Error("Unknown input type for opt_headers: "+String(A));A=Array.from(b.keys()).find(te=>te.toLowerCase()=="content-type"),$=f.FormData&&h instanceof f.FormData,!(0<=Array.prototype.indexOf.call(ni,x,void 0))||A||$||b.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[te,ve]of b)this.g.setRequestHeader(te,ve);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{ai(this),this.u=!0,this.g.send(h),this.u=!1}catch(te){au(this,te)}};function au(h,x){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=x,h.m=5,$i(h),Wa(h)}function $i(h){h.A||(h.A=!0,ft(h,"complete"),ft(h,"error"))}s.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=h||7,ft(this,"complete"),ft(this,"abort"),Wa(this))},s.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Wa(this,!0)),Et.aa.N.call(this)},s.Ea=function(){this.s||(this.B||this.u||this.j?Ki(this):this.bb())},s.bb=function(){Ki(this)};function Ki(h){if(h.h&&typeof d<"u"&&(!h.v[1]||xa(h)!=4||h.Z()!=2)){if(h.u&&xa(h)==4)Xt(h.Ea,0,h);else if(ft(h,"readystatechange"),xa(h)==4){h.h=!1;try{const ve=h.Z();e:switch(ve){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var x=!0;break e;default:x=!1}var b;if(!(b=x)){var A;if(A=ve===0){var $=String(h.D).match(Xr)[1]||null;!$&&f.self&&f.self.location&&($=f.self.location.protocol.slice(0,-1)),A=!qi.test($?$.toLowerCase():"")}b=A}if(b)ft(h,"complete"),ft(h,"success");else{h.m=6;try{var te=2<xa(h)?h.g.statusText:""}catch{te=""}h.l=te+" ["+h.Z()+"]",$i(h)}}finally{Wa(h)}}}}function Wa(h,x){if(h.g){ai(h);const b=h.g,A=h.v[0]?()=>{}:null;h.g=null,h.v=null,x||ft(h,"ready");try{b.onreadystatechange=A}catch{}}}function ai(h){h.I&&(f.clearTimeout(h.I),h.I=null)}s.isActive=function(){return!!this.g};function xa(h){return h.g?h.g.readyState:0}s.Z=function(){try{return 2<xa(this)?this.g.status:-1}catch{return-1}},s.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},s.Oa=function(h){if(this.g){var x=this.g.responseText;return h&&x.indexOf(h)==0&&(x=x.substring(h.length)),Ga(x)}};function su(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.H){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function Ch(h){const x={};h=(h.g&&2<=xa(h)&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let A=0;A<h.length;A++){if(U(h[A]))continue;var b=M(h[A]);const $=b[0];if(b=b[1],typeof b!="string")continue;b=b.trim();const te=x[$]||[];x[$]=te,te.push(b)}N(x,function(A){return A.join(", ")})}s.Ba=function(){return this.m},s.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function si(h,x,b){return b&&b.internalChannelParams&&b.internalChannelParams[h]||x}function Yi(h){this.Aa=0,this.i=[],this.j=new Pe,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=si("failFast",!1,h),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=si("baseRetryDelayMs",5e3,h),this.cb=si("retryDelaySeedMs",1e4,h),this.Wa=si("forwardChannelMaxRetries",2,h),this.wa=si("forwardChannelRequestTimeoutMs",2e4,h),this.pa=h&&h.xmlHttpFactory||void 0,this.Xa=h&&h.Tb||void 0,this.Ca=h&&h.useFetchStreams||!1,this.L=void 0,this.J=h&&h.supportsCrossDomainXhr||!1,this.K="",this.h=new _s(h&&h.concurrentRequestLimit),this.Da=new ti,this.P=h&&h.fastHandshake||!1,this.O=h&&h.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=h&&h.Rb||!1,h&&h.xa&&this.j.xa(),h&&h.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&h&&h.detectBufferingProxy||!1,this.ja=void 0,h&&h.longPollingTimeout&&0<h.longPollingTimeout&&(this.ja=h.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}s=Yi.prototype,s.la=8,s.G=1,s.connect=function(h,x,b,A){Ne(0),this.W=h,this.H=x||{},b&&A!==void 0&&(this.H.OSID=b,this.H.OAID=A),this.F=this.X,this.I=du(this,null,this.W),Xi(this)};function hl(h){if(ru(h),h.G==3){var x=h.U++,b=ra(h.I);if(Rt(b,"SID",h.K),Rt(b,"RID",x),Rt(b,"TYPE","terminate"),ri(h,b),x=new Jt(h,h.j,x),x.L=2,x.v=Wr(ra(b)),b=!1,f.navigator&&f.navigator.sendBeacon)try{b=f.navigator.sendBeacon(x.v.toString(),"")}catch{}!b&&f.Image&&(new Image().src=x.v,b=!0),b||(x.g=hu(x.j,null),x.g.ea(x.v)),x.F=Date.now(),$a(x)}uu(h)}function Qi(h){h.g&&(ii(h),h.g.cancel(),h.g=null)}function ru(h){Qi(h),h.u&&(f.clearTimeout(h.u),h.u=null),Zi(h),h.h.cancel(),h.s&&(typeof h.s=="number"&&f.clearTimeout(h.s),h.s=null)}function Xi(h){if(!Ui(h.h)&&!h.s){h.s=!0;var x=h.Ga;de||O(),me||(de(),me=!0),ye.add(x,h),h.B=0}}function Ih(h,x){return Bi(h.h)>=h.h.j-(h.s?1:0)?!1:h.s?(h.i=x.D.concat(h.i),!0):h.G==1||h.G==2||h.B>=(h.Va?0:h.Wa)?!1:(h.s=Ae(S(h.Ga,h,x),gl(h,h.B)),h.B++,!0)}s.Ga=function(h){if(this.s)if(this.s=null,this.G==1){if(!h){this.U=Math.floor(1e5*Math.random()),h=this.U++;const $=new Jt(this,this.j,h);let te=this.o;if(this.S&&(te?(te=R(te),C(te,this.S)):te=this.S),this.m!==null||this.O||($.H=te,te=null),this.P)e:{for(var x=0,b=0;b<this.i.length;b++){t:{var A=this.i[b];if("__data__"in A.map&&(A=A.map.__data__,typeof A=="string")){A=A.length;break t}A=void 0}if(A===void 0)break;if(x+=A,4096<x){x=b;break e}if(x===4096||b===this.i.length-1){x=b+1;break e}}x=1e3}else x=1e3;x=iu(this,$,x),b=ra(this.I),Rt(b,"RID",h),Rt(b,"CVER",22),this.D&&Rt(b,"X-HTTP-Session-Id",this.D),ri(this,b),te&&(this.O?x="headers="+encodeURIComponent(String(dl(te)))+"&"+x:this.m&&vn(b,this.m,te)),Hi(this.h,$),this.Ua&&Rt(b,"TYPE","init"),this.P?(Rt(b,"$req",x),Rt(b,"SID","null"),$.T=!0,nt($,b,null)):nt($,b,x),this.G=2}}else this.G==3&&(h?ml(this,h):this.i.length==0||Ui(this.h)||ml(this))};function ml(h,x){var b;x?b=x.l:b=h.U++;const A=ra(h.I);Rt(A,"SID",h.K),Rt(A,"RID",b),Rt(A,"AID",h.T),ri(h,A),h.m&&h.o&&vn(A,h.m,h.o),b=new Jt(h,h.j,b,h.B+1),h.m===null&&(b.H=h.o),x&&(h.i=x.D.concat(h.i)),x=iu(h,b,1e3),b.I=Math.round(.5*h.wa)+Math.round(.5*h.wa*Math.random()),Hi(h.h,b),nt(b,A,x)}function ri(h,x){h.H&&ne(h.H,function(b,A){Rt(x,A,b)}),h.l&&il({},function(b,A){Rt(x,A,b)})}function iu(h,x,b){b=Math.min(h.i.length,b);var A=h.l?S(h.l.Na,h.l,h):null;e:{var $=h.i;let te=-1;for(;;){const ve=["count="+b];te==-1?0<b?(te=$[0].g,ve.push("ofs="+te)):te=0:ve.push("ofs="+te);let xt=!0;for(let hn=0;hn<b;hn++){let vt=$[hn].g;const bn=$[hn].map;if(vt-=te,0>vt)te=Math.max(0,$[hn].g-100),xt=!1;else try{Qa(bn,ve,"req"+vt+"_")}catch{A&&A(bn)}}if(xt){A=ve.join("&");break e}}}return h=h.i.splice(0,b),x.D=h,A}function ou(h){if(!h.g&&!h.u){h.Y=1;var x=h.Fa;de||O(),me||(de(),me=!0),ye.add(x,h),h.v=0}}function fl(h){return h.g||h.u||3<=h.v?!1:(h.Y++,h.u=Ae(S(h.Fa,h),gl(h,h.v)),h.v++,!0)}s.Fa=function(){if(this.u=null,lu(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var h=2*this.R;this.j.info("BP detection timer enabled: "+h),this.A=Ae(S(this.ab,this),h)}},s.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Ne(10),Qi(this),lu(this))};function ii(h){h.A!=null&&(f.clearTimeout(h.A),h.A=null)}function lu(h){h.g=new Jt(h,h.j,"rpc",h.Y),h.m===null&&(h.g.H=h.o),h.g.O=0;var x=ra(h.qa);Rt(x,"RID","rpc"),Rt(x,"SID",h.K),Rt(x,"AID",h.T),Rt(x,"CI",h.F?"0":"1"),!h.F&&h.ja&&Rt(x,"TO",h.ja),Rt(x,"TYPE","xmlhttp"),ri(h,x),h.m&&h.o&&vn(x,h.m,h.o),h.L&&(h.g.I=h.L);var b=h.g;h=h.ia,b.L=1,b.v=Wr(ra(x)),b.m=null,b.P=!0,Pn(b,h)}s.Za=function(){this.C!=null&&(this.C=null,Qi(this),fl(this),Ne(19))};function Zi(h){h.C!=null&&(f.clearTimeout(h.C),h.C=null)}function cu(h,x){var b=null;if(h.g==x){Zi(h),ii(h),h.g=null;var A=2}else if(sl(h.h,x))b=x.D,Fn(h.h,x),A=1;else return;if(h.G!=0){if(x.o)if(A==1){b=x.m?x.m.length:0,x=Date.now()-x.F;var $=h.B;A=re(),ft(A,new be(A,b)),Xi(h)}else ou(h);else if($=x.s,$==3||$==0&&0<x.X||!(A==1&&Ih(h,x)||A==2&&fl(h)))switch(b&&0<b.length&&(x=h.h,x.i=x.i.concat(b)),$){case 1:As(h,5);break;case 4:As(h,10);break;case 3:As(h,6);break;default:As(h,2)}}}function gl(h,x){let b=h.Ta+Math.floor(Math.random()*h.cb);return h.isActive()||(b*=2),b*x}function As(h,x){if(h.j.info("Error code "+x),x==2){var b=S(h.fb,h),A=h.Xa;const $=!A;A=new an(A||"//www.google.com/images/cleardot.gif"),f.location&&f.location.protocol=="http"||Zr(A,"https"),Wr(A),$?ei(A.toString(),b):Da(A.toString(),b)}else Ne(2);h.G=0,h.l&&h.l.sa(x),uu(h),ru(h)}s.fb=function(h){h?(this.j.info("Successfully pinged google.com"),Ne(2)):(this.j.info("Failed to ping google.com"),Ne(1))};function uu(h){if(h.G=0,h.ka=[],h.l){const x=rl(h.h);(x.length!=0||h.i.length!=0)&&(P(h.ka,x),P(h.ka,h.i),h.h.i.length=0,L(h.i),h.i.length=0),h.l.ra()}}function du(h,x,b){var A=b instanceof an?ra(b):new an(b);if(A.g!="")x&&(A.g=x+"."+A.g),ar(A,A.s);else{var $=f.location;A=$.protocol,x=x?x+"."+$.hostname:$.hostname,$=+$.port;var te=new an(null);A&&Zr(te,A),x&&(te.g=x),$&&ar(te,$),b&&(te.l=b),A=te}return b=h.D,x=h.ya,b&&x&&Rt(A,b,x),Rt(A,"VER",h.la),ri(h,A),A}function hu(h,x,b){if(x&&!h.J)throw Error("Can't create secondary domain capable XhrIo object.");return x=h.Ca&&!h.pa?new Et(new sr({eb:b})):new Et(h.pa),x.Ha(h.J),x}s.isActive=function(){return!!this.l&&this.l.isActive(this)};function mu(){}s=mu.prototype,s.ua=function(){},s.ta=function(){},s.sa=function(){},s.ra=function(){},s.isActive=function(){return!0},s.Na=function(){};function Wi(){}Wi.prototype.g=function(h,x){return new qn(h,x)};function qn(h,x){st.call(this),this.g=new Yi(x),this.l=h,this.h=x&&x.messageUrlParams||null,h=x&&x.messageHeaders||null,x&&x.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=x&&x.initMessageHeaders||null,x&&x.messageContentType&&(h?h["X-WebChannel-Content-Type"]=x.messageContentType:h={"X-WebChannel-Content-Type":x.messageContentType}),x&&x.va&&(h?h["X-WebChannel-Client-Profile"]=x.va:h={"X-WebChannel-Client-Profile":x.va}),this.g.S=h,(h=x&&x.Sb)&&!U(h)&&(this.g.m=h),this.v=x&&x.supportsCrossDomainXhr||!1,this.u=x&&x.sendRawJson||!1,(x=x&&x.httpSessionIdParam)&&!U(x)&&(this.g.D=x,h=this.h,h!==null&&x in h&&(h=this.h,x in h&&delete h[x])),this.j=new Ja(this)}q(qn,st),qn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},qn.prototype.close=function(){hl(this.g)},qn.prototype.o=function(h){var x=this.g;if(typeof h=="string"){var b={};b.__data__=h,h=b}else this.u&&(b={},b.__data__=On(h),h=b);x.i.push(new eu(x.Ya++,h)),x.G==3&&Xi(x)},qn.prototype.N=function(){this.g.l=null,delete this.j,hl(this.g),delete this.g,qn.aa.N.call(this)};function fu(h){ke.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var x=h.__sm__;if(x){e:{for(const b in x){h=b;break e}h=void 0}(this.i=h)&&(h=this.i,x=x!==null&&h in x?x[h]:void 0),this.data=x}else this.data=h}q(fu,ke);function gu(){Oe.call(this),this.status=1}q(gu,Oe);function Ja(h){this.g=h}q(Ja,mu),Ja.prototype.ua=function(){ft(this.g,"a")},Ja.prototype.ta=function(h){ft(this.g,new fu(h))},Ja.prototype.sa=function(h){ft(this.g,new gu)},Ja.prototype.ra=function(){ft(this.g,"b")},Wi.prototype.createWebChannel=Wi.prototype.g,qn.prototype.send=qn.prototype.o,qn.prototype.open=qn.prototype.m,qn.prototype.close=qn.prototype.close,W1=function(){return new Wi},Z1=function(){return re()},X1=Ke,tg={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Zt.NO_ERROR=0,Zt.TIMEOUT=8,Zt.HTTP_ERROR=6,jd=Zt,Wt.COMPLETE="complete",Q1=Wt,vs.EventType=sa,sa.OPEN="a",sa.CLOSE="b",sa.ERROR="c",sa.MESSAGE="d",st.prototype.listen=st.prototype.K,oc=vs,Et.prototype.listenOnce=Et.prototype.L,Et.prototype.getLastError=Et.prototype.Ka,Et.prototype.getLastErrorCode=Et.prototype.Ba,Et.prototype.getStatus=Et.prototype.Z,Et.prototype.getResponseJson=Et.prototype.Oa,Et.prototype.getResponseText=Et.prototype.oa,Et.prototype.send=Et.prototype.ea,Et.prototype.setWithCredentials=Et.prototype.Ha,Y1=Et}).apply(typeof xd<"u"?xd:typeof self<"u"?self:typeof window<"u"?window:{});const jv="@firebase/firestore",Cv="4.9.1";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Zn=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Zn.UNAUTHENTICATED=new Zn(null),Zn.GOOGLE_CREDENTIALS=new Zn("google-credentials-uid"),Zn.FIRST_PARTY=new Zn("first-party-uid"),Zn.MOCK_USER=new Zn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Wo="12.2.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ri=new jg("@firebase/firestore");function Ro(){return Ri.logLevel}function Re(s,...e){if(Ri.logLevel<=dt.DEBUG){const t=e.map(Bg);Ri.debug(`Firestore (${Wo}): ${s}`,...t)}}function Zs(s,...e){if(Ri.logLevel<=dt.ERROR){const t=e.map(Bg);Ri.error(`Firestore (${Wo}): ${s}`,...t)}}function kc(s,...e){if(Ri.logLevel<=dt.WARN){const t=e.map(Bg);Ri.warn(`Firestore (${Wo}): ${s}`,...t)}}function Bg(s){if(typeof s=="string")return s;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return(function(t){return JSON.stringify(t)})(s)}catch{return s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qe(s,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,J1(s,r,t)}function J1(s,e,t){let r=`FIRESTORE (${Wo}) INTERNAL ASSERTION FAILED: ${e} (ID: ${s.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw Zs(r),new Error(r)}function St(s,e,t,r){let o="Unexpected state";typeof t=="string"?o=t:r=t,s||J1(e,o,r)}function at(s,e){return s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oe={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Te extends er{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ks{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z2{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class W2{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Zn.UNAUTHENTICATED)))}shutdown(){}}class J2{constructor(e){this.t=e,this.currentUser=Zn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){St(this.o===void 0,42304);let r=this.i;const o=p=>this.i!==r?(r=this.i,t(p)):Promise.resolve();let c=new Ks;this.o=()=>{this.i++,this.currentUser=this.u(),c.resolve(),c=new Ks,e.enqueueRetryable((()=>o(this.currentUser)))};const d=()=>{const p=c;e.enqueueRetryable((async()=>{await p.promise,await o(this.currentUser)}))},f=p=>{Re("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=p,this.o&&(this.auth.addAuthTokenListener(this.o),d())};this.t.onInit((p=>f(p))),setTimeout((()=>{if(!this.auth){const p=this.t.getImmediate({optional:!0});p?f(p):(Re("FirebaseAuthCredentialsProvider","Auth not yet detected"),c.resolve(),c=new Ks)}}),0),d()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((r=>this.i!==e?(Re("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(St(typeof r.accessToken=="string",31837,{l:r}),new Z2(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return St(e===null||typeof e=="string",2055,{h:e}),new Zn(e)}}class eR{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=Zn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class tR{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new eR(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(Zn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class Iv{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class nR{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Aa(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){St(this.o===void 0,3512);const r=c=>{c.error!=null&&Re("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${c.error.message}`);const d=c.token!==this.m;return this.m=c.token,Re("FirebaseAppCheckTokenProvider",`Received ${d?"new":"existing"} token.`),d?t(c.token):Promise.resolve()};this.o=c=>{e.enqueueRetryable((()=>r(c)))};const o=c=>{Re("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=c,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((c=>o(c))),setTimeout((()=>{if(!this.appCheck){const c=this.V.getImmediate({optional:!0});c?o(c):Re("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new Iv(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(St(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new Iv(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aR(s){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(s);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<s;r++)t[r]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hg{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const o=aR(40);for(let c=0;c<o.length;++c)r.length<20&&o[c]<t&&(r+=e.charAt(o[c]%62))}return r}}function ht(s,e){return s<e?-1:s>e?1:0}function ng(s,e){const t=Math.min(s.length,e.length);for(let r=0;r<t;r++){const o=s.charAt(r),c=e.charAt(r);if(o!==c)return Vf(o)===Vf(c)?ht(o,c):Vf(o)?1:-1}return ht(s.length,e.length)}const sR=55296,rR=57343;function Vf(s){const e=s.charCodeAt(0);return e>=sR&&e<=rR}function Uo(s,e,t){return s.length===e.length&&s.every(((r,o)=>t(r,e[o])))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dv="__name__";class is{constructor(e,t,r){t===void 0?t=0:t>e.length&&Qe(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&Qe(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return is.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof is?e.forEach((r=>{t.push(r)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let o=0;o<r;o++){const c=is.compareSegments(e.get(o),t.get(o));if(c!==0)return c}return ht(e.length,t.length)}static compareSegments(e,t){const r=is.isNumericId(e),o=is.isNumericId(t);return r&&!o?-1:!r&&o?1:r&&o?is.extractNumericId(e).compare(is.extractNumericId(t)):ng(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return zr.fromString(e.substring(4,e.length-2))}}class Vt extends is{construct(e,t,r){return new Vt(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new Te(oe.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter((o=>o.length>0)))}return new Vt(t)}static emptyPath(){return new Vt([])}}const iR=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class In extends is{construct(e,t,r){return new In(e,t,r)}static isValidIdentifier(e){return iR.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),In.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Dv}static keyField(){return new In([Dv])}static fromServerFormat(e){const t=[];let r="",o=0;const c=()=>{if(r.length===0)throw new Te(oe.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let d=!1;for(;o<e.length;){const f=e[o];if(f==="\\"){if(o+1===e.length)throw new Te(oe.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const p=e[o+1];if(p!=="\\"&&p!=="."&&p!=="`")throw new Te(oe.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=p,o+=2}else f==="`"?(d=!d,o++):f!=="."||d?(r+=f,o++):(c(),o++)}if(c(),d)throw new Te(oe.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new In(t)}static emptyPath(){return new In([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ue{constructor(e){this.path=e}static fromPath(e){return new Ue(Vt.fromString(e))}static fromName(e){return new Ue(Vt.fromString(e).popFirst(5))}static empty(){return new Ue(Vt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Vt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Vt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ue(new Vt(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e_(s,e,t){if(!t)throw new Te(oe.INVALID_ARGUMENT,`Function ${s}() cannot be called with an empty ${e}.`)}function oR(s,e,t,r){if(e===!0&&r===!0)throw new Te(oe.INVALID_ARGUMENT,`${s} and ${t} cannot be used together.`)}function Mv(s){if(!Ue.isDocumentKey(s))throw new Te(oe.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${s} has ${s.length}.`)}function Ov(s){if(Ue.isDocumentKey(s))throw new Te(oe.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${s} has ${s.length}.`)}function t_(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}function uh(s){if(s===void 0)return"undefined";if(s===null)return"null";if(typeof s=="string")return s.length>20&&(s=`${s.substring(0,20)}...`),JSON.stringify(s);if(typeof s=="number"||typeof s=="boolean")return""+s;if(typeof s=="object"){if(s instanceof Array)return"an array";{const e=(function(r){return r.constructor?r.constructor.name:null})(s);return e?`a custom ${e} object`:"an object"}}return typeof s=="function"?"a function":Qe(12329,{type:typeof s})}function ji(s,e){if("_delegate"in s&&(s=s._delegate),!(s instanceof e)){if(e.name===s.constructor.name)throw new Te(oe.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=uh(s);throw new Te(oe.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return s}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cn(s,e){const t={typeString:s};return e&&(t.value=e),t}function Gc(s,e){if(!t_(s))throw new Te(oe.INVALID_ARGUMENT,"JSON must be an object");let t;for(const r in e)if(e[r]){const o=e[r].typeString,c="value"in e[r]?{value:e[r].value}:void 0;if(!(r in s)){t=`JSON missing required field: '${r}'`;break}const d=s[r];if(o&&typeof d!==o){t=`JSON field '${r}' must be a ${o}.`;break}if(c!==void 0&&d!==c.value){t=`Expected '${r}' field to equal '${c.value}'`;break}}if(t)throw new Te(oe.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pv=-62135596800,zv=1e6;class zt{static now(){return zt.fromMillis(Date.now())}static fromDate(e){return zt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*zv);return new zt(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Te(oe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Te(oe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<Pv)throw new Te(oe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Te(oe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/zv}_compareTo(e){return this.seconds===e.seconds?ht(this.nanoseconds,e.nanoseconds):ht(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:zt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Gc(e,zt._jsonSchema))return new zt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-Pv;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}zt._jsonSchemaVersion="firestore/timestamp/1.0",zt._jsonSchema={type:cn("string",zt._jsonSchemaVersion),seconds:cn("number"),nanoseconds:cn("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tt{static fromTimestamp(e){return new tt(e)}static min(){return new tt(new zt(0,0))}static max(){return new tt(new zt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tc=-1;function lR(s,e){const t=s.toTimestamp().seconds,r=s.toTimestamp().nanoseconds+1,o=tt.fromTimestamp(r===1e9?new zt(t+1,0):new zt(t,r));return new Vr(o,Ue.empty(),e)}function cR(s){return new Vr(s.readTime,s.key,Tc)}class Vr{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new Vr(tt.min(),Ue.empty(),Tc)}static max(){return new Vr(tt.max(),Ue.empty(),Tc)}}function uR(s,e){let t=s.readTime.compareTo(e.readTime);return t!==0?t:(t=Ue.comparator(s.documentKey,e.documentKey),t!==0?t:ht(s.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dR="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class hR{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Jo(s){if(s.code!==oe.FAILED_PRECONDITION||s.message!==dR)throw s;Re("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ue{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Qe(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new ue(((r,o)=>{this.nextCallback=c=>{this.wrapSuccess(e,c).next(r,o)},this.catchCallback=c=>{this.wrapFailure(t,c).next(r,o)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof ue?t:ue.resolve(t)}catch(t){return ue.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):ue.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):ue.reject(t)}static resolve(e){return new ue(((t,r)=>{t(e)}))}static reject(e){return new ue(((t,r)=>{r(e)}))}static waitFor(e){return new ue(((t,r)=>{let o=0,c=0,d=!1;e.forEach((f=>{++o,f.next((()=>{++c,d&&c===o&&t()}),(p=>r(p)))})),d=!0,c===o&&t()}))}static or(e){let t=ue.resolve(!1);for(const r of e)t=t.next((o=>o?ue.resolve(o):r()));return t}static forEach(e,t){const r=[];return e.forEach(((o,c)=>{r.push(t.call(this,o,c))})),this.waitFor(r)}static mapArray(e,t){return new ue(((r,o)=>{const c=e.length,d=new Array(c);let f=0;for(let p=0;p<c;p++){const y=p;t(e[y]).next((v=>{d[y]=v,++f,f===c&&r(d)}),(v=>o(v)))}}))}static doWhile(e,t){return new ue(((r,o)=>{const c=()=>{e()===!0?t().next((()=>{c()}),o):r()};c()}))}}function mR(s){const e=s.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function el(s){return s.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dh{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>t.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}dh.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gg=-1;function hh(s){return s==null}function qd(s){return s===0&&1/s==-1/0}function fR(s){return typeof s=="number"&&Number.isInteger(s)&&!qd(s)&&s<=Number.MAX_SAFE_INTEGER&&s>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n_="";function gR(s){let e="";for(let t=0;t<s.length;t++)e.length>0&&(e=Lv(e)),e=pR(s.get(t),e);return Lv(e)}function pR(s,e){let t=e;const r=s.length;for(let o=0;o<r;o++){const c=s.charAt(o);switch(c){case"\0":t+="";break;case n_:t+="";break;default:t+=c}}return t}function Lv(s){return s+n_+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vv(s){let e=0;for(const t in s)Object.prototype.hasOwnProperty.call(s,t)&&e++;return e}function Pi(s,e){for(const t in s)Object.prototype.hasOwnProperty.call(s,t)&&e(t,s[t])}function a_(s){for(const e in s)if(Object.prototype.hasOwnProperty.call(s,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $t{constructor(e,t){this.comparator=e,this.root=t||Cn.EMPTY}insert(e,t){return new $t(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Cn.BLACK,null,null))}remove(e){return new $t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Cn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const o=this.comparator(e,r.key);if(o===0)return t+r.left.size;o<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,r)=>(e(t,r),!1)))}toString(){const e=[];return this.inorderTraversal(((t,r)=>(e.push(`${t}:${r}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new vd(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new vd(this.root,e,this.comparator,!1)}getReverseIterator(){return new vd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new vd(this.root,e,this.comparator,!0)}}class vd{constructor(e,t,r,o){this.isReverse=o,this.nodeStack=[];let c=1;for(;!e.isEmpty();)if(c=t?r(e.key,t):1,t&&o&&(c*=-1),c<0)e=this.isReverse?e.left:e.right;else{if(c===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Cn{constructor(e,t,r,o,c){this.key=e,this.value=t,this.color=r??Cn.RED,this.left=o??Cn.EMPTY,this.right=c??Cn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,o,c){return new Cn(e??this.key,t??this.value,r??this.color,o??this.left,c??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let o=this;const c=r(e,o.key);return o=c<0?o.copy(null,null,null,o.left.insert(e,t,r),null):c===0?o.copy(null,t,null,null,null):o.copy(null,null,null,null,o.right.insert(e,t,r)),o.fixUp()}removeMin(){if(this.left.isEmpty())return Cn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,o=this;if(t(e,o.key)<0)o.left.isEmpty()||o.left.isRed()||o.left.left.isRed()||(o=o.moveRedLeft()),o=o.copy(null,null,null,o.left.remove(e,t),null);else{if(o.left.isRed()&&(o=o.rotateRight()),o.right.isEmpty()||o.right.isRed()||o.right.left.isRed()||(o=o.moveRedRight()),t(e,o.key)===0){if(o.right.isEmpty())return Cn.EMPTY;r=o.right.min(),o=o.copy(r.key,r.value,null,null,o.right.removeMin())}o=o.copy(null,null,null,null,o.right.remove(e,t))}return o.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Cn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Cn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Qe(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Qe(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Qe(27949);return e+(this.isRed()?0:1)}}Cn.EMPTY=null,Cn.RED=!0,Cn.BLACK=!1;Cn.EMPTY=new class{constructor(){this.size=0}get key(){throw Qe(57766)}get value(){throw Qe(16141)}get color(){throw Qe(16727)}get left(){throw Qe(29726)}get right(){throw Qe(36894)}copy(e,t,r,o,c){return this}insert(e,t,r){return new Cn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pn{constructor(e){this.comparator=e,this.data=new $t(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,r)=>(e(t),!1)))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const o=r.getNext();if(this.comparator(o.key,e[1])>=0)return;t(o.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Uv(this.data.getIterator())}getIteratorFrom(e){return new Uv(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((r=>{t=t.add(r)})),t}isEqual(e){if(!(e instanceof pn)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const o=t.getNext().key,c=r.getNext().key;if(this.comparator(o,c)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new pn(this.comparator);return t.data=e,t}}class Uv{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class La{constructor(e){this.fields=e,e.sort(In.comparator)}static empty(){return new La([])}unionWith(e){let t=new pn(In.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new La(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Uo(this.fields,e.fields,((t,r)=>t.isEqual(r)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s_ extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dn{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(o){try{return atob(o)}catch(c){throw typeof DOMException<"u"&&c instanceof DOMException?new s_("Invalid base64 string: "+c):c}})(e);return new Dn(t)}static fromUint8Array(e){const t=(function(o){let c="";for(let d=0;d<o.length;++d)c+=String.fromCharCode(o[d]);return c})(e);return new Dn(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const r=new Uint8Array(t.length);for(let o=0;o<t.length;o++)r[o]=t.charCodeAt(o);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ht(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Dn.EMPTY_BYTE_STRING=new Dn("");const yR=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ur(s){if(St(!!s,39018),typeof s=="string"){let e=0;const t=yR.exec(s);if(St(!!t,46558,{timestamp:s}),t[1]){let o=t[1];o=(o+"000000000").substr(0,9),e=Number(o)}const r=new Date(s);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:nn(s.seconds),nanos:nn(s.nanos)}}function nn(s){return typeof s=="number"?s:typeof s=="string"?Number(s):0}function Br(s){return typeof s=="string"?Dn.fromBase64String(s):Dn.fromUint8Array(s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r_="server_timestamp",i_="__type__",o_="__previous_value__",l_="__local_write_time__";function Fg(s){return(s?.mapValue?.fields||{})[i_]?.stringValue===r_}function mh(s){const e=s.mapValue.fields[o_];return Fg(e)?mh(e):e}function wc(s){const e=Ur(s.mapValue.fields[l_].timestampValue);return new zt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xR{constructor(e,t,r,o,c,d,f,p,y,v){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=o,this.ssl=c,this.forceLongPolling=d,this.autoDetectLongPolling=f,this.longPollingOptions=p,this.useFetchStreams=y,this.isUsingEmulator=v}}const $d="(default)";class Ec{constructor(e,t){this.projectId=e,this.database=t||$d}static empty(){return new Ec("","")}get isDefaultDatabase(){return this.database===$d}isEqual(e){return e instanceof Ec&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c_="__type__",vR="__max__",bd={mapValue:{}},u_="__vector__",Kd="value";function Hr(s){return"nullValue"in s?0:"booleanValue"in s?1:"integerValue"in s||"doubleValue"in s?2:"timestampValue"in s?3:"stringValue"in s?5:"bytesValue"in s?6:"referenceValue"in s?7:"geoPointValue"in s?8:"arrayValue"in s?9:"mapValue"in s?Fg(s)?4:_R(s)?9007199254740991:bR(s)?10:11:Qe(28295,{value:s})}function gs(s,e){if(s===e)return!0;const t=Hr(s);if(t!==Hr(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return s.booleanValue===e.booleanValue;case 4:return wc(s).isEqual(wc(e));case 3:return(function(o,c){if(typeof o.timestampValue=="string"&&typeof c.timestampValue=="string"&&o.timestampValue.length===c.timestampValue.length)return o.timestampValue===c.timestampValue;const d=Ur(o.timestampValue),f=Ur(c.timestampValue);return d.seconds===f.seconds&&d.nanos===f.nanos})(s,e);case 5:return s.stringValue===e.stringValue;case 6:return(function(o,c){return Br(o.bytesValue).isEqual(Br(c.bytesValue))})(s,e);case 7:return s.referenceValue===e.referenceValue;case 8:return(function(o,c){return nn(o.geoPointValue.latitude)===nn(c.geoPointValue.latitude)&&nn(o.geoPointValue.longitude)===nn(c.geoPointValue.longitude)})(s,e);case 2:return(function(o,c){if("integerValue"in o&&"integerValue"in c)return nn(o.integerValue)===nn(c.integerValue);if("doubleValue"in o&&"doubleValue"in c){const d=nn(o.doubleValue),f=nn(c.doubleValue);return d===f?qd(d)===qd(f):isNaN(d)&&isNaN(f)}return!1})(s,e);case 9:return Uo(s.arrayValue.values||[],e.arrayValue.values||[],gs);case 10:case 11:return(function(o,c){const d=o.mapValue.fields||{},f=c.mapValue.fields||{};if(Vv(d)!==Vv(f))return!1;for(const p in d)if(d.hasOwnProperty(p)&&(f[p]===void 0||!gs(d[p],f[p])))return!1;return!0})(s,e);default:return Qe(52216,{left:s})}}function Sc(s,e){return(s.values||[]).find((t=>gs(t,e)))!==void 0}function Bo(s,e){if(s===e)return 0;const t=Hr(s),r=Hr(e);if(t!==r)return ht(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return ht(s.booleanValue,e.booleanValue);case 2:return(function(c,d){const f=nn(c.integerValue||c.doubleValue),p=nn(d.integerValue||d.doubleValue);return f<p?-1:f>p?1:f===p?0:isNaN(f)?isNaN(p)?0:-1:1})(s,e);case 3:return Bv(s.timestampValue,e.timestampValue);case 4:return Bv(wc(s),wc(e));case 5:return ng(s.stringValue,e.stringValue);case 6:return(function(c,d){const f=Br(c),p=Br(d);return f.compareTo(p)})(s.bytesValue,e.bytesValue);case 7:return(function(c,d){const f=c.split("/"),p=d.split("/");for(let y=0;y<f.length&&y<p.length;y++){const v=ht(f[y],p[y]);if(v!==0)return v}return ht(f.length,p.length)})(s.referenceValue,e.referenceValue);case 8:return(function(c,d){const f=ht(nn(c.latitude),nn(d.latitude));return f!==0?f:ht(nn(c.longitude),nn(d.longitude))})(s.geoPointValue,e.geoPointValue);case 9:return Hv(s.arrayValue,e.arrayValue);case 10:return(function(c,d){const f=c.fields||{},p=d.fields||{},y=f[Kd]?.arrayValue,v=p[Kd]?.arrayValue,k=ht(y?.values?.length||0,v?.values?.length||0);return k!==0?k:Hv(y,v)})(s.mapValue,e.mapValue);case 11:return(function(c,d){if(c===bd.mapValue&&d===bd.mapValue)return 0;if(c===bd.mapValue)return 1;if(d===bd.mapValue)return-1;const f=c.fields||{},p=Object.keys(f),y=d.fields||{},v=Object.keys(y);p.sort(),v.sort();for(let k=0;k<p.length&&k<v.length;++k){const S=ng(p[k],v[k]);if(S!==0)return S;const I=Bo(f[p[k]],y[v[k]]);if(I!==0)return I}return ht(p.length,v.length)})(s.mapValue,e.mapValue);default:throw Qe(23264,{he:t})}}function Bv(s,e){if(typeof s=="string"&&typeof e=="string"&&s.length===e.length)return ht(s,e);const t=Ur(s),r=Ur(e),o=ht(t.seconds,r.seconds);return o!==0?o:ht(t.nanos,r.nanos)}function Hv(s,e){const t=s.values||[],r=e.values||[];for(let o=0;o<t.length&&o<r.length;++o){const c=Bo(t[o],r[o]);if(c)return c}return ht(t.length,r.length)}function Ho(s){return ag(s)}function ag(s){return"nullValue"in s?"null":"booleanValue"in s?""+s.booleanValue:"integerValue"in s?""+s.integerValue:"doubleValue"in s?""+s.doubleValue:"timestampValue"in s?(function(t){const r=Ur(t);return`time(${r.seconds},${r.nanos})`})(s.timestampValue):"stringValue"in s?s.stringValue:"bytesValue"in s?(function(t){return Br(t).toBase64()})(s.bytesValue):"referenceValue"in s?(function(t){return Ue.fromName(t).toString()})(s.referenceValue):"geoPointValue"in s?(function(t){return`geo(${t.latitude},${t.longitude})`})(s.geoPointValue):"arrayValue"in s?(function(t){let r="[",o=!0;for(const c of t.values||[])o?o=!1:r+=",",r+=ag(c);return r+"]"})(s.arrayValue):"mapValue"in s?(function(t){const r=Object.keys(t.fields||{}).sort();let o="{",c=!0;for(const d of r)c?c=!1:o+=",",o+=`${d}:${ag(t.fields[d])}`;return o+"}"})(s.mapValue):Qe(61005,{value:s})}function Cd(s){switch(Hr(s)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=mh(s);return e?16+Cd(e):16;case 5:return 2*s.stringValue.length;case 6:return Br(s.bytesValue).approximateByteSize();case 7:return s.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce(((o,c)=>o+Cd(c)),0)})(s.arrayValue);case 10:case 11:return(function(r){let o=0;return Pi(r.fields,((c,d)=>{o+=c.length+Cd(d)})),o})(s.mapValue);default:throw Qe(13486,{value:s})}}function Gv(s,e){return{referenceValue:`projects/${s.projectId}/databases/${s.database}/documents/${e.path.canonicalString()}`}}function sg(s){return!!s&&"integerValue"in s}function qg(s){return!!s&&"arrayValue"in s}function Fv(s){return!!s&&"nullValue"in s}function qv(s){return!!s&&"doubleValue"in s&&isNaN(Number(s.doubleValue))}function Id(s){return!!s&&"mapValue"in s}function bR(s){return(s?.mapValue?.fields||{})[c_]?.stringValue===u_}function mc(s){if(s.geoPointValue)return{geoPointValue:{...s.geoPointValue}};if(s.timestampValue&&typeof s.timestampValue=="object")return{timestampValue:{...s.timestampValue}};if(s.mapValue){const e={mapValue:{fields:{}}};return Pi(s.mapValue.fields,((t,r)=>e.mapValue.fields[t]=mc(r))),e}if(s.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(s.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=mc(s.arrayValue.values[t]);return e}return{...s}}function _R(s){return(((s.mapValue||{}).fields||{}).__type__||{}).stringValue===vR}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Na{constructor(e){this.value=e}static empty(){return new Na({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Id(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=mc(t)}setAll(e){let t=In.emptyPath(),r={},o=[];e.forEach(((d,f)=>{if(!t.isImmediateParentOf(f)){const p=this.getFieldsMap(t);this.applyChanges(p,r,o),r={},o=[],t=f.popLast()}d?r[f.lastSegment()]=mc(d):o.push(f.lastSegment())}));const c=this.getFieldsMap(t);this.applyChanges(c,r,o)}delete(e){const t=this.field(e.popLast());Id(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return gs(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let o=t.mapValue.fields[e.get(r)];Id(o)&&o.mapValue.fields||(o={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=o),t=o}return t.mapValue.fields}applyChanges(e,t,r){Pi(t,((o,c)=>e[o]=c));for(const o of r)delete e[o]}clone(){return new Na(mc(this.value))}}function d_(s){const e=[];return Pi(s.fields,((t,r)=>{const o=new In([t]);if(Id(r)){const c=d_(r.mapValue).fields;if(c.length===0)e.push(o);else for(const d of c)e.push(o.child(d))}else e.push(o)})),new La(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Un{constructor(e,t,r,o,c,d,f){this.key=e,this.documentType=t,this.version=r,this.readTime=o,this.createTime=c,this.data=d,this.documentState=f}static newInvalidDocument(e){return new Un(e,0,tt.min(),tt.min(),tt.min(),Na.empty(),0)}static newFoundDocument(e,t,r,o){return new Un(e,1,t,tt.min(),r,o,0)}static newNoDocument(e,t){return new Un(e,2,t,tt.min(),tt.min(),Na.empty(),0)}static newUnknownDocument(e,t){return new Un(e,3,t,tt.min(),tt.min(),Na.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(tt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Na.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Na.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=tt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Un&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Un(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yd{constructor(e,t){this.position=e,this.inclusive=t}}function $v(s,e,t){let r=0;for(let o=0;o<s.position.length;o++){const c=e[o],d=s.position[o];if(c.field.isKeyField()?r=Ue.comparator(Ue.fromName(d.referenceValue),t.key):r=Bo(d,t.data.field(c.field)),c.dir==="desc"&&(r*=-1),r!==0)break}return r}function Kv(s,e){if(s===null)return e===null;if(e===null||s.inclusive!==e.inclusive||s.position.length!==e.position.length)return!1;for(let t=0;t<s.position.length;t++)if(!gs(s.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qd{constructor(e,t="asc"){this.field=e,this.dir=t}}function kR(s,e){return s.dir===e.dir&&s.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h_{}class ln extends h_{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new wR(e,t,r):t==="array-contains"?new AR(e,r):t==="in"?new NR(e,r):t==="not-in"?new RR(e,r):t==="array-contains-any"?new jR(e,r):new ln(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new ER(e,r):new SR(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Bo(t,this.value)):t!==null&&Hr(this.value)===Hr(t)&&this.matchesComparison(Bo(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Qe(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ba extends h_{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new Ba(e,t)}matches(e){return m_(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function m_(s){return s.op==="and"}function f_(s){return TR(s)&&m_(s)}function TR(s){for(const e of s.filters)if(e instanceof Ba)return!1;return!0}function rg(s){if(s instanceof ln)return s.field.canonicalString()+s.op.toString()+Ho(s.value);if(f_(s))return s.filters.map((e=>rg(e))).join(",");{const e=s.filters.map((t=>rg(t))).join(",");return`${s.op}(${e})`}}function g_(s,e){return s instanceof ln?(function(r,o){return o instanceof ln&&r.op===o.op&&r.field.isEqual(o.field)&&gs(r.value,o.value)})(s,e):s instanceof Ba?(function(r,o){return o instanceof Ba&&r.op===o.op&&r.filters.length===o.filters.length?r.filters.reduce(((c,d,f)=>c&&g_(d,o.filters[f])),!0):!1})(s,e):void Qe(19439)}function p_(s){return s instanceof ln?(function(t){return`${t.field.canonicalString()} ${t.op} ${Ho(t.value)}`})(s):s instanceof Ba?(function(t){return t.op.toString()+" {"+t.getFilters().map(p_).join(" ,")+"}"})(s):"Filter"}class wR extends ln{constructor(e,t,r){super(e,t,r),this.key=Ue.fromName(r.referenceValue)}matches(e){const t=Ue.comparator(e.key,this.key);return this.matchesComparison(t)}}class ER extends ln{constructor(e,t){super(e,"in",t),this.keys=y_("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class SR extends ln{constructor(e,t){super(e,"not-in",t),this.keys=y_("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function y_(s,e){return(e.arrayValue?.values||[]).map((t=>Ue.fromName(t.referenceValue)))}class AR extends ln{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return qg(t)&&Sc(t.arrayValue,this.value)}}class NR extends ln{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Sc(this.value.arrayValue,t)}}class RR extends ln{constructor(e,t){super(e,"not-in",t)}matches(e){if(Sc(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Sc(this.value.arrayValue,t)}}class jR extends ln{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!qg(t)||!t.arrayValue.values)&&t.arrayValue.values.some((r=>Sc(this.value.arrayValue,r)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CR{constructor(e,t=null,r=[],o=[],c=null,d=null,f=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=o,this.limit=c,this.startAt=d,this.endAt=f,this.Te=null}}function Yv(s,e=null,t=[],r=[],o=null,c=null,d=null){return new CR(s,e,t,r,o,c,d)}function $g(s){const e=at(s);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((r=>rg(r))).join(","),t+="|ob:",t+=e.orderBy.map((r=>(function(c){return c.field.canonicalString()+c.dir})(r))).join(","),hh(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((r=>Ho(r))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((r=>Ho(r))).join(",")),e.Te=t}return e.Te}function Kg(s,e){if(s.limit!==e.limit||s.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<s.orderBy.length;t++)if(!kR(s.orderBy[t],e.orderBy[t]))return!1;if(s.filters.length!==e.filters.length)return!1;for(let t=0;t<s.filters.length;t++)if(!g_(s.filters[t],e.filters[t]))return!1;return s.collectionGroup===e.collectionGroup&&!!s.path.isEqual(e.path)&&!!Kv(s.startAt,e.startAt)&&Kv(s.endAt,e.endAt)}function ig(s){return Ue.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fc{constructor(e,t=null,r=[],o=[],c=null,d="F",f=null,p=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=o,this.limit=c,this.limitType=d,this.startAt=f,this.endAt=p,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function IR(s,e,t,r,o,c,d,f){return new Fc(s,e,t,r,o,c,d,f)}function Yg(s){return new Fc(s)}function Qv(s){return s.filters.length===0&&s.limit===null&&s.startAt==null&&s.endAt==null&&(s.explicitOrderBy.length===0||s.explicitOrderBy.length===1&&s.explicitOrderBy[0].field.isKeyField())}function x_(s){return s.collectionGroup!==null}function fc(s){const e=at(s);if(e.Ie===null){e.Ie=[];const t=new Set;for(const c of e.explicitOrderBy)e.Ie.push(c),t.add(c.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(d){let f=new pn(In.comparator);return d.filters.forEach((p=>{p.getFlattenedFilters().forEach((y=>{y.isInequality()&&(f=f.add(y.field))}))})),f})(e).forEach((c=>{t.has(c.canonicalString())||c.isKeyField()||e.Ie.push(new Qd(c,r))})),t.has(In.keyField().canonicalString())||e.Ie.push(new Qd(In.keyField(),r))}return e.Ie}function us(s){const e=at(s);return e.Ee||(e.Ee=DR(e,fc(s))),e.Ee}function DR(s,e){if(s.limitType==="F")return Yv(s.path,s.collectionGroup,e,s.filters,s.limit,s.startAt,s.endAt);{e=e.map((o=>{const c=o.dir==="desc"?"asc":"desc";return new Qd(o.field,c)}));const t=s.endAt?new Yd(s.endAt.position,s.endAt.inclusive):null,r=s.startAt?new Yd(s.startAt.position,s.startAt.inclusive):null;return Yv(s.path,s.collectionGroup,e,s.filters,s.limit,t,r)}}function og(s,e){const t=s.filters.concat([e]);return new Fc(s.path,s.collectionGroup,s.explicitOrderBy.slice(),t,s.limit,s.limitType,s.startAt,s.endAt)}function lg(s,e,t){return new Fc(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),e,t,s.startAt,s.endAt)}function fh(s,e){return Kg(us(s),us(e))&&s.limitType===e.limitType}function v_(s){return`${$g(us(s))}|lt:${s.limitType}`}function jo(s){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map((o=>p_(o))).join(", ")}]`),hh(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map((o=>(function(d){return`${d.field.canonicalString()} (${d.dir})`})(o))).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map((o=>Ho(o))).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map((o=>Ho(o))).join(",")),`Target(${r})`})(us(s))}; limitType=${s.limitType})`}function gh(s,e){return e.isFoundDocument()&&(function(r,o){const c=o.key.path;return r.collectionGroup!==null?o.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(c):Ue.isDocumentKey(r.path)?r.path.isEqual(c):r.path.isImmediateParentOf(c)})(s,e)&&(function(r,o){for(const c of fc(r))if(!c.field.isKeyField()&&o.data.field(c.field)===null)return!1;return!0})(s,e)&&(function(r,o){for(const c of r.filters)if(!c.matches(o))return!1;return!0})(s,e)&&(function(r,o){return!(r.startAt&&!(function(d,f,p){const y=$v(d,f,p);return d.inclusive?y<=0:y<0})(r.startAt,fc(r),o)||r.endAt&&!(function(d,f,p){const y=$v(d,f,p);return d.inclusive?y>=0:y>0})(r.endAt,fc(r),o))})(s,e)}function MR(s){return s.collectionGroup||(s.path.length%2==1?s.path.lastSegment():s.path.get(s.path.length-2))}function b_(s){return(e,t)=>{let r=!1;for(const o of fc(s)){const c=OR(o,e,t);if(c!==0)return c;r=r||o.field.isKeyField()}return 0}}function OR(s,e,t){const r=s.field.isKeyField()?Ue.comparator(e.key,t.key):(function(c,d,f){const p=d.data.field(c),y=f.data.field(c);return p!==null&&y!==null?Bo(p,y):Qe(42886)})(s.field,e,t);switch(s.dir){case"asc":return r;case"desc":return-1*r;default:return Qe(19790,{direction:s.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zi{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[o,c]of r)if(this.equalsFn(o,e))return c}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),o=this.inner[r];if(o===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let c=0;c<o.length;c++)if(this.equalsFn(o[c][0],e))return void(o[c]=[e,t]);o.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let o=0;o<r.length;o++)if(this.equalsFn(r[o][0],e))return r.length===1?delete this.inner[t]:r.splice(o,1),this.innerSize--,!0;return!1}forEach(e){Pi(this.inner,((t,r)=>{for(const[o,c]of r)e(o,c)}))}isEmpty(){return a_(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PR=new $t(Ue.comparator);function Ws(){return PR}const __=new $t(Ue.comparator);function lc(...s){let e=__;for(const t of s)e=e.insert(t.key,t);return e}function k_(s){let e=__;return s.forEach(((t,r)=>e=e.insert(t,r.overlayedDocument))),e}function Ti(){return gc()}function T_(){return gc()}function gc(){return new zi((s=>s.toString()),((s,e)=>s.isEqual(e)))}const zR=new $t(Ue.comparator),LR=new pn(Ue.comparator);function mt(...s){let e=LR;for(const t of s)e=e.add(t);return e}const VR=new pn(ht);function UR(){return VR}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qg(s,e){if(s.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:qd(e)?"-0":e}}function w_(s){return{integerValue:""+s}}function BR(s,e){return fR(e)?w_(e):Qg(s,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ph{constructor(){this._=void 0}}function HR(s,e,t){return s instanceof Ac?(function(o,c){const d={fields:{[i_]:{stringValue:r_},[l_]:{timestampValue:{seconds:o.seconds,nanos:o.nanoseconds}}}};return c&&Fg(c)&&(c=mh(c)),c&&(d.fields[o_]=c),{mapValue:d}})(t,e):s instanceof Nc?S_(s,e):s instanceof Rc?A_(s,e):(function(o,c){const d=E_(o,c),f=Xv(d)+Xv(o.Ae);return sg(d)&&sg(o.Ae)?w_(f):Qg(o.serializer,f)})(s,e)}function GR(s,e,t){return s instanceof Nc?S_(s,e):s instanceof Rc?A_(s,e):t}function E_(s,e){return s instanceof Xd?(function(r){return sg(r)||(function(c){return!!c&&"doubleValue"in c})(r)})(e)?e:{integerValue:0}:null}class Ac extends ph{}class Nc extends ph{constructor(e){super(),this.elements=e}}function S_(s,e){const t=N_(e);for(const r of s.elements)t.some((o=>gs(o,r)))||t.push(r);return{arrayValue:{values:t}}}class Rc extends ph{constructor(e){super(),this.elements=e}}function A_(s,e){let t=N_(e);for(const r of s.elements)t=t.filter((o=>!gs(o,r)));return{arrayValue:{values:t}}}class Xd extends ph{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function Xv(s){return nn(s.integerValue||s.doubleValue)}function N_(s){return qg(s)&&s.arrayValue.values?s.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FR{constructor(e,t){this.field=e,this.transform=t}}function qR(s,e){return s.field.isEqual(e.field)&&(function(r,o){return r instanceof Nc&&o instanceof Nc||r instanceof Rc&&o instanceof Rc?Uo(r.elements,o.elements,gs):r instanceof Xd&&o instanceof Xd?gs(r.Ae,o.Ae):r instanceof Ac&&o instanceof Ac})(s.transform,e.transform)}class $R{constructor(e,t){this.version=e,this.transformResults=t}}class ds{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new ds}static exists(e){return new ds(void 0,e)}static updateTime(e){return new ds(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Dd(s,e){return s.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(s.updateTime):s.exists===void 0||s.exists===e.isFoundDocument()}class yh{}function R_(s,e){if(!s.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return s.isNoDocument()?new C_(s.key,ds.none()):new qc(s.key,s.data,ds.none());{const t=s.data,r=Na.empty();let o=new pn(In.comparator);for(let c of e.fields)if(!o.has(c)){let d=t.field(c);d===null&&c.length>1&&(c=c.popLast(),d=t.field(c)),d===null?r.delete(c):r.set(c,d),o=o.add(c)}return new Li(s.key,r,new La(o.toArray()),ds.none())}}function KR(s,e,t){s instanceof qc?(function(o,c,d){const f=o.value.clone(),p=Wv(o.fieldTransforms,c,d.transformResults);f.setAll(p),c.convertToFoundDocument(d.version,f).setHasCommittedMutations()})(s,e,t):s instanceof Li?(function(o,c,d){if(!Dd(o.precondition,c))return void c.convertToUnknownDocument(d.version);const f=Wv(o.fieldTransforms,c,d.transformResults),p=c.data;p.setAll(j_(o)),p.setAll(f),c.convertToFoundDocument(d.version,p).setHasCommittedMutations()})(s,e,t):(function(o,c,d){c.convertToNoDocument(d.version).setHasCommittedMutations()})(0,e,t)}function pc(s,e,t,r){return s instanceof qc?(function(c,d,f,p){if(!Dd(c.precondition,d))return f;const y=c.value.clone(),v=Jv(c.fieldTransforms,p,d);return y.setAll(v),d.convertToFoundDocument(d.version,y).setHasLocalMutations(),null})(s,e,t,r):s instanceof Li?(function(c,d,f,p){if(!Dd(c.precondition,d))return f;const y=Jv(c.fieldTransforms,p,d),v=d.data;return v.setAll(j_(c)),v.setAll(y),d.convertToFoundDocument(d.version,v).setHasLocalMutations(),f===null?null:f.unionWith(c.fieldMask.fields).unionWith(c.fieldTransforms.map((k=>k.field)))})(s,e,t,r):(function(c,d,f){return Dd(c.precondition,d)?(d.convertToNoDocument(d.version).setHasLocalMutations(),null):f})(s,e,t)}function YR(s,e){let t=null;for(const r of s.fieldTransforms){const o=e.data.field(r.field),c=E_(r.transform,o||null);c!=null&&(t===null&&(t=Na.empty()),t.set(r.field,c))}return t||null}function Zv(s,e){return s.type===e.type&&!!s.key.isEqual(e.key)&&!!s.precondition.isEqual(e.precondition)&&!!(function(r,o){return r===void 0&&o===void 0||!(!r||!o)&&Uo(r,o,((c,d)=>qR(c,d)))})(s.fieldTransforms,e.fieldTransforms)&&(s.type===0?s.value.isEqual(e.value):s.type!==1||s.data.isEqual(e.data)&&s.fieldMask.isEqual(e.fieldMask))}class qc extends yh{constructor(e,t,r,o=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=o,this.type=0}getFieldMask(){return null}}class Li extends yh{constructor(e,t,r,o,c=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=o,this.fieldTransforms=c,this.type=1}getFieldMask(){return this.fieldMask}}function j_(s){const e=new Map;return s.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const r=s.data.field(t);e.set(t,r)}})),e}function Wv(s,e,t){const r=new Map;St(s.length===t.length,32656,{Re:t.length,Ve:s.length});for(let o=0;o<t.length;o++){const c=s[o],d=c.transform,f=e.data.field(c.field);r.set(c.field,GR(d,f,t[o]))}return r}function Jv(s,e,t){const r=new Map;for(const o of s){const c=o.transform,d=t.data.field(o.field);r.set(o.field,HR(c,d,e))}return r}class C_ extends yh{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class QR extends yh{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XR{constructor(e,t,r,o){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=o}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let o=0;o<this.mutations.length;o++){const c=this.mutations[o];c.key.isEqual(e.key)&&KR(c,e,r[o])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=pc(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=pc(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=T_();return this.mutations.forEach((o=>{const c=e.get(o.key),d=c.overlayedDocument;let f=this.applyToLocalView(d,c.mutatedFields);f=t.has(o.key)?null:f;const p=R_(d,f);p!==null&&r.set(o.key,p),d.isValidDocument()||d.convertToNoDocument(tt.min())})),r}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),mt())}isEqual(e){return this.batchId===e.batchId&&Uo(this.mutations,e.mutations,((t,r)=>Zv(t,r)))&&Uo(this.baseMutations,e.baseMutations,((t,r)=>Zv(t,r)))}}class Xg{constructor(e,t,r,o){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=o}static from(e,t,r){St(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let o=(function(){return zR})();const c=e.mutations;for(let d=0;d<c.length;d++)o=o.insert(c[d].key,r[d].version);return new Xg(e,t,r,o)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZR{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WR{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var on,_t;function JR(s){switch(s){case oe.OK:return Qe(64938);case oe.CANCELLED:case oe.UNKNOWN:case oe.DEADLINE_EXCEEDED:case oe.RESOURCE_EXHAUSTED:case oe.INTERNAL:case oe.UNAVAILABLE:case oe.UNAUTHENTICATED:return!1;case oe.INVALID_ARGUMENT:case oe.NOT_FOUND:case oe.ALREADY_EXISTS:case oe.PERMISSION_DENIED:case oe.FAILED_PRECONDITION:case oe.ABORTED:case oe.OUT_OF_RANGE:case oe.UNIMPLEMENTED:case oe.DATA_LOSS:return!0;default:return Qe(15467,{code:s})}}function I_(s){if(s===void 0)return Zs("GRPC error has no .code"),oe.UNKNOWN;switch(s){case on.OK:return oe.OK;case on.CANCELLED:return oe.CANCELLED;case on.UNKNOWN:return oe.UNKNOWN;case on.DEADLINE_EXCEEDED:return oe.DEADLINE_EXCEEDED;case on.RESOURCE_EXHAUSTED:return oe.RESOURCE_EXHAUSTED;case on.INTERNAL:return oe.INTERNAL;case on.UNAVAILABLE:return oe.UNAVAILABLE;case on.UNAUTHENTICATED:return oe.UNAUTHENTICATED;case on.INVALID_ARGUMENT:return oe.INVALID_ARGUMENT;case on.NOT_FOUND:return oe.NOT_FOUND;case on.ALREADY_EXISTS:return oe.ALREADY_EXISTS;case on.PERMISSION_DENIED:return oe.PERMISSION_DENIED;case on.FAILED_PRECONDITION:return oe.FAILED_PRECONDITION;case on.ABORTED:return oe.ABORTED;case on.OUT_OF_RANGE:return oe.OUT_OF_RANGE;case on.UNIMPLEMENTED:return oe.UNIMPLEMENTED;case on.DATA_LOSS:return oe.DATA_LOSS;default:return Qe(39323,{code:s})}}(_t=on||(on={}))[_t.OK=0]="OK",_t[_t.CANCELLED=1]="CANCELLED",_t[_t.UNKNOWN=2]="UNKNOWN",_t[_t.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",_t[_t.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",_t[_t.NOT_FOUND=5]="NOT_FOUND",_t[_t.ALREADY_EXISTS=6]="ALREADY_EXISTS",_t[_t.PERMISSION_DENIED=7]="PERMISSION_DENIED",_t[_t.UNAUTHENTICATED=16]="UNAUTHENTICATED",_t[_t.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",_t[_t.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",_t[_t.ABORTED=10]="ABORTED",_t[_t.OUT_OF_RANGE=11]="OUT_OF_RANGE",_t[_t.UNIMPLEMENTED=12]="UNIMPLEMENTED",_t[_t.INTERNAL=13]="INTERNAL",_t[_t.UNAVAILABLE=14]="UNAVAILABLE",_t[_t.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ej(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tj=new zr([4294967295,4294967295],0);function eb(s){const e=ej().encode(s),t=new K1;return t.update(e),new Uint8Array(t.digest())}function tb(s){const e=new DataView(s.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),o=e.getUint32(8,!0),c=e.getUint32(12,!0);return[new zr([t,r],0),new zr([o,c],0)]}class Zg{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new cc(`Invalid padding: ${t}`);if(r<0)throw new cc(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new cc(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new cc(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=zr.fromNumber(this.ge)}ye(e,t,r){let o=e.add(t.multiply(zr.fromNumber(r)));return o.compare(tj)===1&&(o=new zr([o.getBits(0),o.getBits(1)],0)),o.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=eb(e),[r,o]=tb(t);for(let c=0;c<this.hashCount;c++){const d=this.ye(r,o,c);if(!this.we(d))return!1}return!0}static create(e,t,r){const o=e%8==0?0:8-e%8,c=new Uint8Array(Math.ceil(e/8)),d=new Zg(c,o,t);return r.forEach((f=>d.insert(f))),d}insert(e){if(this.ge===0)return;const t=eb(e),[r,o]=tb(t);for(let c=0;c<this.hashCount;c++){const d=this.ye(r,o,c);this.Se(d)}}Se(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class cc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xh{constructor(e,t,r,o,c){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=o,this.resolvedLimboDocuments=c}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const o=new Map;return o.set(e,$c.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new xh(tt.min(),o,new $t(ht),Ws(),mt())}}class $c{constructor(e,t,r,o,c){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=o,this.removedDocuments=c}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new $c(r,t,mt(),mt(),mt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Md{constructor(e,t,r,o){this.be=e,this.removedTargetIds=t,this.key=r,this.De=o}}class D_{constructor(e,t){this.targetId=e,this.Ce=t}}class M_{constructor(e,t,r=Dn.EMPTY_BYTE_STRING,o=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=o}}class nb{constructor(){this.ve=0,this.Fe=ab(),this.Me=Dn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=mt(),t=mt(),r=mt();return this.Fe.forEach(((o,c)=>{switch(c){case 0:e=e.add(o);break;case 2:t=t.add(o);break;case 1:r=r.add(o);break;default:Qe(38017,{changeType:c})}})),new $c(this.Me,this.xe,e,t,r)}qe(){this.Oe=!1,this.Fe=ab()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,St(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class nj{constructor(e){this.Ge=e,this.ze=new Map,this.je=Ws(),this.Je=_d(),this.He=_d(),this.Ye=new $t(ht)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const r=this.nt(t);switch(e.state){case 0:this.rt(t)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),r.Le(e.resumeToken));break;default:Qe(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((r,o)=>{this.rt(o)&&t(o)}))}st(e){const t=e.targetId,r=e.Ce.count,o=this.ot(t);if(o){const c=o.target;if(ig(c))if(r===0){const d=new Ue(c.path);this.et(t,d,Un.newNoDocument(d,tt.min()))}else St(r===1,20013,{expectedCount:r});else{const d=this._t(t);if(d!==r){const f=this.ut(e),p=f?this.ct(f,e,d):1;if(p!==0){this.it(t);const y=p===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,y)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:o=0},hashCount:c=0}=t;let d,f;try{d=Br(r).toUint8Array()}catch(p){if(p instanceof s_)return kc("Decoding the base64 bloom filter in existence filter failed ("+p.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw p}try{f=new Zg(d,o,c)}catch(p){return kc(p instanceof cc?"BloomFilter error: ":"Applying bloom filter failed: ",p),null}return f.ge===0?null:f}ct(e,t,r){return t.Ce.count===r-this.Pt(e,t.targetId)?0:2}Pt(e,t){const r=this.Ge.getRemoteKeysForTarget(t);let o=0;return r.forEach((c=>{const d=this.Ge.ht(),f=`projects/${d.projectId}/databases/${d.database}/documents/${c.path.canonicalString()}`;e.mightContain(f)||(this.et(t,c,null),o++)})),o}Tt(e){const t=new Map;this.ze.forEach(((c,d)=>{const f=this.ot(d);if(f){if(c.current&&ig(f.target)){const p=new Ue(f.target.path);this.It(p).has(d)||this.Et(d,p)||this.et(d,p,Un.newNoDocument(p,e))}c.Be&&(t.set(d,c.ke()),c.qe())}}));let r=mt();this.He.forEach(((c,d)=>{let f=!0;d.forEachWhile((p=>{const y=this.ot(p);return!y||y.purpose==="TargetPurposeLimboResolution"||(f=!1,!1)})),f&&(r=r.add(c))})),this.je.forEach(((c,d)=>d.setReadTime(e)));const o=new xh(e,t,this.Ye,this.je,r);return this.je=Ws(),this.Je=_d(),this.He=_d(),this.Ye=new $t(ht),o}Xe(e,t){if(!this.rt(e))return;const r=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,r),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,r){if(!this.rt(e))return;const o=this.nt(e);this.Et(e,t)?o.Qe(t,1):o.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),r&&(this.je=this.je.insert(t,r))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new nb,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new pn(ht),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new pn(ht),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||Re("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new nb),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function _d(){return new $t(Ue.comparator)}function ab(){return new $t(Ue.comparator)}const aj={asc:"ASCENDING",desc:"DESCENDING"},sj={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},rj={and:"AND",or:"OR"};class ij{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function cg(s,e){return s.useProto3Json||hh(e)?e:{value:e}}function Zd(s,e){return s.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function O_(s,e){return s.useProto3Json?e.toBase64():e.toUint8Array()}function oj(s,e){return Zd(s,e.toTimestamp())}function hs(s){return St(!!s,49232),tt.fromTimestamp((function(t){const r=Ur(t);return new zt(r.seconds,r.nanos)})(s))}function Wg(s,e){return ug(s,e).canonicalString()}function ug(s,e){const t=(function(o){return new Vt(["projects",o.projectId,"databases",o.database])})(s).child("documents");return e===void 0?t:t.child(e)}function P_(s){const e=Vt.fromString(s);return St(B_(e),10190,{key:e.toString()}),e}function dg(s,e){return Wg(s.databaseId,e.path)}function Uf(s,e){const t=P_(e);if(t.get(1)!==s.databaseId.projectId)throw new Te(oe.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+s.databaseId.projectId);if(t.get(3)!==s.databaseId.database)throw new Te(oe.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+s.databaseId.database);return new Ue(L_(t))}function z_(s,e){return Wg(s.databaseId,e)}function lj(s){const e=P_(s);return e.length===4?Vt.emptyPath():L_(e)}function hg(s){return new Vt(["projects",s.databaseId.projectId,"databases",s.databaseId.database]).canonicalString()}function L_(s){return St(s.length>4&&s.get(4)==="documents",29091,{key:s.toString()}),s.popFirst(5)}function sb(s,e,t){return{name:dg(s,e),fields:t.value.mapValue.fields}}function cj(s,e){let t;if("targetChange"in e){e.targetChange;const r=(function(y){return y==="NO_CHANGE"?0:y==="ADD"?1:y==="REMOVE"?2:y==="CURRENT"?3:y==="RESET"?4:Qe(39313,{state:y})})(e.targetChange.targetChangeType||"NO_CHANGE"),o=e.targetChange.targetIds||[],c=(function(y,v){return y.useProto3Json?(St(v===void 0||typeof v=="string",58123),Dn.fromBase64String(v||"")):(St(v===void 0||v instanceof Buffer||v instanceof Uint8Array,16193),Dn.fromUint8Array(v||new Uint8Array))})(s,e.targetChange.resumeToken),d=e.targetChange.cause,f=d&&(function(y){const v=y.code===void 0?oe.UNKNOWN:I_(y.code);return new Te(v,y.message||"")})(d);t=new M_(r,o,c,f||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const o=Uf(s,r.document.name),c=hs(r.document.updateTime),d=r.document.createTime?hs(r.document.createTime):tt.min(),f=new Na({mapValue:{fields:r.document.fields}}),p=Un.newFoundDocument(o,c,d,f),y=r.targetIds||[],v=r.removedTargetIds||[];t=new Md(y,v,p.key,p)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const o=Uf(s,r.document),c=r.readTime?hs(r.readTime):tt.min(),d=Un.newNoDocument(o,c),f=r.removedTargetIds||[];t=new Md([],f,d.key,d)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const o=Uf(s,r.document),c=r.removedTargetIds||[];t=new Md([],c,o,null)}else{if(!("filter"in e))return Qe(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:o=0,unchangedNames:c}=r,d=new WR(o,c),f=r.targetId;t=new D_(f,d)}}return t}function uj(s,e){let t;if(e instanceof qc)t={update:sb(s,e.key,e.value)};else if(e instanceof C_)t={delete:dg(s,e.key)};else if(e instanceof Li)t={update:sb(s,e.key,e.data),updateMask:vj(e.fieldMask)};else{if(!(e instanceof QR))return Qe(16599,{Vt:e.type});t={verify:dg(s,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((r=>(function(c,d){const f=d.transform;if(f instanceof Ac)return{fieldPath:d.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(f instanceof Nc)return{fieldPath:d.field.canonicalString(),appendMissingElements:{values:f.elements}};if(f instanceof Rc)return{fieldPath:d.field.canonicalString(),removeAllFromArray:{values:f.elements}};if(f instanceof Xd)return{fieldPath:d.field.canonicalString(),increment:f.Ae};throw Qe(20930,{transform:d.transform})})(0,r)))),e.precondition.isNone||(t.currentDocument=(function(o,c){return c.updateTime!==void 0?{updateTime:oj(o,c.updateTime)}:c.exists!==void 0?{exists:c.exists}:Qe(27497)})(s,e.precondition)),t}function dj(s,e){return s&&s.length>0?(St(e!==void 0,14353),s.map((t=>(function(o,c){let d=o.updateTime?hs(o.updateTime):hs(c);return d.isEqual(tt.min())&&(d=hs(c)),new $R(d,o.transformResults||[])})(t,e)))):[]}function hj(s,e){return{documents:[z_(s,e.path)]}}function mj(s,e){const t={structuredQuery:{}},r=e.path;let o;e.collectionGroup!==null?(o=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(o=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=z_(s,o);const c=(function(y){if(y.length!==0)return U_(Ba.create(y,"and"))})(e.filters);c&&(t.structuredQuery.where=c);const d=(function(y){if(y.length!==0)return y.map((v=>(function(S){return{field:Co(S.field),direction:pj(S.dir)}})(v)))})(e.orderBy);d&&(t.structuredQuery.orderBy=d);const f=cg(s,e.limit);return f!==null&&(t.structuredQuery.limit=f),e.startAt&&(t.structuredQuery.startAt=(function(y){return{before:y.inclusive,values:y.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(y){return{before:!y.inclusive,values:y.position}})(e.endAt)),{ft:t,parent:o}}function fj(s){let e=lj(s.parent);const t=s.structuredQuery,r=t.from?t.from.length:0;let o=null;if(r>0){St(r===1,65062);const v=t.from[0];v.allDescendants?o=v.collectionId:e=e.child(v.collectionId)}let c=[];t.where&&(c=(function(k){const S=V_(k);return S instanceof Ba&&f_(S)?S.getFilters():[S]})(t.where));let d=[];t.orderBy&&(d=(function(k){return k.map((S=>(function(q){return new Qd(Io(q.field),(function(P){switch(P){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(q.direction))})(S)))})(t.orderBy));let f=null;t.limit&&(f=(function(k){let S;return S=typeof k=="object"?k.value:k,hh(S)?null:S})(t.limit));let p=null;t.startAt&&(p=(function(k){const S=!!k.before,I=k.values||[];return new Yd(I,S)})(t.startAt));let y=null;return t.endAt&&(y=(function(k){const S=!k.before,I=k.values||[];return new Yd(I,S)})(t.endAt)),IR(e,o,d,c,f,"F",p,y)}function gj(s,e){const t=(function(o){switch(o){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Qe(28987,{purpose:o})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function V_(s){return s.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=Io(t.unaryFilter.field);return ln.create(r,"==",{doubleValue:NaN});case"IS_NULL":const o=Io(t.unaryFilter.field);return ln.create(o,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const c=Io(t.unaryFilter.field);return ln.create(c,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const d=Io(t.unaryFilter.field);return ln.create(d,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Qe(61313);default:return Qe(60726)}})(s):s.fieldFilter!==void 0?(function(t){return ln.create(Io(t.fieldFilter.field),(function(o){switch(o){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Qe(58110);default:return Qe(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(s):s.compositeFilter!==void 0?(function(t){return Ba.create(t.compositeFilter.filters.map((r=>V_(r))),(function(o){switch(o){case"AND":return"and";case"OR":return"or";default:return Qe(1026)}})(t.compositeFilter.op))})(s):Qe(30097,{filter:s})}function pj(s){return aj[s]}function yj(s){return sj[s]}function xj(s){return rj[s]}function Co(s){return{fieldPath:s.canonicalString()}}function Io(s){return In.fromServerFormat(s.fieldPath)}function U_(s){return s instanceof ln?(function(t){if(t.op==="=="){if(qv(t.value))return{unaryFilter:{field:Co(t.field),op:"IS_NAN"}};if(Fv(t.value))return{unaryFilter:{field:Co(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(qv(t.value))return{unaryFilter:{field:Co(t.field),op:"IS_NOT_NAN"}};if(Fv(t.value))return{unaryFilter:{field:Co(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Co(t.field),op:yj(t.op),value:t.value}}})(s):s instanceof Ba?(function(t){const r=t.getFilters().map((o=>U_(o)));return r.length===1?r[0]:{compositeFilter:{op:xj(t.op),filters:r}}})(s):Qe(54877,{filter:s})}function vj(s){const e=[];return s.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function B_(s){return s.length>=4&&s.get(0)==="projects"&&s.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ir{constructor(e,t,r,o,c=tt.min(),d=tt.min(),f=Dn.EMPTY_BYTE_STRING,p=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=o,this.snapshotVersion=c,this.lastLimboFreeSnapshotVersion=d,this.resumeToken=f,this.expectedCount=p}withSequenceNumber(e){return new Ir(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Ir(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ir(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ir(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bj{constructor(e){this.yt=e}}function _j(s){const e=fj({parent:s.parent,structuredQuery:s.structuredQuery});return s.limitType==="LAST"?lg(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kj{constructor(){this.Cn=new Tj}addToCollectionParentIndex(e,t){return this.Cn.add(t),ue.resolve()}getCollectionParents(e,t){return ue.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return ue.resolve()}deleteFieldIndex(e,t){return ue.resolve()}deleteAllFieldIndexes(e){return ue.resolve()}createTargetIndexes(e,t){return ue.resolve()}getDocumentsMatchingTarget(e,t){return ue.resolve(null)}getIndexType(e,t){return ue.resolve(0)}getFieldIndexes(e,t){return ue.resolve([])}getNextCollectionGroupToUpdate(e){return ue.resolve(null)}getMinOffset(e,t){return ue.resolve(Vr.min())}getMinOffsetFromCollectionGroup(e,t){return ue.resolve(Vr.min())}updateCollectionGroup(e,t,r){return ue.resolve()}updateIndexEntries(e,t){return ue.resolve()}}class Tj{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),o=this.index[t]||new pn(Vt.comparator),c=!o.has(r);return this.index[t]=o.add(r),c}has(e){const t=e.lastSegment(),r=e.popLast(),o=this.index[t];return o&&o.has(r)}getEntries(e){return(this.index[e]||new pn(Vt.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rb={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},H_=41943040;class Wn{static withCacheSize(e){return new Wn(e,Wn.DEFAULT_COLLECTION_PERCENTILE,Wn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Wn.DEFAULT_COLLECTION_PERCENTILE=10,Wn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Wn.DEFAULT=new Wn(H_,Wn.DEFAULT_COLLECTION_PERCENTILE,Wn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Wn.DISABLED=new Wn(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Go{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Go(0)}static cr(){return new Go(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ib="LruGarbageCollector",G_=1048576;function ob([s,e],[t,r]){const o=ht(s,t);return o===0?ht(e,r):o}class wj{constructor(e){this.Ir=e,this.buffer=new pn(ob),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();ob(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class Ej{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Re(ib,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){el(t)?Re(ib,"Ignoring IndexedDB error during garbage collection: ",t):await Jo(t)}await this.Vr(3e5)}))}}class Sj{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((r=>Math.floor(t/100*r)))}nthSequenceNumber(e,t){if(t===0)return ue.resolve(dh.ce);const r=new wj(t);return this.mr.forEachTarget(e,(o=>r.Ar(o.sequenceNumber))).next((()=>this.mr.pr(e,(o=>r.Ar(o))))).next((()=>r.maxValue))}removeTargets(e,t,r){return this.mr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(Re("LruGarbageCollector","Garbage collection skipped; disabled"),ue.resolve(rb)):this.getCacheSize(e).next((r=>r<this.params.cacheSizeCollectionThreshold?(Re("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),rb):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let r,o,c,d,f,p,y;const v=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((k=>(k>this.params.maximumSequenceNumbersToCollect?(Re("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${k}`),o=this.params.maximumSequenceNumbersToCollect):o=k,d=Date.now(),this.nthSequenceNumber(e,o)))).next((k=>(r=k,f=Date.now(),this.removeTargets(e,r,t)))).next((k=>(c=k,p=Date.now(),this.removeOrphanedDocuments(e,r)))).next((k=>(y=Date.now(),Ro()<=dt.DEBUG&&Re("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${d-v}ms
	Determined least recently used ${o} in `+(f-d)+`ms
	Removed ${c} targets in `+(p-f)+`ms
	Removed ${k} documents in `+(y-p)+`ms
Total Duration: ${y-v}ms`),ue.resolve({didRun:!0,sequenceNumbersCollected:o,targetsRemoved:c,documentsRemoved:k}))))}}function Aj(s,e){return new Sj(s,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nj{constructor(){this.changes=new zi((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Un.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?ue.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rj{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jj{constructor(e,t,r,o){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=o}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next((o=>(r=o,this.remoteDocumentCache.getEntry(e,t)))).next((o=>(r!==null&&pc(r.mutation,o,La.empty(),zt.now()),o)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.getLocalViewOfDocuments(e,r,mt()).next((()=>r))))}getLocalViewOfDocuments(e,t,r=mt()){const o=Ti();return this.populateOverlays(e,o,t).next((()=>this.computeViews(e,t,o,r).next((c=>{let d=lc();return c.forEach(((f,p)=>{d=d.insert(f,p.overlayedDocument)})),d}))))}getOverlayedDocuments(e,t){const r=Ti();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,mt())))}populateOverlays(e,t,r){const o=[];return r.forEach((c=>{t.has(c)||o.push(c)})),this.documentOverlayCache.getOverlays(e,o).next((c=>{c.forEach(((d,f)=>{t.set(d,f)}))}))}computeViews(e,t,r,o){let c=Ws();const d=gc(),f=(function(){return gc()})();return t.forEach(((p,y)=>{const v=r.get(y.key);o.has(y.key)&&(v===void 0||v.mutation instanceof Li)?c=c.insert(y.key,y):v!==void 0?(d.set(y.key,v.mutation.getFieldMask()),pc(v.mutation,y,v.mutation.getFieldMask(),zt.now())):d.set(y.key,La.empty())})),this.recalculateAndSaveOverlays(e,c).next((p=>(p.forEach(((y,v)=>d.set(y,v))),t.forEach(((y,v)=>f.set(y,new Rj(v,d.get(y)??null)))),f)))}recalculateAndSaveOverlays(e,t){const r=gc();let o=new $t(((d,f)=>d-f)),c=mt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((d=>{for(const f of d)f.keys().forEach((p=>{const y=t.get(p);if(y===null)return;let v=r.get(p)||La.empty();v=f.applyToLocalView(y,v),r.set(p,v);const k=(o.get(f.batchId)||mt()).add(p);o=o.insert(f.batchId,k)}))})).next((()=>{const d=[],f=o.getReverseIterator();for(;f.hasNext();){const p=f.getNext(),y=p.key,v=p.value,k=T_();v.forEach((S=>{if(!c.has(S)){const I=R_(t.get(S),r.get(S));I!==null&&k.set(S,I),c=c.add(S)}})),d.push(this.documentOverlayCache.saveOverlays(e,y,k))}return ue.waitFor(d)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.recalculateAndSaveOverlays(e,r)))}getDocumentsMatchingQuery(e,t,r,o){return(function(d){return Ue.isDocumentKey(d.path)&&d.collectionGroup===null&&d.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):x_(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,o):this.getDocumentsMatchingCollectionQuery(e,t,r,o)}getNextDocuments(e,t,r,o){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,o).next((c=>{const d=o-c.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,o-c.size):ue.resolve(Ti());let f=Tc,p=c;return d.next((y=>ue.forEach(y,((v,k)=>(f<k.largestBatchId&&(f=k.largestBatchId),c.get(v)?ue.resolve():this.remoteDocumentCache.getEntry(e,v).next((S=>{p=p.insert(v,S)}))))).next((()=>this.populateOverlays(e,y,c))).next((()=>this.computeViews(e,p,y,mt()))).next((v=>({batchId:f,changes:k_(v)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Ue(t)).next((r=>{let o=lc();return r.isFoundDocument()&&(o=o.insert(r.key,r)),o}))}getDocumentsMatchingCollectionGroupQuery(e,t,r,o){const c=t.collectionGroup;let d=lc();return this.indexManager.getCollectionParents(e,c).next((f=>ue.forEach(f,(p=>{const y=(function(k,S){return new Fc(S,null,k.explicitOrderBy.slice(),k.filters.slice(),k.limit,k.limitType,k.startAt,k.endAt)})(t,p.child(c));return this.getDocumentsMatchingCollectionQuery(e,y,r,o).next((v=>{v.forEach(((k,S)=>{d=d.insert(k,S)}))}))})).next((()=>d))))}getDocumentsMatchingCollectionQuery(e,t,r,o){let c;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next((d=>(c=d,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,c,o)))).next((d=>{c.forEach(((p,y)=>{const v=y.getKey();d.get(v)===null&&(d=d.insert(v,Un.newInvalidDocument(v)))}));let f=lc();return d.forEach(((p,y)=>{const v=c.get(p);v!==void 0&&pc(v.mutation,y,La.empty(),zt.now()),gh(t,y)&&(f=f.insert(p,y))})),f}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cj{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return ue.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(o){return{id:o.id,version:o.version,createTime:hs(o.createTime)}})(t)),ue.resolve()}getNamedQuery(e,t){return ue.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(o){return{name:o.name,query:_j(o.bundledQuery),readTime:hs(o.readTime)}})(t)),ue.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ij{constructor(){this.overlays=new $t(Ue.comparator),this.qr=new Map}getOverlay(e,t){return ue.resolve(this.overlays.get(t))}getOverlays(e,t){const r=Ti();return ue.forEach(t,(o=>this.getOverlay(e,o).next((c=>{c!==null&&r.set(o,c)})))).next((()=>r))}saveOverlays(e,t,r){return r.forEach(((o,c)=>{this.St(e,t,c)})),ue.resolve()}removeOverlaysForBatchId(e,t,r){const o=this.qr.get(r);return o!==void 0&&(o.forEach((c=>this.overlays=this.overlays.remove(c))),this.qr.delete(r)),ue.resolve()}getOverlaysForCollection(e,t,r){const o=Ti(),c=t.length+1,d=new Ue(t.child("")),f=this.overlays.getIteratorFrom(d);for(;f.hasNext();){const p=f.getNext().value,y=p.getKey();if(!t.isPrefixOf(y.path))break;y.path.length===c&&p.largestBatchId>r&&o.set(p.getKey(),p)}return ue.resolve(o)}getOverlaysForCollectionGroup(e,t,r,o){let c=new $t(((y,v)=>y-v));const d=this.overlays.getIterator();for(;d.hasNext();){const y=d.getNext().value;if(y.getKey().getCollectionGroup()===t&&y.largestBatchId>r){let v=c.get(y.largestBatchId);v===null&&(v=Ti(),c=c.insert(y.largestBatchId,v)),v.set(y.getKey(),y)}}const f=Ti(),p=c.getIterator();for(;p.hasNext()&&(p.getNext().value.forEach(((y,v)=>f.set(y,v))),!(f.size()>=o)););return ue.resolve(f)}St(e,t,r){const o=this.overlays.get(r.key);if(o!==null){const d=this.qr.get(o.largestBatchId).delete(r.key);this.qr.set(o.largestBatchId,d)}this.overlays=this.overlays.insert(r.key,new ZR(t,r));let c=this.qr.get(t);c===void 0&&(c=mt(),this.qr.set(t,c)),this.qr.set(t,c.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dj{constructor(){this.sessionToken=Dn.EMPTY_BYTE_STRING}getSessionToken(e){return ue.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,ue.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jg{constructor(){this.Qr=new pn(wn.$r),this.Ur=new pn(wn.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const r=new wn(e,t);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,t){e.forEach((r=>this.addReference(r,t)))}removeReference(e,t){this.Gr(new wn(e,t))}zr(e,t){e.forEach((r=>this.removeReference(r,t)))}jr(e){const t=new Ue(new Vt([])),r=new wn(t,e),o=new wn(t,e+1),c=[];return this.Ur.forEachInRange([r,o],(d=>{this.Gr(d),c.push(d.key)})),c}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new Ue(new Vt([])),r=new wn(t,e),o=new wn(t,e+1);let c=mt();return this.Ur.forEachInRange([r,o],(d=>{c=c.add(d.key)})),c}containsKey(e){const t=new wn(e,0),r=this.Qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class wn{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return Ue.comparator(e.key,t.key)||ht(e.Yr,t.Yr)}static Kr(e,t){return ht(e.Yr,t.Yr)||Ue.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mj{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new pn(wn.$r)}checkEmpty(e){return ue.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,o){const c=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const d=new XR(c,t,r,o);this.mutationQueue.push(d);for(const f of o)this.Zr=this.Zr.add(new wn(f.key,c)),this.indexManager.addToCollectionParentIndex(e,f.key.path.popLast());return ue.resolve(d)}lookupMutationBatch(e,t){return ue.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,o=this.ei(r),c=o<0?0:o;return ue.resolve(this.mutationQueue.length>c?this.mutationQueue[c]:null)}getHighestUnacknowledgedBatchId(){return ue.resolve(this.mutationQueue.length===0?Gg:this.tr-1)}getAllMutationBatches(e){return ue.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new wn(t,0),o=new wn(t,Number.POSITIVE_INFINITY),c=[];return this.Zr.forEachInRange([r,o],(d=>{const f=this.Xr(d.Yr);c.push(f)})),ue.resolve(c)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new pn(ht);return t.forEach((o=>{const c=new wn(o,0),d=new wn(o,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([c,d],(f=>{r=r.add(f.Yr)}))})),ue.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,o=r.length+1;let c=r;Ue.isDocumentKey(c)||(c=c.child(""));const d=new wn(new Ue(c),0);let f=new pn(ht);return this.Zr.forEachWhile((p=>{const y=p.key.path;return!!r.isPrefixOf(y)&&(y.length===o&&(f=f.add(p.Yr)),!0)}),d),ue.resolve(this.ti(f))}ti(e){const t=[];return e.forEach((r=>{const o=this.Xr(r);o!==null&&t.push(o)})),t}removeMutationBatch(e,t){St(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return ue.forEach(t.mutations,(o=>{const c=new wn(o.key,t.batchId);return r=r.delete(c),this.referenceDelegate.markPotentiallyOrphaned(e,o.key)})).next((()=>{this.Zr=r}))}ir(e){}containsKey(e,t){const r=new wn(t,0),o=this.Zr.firstAfterOrEqual(r);return ue.resolve(t.isEqual(o&&o.key))}performConsistencyCheck(e){return this.mutationQueue.length,ue.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oj{constructor(e){this.ri=e,this.docs=(function(){return new $t(Ue.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,o=this.docs.get(r),c=o?o.size:0,d=this.ri(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:d}),this.size+=d-c,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return ue.resolve(r?r.document.mutableCopy():Un.newInvalidDocument(t))}getEntries(e,t){let r=Ws();return t.forEach((o=>{const c=this.docs.get(o);r=r.insert(o,c?c.document.mutableCopy():Un.newInvalidDocument(o))})),ue.resolve(r)}getDocumentsMatchingQuery(e,t,r,o){let c=Ws();const d=t.path,f=new Ue(d.child("__id-9223372036854775808__")),p=this.docs.getIteratorFrom(f);for(;p.hasNext();){const{key:y,value:{document:v}}=p.getNext();if(!d.isPrefixOf(y.path))break;y.path.length>d.length+1||uR(cR(v),r)<=0||(o.has(v.key)||gh(t,v))&&(c=c.insert(v.key,v.mutableCopy()))}return ue.resolve(c)}getAllFromCollectionGroup(e,t,r,o){Qe(9500)}ii(e,t){return ue.forEach(this.docs,(r=>t(r)))}newChangeBuffer(e){return new Pj(this)}getSize(e){return ue.resolve(this.size)}}class Pj extends Nj{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((r,o)=>{o.isValidDocument()?t.push(this.Nr.addEntry(e,o)):this.Nr.removeEntry(r)})),ue.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zj{constructor(e){this.persistence=e,this.si=new zi((t=>$g(t)),Kg),this.lastRemoteSnapshotVersion=tt.min(),this.highestTargetId=0,this.oi=0,this._i=new Jg,this.targetCount=0,this.ai=Go.ur()}forEachTarget(e,t){return this.si.forEach(((r,o)=>t(o))),ue.resolve()}getLastRemoteSnapshotVersion(e){return ue.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ue.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),ue.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.oi&&(this.oi=t),ue.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new Go(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,ue.resolve()}updateTargetData(e,t){return this.Pr(t),ue.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,ue.resolve()}removeTargets(e,t,r){let o=0;const c=[];return this.si.forEach(((d,f)=>{f.sequenceNumber<=t&&r.get(f.targetId)===null&&(this.si.delete(d),c.push(this.removeMatchingKeysForTargetId(e,f.targetId)),o++)})),ue.waitFor(c).next((()=>o))}getTargetCount(e){return ue.resolve(this.targetCount)}getTargetData(e,t){const r=this.si.get(t)||null;return ue.resolve(r)}addMatchingKeys(e,t,r){return this._i.Wr(t,r),ue.resolve()}removeMatchingKeys(e,t,r){this._i.zr(t,r);const o=this.persistence.referenceDelegate,c=[];return o&&t.forEach((d=>{c.push(o.markPotentiallyOrphaned(e,d))})),ue.waitFor(c)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),ue.resolve()}getMatchingKeysForTargetId(e,t){const r=this._i.Hr(t);return ue.resolve(r)}containsKey(e,t){return ue.resolve(this._i.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F_{constructor(e,t){this.ui={},this.overlays={},this.ci=new dh(0),this.li=!1,this.li=!0,this.hi=new Dj,this.referenceDelegate=e(this),this.Pi=new zj(this),this.indexManager=new kj,this.remoteDocumentCache=(function(o){return new Oj(o)})((r=>this.referenceDelegate.Ti(r))),this.serializer=new bj(t),this.Ii=new Cj(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Ij,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ui[e.toKey()];return r||(r=new Mj(t,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,r){Re("MemoryPersistence","Starting transaction:",e);const o=new Lj(this.ci.next());return this.referenceDelegate.Ei(),r(o).next((c=>this.referenceDelegate.di(o).next((()=>c)))).toPromise().then((c=>(o.raiseOnCommittedEvent(),c)))}Ai(e,t){return ue.or(Object.values(this.ui).map((r=>()=>r.containsKey(e,t))))}}class Lj extends hR{constructor(e){super(),this.currentSequenceNumber=e}}class ep{constructor(e){this.persistence=e,this.Ri=new Jg,this.Vi=null}static mi(e){return new ep(e)}get fi(){if(this.Vi)return this.Vi;throw Qe(60996)}addReference(e,t,r){return this.Ri.addReference(r,t),this.fi.delete(r.toString()),ue.resolve()}removeReference(e,t,r){return this.Ri.removeReference(r,t),this.fi.add(r.toString()),ue.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),ue.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((o=>this.fi.add(o.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((o=>{o.forEach((c=>this.fi.add(c.toString())))})).next((()=>r.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ue.forEach(this.fi,(r=>{const o=Ue.fromPath(r);return this.gi(e,o).next((c=>{c||t.removeEntry(o,tt.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((r=>{r?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return ue.or([()=>ue.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class Wd{constructor(e,t){this.persistence=e,this.pi=new zi((r=>gR(r.path)),((r,o)=>r.isEqual(o))),this.garbageCollector=Aj(this,t)}static mi(e,t){return new Wd(e,t)}Ei(){}di(e){return ue.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((r=>t.next((o=>r+o))))}wr(e){let t=0;return this.pr(e,(r=>{t++})).next((()=>t))}pr(e,t){return ue.forEach(this.pi,((r,o)=>this.br(e,r,o).next((c=>c?ue.resolve():t(o)))))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const o=this.persistence.getRemoteDocumentCache(),c=o.newChangeBuffer();return o.ii(e,(d=>this.br(e,d,t).next((f=>{f||(r++,c.removeEntry(d,tt.min()))})))).next((()=>c.apply(e))).next((()=>r))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),ue.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),ue.resolve()}removeReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),ue.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),ue.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Cd(e.data.value)),t}br(e,t,r){return ue.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const o=this.pi.get(t);return ue.resolve(o!==void 0&&o>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tp{constructor(e,t,r,o){this.targetId=e,this.fromCache=t,this.Es=r,this.ds=o}static As(e,t){let r=mt(),o=mt();for(const c of t.docChanges)switch(c.type){case 0:r=r.add(c.doc.key);break;case 1:o=o.add(c.doc.key)}return new tp(e,t.fromCache,r,o)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vj{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uj{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return gS()?8:mR(Hn())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,r,o){const c={result:null};return this.ys(e,t).next((d=>{c.result=d})).next((()=>{if(!c.result)return this.ws(e,t,o,r).next((d=>{c.result=d}))})).next((()=>{if(c.result)return;const d=new Vj;return this.Ss(e,t,d).next((f=>{if(c.result=f,this.Vs)return this.bs(e,t,d,f.size)}))})).next((()=>c.result))}bs(e,t,r,o){return r.documentReadCount<this.fs?(Ro()<=dt.DEBUG&&Re("QueryEngine","SDK will not create cache indexes for query:",jo(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),ue.resolve()):(Ro()<=dt.DEBUG&&Re("QueryEngine","Query:",jo(t),"scans",r.documentReadCount,"local documents and returns",o,"documents as results."),r.documentReadCount>this.gs*o?(Ro()<=dt.DEBUG&&Re("QueryEngine","The SDK decides to create cache indexes for query:",jo(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,us(t))):ue.resolve())}ys(e,t){if(Qv(t))return ue.resolve(null);let r=us(t);return this.indexManager.getIndexType(e,r).next((o=>o===0?null:(t.limit!==null&&o===1&&(t=lg(t,null,"F"),r=us(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next((c=>{const d=mt(...c);return this.ps.getDocuments(e,d).next((f=>this.indexManager.getMinOffset(e,r).next((p=>{const y=this.Ds(t,f);return this.Cs(t,y,d,p.readTime)?this.ys(e,lg(t,null,"F")):this.vs(e,y,t,p)}))))})))))}ws(e,t,r,o){return Qv(t)||o.isEqual(tt.min())?ue.resolve(null):this.ps.getDocuments(e,r).next((c=>{const d=this.Ds(t,c);return this.Cs(t,d,r,o)?ue.resolve(null):(Ro()<=dt.DEBUG&&Re("QueryEngine","Re-using previous result from %s to execute query: %s",o.toString(),jo(t)),this.vs(e,d,t,lR(o,Tc)).next((f=>f)))}))}Ds(e,t){let r=new pn(b_(e));return t.forEach(((o,c)=>{gh(e,c)&&(r=r.add(c))})),r}Cs(e,t,r,o){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const c=e.limitType==="F"?t.last():t.first();return!!c&&(c.hasPendingWrites||c.version.compareTo(o)>0)}Ss(e,t,r){return Ro()<=dt.DEBUG&&Re("QueryEngine","Using full collection scan to execute query:",jo(t)),this.ps.getDocumentsMatchingQuery(e,t,Vr.min(),r)}vs(e,t,r,o){return this.ps.getDocumentsMatchingQuery(e,r,o).next((c=>(t.forEach((d=>{c=c.insert(d.key,d)})),c)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const np="LocalStore",Bj=3e8;class Hj{constructor(e,t,r,o){this.persistence=e,this.Fs=t,this.serializer=o,this.Ms=new $t(ht),this.xs=new zi((c=>$g(c)),Kg),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new jj(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function Gj(s,e,t,r){return new Hj(s,e,t,r)}async function q_(s,e){const t=at(s);return await t.persistence.runTransaction("Handle user change","readonly",(r=>{let o;return t.mutationQueue.getAllMutationBatches(r).next((c=>(o=c,t.Bs(e),t.mutationQueue.getAllMutationBatches(r)))).next((c=>{const d=[],f=[];let p=mt();for(const y of o){d.push(y.batchId);for(const v of y.mutations)p=p.add(v.key)}for(const y of c){f.push(y.batchId);for(const v of y.mutations)p=p.add(v.key)}return t.localDocuments.getDocuments(r,p).next((y=>({Ls:y,removedBatchIds:d,addedBatchIds:f})))}))}))}function Fj(s,e){const t=at(s);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(r=>{const o=e.batch.keys(),c=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(f,p,y,v){const k=y.batch,S=k.keys();let I=ue.resolve();return S.forEach((q=>{I=I.next((()=>v.getEntry(p,q))).next((L=>{const P=y.docVersions.get(q);St(P!==null,48541),L.version.compareTo(P)<0&&(k.applyToRemoteDocument(L,y),L.isValidDocument()&&(L.setReadTime(y.commitVersion),v.addEntry(L)))}))})),I.next((()=>f.mutationQueue.removeMutationBatch(p,k)))})(t,r,e,c).next((()=>c.apply(r))).next((()=>t.mutationQueue.performConsistencyCheck(r))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(r,o,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(f){let p=mt();for(let y=0;y<f.mutationResults.length;++y)f.mutationResults[y].transformResults.length>0&&(p=p.add(f.batch.mutations[y].key));return p})(e)))).next((()=>t.localDocuments.getDocuments(r,o)))}))}function $_(s){const e=at(s);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function qj(s,e){const t=at(s),r=e.snapshotVersion;let o=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(c=>{const d=t.Ns.newChangeBuffer({trackRemovals:!0});o=t.Ms;const f=[];e.targetChanges.forEach(((v,k)=>{const S=o.get(k);if(!S)return;f.push(t.Pi.removeMatchingKeys(c,v.removedDocuments,k).next((()=>t.Pi.addMatchingKeys(c,v.addedDocuments,k))));let I=S.withSequenceNumber(c.currentSequenceNumber);e.targetMismatches.get(k)!==null?I=I.withResumeToken(Dn.EMPTY_BYTE_STRING,tt.min()).withLastLimboFreeSnapshotVersion(tt.min()):v.resumeToken.approximateByteSize()>0&&(I=I.withResumeToken(v.resumeToken,r)),o=o.insert(k,I),(function(L,P,K){return L.resumeToken.approximateByteSize()===0||P.snapshotVersion.toMicroseconds()-L.snapshotVersion.toMicroseconds()>=Bj?!0:K.addedDocuments.size+K.modifiedDocuments.size+K.removedDocuments.size>0})(S,I,v)&&f.push(t.Pi.updateTargetData(c,I))}));let p=Ws(),y=mt();if(e.documentUpdates.forEach((v=>{e.resolvedLimboDocuments.has(v)&&f.push(t.persistence.referenceDelegate.updateLimboDocument(c,v))})),f.push($j(c,d,e.documentUpdates).next((v=>{p=v.ks,y=v.qs}))),!r.isEqual(tt.min())){const v=t.Pi.getLastRemoteSnapshotVersion(c).next((k=>t.Pi.setTargetsMetadata(c,c.currentSequenceNumber,r)));f.push(v)}return ue.waitFor(f).next((()=>d.apply(c))).next((()=>t.localDocuments.getLocalViewOfDocuments(c,p,y))).next((()=>p))})).then((c=>(t.Ms=o,c)))}function $j(s,e,t){let r=mt(),o=mt();return t.forEach((c=>r=r.add(c))),e.getEntries(s,r).next((c=>{let d=Ws();return t.forEach(((f,p)=>{const y=c.get(f);p.isFoundDocument()!==y.isFoundDocument()&&(o=o.add(f)),p.isNoDocument()&&p.version.isEqual(tt.min())?(e.removeEntry(f,p.readTime),d=d.insert(f,p)):!y.isValidDocument()||p.version.compareTo(y.version)>0||p.version.compareTo(y.version)===0&&y.hasPendingWrites?(e.addEntry(p),d=d.insert(f,p)):Re(np,"Ignoring outdated watch update for ",f,". Current version:",y.version," Watch version:",p.version)})),{ks:d,qs:o}}))}function Kj(s,e){const t=at(s);return t.persistence.runTransaction("Get next mutation batch","readonly",(r=>(e===void 0&&(e=Gg),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e))))}function Yj(s,e){const t=at(s);return t.persistence.runTransaction("Allocate target","readwrite",(r=>{let o;return t.Pi.getTargetData(r,e).next((c=>c?(o=c,ue.resolve(o)):t.Pi.allocateTargetId(r).next((d=>(o=new Ir(e,d,"TargetPurposeListen",r.currentSequenceNumber),t.Pi.addTargetData(r,o).next((()=>o)))))))})).then((r=>{const o=t.Ms.get(r.targetId);return(o===null||r.snapshotVersion.compareTo(o.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(r.targetId,r),t.xs.set(e,r.targetId)),r}))}async function mg(s,e,t){const r=at(s),o=r.Ms.get(e),c=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",c,(d=>r.persistence.referenceDelegate.removeTarget(d,o)))}catch(d){if(!el(d))throw d;Re(np,`Failed to update sequence numbers for target ${e}: ${d}`)}r.Ms=r.Ms.remove(e),r.xs.delete(o.target)}function lb(s,e,t){const r=at(s);let o=tt.min(),c=mt();return r.persistence.runTransaction("Execute query","readwrite",(d=>(function(p,y,v){const k=at(p),S=k.xs.get(v);return S!==void 0?ue.resolve(k.Ms.get(S)):k.Pi.getTargetData(y,v)})(r,d,us(e)).next((f=>{if(f)return o=f.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(d,f.targetId).next((p=>{c=p}))})).next((()=>r.Fs.getDocumentsMatchingQuery(d,e,t?o:tt.min(),t?c:mt()))).next((f=>(Qj(r,MR(e),f),{documents:f,Qs:c})))))}function Qj(s,e,t){let r=s.Os.get(e)||tt.min();t.forEach(((o,c)=>{c.readTime.compareTo(r)>0&&(r=c.readTime)})),s.Os.set(e,r)}class cb{constructor(){this.activeTargetIds=UR()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Xj{constructor(){this.Mo=new cb,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,r){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new cb,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zj{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ub="ConnectivityMonitor";class db{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Re(ub,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Re(ub,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let kd=null;function fg(){return kd===null?kd=(function(){return 268435456+Math.round(2147483648*Math.random())})():kd++,"0x"+kd.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bf="RestConnection",Wj={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Jj{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${r}/databases/${o}`,this.Wo=this.databaseId.database===$d?`project_id=${r}`:`project_id=${r}&database_id=${o}`}Go(e,t,r,o,c){const d=fg(),f=this.zo(e,t.toUriEncodedString());Re(Bf,`Sending RPC '${e}' ${d}:`,f,r);const p={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(p,o,c);const{host:y}=new URL(f),v=Qo(y);return this.Jo(e,f,p,r,v).then((k=>(Re(Bf,`Received RPC '${e}' ${d}: `,k),k)),(k=>{throw kc(Bf,`RPC '${e}' ${d} failed with error: `,k,"url: ",f,"request:",r),k}))}Ho(e,t,r,o,c,d){return this.Go(e,t,r,o,c)}jo(e,t,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Wo})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((o,c)=>e[c]=o)),r&&r.headers.forEach(((o,c)=>e[c]=o))}zo(e,t){const r=Wj[e];return`${this.Uo}/v1/${t}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eC{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vn="WebChannelConnection";class tC extends Jj{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,r,o,c){const d=fg();return new Promise(((f,p)=>{const y=new Y1;y.setWithCredentials(!0),y.listenOnce(Q1.COMPLETE,(()=>{try{switch(y.getLastErrorCode()){case jd.NO_ERROR:const k=y.getResponseJson();Re(Vn,`XHR for RPC '${e}' ${d} received:`,JSON.stringify(k)),f(k);break;case jd.TIMEOUT:Re(Vn,`RPC '${e}' ${d} timed out`),p(new Te(oe.DEADLINE_EXCEEDED,"Request time out"));break;case jd.HTTP_ERROR:const S=y.getStatus();if(Re(Vn,`RPC '${e}' ${d} failed with status:`,S,"response text:",y.getResponseText()),S>0){let I=y.getResponseJson();Array.isArray(I)&&(I=I[0]);const q=I?.error;if(q&&q.status&&q.message){const L=(function(K){const U=K.toLowerCase().replace(/_/g,"-");return Object.values(oe).indexOf(U)>=0?U:oe.UNKNOWN})(q.status);p(new Te(L,q.message))}else p(new Te(oe.UNKNOWN,"Server responded with status "+y.getStatus()))}else p(new Te(oe.UNAVAILABLE,"Connection failed."));break;default:Qe(9055,{l_:e,streamId:d,h_:y.getLastErrorCode(),P_:y.getLastError()})}}finally{Re(Vn,`RPC '${e}' ${d} completed.`)}}));const v=JSON.stringify(o);Re(Vn,`RPC '${e}' ${d} sending request:`,o),y.send(t,"POST",v,r,15)}))}T_(e,t,r){const o=fg(),c=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],d=W1(),f=Z1(),p={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},y=this.longPollingOptions.timeoutSeconds;y!==void 0&&(p.longPollingTimeout=Math.round(1e3*y)),this.useFetchStreams&&(p.useFetchStreams=!0),this.jo(p.initMessageHeaders,t,r),p.encodeInitMessageHeaders=!0;const v=c.join("");Re(Vn,`Creating RPC '${e}' stream ${o}: ${v}`,p);const k=d.createWebChannel(v,p);this.I_(k);let S=!1,I=!1;const q=new eC({Yo:P=>{I?Re(Vn,`Not sending because RPC '${e}' stream ${o} is closed:`,P):(S||(Re(Vn,`Opening RPC '${e}' stream ${o} transport.`),k.open(),S=!0),Re(Vn,`RPC '${e}' stream ${o} sending:`,P),k.send(P))},Zo:()=>k.close()}),L=(P,K,U)=>{P.listen(K,(B=>{try{U(B)}catch(F){setTimeout((()=>{throw F}),0)}}))};return L(k,oc.EventType.OPEN,(()=>{I||(Re(Vn,`RPC '${e}' stream ${o} transport opened.`),q.o_())})),L(k,oc.EventType.CLOSE,(()=>{I||(I=!0,Re(Vn,`RPC '${e}' stream ${o} transport closed`),q.a_(),this.E_(k))})),L(k,oc.EventType.ERROR,(P=>{I||(I=!0,kc(Vn,`RPC '${e}' stream ${o} transport errored. Name:`,P.name,"Message:",P.message),q.a_(new Te(oe.UNAVAILABLE,"The operation could not be completed")))})),L(k,oc.EventType.MESSAGE,(P=>{if(!I){const K=P.data[0];St(!!K,16349);const U=K,B=U?.error||U[0]?.error;if(B){Re(Vn,`RPC '${e}' stream ${o} received error:`,B);const F=B.status;let ae=(function(R){const E=on[R];if(E!==void 0)return I_(E)})(F),ne=B.message;ae===void 0&&(ae=oe.INTERNAL,ne="Unknown error status: "+F+" with message "+B.message),I=!0,q.a_(new Te(ae,ne)),k.close()}else Re(Vn,`RPC '${e}' stream ${o} received:`,K),q.u_(K)}})),L(f,X1.STAT_EVENT,(P=>{P.stat===tg.PROXY?Re(Vn,`RPC '${e}' stream ${o} detected buffering proxy`):P.stat===tg.NOPROXY&&Re(Vn,`RPC '${e}' stream ${o} detected no buffering proxy`)})),setTimeout((()=>{q.__()}),0),q}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function Hf(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vh(s){return new ij(s,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K_{constructor(e,t,r=1e3,o=1.5,c=6e4){this.Mi=e,this.timerId=t,this.d_=r,this.A_=o,this.R_=c,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),o=Math.max(0,t-r);o>0&&Re("ExponentialBackoff",`Backing off for ${o} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,o,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hb="PersistentStream";class Y_{constructor(e,t,r,o,c,d,f,p){this.Mi=e,this.S_=r,this.b_=o,this.connection=c,this.authCredentialsProvider=d,this.appCheckCredentialsProvider=f,this.listener=p,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new K_(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===oe.RESOURCE_EXHAUSTED?(Zs(t.toString()),Zs("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===oe.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,o])=>{this.D_===t&&this.G_(r,o)}),(r=>{e((()=>{const o=new Te(oe.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(o)}))}))}G_(e,t){const r=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{r((()=>this.listener.Xo()))})),this.stream.t_((()=>{r((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((o=>{r((()=>this.z_(o)))})),this.stream.onMessage((o=>{r((()=>++this.F_==1?this.J_(o):this.onNext(o)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return Re(hb,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(Re(hb,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class nC extends Y_{constructor(e,t,r,o,c,d){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,o,d),this.serializer=c}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=cj(this.serializer,e),r=(function(c){if(!("targetChange"in c))return tt.min();const d=c.targetChange;return d.targetIds&&d.targetIds.length?tt.min():d.readTime?hs(d.readTime):tt.min()})(e);return this.listener.H_(t,r)}Y_(e){const t={};t.database=hg(this.serializer),t.addTarget=(function(c,d){let f;const p=d.target;if(f=ig(p)?{documents:hj(c,p)}:{query:mj(c,p).ft},f.targetId=d.targetId,d.resumeToken.approximateByteSize()>0){f.resumeToken=O_(c,d.resumeToken);const y=cg(c,d.expectedCount);y!==null&&(f.expectedCount=y)}else if(d.snapshotVersion.compareTo(tt.min())>0){f.readTime=Zd(c,d.snapshotVersion.toTimestamp());const y=cg(c,d.expectedCount);y!==null&&(f.expectedCount=y)}return f})(this.serializer,e);const r=gj(this.serializer,e);r&&(t.labels=r),this.q_(t)}Z_(e){const t={};t.database=hg(this.serializer),t.removeTarget=e,this.q_(t)}}class aC extends Y_{constructor(e,t,r,o,c,d){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,o,d),this.serializer=c}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return St(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,St(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){St(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=dj(e.writeResults,e.commitTime),r=hs(e.commitTime);return this.listener.na(r,t)}ra(){const e={};e.database=hg(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((r=>uj(this.serializer,r)))};this.q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sC{}class rC extends sC{constructor(e,t,r,o){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=o,this.ia=!1}sa(){if(this.ia)throw new Te(oe.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,r,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([c,d])=>this.connection.Go(e,ug(t,r),o,c,d))).catch((c=>{throw c.name==="FirebaseError"?(c.code===oe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),c):new Te(oe.UNKNOWN,c.toString())}))}Ho(e,t,r,o,c){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([d,f])=>this.connection.Ho(e,ug(t,r),o,d,f,c))).catch((d=>{throw d.name==="FirebaseError"?(d.code===oe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),d):new Te(oe.UNKNOWN,d.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class iC{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Zs(t),this.aa=!1):Re("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ci="RemoteStore";class oC{constructor(e,t,r,o,c){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=c,this.Aa.Oo((d=>{r.enqueueAndForget((async()=>{Vi(this)&&(Re(Ci,"Restarting streams for network reachability change."),await(async function(p){const y=at(p);y.Ea.add(4),await Kc(y),y.Ra.set("Unknown"),y.Ea.delete(4),await bh(y)})(this))}))})),this.Ra=new iC(r,o)}}async function bh(s){if(Vi(s))for(const e of s.da)await e(!0)}async function Kc(s){for(const e of s.da)await e(!1)}function Q_(s,e){const t=at(s);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),ip(t)?rp(t):tl(t).O_()&&sp(t,e))}function ap(s,e){const t=at(s),r=tl(t);t.Ia.delete(e),r.O_()&&X_(t,e),t.Ia.size===0&&(r.O_()?r.L_():Vi(t)&&t.Ra.set("Unknown"))}function sp(s,e){if(s.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(tt.min())>0){const t=s.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}tl(s).Y_(e)}function X_(s,e){s.Va.Ue(e),tl(s).Z_(e)}function rp(s){s.Va=new nj({getRemoteKeysForTarget:e=>s.remoteSyncer.getRemoteKeysForTarget(e),At:e=>s.Ia.get(e)||null,ht:()=>s.datastore.serializer.databaseId}),tl(s).start(),s.Ra.ua()}function ip(s){return Vi(s)&&!tl(s).x_()&&s.Ia.size>0}function Vi(s){return at(s).Ea.size===0}function Z_(s){s.Va=void 0}async function lC(s){s.Ra.set("Online")}async function cC(s){s.Ia.forEach(((e,t)=>{sp(s,e)}))}async function uC(s,e){Z_(s),ip(s)?(s.Ra.ha(e),rp(s)):s.Ra.set("Unknown")}async function dC(s,e,t){if(s.Ra.set("Online"),e instanceof M_&&e.state===2&&e.cause)try{await(async function(o,c){const d=c.cause;for(const f of c.targetIds)o.Ia.has(f)&&(await o.remoteSyncer.rejectListen(f,d),o.Ia.delete(f),o.Va.removeTarget(f))})(s,e)}catch(r){Re(Ci,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Jd(s,r)}else if(e instanceof Md?s.Va.Ze(e):e instanceof D_?s.Va.st(e):s.Va.tt(e),!t.isEqual(tt.min()))try{const r=await $_(s.localStore);t.compareTo(r)>=0&&await(function(c,d){const f=c.Va.Tt(d);return f.targetChanges.forEach(((p,y)=>{if(p.resumeToken.approximateByteSize()>0){const v=c.Ia.get(y);v&&c.Ia.set(y,v.withResumeToken(p.resumeToken,d))}})),f.targetMismatches.forEach(((p,y)=>{const v=c.Ia.get(p);if(!v)return;c.Ia.set(p,v.withResumeToken(Dn.EMPTY_BYTE_STRING,v.snapshotVersion)),X_(c,p);const k=new Ir(v.target,p,y,v.sequenceNumber);sp(c,k)})),c.remoteSyncer.applyRemoteEvent(f)})(s,t)}catch(r){Re(Ci,"Failed to raise snapshot:",r),await Jd(s,r)}}async function Jd(s,e,t){if(!el(e))throw e;s.Ea.add(1),await Kc(s),s.Ra.set("Offline"),t||(t=()=>$_(s.localStore)),s.asyncQueue.enqueueRetryable((async()=>{Re(Ci,"Retrying IndexedDB access"),await t(),s.Ea.delete(1),await bh(s)}))}function W_(s,e){return e().catch((t=>Jd(s,t,e)))}async function _h(s){const e=at(s),t=Gr(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Gg;for(;hC(e);)try{const o=await Kj(e.localStore,r);if(o===null){e.Ta.length===0&&t.L_();break}r=o.batchId,mC(e,o)}catch(o){await Jd(e,o)}J_(e)&&ek(e)}function hC(s){return Vi(s)&&s.Ta.length<10}function mC(s,e){s.Ta.push(e);const t=Gr(s);t.O_()&&t.X_&&t.ea(e.mutations)}function J_(s){return Vi(s)&&!Gr(s).x_()&&s.Ta.length>0}function ek(s){Gr(s).start()}async function fC(s){Gr(s).ra()}async function gC(s){const e=Gr(s);for(const t of s.Ta)e.ea(t.mutations)}async function pC(s,e,t){const r=s.Ta.shift(),o=Xg.from(r,e,t);await W_(s,(()=>s.remoteSyncer.applySuccessfulWrite(o))),await _h(s)}async function yC(s,e){e&&Gr(s).X_&&await(async function(r,o){if((function(d){return JR(d)&&d!==oe.ABORTED})(o.code)){const c=r.Ta.shift();Gr(r).B_(),await W_(r,(()=>r.remoteSyncer.rejectFailedWrite(c.batchId,o))),await _h(r)}})(s,e),J_(s)&&ek(s)}async function mb(s,e){const t=at(s);t.asyncQueue.verifyOperationInProgress(),Re(Ci,"RemoteStore received new credentials");const r=Vi(t);t.Ea.add(3),await Kc(t),r&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await bh(t)}async function xC(s,e){const t=at(s);e?(t.Ea.delete(2),await bh(t)):e||(t.Ea.add(2),await Kc(t),t.Ra.set("Unknown"))}function tl(s){return s.ma||(s.ma=(function(t,r,o){const c=at(t);return c.sa(),new nC(r,c.connection,c.authCredentials,c.appCheckCredentials,c.serializer,o)})(s.datastore,s.asyncQueue,{Xo:lC.bind(null,s),t_:cC.bind(null,s),r_:uC.bind(null,s),H_:dC.bind(null,s)}),s.da.push((async e=>{e?(s.ma.B_(),ip(s)?rp(s):s.Ra.set("Unknown")):(await s.ma.stop(),Z_(s))}))),s.ma}function Gr(s){return s.fa||(s.fa=(function(t,r,o){const c=at(t);return c.sa(),new aC(r,c.connection,c.authCredentials,c.appCheckCredentials,c.serializer,o)})(s.datastore,s.asyncQueue,{Xo:()=>Promise.resolve(),t_:fC.bind(null,s),r_:yC.bind(null,s),ta:gC.bind(null,s),na:pC.bind(null,s)}),s.da.push((async e=>{e?(s.fa.B_(),await _h(s)):(await s.fa.stop(),s.Ta.length>0&&(Re(Ci,`Stopping write stream with ${s.Ta.length} pending writes`),s.Ta=[]))}))),s.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class op{constructor(e,t,r,o,c){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=o,this.removalCallback=c,this.deferred=new Ks,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((d=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,o,c){const d=Date.now()+r,f=new op(e,t,d,o,c);return f.start(r),f}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Te(oe.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function lp(s,e){if(Zs("AsyncQueue",`${e}: ${s}`),el(s))return new Te(oe.UNAVAILABLE,`${e}: ${s}`);throw s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zo{static emptySet(e){return new zo(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||Ue.comparator(t.key,r.key):(t,r)=>Ue.comparator(t.key,r.key),this.keyedMap=lc(),this.sortedSet=new $t(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,r)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof zo)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const o=t.getNext().key,c=r.getNext().key;if(!o.isEqual(c))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new zo;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fb{constructor(){this.ga=new $t(Ue.comparator)}track(e){const t=e.doc.key,r=this.ga.get(t);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(t,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(t):e.type===1&&r.type===2?this.ga=this.ga.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Qe(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,r)=>{e.push(r)})),e}}class Fo{constructor(e,t,r,o,c,d,f,p,y){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=o,this.mutatedKeys=c,this.fromCache=d,this.syncStateChanged=f,this.excludesMetadataChanges=p,this.hasCachedResults=y}static fromInitialDocuments(e,t,r,o,c){const d=[];return t.forEach((f=>{d.push({type:0,doc:f})})),new Fo(e,t,zo.emptySet(t),d,r,o,!0,!1,c)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&fh(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let o=0;o<t.length;o++)if(t[o].type!==r[o].type||!t[o].doc.isEqual(r[o].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vC{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class bC{constructor(){this.queries=gb(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,r){const o=at(t),c=o.queries;o.queries=gb(),c.forEach(((d,f)=>{for(const p of f.Sa)p.onError(r)}))})(this,new Te(oe.ABORTED,"Firestore shutting down"))}}function gb(){return new zi((s=>v_(s)),fh)}async function tk(s,e){const t=at(s);let r=3;const o=e.query;let c=t.queries.get(o);c?!c.ba()&&e.Da()&&(r=2):(c=new vC,r=e.Da()?0:1);try{switch(r){case 0:c.wa=await t.onListen(o,!0);break;case 1:c.wa=await t.onListen(o,!1);break;case 2:await t.onFirstRemoteStoreListen(o)}}catch(d){const f=lp(d,`Initialization of query '${jo(e.query)}' failed`);return void e.onError(f)}t.queries.set(o,c),c.Sa.push(e),e.va(t.onlineState),c.wa&&e.Fa(c.wa)&&cp(t)}async function nk(s,e){const t=at(s),r=e.query;let o=3;const c=t.queries.get(r);if(c){const d=c.Sa.indexOf(e);d>=0&&(c.Sa.splice(d,1),c.Sa.length===0?o=e.Da()?0:1:!c.ba()&&e.Da()&&(o=2))}switch(o){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function _C(s,e){const t=at(s);let r=!1;for(const o of e){const c=o.query,d=t.queries.get(c);if(d){for(const f of d.Sa)f.Fa(o)&&(r=!0);d.wa=o}}r&&cp(t)}function kC(s,e,t){const r=at(s),o=r.queries.get(e);if(o)for(const c of o.Sa)c.onError(t);r.queries.delete(e)}function cp(s){s.Ca.forEach((e=>{e.next()}))}var gg,pb;(pb=gg||(gg={})).Ma="default",pb.Cache="cache";class ak{constructor(e,t,r){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const o of e.docChanges)o.type!==3&&r.push(o);e=new Fo(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const r=t!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Fo.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==gg.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sk{constructor(e){this.key=e}}class rk{constructor(e){this.key=e}}class TC{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=mt(),this.mutatedKeys=mt(),this.eu=b_(e),this.tu=new zo(this.eu)}get nu(){return this.Ya}ru(e,t){const r=t?t.iu:new fb,o=t?t.tu:this.tu;let c=t?t.mutatedKeys:this.mutatedKeys,d=o,f=!1;const p=this.query.limitType==="F"&&o.size===this.query.limit?o.last():null,y=this.query.limitType==="L"&&o.size===this.query.limit?o.first():null;if(e.inorderTraversal(((v,k)=>{const S=o.get(v),I=gh(this.query,k)?k:null,q=!!S&&this.mutatedKeys.has(S.key),L=!!I&&(I.hasLocalMutations||this.mutatedKeys.has(I.key)&&I.hasCommittedMutations);let P=!1;S&&I?S.data.isEqual(I.data)?q!==L&&(r.track({type:3,doc:I}),P=!0):this.su(S,I)||(r.track({type:2,doc:I}),P=!0,(p&&this.eu(I,p)>0||y&&this.eu(I,y)<0)&&(f=!0)):!S&&I?(r.track({type:0,doc:I}),P=!0):S&&!I&&(r.track({type:1,doc:S}),P=!0,(p||y)&&(f=!0)),P&&(I?(d=d.add(I),c=L?c.add(v):c.delete(v)):(d=d.delete(v),c=c.delete(v)))})),this.query.limit!==null)for(;d.size>this.query.limit;){const v=this.query.limitType==="F"?d.last():d.first();d=d.delete(v.key),c=c.delete(v.key),r.track({type:1,doc:v})}return{tu:d,iu:r,Cs:f,mutatedKeys:c}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,o){const c=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const d=e.iu.ya();d.sort(((v,k)=>(function(I,q){const L=P=>{switch(P){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Qe(20277,{Rt:P})}};return L(I)-L(q)})(v.type,k.type)||this.eu(v.doc,k.doc))),this.ou(r),o=o??!1;const f=t&&!o?this._u():[],p=this.Xa.size===0&&this.current&&!o?1:0,y=p!==this.Za;return this.Za=p,d.length!==0||y?{snapshot:new Fo(this.query,e.tu,c,d,e.mutatedKeys,p===0,y,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:f}:{au:f}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new fb,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=mt(),this.tu.forEach((r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))}));const t=[];return e.forEach((r=>{this.Xa.has(r)||t.push(new rk(r))})),this.Xa.forEach((r=>{e.has(r)||t.push(new sk(r))})),t}cu(e){this.Ya=e.Qs,this.Xa=mt();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Fo.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const up="SyncEngine";class wC{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class EC{constructor(e){this.key=e,this.hu=!1}}class SC{constructor(e,t,r,o,c,d){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=o,this.currentUser=c,this.maxConcurrentLimboResolutions=d,this.Pu={},this.Tu=new zi((f=>v_(f)),fh),this.Iu=new Map,this.Eu=new Set,this.du=new $t(Ue.comparator),this.Au=new Map,this.Ru=new Jg,this.Vu={},this.mu=new Map,this.fu=Go.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function AC(s,e,t=!0){const r=dk(s);let o;const c=r.Tu.get(e);return c?(r.sharedClientState.addLocalQueryTarget(c.targetId),o=c.view.lu()):o=await ik(r,e,t,!0),o}async function NC(s,e){const t=dk(s);await ik(t,e,!0,!1)}async function ik(s,e,t,r){const o=await Yj(s.localStore,us(e)),c=o.targetId,d=s.sharedClientState.addLocalQueryTarget(c,t);let f;return r&&(f=await RC(s,e,c,d==="current",o.resumeToken)),s.isPrimaryClient&&t&&Q_(s.remoteStore,o),f}async function RC(s,e,t,r,o){s.pu=(k,S,I)=>(async function(L,P,K,U){let B=P.view.ru(K);B.Cs&&(B=await lb(L.localStore,P.query,!1).then((({documents:N})=>P.view.ru(N,B))));const F=U&&U.targetChanges.get(P.targetId),ae=U&&U.targetMismatches.get(P.targetId)!=null,ne=P.view.applyChanges(B,L.isPrimaryClient,F,ae);return xb(L,P.targetId,ne.au),ne.snapshot})(s,k,S,I);const c=await lb(s.localStore,e,!0),d=new TC(e,c.Qs),f=d.ru(c.documents),p=$c.createSynthesizedTargetChangeForCurrentChange(t,r&&s.onlineState!=="Offline",o),y=d.applyChanges(f,s.isPrimaryClient,p);xb(s,t,y.au);const v=new wC(e,t,d);return s.Tu.set(e,v),s.Iu.has(t)?s.Iu.get(t).push(e):s.Iu.set(t,[e]),y.snapshot}async function jC(s,e,t){const r=at(s),o=r.Tu.get(e),c=r.Iu.get(o.targetId);if(c.length>1)return r.Iu.set(o.targetId,c.filter((d=>!fh(d,e)))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(o.targetId),r.sharedClientState.isActiveQueryTarget(o.targetId)||await mg(r.localStore,o.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(o.targetId),t&&ap(r.remoteStore,o.targetId),pg(r,o.targetId)})).catch(Jo)):(pg(r,o.targetId),await mg(r.localStore,o.targetId,!0))}async function CC(s,e){const t=at(s),r=t.Tu.get(e),o=t.Iu.get(r.targetId);t.isPrimaryClient&&o.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),ap(t.remoteStore,r.targetId))}async function IC(s,e,t){const r=VC(s);try{const o=await(function(d,f){const p=at(d),y=zt.now(),v=f.reduce(((I,q)=>I.add(q.key)),mt());let k,S;return p.persistence.runTransaction("Locally write mutations","readwrite",(I=>{let q=Ws(),L=mt();return p.Ns.getEntries(I,v).next((P=>{q=P,q.forEach(((K,U)=>{U.isValidDocument()||(L=L.add(K))}))})).next((()=>p.localDocuments.getOverlayedDocuments(I,q))).next((P=>{k=P;const K=[];for(const U of f){const B=YR(U,k.get(U.key).overlayedDocument);B!=null&&K.push(new Li(U.key,B,d_(B.value.mapValue),ds.exists(!0)))}return p.mutationQueue.addMutationBatch(I,y,K,f)})).next((P=>{S=P;const K=P.applyToLocalDocumentSet(k,L);return p.documentOverlayCache.saveOverlays(I,P.batchId,K)}))})).then((()=>({batchId:S.batchId,changes:k_(k)})))})(r.localStore,e);r.sharedClientState.addPendingMutation(o.batchId),(function(d,f,p){let y=d.Vu[d.currentUser.toKey()];y||(y=new $t(ht)),y=y.insert(f,p),d.Vu[d.currentUser.toKey()]=y})(r,o.batchId,t),await Yc(r,o.changes),await _h(r.remoteStore)}catch(o){const c=lp(o,"Failed to persist write");t.reject(c)}}async function ok(s,e){const t=at(s);try{const r=await qj(t.localStore,e);e.targetChanges.forEach(((o,c)=>{const d=t.Au.get(c);d&&(St(o.addedDocuments.size+o.modifiedDocuments.size+o.removedDocuments.size<=1,22616),o.addedDocuments.size>0?d.hu=!0:o.modifiedDocuments.size>0?St(d.hu,14607):o.removedDocuments.size>0&&(St(d.hu,42227),d.hu=!1))})),await Yc(t,r,e)}catch(r){await Jo(r)}}function yb(s,e,t){const r=at(s);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const o=[];r.Tu.forEach(((c,d)=>{const f=d.view.va(e);f.snapshot&&o.push(f.snapshot)})),(function(d,f){const p=at(d);p.onlineState=f;let y=!1;p.queries.forEach(((v,k)=>{for(const S of k.Sa)S.va(f)&&(y=!0)})),y&&cp(p)})(r.eventManager,e),o.length&&r.Pu.H_(o),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function DC(s,e,t){const r=at(s);r.sharedClientState.updateQueryState(e,"rejected",t);const o=r.Au.get(e),c=o&&o.key;if(c){let d=new $t(Ue.comparator);d=d.insert(c,Un.newNoDocument(c,tt.min()));const f=mt().add(c),p=new xh(tt.min(),new Map,new $t(ht),d,f);await ok(r,p),r.du=r.du.remove(c),r.Au.delete(e),dp(r)}else await mg(r.localStore,e,!1).then((()=>pg(r,e,t))).catch(Jo)}async function MC(s,e){const t=at(s),r=e.batch.batchId;try{const o=await Fj(t.localStore,e);ck(t,r,null),lk(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await Yc(t,o)}catch(o){await Jo(o)}}async function OC(s,e,t){const r=at(s);try{const o=await(function(d,f){const p=at(d);return p.persistence.runTransaction("Reject batch","readwrite-primary",(y=>{let v;return p.mutationQueue.lookupMutationBatch(y,f).next((k=>(St(k!==null,37113),v=k.keys(),p.mutationQueue.removeMutationBatch(y,k)))).next((()=>p.mutationQueue.performConsistencyCheck(y))).next((()=>p.documentOverlayCache.removeOverlaysForBatchId(y,v,f))).next((()=>p.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(y,v))).next((()=>p.localDocuments.getDocuments(y,v)))}))})(r.localStore,e);ck(r,e,t),lk(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await Yc(r,o)}catch(o){await Jo(o)}}function lk(s,e){(s.mu.get(e)||[]).forEach((t=>{t.resolve()})),s.mu.delete(e)}function ck(s,e,t){const r=at(s);let o=r.Vu[r.currentUser.toKey()];if(o){const c=o.get(e);c&&(t?c.reject(t):c.resolve(),o=o.remove(e)),r.Vu[r.currentUser.toKey()]=o}}function pg(s,e,t=null){s.sharedClientState.removeLocalQueryTarget(e);for(const r of s.Iu.get(e))s.Tu.delete(r),t&&s.Pu.yu(r,t);s.Iu.delete(e),s.isPrimaryClient&&s.Ru.jr(e).forEach((r=>{s.Ru.containsKey(r)||uk(s,r)}))}function uk(s,e){s.Eu.delete(e.path.canonicalString());const t=s.du.get(e);t!==null&&(ap(s.remoteStore,t),s.du=s.du.remove(e),s.Au.delete(t),dp(s))}function xb(s,e,t){for(const r of t)r instanceof sk?(s.Ru.addReference(r.key,e),PC(s,r)):r instanceof rk?(Re(up,"Document no longer in limbo: "+r.key),s.Ru.removeReference(r.key,e),s.Ru.containsKey(r.key)||uk(s,r.key)):Qe(19791,{wu:r})}function PC(s,e){const t=e.key,r=t.path.canonicalString();s.du.get(t)||s.Eu.has(r)||(Re(up,"New document in limbo: "+t),s.Eu.add(r),dp(s))}function dp(s){for(;s.Eu.size>0&&s.du.size<s.maxConcurrentLimboResolutions;){const e=s.Eu.values().next().value;s.Eu.delete(e);const t=new Ue(Vt.fromString(e)),r=s.fu.next();s.Au.set(r,new EC(t)),s.du=s.du.insert(t,r),Q_(s.remoteStore,new Ir(us(Yg(t.path)),r,"TargetPurposeLimboResolution",dh.ce))}}async function Yc(s,e,t){const r=at(s),o=[],c=[],d=[];r.Tu.isEmpty()||(r.Tu.forEach(((f,p)=>{d.push(r.pu(p,e,t).then((y=>{if((y||t)&&r.isPrimaryClient){const v=y?!y.fromCache:t?.targetChanges.get(p.targetId)?.current;r.sharedClientState.updateQueryState(p.targetId,v?"current":"not-current")}if(y){o.push(y);const v=tp.As(p.targetId,y);c.push(v)}})))})),await Promise.all(d),r.Pu.H_(o),await(async function(p,y){const v=at(p);try{await v.persistence.runTransaction("notifyLocalViewChanges","readwrite",(k=>ue.forEach(y,(S=>ue.forEach(S.Es,(I=>v.persistence.referenceDelegate.addReference(k,S.targetId,I))).next((()=>ue.forEach(S.ds,(I=>v.persistence.referenceDelegate.removeReference(k,S.targetId,I)))))))))}catch(k){if(!el(k))throw k;Re(np,"Failed to update sequence numbers: "+k)}for(const k of y){const S=k.targetId;if(!k.fromCache){const I=v.Ms.get(S),q=I.snapshotVersion,L=I.withLastLimboFreeSnapshotVersion(q);v.Ms=v.Ms.insert(S,L)}}})(r.localStore,c))}async function zC(s,e){const t=at(s);if(!t.currentUser.isEqual(e)){Re(up,"User change. New user:",e.toKey());const r=await q_(t.localStore,e);t.currentUser=e,(function(c,d){c.mu.forEach((f=>{f.forEach((p=>{p.reject(new Te(oe.CANCELLED,d))}))})),c.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Yc(t,r.Ls)}}function LC(s,e){const t=at(s),r=t.Au.get(e);if(r&&r.hu)return mt().add(r.key);{let o=mt();const c=t.Iu.get(e);if(!c)return o;for(const d of c){const f=t.Tu.get(d);o=o.unionWith(f.view.nu)}return o}}function dk(s){const e=at(s);return e.remoteStore.remoteSyncer.applyRemoteEvent=ok.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=LC.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=DC.bind(null,e),e.Pu.H_=_C.bind(null,e.eventManager),e.Pu.yu=kC.bind(null,e.eventManager),e}function VC(s){const e=at(s);return e.remoteStore.remoteSyncer.applySuccessfulWrite=MC.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=OC.bind(null,e),e}class eh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=vh(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return Gj(this.persistence,new Uj,e.initialUser,this.serializer)}Cu(e){return new F_(ep.mi,this.serializer)}Du(e){return new Xj}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}eh.provider={build:()=>new eh};class UC extends eh{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){St(this.persistence.referenceDelegate instanceof Wd,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new Ej(r,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?Wn.withCacheSize(this.cacheSizeBytes):Wn.DEFAULT;return new F_((r=>Wd.mi(r,t)),this.serializer)}}class yg{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>yb(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=zC.bind(null,this.syncEngine),await xC(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new bC})()}createDatastore(e){const t=vh(e.databaseInfo.databaseId),r=(function(c){return new tC(c)})(e.databaseInfo);return(function(c,d,f,p){return new rC(c,d,f,p)})(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return(function(r,o,c,d,f){return new oC(r,o,c,d,f)})(this.localStore,this.datastore,e.asyncQueue,(t=>yb(this.syncEngine,t,0)),(function(){return db.v()?new db:new Zj})())}createSyncEngine(e,t){return(function(o,c,d,f,p,y,v){const k=new SC(o,c,d,f,p,y);return v&&(k.gu=!0),k})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const r=at(t);Re(Ci,"RemoteStore shutting down."),r.Ea.add(5),await Kc(r),r.Aa.shutdown(),r.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}yg.provider={build:()=>new yg};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hk{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Zs("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fr="FirestoreClient";class BC{constructor(e,t,r,o,c){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=o,this.user=Zn.UNAUTHENTICATED,this.clientId=Hg.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=c,this.authCredentials.start(r,(async d=>{Re(Fr,"Received user=",d.uid),await this.authCredentialListener(d),this.user=d})),this.appCheckCredentials.start(r,(d=>(Re(Fr,"Received new app check token=",d),this.appCheckCredentialListener(d,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ks;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=lp(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}}async function Gf(s,e){s.asyncQueue.verifyOperationInProgress(),Re(Fr,"Initializing OfflineComponentProvider");const t=s.configuration;await e.initialize(t);let r=t.initialUser;s.setCredentialChangeListener((async o=>{r.isEqual(o)||(await q_(e.localStore,o),r=o)})),e.persistence.setDatabaseDeletedListener((()=>s.terminate())),s._offlineComponents=e}async function vb(s,e){s.asyncQueue.verifyOperationInProgress();const t=await HC(s);Re(Fr,"Initializing OnlineComponentProvider"),await e.initialize(t,s.configuration),s.setCredentialChangeListener((r=>mb(e.remoteStore,r))),s.setAppCheckTokenChangeListener(((r,o)=>mb(e.remoteStore,o))),s._onlineComponents=e}async function HC(s){if(!s._offlineComponents)if(s._uninitializedComponentsProvider){Re(Fr,"Using user provided OfflineComponentProvider");try{await Gf(s,s._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(o){return o.name==="FirebaseError"?o.code===oe.FAILED_PRECONDITION||o.code===oe.UNIMPLEMENTED:!(typeof DOMException<"u"&&o instanceof DOMException)||o.code===22||o.code===20||o.code===11})(t))throw t;kc("Error using user provided cache. Falling back to memory cache: "+t),await Gf(s,new eh)}}else Re(Fr,"Using default OfflineComponentProvider"),await Gf(s,new UC(void 0));return s._offlineComponents}async function mk(s){return s._onlineComponents||(s._uninitializedComponentsProvider?(Re(Fr,"Using user provided OnlineComponentProvider"),await vb(s,s._uninitializedComponentsProvider._online)):(Re(Fr,"Using default OnlineComponentProvider"),await vb(s,new yg))),s._onlineComponents}function GC(s){return mk(s).then((e=>e.syncEngine))}async function fk(s){const e=await mk(s),t=e.eventManager;return t.onListen=AC.bind(null,e.syncEngine),t.onUnlisten=jC.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=NC.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=CC.bind(null,e.syncEngine),t}function FC(s,e,t={}){const r=new Ks;return s.asyncQueue.enqueueAndForget((async()=>(function(c,d,f,p,y){const v=new hk({next:S=>{v.Nu(),d.enqueueAndForget((()=>nk(c,k)));const I=S.docs.has(f);!I&&S.fromCache?y.reject(new Te(oe.UNAVAILABLE,"Failed to get document because the client is offline.")):I&&S.fromCache&&p&&p.source==="server"?y.reject(new Te(oe.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):y.resolve(S)},error:S=>y.reject(S)}),k=new ak(Yg(f.path),v,{includeMetadataChanges:!0,qa:!0});return tk(c,k)})(await fk(s),s.asyncQueue,e,t,r))),r.promise}function qC(s,e,t={}){const r=new Ks;return s.asyncQueue.enqueueAndForget((async()=>(function(c,d,f,p,y){const v=new hk({next:S=>{v.Nu(),d.enqueueAndForget((()=>nk(c,k))),S.fromCache&&p.source==="server"?y.reject(new Te(oe.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):y.resolve(S)},error:S=>y.reject(S)}),k=new ak(f,v,{includeMetadataChanges:!0,qa:!0});return tk(c,k)})(await fk(s),s.asyncQueue,e,t,r))),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gk(s){const e={};return s.timeoutSeconds!==void 0&&(e.timeoutSeconds=s.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bb=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $C="firestore.googleapis.com",_b=!0;class kb{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Te(oe.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=$C,this.ssl=_b}else this.host=e.host,this.ssl=e.ssl??_b;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=H_;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<G_)throw new Te(oe.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}oR("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=gk(e.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new Te(oe.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new Te(oe.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new Te(oe.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,o){return r.timeoutSeconds===o.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class hp{constructor(e,t,r,o){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=o,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new kb({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Te(oe.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Te(oe.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new kb(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new W2;switch(r.type){case"firstParty":return new tR(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new Te(oe.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const r=bb.get(t);r&&(Re("ComponentProvider","Removing Datastore"),bb.delete(t),r.terminate())})(this),Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nl{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new nl(this.firestore,e,this._query)}}class un{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Lr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new un(this.firestore,e,this._key)}toJSON(){return{type:un._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(Gc(t,un._jsonSchema))return new un(e,r||null,new Ue(Vt.fromString(t.referencePath)))}}un._jsonSchemaVersion="firestore/documentReference/1.0",un._jsonSchema={type:cn("string",un._jsonSchemaVersion),referencePath:cn("string")};class Lr extends nl{constructor(e,t,r){super(e,t,Yg(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new un(this.firestore,null,new Ue(e))}withConverter(e){return new Lr(this.firestore,e,this._path)}}function mp(s,e,...t){if(s=Kn(s),e_("collection","path",e),s instanceof hp){const r=Vt.fromString(e,...t);return Ov(r),new Lr(s,null,r)}{if(!(s instanceof un||s instanceof Lr))throw new Te(oe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=s._path.child(Vt.fromString(e,...t));return Ov(r),new Lr(s.firestore,null,r)}}function fp(s,e,...t){if(s=Kn(s),arguments.length===1&&(e=Hg.newId()),e_("doc","path",e),s instanceof hp){const r=Vt.fromString(e,...t);return Mv(r),new un(s,null,new Ue(r))}{if(!(s instanceof un||s instanceof Lr))throw new Te(oe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=s._path.child(Vt.fromString(e,...t));return Mv(r),new un(s.firestore,s instanceof Lr?s.converter:null,new Ue(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tb="AsyncQueue";class wb{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new K_(this,"async_queue_retry"),this._c=()=>{const r=Hf();r&&Re(Tb,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const t=Hf();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Hf();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new Ks;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!el(e))throw e;Re(Tb,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((r=>{throw this.nc=r,this.rc=!1,Zs("INTERNAL UNHANDLED ERROR: ",Eb(r)),r})).then((r=>(this.rc=!1,r))))));return this.ac=t,t}enqueueAfterDelay(e,t,r){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const o=op.createAndSchedule(this,e,t,r,(c=>this.hc(c)));return this.tc.push(o),o}uc(){this.nc&&Qe(47125,{Pc:Eb(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,r)=>t.targetTimeMs-r.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function Eb(s){let e=s.message||"";return s.stack&&(e=s.stack.includes(s.message)?s.stack:s.message+`
`+s.stack),e}class Qc extends hp{constructor(e,t,r,o){super(e,t,r,o),this.type="firestore",this._queue=new wb,this._persistenceKey=o?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new wb(e),this._firestoreClient=void 0,await e}}}function KC(s,e,t){t||(t=$d);const r=Ig(s,"firestore");if(r.isInitialized(t)){const o=r.getImmediate({identifier:t}),c=r.getOptions(t);if(Ei(c,e))return o;throw new Te(oe.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new Te(oe.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<G_)throw new Te(oe.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return e.host&&Qo(e.host)&&i1(e.host),r.initialize({options:e,instanceIdentifier:t})}function gp(s){if(s._terminated)throw new Te(oe.FAILED_PRECONDITION,"The client has already been terminated.");return s._firestoreClient||YC(s),s._firestoreClient}function YC(s){const e=s._freezeSettings(),t=(function(o,c,d,f){return new xR(o,c,d,f.host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,gk(f.experimentalLongPollingOptions),f.useFetchStreams,f.isUsingEmulator)})(s._databaseId,s._app?.options.appId||"",s._persistenceKey,e);s._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(s._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),s._firestoreClient=new BC(s._authCredentials,s._appCheckCredentials,s._queue,t,s._componentsProvider&&(function(o){const c=o?._online.build();return{_offline:o?._offline.build(c),_online:c}})(s._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ra{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Ra(Dn.fromBase64String(e))}catch(t){throw new Te(oe.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Ra(Dn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Ra._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Gc(e,Ra._jsonSchema))return Ra.fromBase64String(e.bytes)}}Ra._jsonSchemaVersion="firestore/bytes/1.0",Ra._jsonSchema={type:cn("string",Ra._jsonSchemaVersion),bytes:cn("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pp{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Te(oe.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new In(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yp{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ms{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Te(oe.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Te(oe.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return ht(this._lat,e._lat)||ht(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:ms._jsonSchemaVersion}}static fromJSON(e){if(Gc(e,ms._jsonSchema))return new ms(e.latitude,e.longitude)}}ms._jsonSchemaVersion="firestore/geoPoint/1.0",ms._jsonSchema={type:cn("string",ms._jsonSchemaVersion),latitude:cn("number"),longitude:cn("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fs{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(r,o){if(r.length!==o.length)return!1;for(let c=0;c<r.length;++c)if(r[c]!==o[c])return!1;return!0})(this._values,e._values)}toJSON(){return{type:fs._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Gc(e,fs._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new fs(e.vectorValues);throw new Te(oe.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}fs._jsonSchemaVersion="firestore/vectorValue/1.0",fs._jsonSchema={type:cn("string",fs._jsonSchemaVersion),vectorValues:cn("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QC=/^__.*__$/;class XC{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Li(e,this.data,this.fieldMask,t,this.fieldTransforms):new qc(e,this.data,t,this.fieldTransforms)}}function pk(s){switch(s){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Qe(40011,{Ac:s})}}class xp{constructor(e,t,r,o,c,d){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=o,c===void 0&&this.Rc(),this.fieldTransforms=c||[],this.fieldMask=d||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new xp({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.gc(e),r}yc(e){const t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return th(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(pk(this.Ac)&&QC.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class ZC{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||vh(e)}Cc(e,t,r,o=!1){return new xp({Ac:e,methodName:t,Dc:r,path:In.emptyPath(),fc:!1,bc:o},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function vp(s){const e=s._freezeSettings(),t=vh(s._databaseId);return new ZC(s._databaseId,!!e.ignoreUndefinedProperties,t)}function yk(s,e,t,r,o,c={}){const d=s.Cc(c.merge||c.mergeFields?2:0,e,t,o);bk("Data must be an object, but it was:",d,r);const f=xk(r,d);let p,y;if(c.merge)p=new La(d.fieldMask),y=d.fieldTransforms;else if(c.mergeFields){const v=[];for(const k of c.mergeFields){const S=JC(e,k,t);if(!d.contains(S))throw new Te(oe.INVALID_ARGUMENT,`Field '${S}' is specified in your field mask but missing from your input data.`);tI(v,S)||v.push(S)}p=new La(v),y=d.fieldTransforms.filter((k=>p.covers(k.field)))}else p=null,y=d.fieldTransforms;return new XC(new Na(f),p,y)}class bp extends yp{_toFieldTransform(e){return new FR(e.path,new Ac)}isEqual(e){return e instanceof bp}}function WC(s,e,t,r=!1){return _p(t,s.Cc(r?4:3,e))}function _p(s,e){if(vk(s=Kn(s)))return bk("Unsupported field value:",e,s),xk(s,e);if(s instanceof yp)return(function(r,o){if(!pk(o.Ac))throw o.Sc(`${r._methodName}() can only be used with update() and set()`);if(!o.path)throw o.Sc(`${r._methodName}() is not currently supported inside arrays`);const c=r._toFieldTransform(o);c&&o.fieldTransforms.push(c)})(s,e),null;if(s===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),s instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(r,o){const c=[];let d=0;for(const f of r){let p=_p(f,o.wc(d));p==null&&(p={nullValue:"NULL_VALUE"}),c.push(p),d++}return{arrayValue:{values:c}}})(s,e)}return(function(r,o){if((r=Kn(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return BR(o.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const c=zt.fromDate(r);return{timestampValue:Zd(o.serializer,c)}}if(r instanceof zt){const c=new zt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Zd(o.serializer,c)}}if(r instanceof ms)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Ra)return{bytesValue:O_(o.serializer,r._byteString)};if(r instanceof un){const c=o.databaseId,d=r.firestore._databaseId;if(!d.isEqual(c))throw o.Sc(`Document reference is for database ${d.projectId}/${d.database} but should be for database ${c.projectId}/${c.database}`);return{referenceValue:Wg(r.firestore._databaseId||o.databaseId,r._key.path)}}if(r instanceof fs)return(function(d,f){return{mapValue:{fields:{[c_]:{stringValue:u_},[Kd]:{arrayValue:{values:d.toArray().map((y=>{if(typeof y!="number")throw f.Sc("VectorValues must only contain numeric values.");return Qg(f.serializer,y)}))}}}}}})(r,o);throw o.Sc(`Unsupported field value: ${uh(r)}`)})(s,e)}function xk(s,e){const t={};return a_(s)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Pi(s,((r,o)=>{const c=_p(o,e.mc(r));c!=null&&(t[r]=c)})),{mapValue:{fields:t}}}function vk(s){return!(typeof s!="object"||s===null||s instanceof Array||s instanceof Date||s instanceof zt||s instanceof ms||s instanceof Ra||s instanceof un||s instanceof yp||s instanceof fs)}function bk(s,e,t){if(!vk(t)||!t_(t)){const r=uh(t);throw r==="an object"?e.Sc(s+" a custom object"):e.Sc(s+" "+r)}}function JC(s,e,t){if((e=Kn(e))instanceof pp)return e._internalPath;if(typeof e=="string")return _k(s,e);throw th("Field path arguments must be of type string or ",s,!1,void 0,t)}const eI=new RegExp("[~\\*/\\[\\]]");function _k(s,e,t){if(e.search(eI)>=0)throw th(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,s,!1,void 0,t);try{return new pp(...e.split("."))._internalPath}catch{throw th(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,s,!1,void 0,t)}}function th(s,e,t,r,o){const c=r&&!r.isEmpty(),d=o!==void 0;let f=`Function ${e}() called with invalid data`;t&&(f+=" (via `toFirestore()`)"),f+=". ";let p="";return(c||d)&&(p+=" (found",c&&(p+=` in field ${r}`),d&&(p+=` in document ${o}`),p+=")"),new Te(oe.INVALID_ARGUMENT,f+s+p)}function tI(s,e){return s.some((t=>t.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kk{constructor(e,t,r,o,c){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=o,this._converter=c}get id(){return this._key.path.lastSegment()}get ref(){return new un(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new nI(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(kp("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class nI extends kk{data(){return super.data()}}function kp(s,e){return typeof e=="string"?_k(s,e):e instanceof pp?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aI(s){if(s.limitType==="L"&&s.explicitOrderBy.length===0)throw new Te(oe.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Tp{}class sI extends Tp{}function rI(s,e,...t){let r=[];e instanceof Tp&&r.push(e),r=r.concat(t),(function(c){const d=c.filter((p=>p instanceof wp)).length,f=c.filter((p=>p instanceof kh)).length;if(d>1||d>0&&f>0)throw new Te(oe.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(r);for(const o of r)s=o._apply(s);return s}class kh extends sI{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new kh(e,t,r)}_apply(e){const t=this._parse(e);return Tk(e._query,t),new nl(e.firestore,e.converter,og(e._query,t))}_parse(e){const t=vp(e.firestore);return(function(c,d,f,p,y,v,k){let S;if(y.isKeyField()){if(v==="array-contains"||v==="array-contains-any")throw new Te(oe.INVALID_ARGUMENT,`Invalid Query. You can't perform '${v}' queries on documentId().`);if(v==="in"||v==="not-in"){Ab(k,v);const q=[];for(const L of k)q.push(Sb(p,c,L));S={arrayValue:{values:q}}}else S=Sb(p,c,k)}else v!=="in"&&v!=="not-in"&&v!=="array-contains-any"||Ab(k,v),S=WC(f,d,k,v==="in"||v==="not-in");return ln.create(y,v,S)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function iI(s,e,t){const r=e,o=kp("where",s);return kh._create(o,r,t)}class wp extends Tp{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new wp(e,t)}_parse(e){const t=this._queryConstraints.map((r=>r._parse(e))).filter((r=>r.getFilters().length>0));return t.length===1?t[0]:Ba.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(o,c){let d=o;const f=c.getFlattenedFilters();for(const p of f)Tk(d,p),d=og(d,p)})(e._query,t),new nl(e.firestore,e.converter,og(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function Sb(s,e,t){if(typeof(t=Kn(t))=="string"){if(t==="")throw new Te(oe.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!x_(e)&&t.indexOf("/")!==-1)throw new Te(oe.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(Vt.fromString(t));if(!Ue.isDocumentKey(r))throw new Te(oe.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Gv(s,new Ue(r))}if(t instanceof un)return Gv(s,t._key);throw new Te(oe.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${uh(t)}.`)}function Ab(s,e){if(!Array.isArray(s)||s.length===0)throw new Te(oe.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Tk(s,e){const t=(function(o,c){for(const d of o)for(const f of d.getFlattenedFilters())if(c.indexOf(f.op)>=0)return f.op;return null})(s.filters,(function(o){switch(o){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new Te(oe.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Te(oe.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class oI{convertValue(e,t="none"){switch(Hr(e)){case 0:return null;case 1:return e.booleanValue;case 2:return nn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Br(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Qe(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return Pi(e,((o,c)=>{r[o]=this.convertValue(c,t)})),r}convertVectorValue(e){const t=e.fields?.[Kd].arrayValue?.values?.map((r=>nn(r.doubleValue)));return new fs(t)}convertGeoPoint(e){return new ms(nn(e.latitude),nn(e.longitude))}convertArray(e,t){return(e.values||[]).map((r=>this.convertValue(r,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const r=mh(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(wc(e));default:return null}}convertTimestamp(e){const t=Ur(e);return new zt(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=Vt.fromString(e);St(B_(r),9688,{name:e});const o=new Ec(r.get(1),r.get(3)),c=new Ue(r.popFirst(5));return o.isEqual(t)||Zs(`Document ${c} contains a document reference within a different database (${o.projectId}/${o.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wk(s,e,t){let r;return r=s?t&&(t.merge||t.mergeFields)?s.toFirestore(e,t):s.toFirestore(e):e,r}class uc{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class wi extends kk{constructor(e,t,r,o,c,d){super(e,t,r,o,d),this._firestore=e,this._firestoreImpl=e,this.metadata=c}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Od(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(kp("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Te(oe.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=wi._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}wi._jsonSchemaVersion="firestore/documentSnapshot/1.0",wi._jsonSchema={type:cn("string",wi._jsonSchemaVersion),bundleSource:cn("string","DocumentSnapshot"),bundleName:cn("string"),bundle:cn("string")};class Od extends wi{data(e={}){return super.data(e)}}class Lo{constructor(e,t,r,o){this._firestore=e,this._userDataWriter=t,this._snapshot=o,this.metadata=new uc(o.hasPendingWrites,o.fromCache),this.query=r}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((r=>{e.call(t,new Od(this._firestore,this._userDataWriter,r.key,r,new uc(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Te(oe.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(o,c){if(o._snapshot.oldDocs.isEmpty()){let d=0;return o._snapshot.docChanges.map((f=>{const p=new Od(o._firestore,o._userDataWriter,f.doc.key,f.doc,new uc(o._snapshot.mutatedKeys.has(f.doc.key),o._snapshot.fromCache),o.query.converter);return f.doc,{type:"added",doc:p,oldIndex:-1,newIndex:d++}}))}{let d=o._snapshot.oldDocs;return o._snapshot.docChanges.filter((f=>c||f.type!==3)).map((f=>{const p=new Od(o._firestore,o._userDataWriter,f.doc.key,f.doc,new uc(o._snapshot.mutatedKeys.has(f.doc.key),o._snapshot.fromCache),o.query.converter);let y=-1,v=-1;return f.type!==0&&(y=d.indexOf(f.doc.key),d=d.delete(f.doc.key)),f.type!==1&&(d=d.add(f.doc),v=d.indexOf(f.doc.key)),{type:lI(f.type),doc:p,oldIndex:y,newIndex:v}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Te(oe.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Lo._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Hg.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],r=[],o=[];return this.docs.forEach((c=>{c._document!==null&&(t.push(c._document),r.push(this._userDataWriter.convertObjectMap(c._document.data.value.mapValue.fields,"previous")),o.push(c.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function lI(s){switch(s){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Qe(61501,{type:s})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ek(s){s=ji(s,un);const e=ji(s.firestore,Qc);return FC(gp(e),s._key).then((t=>dI(e,s,t)))}Lo._jsonSchemaVersion="firestore/querySnapshot/1.0",Lo._jsonSchema={type:cn("string",Lo._jsonSchemaVersion),bundleSource:cn("string","QuerySnapshot"),bundleName:cn("string"),bundle:cn("string")};class Sk extends oI{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ra(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new un(this.firestore,null,t)}}function cI(s){s=ji(s,nl);const e=ji(s.firestore,Qc),t=gp(e),r=new Sk(e);return aI(s._query),qC(t,s._query).then((o=>new Lo(e,r,s,o)))}function uI(s,e,t){s=ji(s,un);const r=ji(s.firestore,Qc),o=wk(s.converter,e,t);return Nk(r,[yk(vp(r),"setDoc",s._key,o,s.converter!==null,t).toMutation(s._key,ds.none())])}function Ak(s,e){const t=ji(s.firestore,Qc),r=fp(s),o=wk(s.converter,e);return Nk(t,[yk(vp(s.firestore),"addDoc",r._key,o,s.converter!==null,{}).toMutation(r._key,ds.exists(!1))]).then((()=>r))}function Nk(s,e){return(function(r,o){const c=new Ks;return r.asyncQueue.enqueueAndForget((async()=>IC(await GC(r),o,c))),c.promise})(gp(s),e)}function dI(s,e,t){const r=t.docs.get(e._key),o=new Sk(s);return new wi(s,o,e._key,r,new uc(t.hasPendingWrites,t.fromCache),e.converter)}function hI(){return new bp("serverTimestamp")}(function(e,t=!0){(function(o){Wo=o})(Xo),Vo(new Si("firestore",((r,{instanceIdentifier:o,options:c})=>{const d=r.getProvider("app").getImmediate(),f=new Qc(new J2(r.getProvider("auth-internal")),new nR(d,r.getProvider("app-check-internal")),(function(y,v){if(!Object.prototype.hasOwnProperty.apply(y.options,["projectId"]))throw new Te(oe.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ec(y.options.projectId,v)})(d,o),d);return c={useFetchStreams:t,...c},f._setSettings(c),f}),"PUBLIC").setMultipleInstances(!0)),Pr(jv,Cv,e),Pr(jv,Cv,"esm2020")})();const mI={apiKey:"AIzaSyBj5D2l-lSzekgRUF6w164G5xawAbqKV58",authDomain:"neurolearn-c8df8.firebaseapp.com",projectId:"neurolearn-c8df8",storageBucket:"neurolearn-c8df8.firebasestorage.app",messagingSenderId:"1060414258301",appId:"1:1060414258301:web:86a11e8b84e7d05de10514",measurementId:"G-ZBX8RCHB1X"},Rk=TA().length?u1():c1(mI),Td=K2(Rk),fI={experimentalForceLongPolling:!0,experimentalLongPollingOptions:{timeoutSeconds:10}},Xc=globalThis.__FIREBASE_DB__??(globalThis.__FIREBASE_DB__=KC(Rk,fI)),gI=async(s,e)=>{if(!s)throw new Error("UID boş geldi");const t=fp(Xc,"users",s);return await uI(t,{uid:s,...e,createdAt:hI()},{merge:!0}),(await Ek(t)).data()},pI=async s=>{const e=fp(Xc,"users",s),t=await Ek(e);return t.exists()?{id:t.id,...t.data(),createdAt:t.data().createdAt.toDate()}:null},yI=async s=>(await Ak(mp(Xc,"activities"),{...s,createdAt:zt.now()})).id,xI=async s=>{try{const e=await Ak(mp(Xc,"story_attention_games"),{...s,createdAt:zt.now()});return await yI({studentId:s.studentId,type:"story-attention",score:s.score,duration:s.duration,metadata:{theme:s.storyTheme,attentionScores:{selective:s.attentionData.selectiveAttention,sustained:s.attentionData.sustainedAttention,divided:s.attentionData.dividedAttention,impulseControl:s.attentionData.impulseControl},performance:{accuracy:s.attentionData.accuracy,avgReactionTime:s.attentionData.avgReactionTime,distractorClicks:s.attentionData.distractorClicks}}}),console.log("Story attention game data saved successfully:",e.id),e.id}catch(e){throw console.error("Error saving story attention game data:",e),e}},jk=T.createContext(void 0),aa=()=>{const s=T.useContext(jk);if(s===void 0)throw new Error("useAuth must be used within an AuthProvider");return s},vI=({children:s})=>{const[e,t]=T.useState(null),[r,o]=T.useState(!0);T.useEffect(()=>ON(Td,async v=>{if(v){const k=await pI(v.uid);t(k||{id:v.uid,name:v.displayName||"",email:v.email||"",role:"parent",createdAt:new Date})}else t(null);o(!1)}),[]);const p={currentUser:e,loading:r,login:async(y,v)=>{await IN(Td,y,v)},register:async(y,v,k,S="parent",I,q)=>{const L=await CN(Td,y,v),P=L.user?.uid;if(!P)throw new Error("Kullanıcı UID alınamadı");const K={email:L.user.email??y,name:k,role:S,...I&&{age:I},...q&&{parentId:q}};await gI(P,K),t({id:P,name:k,email:y,role:S,...I&&{age:I},...q&&{parentId:q},createdAt:new Date})},logout:async()=>{await PN(Td),t(null)}};return l.jsx(jk.Provider,{value:p,children:s})};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bI=s=>s.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),_I=s=>s.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase()),Nb=s=>{const e=_I(s);return e.charAt(0).toUpperCase()+e.slice(1)},Ck=(...s)=>s.filter((e,t,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===t).join(" ").trim(),kI=s=>{for(const e in s)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var TI={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wI=T.forwardRef(({color:s="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:r,className:o="",children:c,iconNode:d,...f},p)=>T.createElement("svg",{ref:p,...TI,width:e,height:e,stroke:s,strokeWidth:r?Number(t)*24/Number(e):t,className:Ck("lucide",o),...!c&&!kI(f)&&{"aria-hidden":"true"},...f},[...d.map(([y,v])=>T.createElement(y,v)),...Array.isArray(c)?c:[c]]));/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Be=(s,e)=>{const t=T.forwardRef(({className:r,...o},c)=>T.createElement(wI,{ref:c,iconNode:e,className:Ck(`lucide-${bI(Nb(s))}`,`lucide-${s}`,r),...o}));return t.displayName=Nb(s),t};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EI=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],Rb=Be("activity",EI);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SI=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],Th=Be("arrow-left",SI);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AI=[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]],nh=Be("award",AI);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NI=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],xg=Be("bell",NI);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RI=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],jI=Be("book-open",RI);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CI=[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]],Pd=Be("bot",CI);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const II=[["path",{d:"M12 18V5",key:"adv99a"}],["path",{d:"M15 13a4.17 4.17 0 0 1-3-4 4.17 4.17 0 0 1-3 4",key:"1e3is1"}],["path",{d:"M17.598 6.5A3 3 0 1 0 12 5a3 3 0 1 0-5.598 1.5",key:"1gqd8o"}],["path",{d:"M17.997 5.125a4 4 0 0 1 2.526 5.77",key:"iwvgf7"}],["path",{d:"M18 18a4 4 0 0 0 2-7.464",key:"efp6ie"}],["path",{d:"M19.967 17.483A4 4 0 1 1 12 18a4 4 0 1 1-7.967-.517",key:"1gq6am"}],["path",{d:"M6 18a4 4 0 0 1-2-7.464",key:"k1g0md"}],["path",{d:"M6.003 5.125a4 4 0 0 0-2.526 5.77",key:"q97ue3"}]],Jn=Be("brain",II);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DI=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],qr=Be("calendar",DI);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MI=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],os=Be("camera",MI);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OI=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],jc=Be("chart-column",OI);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PI=[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]],zI=Be("chart-pie",PI);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LI=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],VI=Be("chevron-down",LI);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UI=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],BI=Be("chevron-right",UI);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HI=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],GI=Be("chevron-up",HI);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FI=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],wh=Be("circle-alert",FI);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qI=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Ik=Be("circle-check-big",qI);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $I=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],ja=Be("clock",$I);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KI=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Cc=Be("eye",KI);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YI=[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]],QI=Be("hash",YI);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XI=[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]],Dk=Be("heart",XI);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZI=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],WI=Be("house",ZI);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JI=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],jb=Be("info",JI);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eD=[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]],Cb=Be("lightbulb",eD);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tD=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Ib=Be("loader-circle",tD);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nD=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],qo=Be("lock",nD);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aD=[["path",{d:"m10 17 5-5-5-5",key:"1bsop3"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}]],Mk=Be("log-in",aD);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sD=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],Ep=Be("log-out",sD);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rD=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],Eh=Be("mail",rD);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iD=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"m21 3-7 7",key:"1l2asr"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M9 21H3v-6",key:"wtvkvv"}]],oD=Be("maximize-2",iD);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lD=[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]],Ok=Be("message-circle",lD);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cD=[["path",{d:"m14 10 7-7",key:"oa77jy"}],["path",{d:"M20 10h-6V4",key:"mjg0md"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M4 14h6v6",key:"rmj7iw"}]],uD=Be("minimize-2",cD);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dD=[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]],Sp=Be("palette",dD);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hD=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],Db=Be("pause",hD);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mD=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],Pk=Be("play",mD);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fD=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],zk=Be("plus",fD);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gD=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],Sh=Be("rotate-ccw",gD);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pD=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],Lk=Be("send",pD);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yD=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],xD=Be("settings",yD);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vD=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],bD=Be("shield",vD);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _D=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]],kD=Be("smile",_D);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TD=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],Ap=Be("sparkles",TD);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wD=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],Ic=Be("star",wD);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ED=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],Bn=Be("target",ED);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SD=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],Ii=Be("trending-up",SD);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AD=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Mb=Be("triangle-alert",AD);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ND=[["path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978",key:"1n3hpd"}],["path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978",key:"rfe1zi"}],["path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18",key:"7xy6bh"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z",key:"1mhfuq"}],["path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6",key:"tex48p"}]],zd=Be("trophy",ND);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RD=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],Vk=Be("user-plus",RD);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jD=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],Di=Be("user",jD);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CD=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],Uk=Be("users",CD);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ID=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],DD=Be("wifi-off",ID);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MD=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]],Ob=Be("wifi",MD);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OD=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],ah=Be("x",OD);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PD=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],Mi=Be("zap",PD),zD=({onToggleMode:s})=>{const[e,t]=T.useState(""),[r,o]=T.useState(""),[c,d]=T.useState(""),[f,p]=T.useState(!1),{login:y}=aa(),v=async k=>{k.preventDefault(),d(""),p(!0);try{await y(e,r)}catch(S){d(S.message||"Giriş yaparken bir hata oluştu")}p(!1)};return l.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-lg w-full max-w-md",children:[l.jsxs("div",{className:"text-center mb-8",children:[l.jsx("div",{className:"mx-auto w-16 h-16 bg-primary rounded-full flex items-center justify-center mb-4",children:l.jsx(Mk,{className:"h-8 w-8 text-white"})}),l.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Veli Girişi"}),l.jsx("p",{className:"text-gray-600 mt-2",children:"PeakFocus AI Platformuna hoş geldiniz"})]}),c&&l.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6 flex items-center",children:[l.jsx(wh,{className:"h-5 w-5 text-red-500 mr-2"}),l.jsx("span",{className:"text-red-700 text-sm",children:c})]}),l.jsxs("form",{onSubmit:v,className:"space-y-6",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"E-posta Adresi"}),l.jsxs("div",{className:"relative",children:[l.jsx(Eh,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),l.jsx("input",{type:"email",value:e,onChange:k=>t(k.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"ogretmen@email.com",required:!0})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Şifre"}),l.jsxs("div",{className:"relative",children:[l.jsx(qo,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),l.jsx("input",{type:"password",value:r,onChange:k=>o(k.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"••••••••",required:!0})]})]}),l.jsx("button",{type:"submit",disabled:f,className:"w-full bg-primary text-white py-3 rounded-lg font-medium hover:bg-blue-700 focus:ring-2 focus:ring-primary focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:f?"Giriş yapılıyor...":"Giriş Yap"})]}),l.jsx("div",{className:"mt-6 text-center",children:l.jsxs("p",{className:"text-gray-600",children:["Hesabınız yok mu?"," ",l.jsx("button",{onClick:s,className:"text-primary font-medium hover:text-blue-700",children:"Kayıt olun"})]})})]})},LD=({onToggleMode:s})=>{const[e,t]=T.useState(""),[r,o]=T.useState(""),[c,d]=T.useState(""),[f,p]=T.useState(""),[y,v]=T.useState(""),[k,S]=T.useState(!1),{register:I}=aa(),q=async L=>{if(L.preventDefault(),v(""),c!==f){v("Şifreler eşleşmiyor");return}if(c.length<6){v("Şifre en az 6 karakter olmalıdır");return}S(!0);try{await I(r,c,e)}catch(P){v(P.message||"Kayıt olurken bir hata oluştu")}S(!1)};return l.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-lg w-full max-w-md",children:[l.jsxs("div",{className:"text-center mb-8",children:[l.jsx("div",{className:"mx-auto w-16 h-16 bg-secondary rounded-full flex items-center justify-center mb-4",children:l.jsx(Vk,{className:"h-8 w-8 text-white"})}),l.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Veli Kaydı"}),l.jsx("p",{className:"text-gray-600 mt-2",children:"Yeni hesap oluşturun"})]}),y&&l.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6 flex items-center",children:[l.jsx(wh,{className:"h-5 w-5 text-red-500 mr-2"}),l.jsx("span",{className:"text-red-700 text-sm",children:y})]}),l.jsxs("form",{onSubmit:q,className:"space-y-6",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Ad Soyad"}),l.jsxs("div",{className:"relative",children:[l.jsx(Di,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),l.jsx("input",{type:"text",value:e,onChange:L=>t(L.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-secondary focus:border-transparent",placeholder:"Ahmet Yılmaz",required:!0})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"E-posta Adresi"}),l.jsxs("div",{className:"relative",children:[l.jsx(Eh,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),l.jsx("input",{type:"email",value:r,onChange:L=>o(L.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-secondary focus:border-transparent",placeholder:"veli@email.com",required:!0})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Şifre"}),l.jsxs("div",{className:"relative",children:[l.jsx(qo,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),l.jsx("input",{type:"password",value:c,onChange:L=>d(L.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-secondary focus:border-transparent",placeholder:"••••••••",required:!0})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Şifre Tekrar"}),l.jsxs("div",{className:"relative",children:[l.jsx(qo,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),l.jsx("input",{type:"password",value:f,onChange:L=>p(L.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-secondary focus:border-transparent",placeholder:"••••••••",required:!0})]})]}),l.jsx("button",{type:"submit",disabled:k,className:"w-full bg-secondary text-white py-3 rounded-lg font-medium hover:bg-purple-700 focus:ring-2 focus:ring-secondary focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:k?"Kayıt oluşturuluyor...":"Kayıt Ol"})]}),l.jsx("div",{className:"mt-6 text-center",children:l.jsxs("p",{className:"text-gray-600",children:["Zaten hesabınız var mı?"," ",l.jsx("button",{onClick:s,className:"text-secondary font-medium hover:text-purple-700",children:"Giriş yapın"})]})})]})},VD=({onToggleMode:s,onToggleRole:e})=>{const[t,r]=T.useState(""),[o,c]=T.useState(""),[d,f]=T.useState(""),[p,y]=T.useState(!1),{login:v}=aa(),k=async S=>{S.preventDefault(),f(""),y(!0);try{await v(t,o)}catch(I){f(I.message||"Giriş yapılırken bir hata oluştu")}y(!1)};return l.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-lg w-full max-w-md",children:[l.jsxs("div",{className:"text-center mb-8",children:[l.jsx("div",{className:"mx-auto w-16 h-16 bg-primary rounded-full flex items-center justify-center mb-4",children:l.jsx(Mk,{className:"h-8 w-8 text-white"})}),l.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Öğrenci Girişi"}),l.jsx("p",{className:"text-gray-600 mt-2",children:"Hesabınıza giriş yapın"})]}),d&&l.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6 flex items-center",children:[l.jsx(wh,{className:"h-5 w-5 text-red-500 mr-2"}),l.jsx("span",{className:"text-red-700 text-sm",children:d})]}),l.jsxs("form",{onSubmit:k,className:"space-y-6",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"E-posta Adresi"}),l.jsxs("div",{className:"relative",children:[l.jsx(Eh,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),l.jsx("input",{type:"email",value:t,onChange:S=>r(S.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"ogrenci@email.com",required:!0})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Şifre"}),l.jsxs("div",{className:"relative",children:[l.jsx(qo,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),l.jsx("input",{type:"password",value:o,onChange:S=>c(S.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"••••••••",required:!0})]})]}),l.jsx("button",{type:"submit",disabled:p,className:"w-full bg-primary text-white py-3 rounded-lg font-medium hover:bg-blue-700 focus:ring-2 focus:ring-primary focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:p?"Giriş yapılıyor...":"Giriş Yap"})]}),l.jsxs("div",{className:"mt-6 text-center space-y-2",children:[l.jsxs("p",{className:"text-gray-600",children:["Henüz hesabınız yok mu?"," ",l.jsx("button",{onClick:s,className:"text-primary font-medium hover:text-blue-700",children:"Kayıt olun"})]}),l.jsxs("p",{className:"text-gray-600",children:["Veli misiniz?"," ",l.jsx("button",{onClick:e,className:"text-secondary font-medium hover:text-purple-700",children:"Veli girişi"})]})]})]})},UD=({onToggleMode:s,onToggleRole:e})=>{const[t,r]=T.useState(""),[o,c]=T.useState(""),[d,f]=T.useState(""),[p,y]=T.useState(""),[v,k]=T.useState(""),[S,I]=T.useState(""),[q,L]=T.useState([]),[P,K]=T.useState(""),[U,B]=T.useState(!1),{register:F}=aa();T.useEffect(()=>{(async()=>{try{const N=rI(mp(Xc,"users"),iI("role","==","parent")),R=await cI(N),E=[];R.forEach(C=>{const M=C.data();E.push({id:C.id,name:M.name,email:M.email})}),L(E)}catch(N){console.error("Veliler yüklenirken hata:",N)}})()},[]);const ae=async ne=>{if(ne.preventDefault(),K(""),d!==p){K("Şifreler eşleşmiyor");return}if(d.length<6){K("Şifre en az 6 karakter olmalıdır");return}if(!S){K("Lütfen bir veli seçin");return}const N=parseInt(v);if(isNaN(N)||N<3||N>18){K("Yaş 3-18 arasında olmalıdır");return}B(!0);try{await F(o,d,t,"student",N,S)}catch(R){K(R.message||"Kayıt olurken bir hata oluştu")}B(!1)};return l.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-lg w-full max-w-md",children:[l.jsxs("div",{className:"text-center mb-8",children:[l.jsx("div",{className:"mx-auto w-16 h-16 bg-primary rounded-full flex items-center justify-center mb-4",children:l.jsx(Vk,{className:"h-8 w-8 text-white"})}),l.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Öğrenci Kaydı"}),l.jsx("p",{className:"text-gray-600 mt-2",children:"Yeni öğrenci hesabı oluşturun"})]}),P&&l.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6 flex items-center",children:[l.jsx(wh,{className:"h-5 w-5 text-red-500 mr-2"}),l.jsx("span",{className:"text-red-700 text-sm",children:P})]}),l.jsxs("form",{onSubmit:ae,className:"space-y-6",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Ad Soyad"}),l.jsxs("div",{className:"relative",children:[l.jsx(Di,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),l.jsx("input",{type:"text",value:t,onChange:ne=>r(ne.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Öğrenci Adı",required:!0})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Yaş"}),l.jsxs("div",{className:"relative",children:[l.jsx(qr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),l.jsx("input",{type:"number",min:"3",max:"18",value:v,onChange:ne=>k(ne.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Yaş",required:!0})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Öğretmen Seçin"}),l.jsxs("div",{className:"relative",children:[l.jsx(Uk,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),l.jsxs("select",{value:S,onChange:ne=>I(ne.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent appearance-none bg-white",required:!0,children:[l.jsx("option",{value:"",children:"Veli seçin..."}),q.map(ne=>l.jsxs("option",{value:ne.id,children:[ne.name," (",ne.email,")"]},ne.id))]})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"E-posta Adresi"}),l.jsxs("div",{className:"relative",children:[l.jsx(Eh,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),l.jsx("input",{type:"email",value:o,onChange:ne=>c(ne.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"ogrenci@email.com",required:!0})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Şifre"}),l.jsxs("div",{className:"relative",children:[l.jsx(qo,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),l.jsx("input",{type:"password",value:d,onChange:ne=>f(ne.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"••••••••",required:!0})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Şifre Tekrar"}),l.jsxs("div",{className:"relative",children:[l.jsx(qo,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),l.jsx("input",{type:"password",value:p,onChange:ne=>y(ne.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"••••••••",required:!0})]})]}),l.jsx("button",{type:"submit",disabled:U,className:"w-full bg-primary text-white py-3 rounded-lg font-medium hover:bg-blue-700 focus:ring-2 focus:ring-primary focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:U?"Kayıt oluşturuluyor...":"Öğrenci Kaydı Oluştur"})]}),l.jsxs("div",{className:"mt-6 text-center space-y-2",children:[l.jsxs("p",{className:"text-gray-600",children:["Zaten hesabınız var mı?"," ",l.jsx("button",{onClick:s,className:"text-primary font-medium hover:text-blue-700",children:"Giriş yapın"})]}),l.jsxs("p",{className:"text-gray-600",children:["Veli misiniz?"," ",l.jsx("button",{onClick:e,className:"text-secondary font-medium hover:text-purple-700",children:"Öğretmen kaydı"})]})]})]})},BD=()=>{const[s,e]=T.useState(!0),[t,r]=T.useState("parent");return l.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50 flex items-center justify-center p-4",children:l.jsxs("div",{className:"w-full max-w-6xl mx-auto flex items-center justify-center gap-12",children:[l.jsxs("div",{className:"hidden lg:block flex-1 max-w-lg",children:[l.jsxs("div",{className:"text-center mb-8",children:[l.jsx("div",{className:"inline-flex items-center justify-center w-24 h-24 bg-gradient-to-r from-primary to-secondary rounded-full mb-6",children:l.jsx(Jn,{className:"h-12 w-12 text-white"})}),l.jsx("h1",{className:"text-4xl font-bold text-gray-800 mb-4",children:"PeakFocus AI"}),l.jsx("p",{className:"text-xl text-gray-600 mb-8",children:"ADHD'li çocuklar için yapay zeka destekli eğitim platformu"})]}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"bg-white/70 backdrop-blur-sm rounded-lg p-6 border border-white/20",children:[l.jsxs("div",{className:"flex items-center mb-3",children:[l.jsx(Ap,{className:"h-6 w-6 text-primary mr-3"}),l.jsx("h3",{className:"font-semibold text-gray-800",children:"AI Destekli İçerik"})]}),l.jsx("p",{className:"text-gray-600",children:"Yapay zeka ile çocuğa özel sorular ve aktiviteler üretilir"})]}),l.jsxs("div",{className:"bg-white/70 backdrop-blur-sm rounded-lg p-6 border border-white/20",children:[l.jsxs("div",{className:"flex items-center mb-3",children:[l.jsx("div",{className:"w-6 h-6 bg-success rounded-full mr-3"}),l.jsx("h3",{className:"font-semibold text-gray-800",children:"Duygu Analizi"})]}),l.jsx("p",{className:"text-gray-600",children:"Gerçek zamanlı duygu tanıma ile çocuğun durumu takip edilir"})]}),l.jsxs("div",{className:"bg-white/70 backdrop-blur-sm rounded-lg p-6 border border-white/20",children:[l.jsxs("div",{className:"flex items-center mb-3",children:[l.jsx("div",{className:"w-6 h-6 bg-warning rounded-full mr-3"}),l.jsx("h3",{className:"font-semibold text-gray-800",children:"Akıllı Raporlama"})]}),l.jsx("p",{className:"text-gray-600",children:"Detaylı analitik ve çocuk gelişim raporları"})]})]})]}),l.jsxs("div",{className:"flex-1 max-w-md",children:[l.jsxs("div",{className:"bg-white p-1 rounded-lg shadow-sm mb-6 flex",children:[l.jsx("button",{onClick:()=>r("parent"),className:`flex-1 py-2 px-4 rounded-md text-sm font-medium transition-colors ${t==="parent"?"bg-secondary text-white":"text-gray-600 hover:text-gray-800"}`,children:"Veli"}),l.jsx("button",{onClick:()=>r("student"),className:`flex-1 py-2 px-4 rounded-md text-sm font-medium transition-colors ${t==="student"?"bg-primary text-white":"text-gray-600 hover:text-gray-800"}`,children:"Öğrenci"})]}),t==="parent"?s?l.jsx(zD,{onToggleMode:()=>e(!1)}):l.jsx(LD,{onToggleMode:()=>e(!0)}):s?l.jsx(VD,{onToggleMode:()=>e(!1),onToggleRole:()=>r("parent")}):l.jsx(UD,{onToggleMode:()=>e(!0),onToggleRole:()=>r("parent")})]})]})})};function Bk(s){var e,t,r="";if(typeof s=="string"||typeof s=="number")r+=s;else if(typeof s=="object")if(Array.isArray(s)){var o=s.length;for(e=0;e<o;e++)s[e]&&(t=Bk(s[e]))&&(r&&(r+=" "),r+=t)}else for(t in s)s[t]&&(r&&(r+=" "),r+=t);return r}function HD(){for(var s,e,t=0,r="",o=arguments.length;t<o;t++)(s=arguments[t])&&(e=Bk(s))&&(r&&(r+=" "),r+=e);return r}function Zc(...s){return HD(s)}const ea=({variant:s="primary",size:e="md",loading:t=!1,className:r,disabled:o,children:c,...d})=>{const f="inline-flex items-center justify-center font-medium rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",p={primary:"bg-primary text-white hover:bg-blue-700 focus:ring-primary",secondary:"bg-secondary text-white hover:bg-purple-700 focus:ring-secondary",danger:"bg-danger text-white hover:bg-red-700 focus:ring-danger",outline:"border border-gray-300 text-gray-700 hover:bg-gray-50 focus:ring-primary",ghost:"text-gray-700 hover:bg-gray-100 focus:ring-primary"},y={sm:"px-3 py-2 text-sm",md:"px-4 py-2 text-sm",lg:"px-6 py-3 text-base"};return l.jsxs("button",{className:Zc(f,p[s],y[e],r),disabled:o||t,...d,children:[t&&l.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[l.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),l.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),c]})},Wc=({aiStatus:s="connected"})=>{const{currentUser:e,logout:t}=aa(),r=()=>{switch(s){case"connected":return l.jsx(Ob,{className:"h-4 w-4 text-success"});case"disconnected":return l.jsx(DD,{className:"h-4 w-4 text-danger"});case"processing":return l.jsx("div",{className:"h-4 w-4 border-2 border-warning border-t-transparent rounded-full animate-spin"});default:return l.jsx(Ob,{className:"h-4 w-4 text-success"})}},o=()=>{switch(s){case"connected":return"AI Bağlı";case"disconnected":return"AI Bağlantısı Yok";case"processing":return"AI İşlemde";default:return"AI Bağlı"}};return l.jsx("header",{className:"bg-white border-b border-gray-200 px-6 py-4",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("div",{className:"flex items-center space-x-4",children:l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-primary to-secondary rounded-full flex items-center justify-center",children:l.jsx(Jn,{className:"h-6 w-6 text-white"})}),l.jsxs("div",{children:[l.jsx("h1",{className:"text-xl font-bold text-gray-800",children:"PeakFocus AI"}),l.jsx("p",{className:"text-sm text-gray-600",children:"Veli Paneli"})]})]})}),l.jsxs("div",{className:"flex items-center space-x-6",children:[l.jsxs("div",{className:"flex items-center space-x-2 px-3 py-2 bg-gray-50 rounded-lg",children:[r(),l.jsx("span",{className:"text-sm font-medium text-gray-700",children:o()})]}),l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsxs("div",{className:"text-right",children:[l.jsx("p",{className:"text-sm font-medium text-gray-800",children:e?.name||"Veli"}),l.jsx("p",{className:"text-xs text-gray-600",children:e?.email})]}),l.jsx("div",{className:"w-10 h-10 bg-primary rounded-full flex items-center justify-center",children:l.jsx("span",{className:"text-white font-medium text-sm",children:e?.name?.charAt(0)||"V"})}),l.jsxs(ea,{variant:"outline",size:"sm",onClick:t,className:"border-gray-300 text-gray-700 hover:bg-red-50 hover:text-red-700 hover:border-red-300",children:[l.jsx(Ep,{className:"h-4 w-4 mr-2"}),"Çıkış"]})]})]})]})})},Dc=[{id:"mustafa-child-1",name:"Ahmet Deneme",age:8,parentId:"XYrGBIVm5mXsL8TbDxO9i3pXlWy1",notes:"Sayı oyunlarında çok başarılı, dikkat süresi gün geçtikçe artıyor.",createdAt:new Date("2024-01-15")},{id:"mustafa-child-2",name:"Ayşe Deneme",age:6,parentId:"XYrGBIVm5mXsL8TbDxO9i3pXlWy1",notes:"Renk eşleştirme oyunlarında yetenekli, hikaye dinlemeyi seviyor.",createdAt:new Date("2024-02-10")},{id:"1",name:"Elif Yılmaz",age:8,parentId:"parent1",notes:"Matematik konularında çok başarılı, hikaye okumayı seviyor.",createdAt:new Date("2024-01-15")},{id:"2",name:"Mehmet Kaya",age:7,parentId:"parent1",notes:"Renklerle ilgili oyunlarda yetenekli, dikkat süresi artıyor.",createdAt:new Date("2024-02-10")},{id:"3",name:"Zeynep Demir",age:9,parentId:"parent2",notes:"Sosyal beceriler gelişiyor, grup oyunlarına katılım artıyor.",createdAt:new Date("2024-01-20")}],al=[{id:"mustafa-act1",studentId:"mustafa-child-1",gameType:"count",score:88,duration:420,emotions:[{emotion:"focused",confidence:.91,timestamp:new Date("2024-03-15T10:30:00")},{emotion:"happy",confidence:.85,timestamp:new Date("2024-03-15T10:35:00")}],createdAt:new Date("2024-03-15")},{id:"mustafa-act2",studentId:"mustafa-child-1",gameType:"dynamic",score:92,duration:380,emotions:[{emotion:"focused",confidence:.96,timestamp:new Date("2024-03-14T14:20:00")}],createdAt:new Date("2024-03-14")},{id:"mustafa-act3",studentId:"mustafa-child-2",gameType:"conflict",score:76,duration:450,emotions:[{emotion:"happy",confidence:.89,timestamp:new Date("2024-03-13T09:15:00")},{emotion:"focused",confidence:.84,timestamp:new Date("2024-03-13T09:20:00")}],createdAt:new Date("2024-03-13")},{id:"mustafa-act4",studentId:"mustafa-child-2",gameType:"click",score:82,duration:390,emotions:[{emotion:"happy",confidence:.93,timestamp:new Date("2024-03-12T11:00:00")}],createdAt:new Date("2024-03-12")},{id:"act1",studentId:"1",gameType:"click",score:85,duration:450,emotions:[{emotion:"happy",confidence:.92,timestamp:new Date("2024-03-15T10:30:00")},{emotion:"focused",confidence:.88,timestamp:new Date("2024-03-15T10:35:00")}],createdAt:new Date("2024-03-15")},{id:"act2",studentId:"1",gameType:"count",score:92,duration:380,emotions:[{emotion:"focused",confidence:.95,timestamp:new Date("2024-03-14T14:20:00")},{emotion:"happy",confidence:.87,timestamp:new Date("2024-03-14T14:25:00")}],createdAt:new Date("2024-03-14")},{id:"act3",studentId:"2",gameType:"conflict",score:78,duration:520,emotions:[{emotion:"confused",confidence:.75,timestamp:new Date("2024-03-13T09:15:00")},{emotion:"neutral",confidence:.82,timestamp:new Date("2024-03-13T09:20:00")}],createdAt:new Date("2024-03-13")},{id:"act4",studentId:"2",gameType:"dynamic",score:88,duration:420,emotions:[{emotion:"focused",confidence:.91,timestamp:new Date("2024-03-12T11:00:00")}],createdAt:new Date("2024-03-12")},{id:"act5",studentId:"3",gameType:"click",score:94,duration:350,emotions:[{emotion:"happy",confidence:.96,timestamp:new Date("2024-03-11T15:30:00")},{emotion:"focused",confidence:.89,timestamp:new Date("2024-03-11T15:35:00")}],createdAt:new Date("2024-03-11")}],GD=[{id:"mustafa-insight1",studentId:"mustafa-child-1",type:"progress",message:"Ahmet'in sayı oyunlarındaki performansı son 2 haftada %18 arttı. Matematiksel düşünme becerileri gelişiyor.",priority:"medium",createdAt:new Date("2024-03-15")},{id:"mustafa-insight2",studentId:"mustafa-child-1",type:"recommendation",message:"Ahmet dikkat sprint oyunlarında mükemmel performans gösteriyor. Daha zorlu dikkat görevleri eklenebilir.",priority:"low",createdAt:new Date("2024-03-14")},{id:"mustafa-insight3",studentId:"mustafa-child-2",type:"attention",message:"Ayşe'nin renk algısı çok gelişmiş. Kelime-resim eşleştirmede de başarılı sonuçlar alıyor.",priority:"medium",createdAt:new Date("2024-03-13")},{id:"mustafa-insight4",studentId:"mustafa-child-2",type:"progress",message:"Oyun süresince pozitif duygular hakim. Öğrenme motivasyonu yüksek seviyede.",priority:"low",createdAt:new Date("2024-03-12")},{id:"insight1",studentId:"1",type:"progress",message:"Elif'in matematik oyunlarındaki performansı son 2 haftada %15 arttı. Sayı tanıma becerilerinde belirgin gelişme gözleniyor.",priority:"medium",createdAt:new Date("2024-03-15")},{id:"insight2",studentId:"1",type:"recommendation",message:"Elif hikaye temelli oyunlarda çok başarılı. Daha karmaşık hikaye senaryoları ile zorlanabilir.",priority:"low",createdAt:new Date("2024-03-14")},{id:"insight3",studentId:"2",type:"attention",message:"Mehmet'in dikkat süresi artıyor ancak renk karışımlarında hala zorlanıyor. Daha basit renk oyunları önerilir.",priority:"high",createdAt:new Date("2024-03-13")},{id:"insight4",studentId:"2",type:"progress",message:"Dikkat sprint oyunlarında %20 iyileşme kaydedildi. Motor beceriler gelişiyor.",priority:"medium",createdAt:new Date("2024-03-12")},{id:"insight5",studentId:"3",type:"recommendation",message:"Zeynep'in sosyal beceri gelişimi için grup oyunları artırılabilir. Mükemmel kelime-resim eşleştirme performansı.",priority:"low",createdAt:new Date("2024-03-11")},{id:"insight6",studentId:"3",type:"warning",message:"Son oyunlarda hafif stres belirtileri gözlendi. Oyun zorluğu azaltılabilir.",priority:"high",createdAt:new Date("2024-03-10")}],vg=s=>{const e=al.filter(y=>y.studentId===s);if(e.length===0)return{totalGames:0,averageScore:0,totalPlayTime:0,favoriteGame:"Henüz oyun oynamamış",lastActivity:null};const t=e.length,r=Math.round(e.reduce((y,v)=>y+v.score,0)/t),o=Math.round(e.reduce((y,v)=>y+v.duration,0)/60),c=e.reduce((y,v)=>(y[v.gameType]=(y[v.gameType]||0)+1,y),{}),d=Object.entries(c).reduce((y,v)=>c[y[0]]>c[v[0]]?y:v)[0],f={count:"Dikkat Sayma",conflict:"Çatışma Oyunu",dynamic:"Dinamik Dikkat",colorRecognition:"AI Renk Tanıma"},p=e.sort((y,v)=>v.createdAt.getTime()-y.createdAt.getTime())[0];return{totalGames:t,averageScore:r,totalPlayTime:o,favoriteGame:f[d]||d,lastActivity:p}},FD=s=>{const t=al.filter(p=>p.studentId===s).flatMap(p=>p.emotions);if(t.length===0)return{dominantEmotion:"neutral",emotionDistribution:{},averageConfidence:0};const r=t.reduce((p,y)=>(p[y.emotion]=(p[y.emotion]||0)+1,p),{}),o=Object.entries(r).reduce((p,y)=>r[p[0]]>r[y[0]]?p:y)[0],c=t.length,d=Object.entries(r).reduce((p,[y,v])=>(p[y]=Math.round(v/c*100),p),{}),f=t.reduce((p,y)=>p+y.confidence,0)/t.length;return{dominantEmotion:o,emotionDistribution:d,averageConfidence:Math.round(f*100)}},qD=s=>{al.filter(t=>t.studentId===s).sort((t,r)=>t.createdAt.getTime()-r.createdAt.getTime());const e=Array.from({length:7},(t,r)=>{const o=new Date;return o.setDate(o.getDate()-(6-r)),{date:o.toLocaleDateString("tr-TR",{weekday:"short"}),score:0,games:0}});return e.forEach(t=>{t.score=Math.floor(Math.random()*40)+60,t.games=Math.floor(Math.random()*4)+1}),e},Mc={happy:"😊 Mutlu",sad:"😢 Üzgün",angry:"😠 Kızgın",neutral:"😐 Nötr",focused:"🎯 Odaklanmış",confused:"😕 Şaşkın"},bg={count:"Dikkat Sayma",conflict:"Çatışma Oyunu",dynamic:"Dinamik Dikkat",colorRecognition:"AI Renk Tanıma"},$D=({isOpen:s,onClose:e,studentId:t,gameType:r,studentName:o})=>{if(!s)return null;const c=al.filter(U=>U.studentId===t&&U.gameType===r);if(c.length===0)return null;const d=c.length,f=Math.round(c.reduce((U,B)=>U+B.score,0)/d),p=Math.max(...c.map(U=>U.score)),y=Math.round(c.reduce((U,B)=>U+B.duration,0)/d/60),v=c.sort((U,B)=>U.createdAt.getTime()-B.createdAt.getTime())[0],k=c.sort((U,B)=>B.createdAt.getTime()-U.createdAt.getTime())[0],S=k.score-v.score,I=c.flatMap(U=>U.emotions),q=I.reduce((U,B)=>(U[B.emotion]=(U[B.emotion]||0)+1,U),{}),L=Object.entries(q).sort(([,U],[,B])=>B-U).slice(0,3),P={"word-image":"Kelimeler ve resimler arasında bağlantı kurma becerilerini geliştiren oyun. Görsel algı ve dil becerilerini güçlendirir.",number:"Sayısal kavramları öğrenme ve matematik becerilerini geliştirme oyunu. Sayı tanıma ve basit işlemler içerir.",color:"Renk algısı ve eşleştirme becerilerini geliştiren oyun. Görsel dikkat ve kategorize etme yeteneklerini artırır.","attention-sprint":"Dikkat süresi ve odaklanma becerilerini geliştiren hızlı tempolu oyun. Sürdürülebilir dikkat ve tepki hızını artırır."},K=U=>{U.target===U.currentTarget&&e()};return l.jsx("div",{className:"fixed inset-0 bg-black/30 backdrop-blur-sm flex items-center justify-center z-50 p-4",onClick:K,children:l.jsxs("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto shadow-2xl",onClick:U=>U.stopPropagation(),children:[l.jsx("div",{className:"bg-gradient-to-r from-primary to-secondary text-white p-6 rounded-t-lg",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"text-2xl font-bold",children:bg[r]}),l.jsxs("p",{className:"text-blue-100 mt-1",children:[o," - Oyun Detayları"]})]}),l.jsx("button",{onClick:e,className:"p-2 hover:bg-white/20 rounded-full transition-colors",children:l.jsx(ah,{className:"h-6 w-6"})})]})}),l.jsxs("div",{className:"p-6 space-y-6",children:[l.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[l.jsx("h4",{className:"font-semibold text-blue-800 mb-2",children:"Bu Oyun Hakkında"}),l.jsx("p",{className:"text-blue-700 text-sm",children:P[r]})]}),l.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[l.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-green-100 rounded-lg p-4 text-center border border-green-200",children:[l.jsx(Bn,{className:"h-8 w-8 text-green-600 mx-auto mb-2"}),l.jsx("div",{className:"text-2xl font-bold text-green-800",children:d}),l.jsx("div",{className:"text-sm text-green-600",children:"Toplam Oyun"})]}),l.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 rounded-lg p-4 text-center border border-blue-200",children:[l.jsx(Ii,{className:"h-8 w-8 text-blue-600 mx-auto mb-2"}),l.jsxs("div",{className:"text-2xl font-bold text-blue-800",children:[f,"%"]}),l.jsx("div",{className:"text-sm text-blue-600",children:"Ortalama Başarı"})]}),l.jsxs("div",{className:"bg-gradient-to-br from-yellow-50 to-yellow-100 rounded-lg p-4 text-center border border-yellow-200",children:[l.jsx(Ic,{className:"h-8 w-8 text-yellow-600 mx-auto mb-2"}),l.jsxs("div",{className:"text-2xl font-bold text-yellow-800",children:[p,"%"]}),l.jsx("div",{className:"text-sm text-yellow-600",children:"En İyi Skor"})]}),l.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-purple-100 rounded-lg p-4 text-center border border-purple-200",children:[l.jsx(ja,{className:"h-8 w-8 text-purple-600 mx-auto mb-2"}),l.jsxs("div",{className:"text-2xl font-bold text-purple-800",children:[y,"dk"]}),l.jsx("div",{className:"text-sm text-purple-600",children:"Ortalama Süre"})]})]}),l.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[l.jsxs("h4",{className:"font-semibold text-gray-800 mb-4 flex items-center",children:[l.jsx(Ii,{className:"h-5 w-5 mr-2 text-green-500"}),"İlerleme Analizi"]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[l.jsxs("div",{children:[l.jsx("div",{className:"text-sm text-gray-600 mb-2",children:"İlk Oyun vs Son Oyun"}),l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsxs("div",{className:"text-center",children:[l.jsxs("div",{className:"text-lg font-semibold text-gray-800",children:[v.score,"%"]}),l.jsx("div",{className:"text-xs text-gray-500",children:"İlk Skor"})]}),l.jsx("div",{className:"flex-1 h-2 bg-gray-200 rounded-full overflow-hidden",children:l.jsx("div",{className:`h-full transition-all duration-1000 ${S>=0?"bg-green-500":"bg-red-500"}`,style:{width:`${Math.abs(S)*2}%`}})}),l.jsxs("div",{className:"text-center",children:[l.jsxs("div",{className:"text-lg font-semibold text-gray-800",children:[k.score,"%"]}),l.jsx("div",{className:"text-xs text-gray-500",children:"Son Skor"})]})]}),l.jsx("div",{className:"mt-2 text-center",children:l.jsxs("span",{className:`text-sm font-medium ${S>=0?"text-green-600":"text-red-600"}`,children:[S>=0?"+":"",S," puan değişim"]})})]}),l.jsxs("div",{children:[l.jsx("div",{className:"text-sm text-gray-600 mb-2",children:"En Çok Hissedilen Duygular"}),l.jsx("div",{className:"space-y-2",children:L.map(([U,B],F)=>l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"text-sm",children:Mc[U]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("div",{className:"w-16 h-2 bg-gray-200 rounded-full overflow-hidden",children:l.jsx("div",{className:"h-full bg-gradient-to-r from-primary to-secondary rounded-full",style:{width:`${B/I.length*100}%`}})}),l.jsx("span",{className:"text-xs text-gray-500",children:B})]})]},U))})]})]})]}),l.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[l.jsxs("h4",{className:"font-semibold text-gray-800 mb-4 flex items-center",children:[l.jsx(qr,{className:"h-5 w-5 mr-2 text-blue-500"}),"Son Oyunlar (",c.length,")"]}),l.jsx("div",{className:"space-y-3 max-h-60 overflow-y-auto",children:c.sort((U,B)=>B.createdAt.getTime()-U.createdAt.getTime()).map((U,B)=>l.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsx("div",{className:"w-8 h-8 bg-primary rounded-full flex items-center justify-center text-white font-semibold text-sm",children:B+1}),l.jsxs("div",{children:[l.jsx("div",{className:"font-medium text-gray-800",children:U.createdAt.toLocaleDateString("tr-TR")}),l.jsxs("div",{className:"text-sm text-gray-500",children:[Math.round(U.duration/60)," dakika"]})]})]}),l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsx("div",{className:"text-right",children:l.jsxs("div",{className:`font-semibold ${U.score>=80?"text-green-600":U.score>=60?"text-yellow-600":"text-red-600"}`,children:[U.score,"%"]})}),l.jsx("div",{className:"flex space-x-1",children:U.emotions.slice(0,2).map((F,ae)=>l.jsx("span",{className:"text-lg",children:Mc[F.emotion]?.split(" ")[0]||"😐"},ae))})]})]},U.id))})]}),l.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-blue-50 rounded-lg p-4 border border-green-200",children:[l.jsxs("h4",{className:"font-semibold text-green-800 mb-2 flex items-center",children:[l.jsx(Dk,{className:"h-5 w-5 mr-2"}),"AI Önerileri"]}),l.jsxs("div",{className:"text-sm text-green-700",children:[f>=80?l.jsx("p",{children:"Mükemmel performans! Bu oyun türünde zorluğu artırarak daha karmaşık senaryolar denenebilir."}):f>=60?l.jsx("p",{children:"İyi ilerleme kaydediliyor. Düzenli pratik ile başarı daha da artacaktır."}):l.jsx("p",{children:"Bu oyun türünde daha fazla pratik yaparak temel becerileri güçlendirmek faydalı olacaktır."}),S>10&&l.jsx("p",{className:"mt-2 font-medium",children:"🎉 Son zamanlarda bu oyunda harika bir gelişim gösteriyor!"})]})]})]}),l.jsx("div",{className:"bg-gray-50 px-6 py-4 rounded-b-lg",children:l.jsx("div",{className:"flex justify-end",children:l.jsx("button",{onClick:e,className:"px-6 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",children:"Kapat"})})})]})})},Hk=({studentId:s,studentName:e})=>{const[t,r]=T.useState({gameType:"",isOpen:!1}),o=al.filter(L=>L.studentId===s),c=L=>{r({gameType:L,isOpen:!0})},d=()=>{r({gameType:"",isOpen:!1})};if(o.length===0)return l.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[l.jsxs("h4",{className:"font-semibold text-gray-800 mb-4 flex items-center",children:[l.jsx(jc,{className:"h-5 w-5 mr-2"}),e," - Oyun Detayları"]}),l.jsx("p",{className:"text-gray-600 text-center py-8",children:"Henüz oyun verisi bulunmuyor"})]});const f=o.reduce((L,P)=>{const K=P.gameType;return L[K]||(L[K]={count:0,totalScore:0,totalDuration:0,activities:[]}),L[K].count++,L[K].totalScore+=P.score,L[K].totalDuration+=P.duration,L[K].activities.push(P),L},{}),p=o.sort((L,P)=>P.createdAt.getTime()-L.createdAt.getTime())[0],y=o.length,v=Math.round(o.reduce((L,P)=>L+P.score,0)/y),k=Math.round(o.reduce((L,P)=>L+P.duration,0)/60),I=o.flatMap(L=>L.emotions).reduce((L,P)=>(L[P.emotion]=(L[P.emotion]||0)+1,L),{}),q=Object.entries(I).sort(([,L],[,P])=>P-L)[0];return l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg border border-blue-200 p-6",children:[l.jsxs("h4",{className:"font-semibold text-gray-800 mb-4 flex items-center",children:[l.jsx(jc,{className:"h-5 w-5 mr-2 text-blue-600"}),e," - Oyun İstatistikleri Özeti"]}),l.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[l.jsxs("div",{className:"bg-white rounded-lg p-4 text-center shadow-sm",children:[l.jsx(Bn,{className:"h-6 w-6 text-green-500 mx-auto mb-2"}),l.jsx("div",{className:"text-2xl font-bold text-gray-800",children:y}),l.jsx("div",{className:"text-sm text-gray-600",children:"Toplam Oyun"})]}),l.jsxs("div",{className:"bg-white rounded-lg p-4 text-center shadow-sm",children:[l.jsx(Ii,{className:"h-6 w-6 text-blue-500 mx-auto mb-2"}),l.jsxs("div",{className:"text-2xl font-bold text-gray-800",children:[v,"%"]}),l.jsx("div",{className:"text-sm text-gray-600",children:"Ortalama Başarı"})]}),l.jsxs("div",{className:"bg-white rounded-lg p-4 text-center shadow-sm",children:[l.jsx(ja,{className:"h-6 w-6 text-purple-500 mx-auto mb-2"}),l.jsxs("div",{className:"text-2xl font-bold text-gray-800",children:[k,"dk"]}),l.jsx("div",{className:"text-sm text-gray-600",children:"Toplam Süre"})]}),l.jsxs("div",{className:"bg-white rounded-lg p-4 text-center shadow-sm",children:[l.jsx(kD,{className:"h-6 w-6 text-yellow-500 mx-auto mb-2"}),l.jsx("div",{className:"text-2xl",children:Mc[q?.[0]]?.split(" ")[0]||"😐"}),l.jsx("div",{className:"text-sm text-gray-600",children:"Genel Ruh Hali"})]})]})]}),l.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[l.jsx("h5",{className:"font-semibold text-gray-800 mb-4",children:"Oyun Türlerine Göre Performans"}),l.jsx("div",{className:"space-y-4",children:Object.entries(f).map(([L,P])=>{const K=Math.round(P.totalScore/P.count),U=Math.round(P.totalDuration/P.count/60);return l.jsxs("div",{className:"border border-gray-100 rounded-lg p-4 hover:border-primary/30 transition-colors",children:[l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsxs("h6",{className:"font-medium text-gray-800",children:["🎮 ",bg[L]||L]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsxs("span",{className:"text-sm text-gray-500",children:[P.count," oyun"]}),l.jsxs("button",{onClick:()=>c(L),className:"flex items-center px-2 py-1 bg-primary text-white rounded text-xs hover:bg-primary/90 transition-colors",children:[l.jsx(Cc,{className:"h-3 w-3 mr-1"}),"Detay"]})]})]}),l.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[l.jsxs("div",{children:[l.jsxs("div",{className:"text-lg font-semibold text-blue-600",children:[K,"%"]}),l.jsx("div",{className:"text-xs text-gray-600",children:"Ortalama Başarı"})]}),l.jsxs("div",{children:[l.jsxs("div",{className:"text-lg font-semibold text-green-600",children:[U,"dk"]}),l.jsx("div",{className:"text-xs text-gray-600",children:"Ortalama Süre"})]}),l.jsxs("div",{children:[l.jsx("div",{className:"text-lg font-semibold text-purple-600",children:P.count}),l.jsx("div",{className:"text-xs text-gray-600",children:"Oynama Sayısı"})]})]}),l.jsxs("div",{className:"mt-3",children:[l.jsx("div",{className:"text-xs text-gray-600 mb-2",children:"Son oyun skorları:"}),l.jsx("div",{className:"flex space-x-2",children:P.activities.slice(-3).map((B,F)=>l.jsxs("div",{className:"flex-1",children:[l.jsx("div",{className:"h-2 bg-gradient-to-r from-primary to-secondary rounded-full",style:{width:`${B.score}%`}}),l.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[B.score,"%"]})]},F))})]})]},L)})})]}),p&&l.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[l.jsxs("h5",{className:"font-semibold text-gray-800 mb-4 flex items-center",children:[l.jsx(qr,{className:"h-5 w-5 mr-2"}),"Son Oyun Detayı"]}),l.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("div",{className:"text-sm text-gray-600",children:"Oyun Türü"}),l.jsx("div",{className:"font-medium",children:bg[p.gameType]})]}),l.jsxs("div",{children:[l.jsx("div",{className:"text-sm text-gray-600",children:"Tarih"}),l.jsx("div",{className:"font-medium",children:p.createdAt.toLocaleDateString("tr-TR")})]}),l.jsxs("div",{children:[l.jsx("div",{className:"text-sm text-gray-600",children:"Başarı Oranı"}),l.jsxs("div",{className:"font-medium text-green-600",children:[p.score,"%"]})]}),l.jsxs("div",{children:[l.jsx("div",{className:"text-sm text-gray-600",children:"Süre"}),l.jsxs("div",{className:"font-medium",children:[Math.round(p.duration/60)," dakika"]})]})]}),p.emotions.length>0&&l.jsxs("div",{className:"mt-4",children:[l.jsx("div",{className:"text-sm text-gray-600 mb-2",children:"Oyun sırasındaki duygular:"}),l.jsx("div",{className:"flex space-x-2",children:p.emotions.map((L,P)=>l.jsxs("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm",children:[Mc[L.emotion]," (%",Math.round(L.confidence*100),")"]},P))})]})]})]}),l.jsx($D,{isOpen:t.isOpen,onClose:d,studentId:s,gameType:t.gameType,studentName:e})]})},Gk=({students:s,loading:e,onViewStudent:t})=>{const[r,o]=T.useState(null),c=d=>{o(r===d?null:d)};return e?l.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:l.jsxs("div",{className:"animate-pulse space-y-4",children:[l.jsx("div",{className:"h-6 bg-gray-200 rounded w-1/4"}),l.jsx("div",{className:"space-y-3",children:[1,2,3].map(d=>l.jsx("div",{className:"h-20 bg-gray-200 rounded"},d))})]})}):s.length===0?l.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-8 text-center",children:[l.jsx(Di,{className:"h-12 w-12 text-gray-300 mx-auto mb-4"}),l.jsx("h3",{className:"text-lg font-medium text-gray-800 mb-2",children:"Henüz çocuk eklenmemiş"}),l.jsx("p",{className:"text-gray-600",children:"Çocuğunuzun öğrenme sürecini takip etmek için lütfen sistem yöneticisi ile iletişime geçin."})]}):l.jsxs("div",{className:"bg-white rounded-lg border border-gray-200",children:[l.jsx("div",{className:"p-6 border-b border-gray-200",children:l.jsxs("h3",{className:"text-lg font-semibold text-gray-800 flex items-center",children:[l.jsx(Di,{className:"h-5 w-5 mr-2"}),"Çocuklarınız (",s.length,")"]})}),l.jsx("div",{className:"p-6 space-y-4",children:s.map(d=>{const f=vg(d.id),p=FD(d.id),y=qD(d.id),v=Math.round(y.reduce((k,S)=>k+S.score,0)/y.length);return l.jsxs("div",{className:"border border-gray-200 rounded-lg p-5 hover:border-primary/30 hover:shadow-md transition-all",children:[l.jsxs("div",{className:"flex items-start justify-between mb-4",children:[l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-primary to-secondary rounded-full flex items-center justify-center text-white font-bold text-lg",children:d.name.split(" ").map(k=>k[0]).join("").toUpperCase()}),l.jsxs("div",{className:"ml-4",children:[l.jsx("h4",{className:"text-lg font-semibold text-gray-800",children:d.name}),l.jsxs("p",{className:"text-sm text-gray-600",children:[d.age," yaş"]})]})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsxs("div",{className:"px-3 py-1 bg-primary/10 text-primary rounded-full text-sm font-medium",children:[v," puan ortalaması"]}),l.jsx("div",{className:"text-2xl",children:Mc[p.dominantEmotion]?.split(" ")[0]||"😐"})]})]}),l.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4",children:[l.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 text-center",children:[l.jsx(zd,{className:"h-5 w-5 text-yellow-500 mx-auto mb-1"}),l.jsx("div",{className:"text-lg font-semibold text-gray-800",children:f.totalGames}),l.jsx("div",{className:"text-xs text-gray-600",children:"Oyun Oynandı"})]}),l.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 text-center",children:[l.jsx(Ii,{className:"h-5 w-5 text-green-500 mx-auto mb-1"}),l.jsxs("div",{className:"text-lg font-semibold text-gray-800",children:[f.averageScore,"%"]}),l.jsx("div",{className:"text-xs text-gray-600",children:"Ortalama Başarı"})]}),l.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 text-center",children:[l.jsx(ja,{className:"h-5 w-5 text-blue-500 mx-auto mb-1"}),l.jsxs("div",{className:"text-lg font-semibold text-gray-800",children:[f.totalPlayTime,"dk"]}),l.jsx("div",{className:"text-xs text-gray-600",children:"Toplam Süre"})]}),l.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 text-center",children:[l.jsx(Dk,{className:"h-5 w-5 text-red-500 mx-auto mb-1"}),l.jsxs("div",{className:"text-lg font-semibold text-gray-800",children:[p.averageConfidence,"%"]}),l.jsx("div",{className:"text-xs text-gray-600",children:"Duygu Güveni"})]})]}),l.jsxs("div",{className:"mb-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsxs("h5",{className:"text-sm font-medium text-gray-700 flex items-center",children:[l.jsx(jc,{className:"h-4 w-4 mr-1"}),"Haftalık İlerleme"]}),l.jsx("span",{className:"text-xs text-gray-500",children:"Son 7 gün"})]}),l.jsx("div",{className:"flex items-end space-x-1 h-16",children:y.map((k,S)=>l.jsxs("div",{className:"flex-1 flex flex-col items-center",children:[l.jsx("div",{className:"w-full bg-gradient-to-t from-primary to-secondary rounded-sm",style:{height:`${k.score/100*100}%`}}),l.jsx("span",{className:"text-xs text-gray-500 mt-1",children:k.date})]},S))})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("span",{className:"text-sm text-gray-600",children:"En sevdiği oyun:"}),l.jsx("span",{className:"ml-2 text-sm font-medium text-gray-800",children:f.favoriteGame})]}),l.jsxs("div",{className:"flex items-center space-x-4",children:[f.lastActivity&&l.jsxs("div",{className:"text-xs text-gray-500",children:["Son aktivite: ",f.lastActivity.createdAt.toLocaleDateString("tr-TR")]}),l.jsx("button",{onClick:()=>c(d.id),className:"flex items-center px-3 py-1 bg-primary text-white rounded-lg hover:bg-primary/90 transition-colors text-sm",children:r===d.id?l.jsxs(l.Fragment,{children:[l.jsx(GI,{className:"h-4 w-4 mr-1"}),"Detayları Gizle"]}):l.jsxs(l.Fragment,{children:[l.jsx(VI,{className:"h-4 w-4 mr-1"}),"Detayları Göster"]})})]})]}),d.notes&&l.jsx("div",{className:"mt-3 p-3 bg-blue-50 rounded-lg",children:l.jsx("p",{className:"text-sm text-blue-800",children:d.notes})}),r===d.id&&l.jsx("div",{className:"mt-6 border-t border-gray-200 pt-6",children:l.jsx(Hk,{studentId:d.id,studentName:d.name})})]},d.id)})})]})},ta=({className:s,children:e})=>l.jsx("div",{className:Zc("bg-white rounded-lg shadow-sm border border-gray-200 p-6",s),children:e}),Pb=({className:s,children:e})=>l.jsx("div",{className:Zc("mb-4",s),children:e}),zb=({className:s,children:e})=>l.jsx("h3",{className:Zc("text-lg font-semibold text-gray-800",s),children:e}),na=({className:s,children:e})=>l.jsx("div",{className:Zc(s),children:e}),KD=({insights:s,loading:e=!1})=>{const t=d=>({progress:Ik,attention:Mb,recommendation:Cb,warning:Mb})[d]||jb,r=(d,f)=>f==="warning"||d==="high"?"bg-red-50 border-red-200 text-red-800":f==="attention"||d==="medium"?"bg-yellow-50 border-yellow-200 text-yellow-800":f==="progress"?"bg-green-50 border-green-200 text-green-800":"bg-blue-50 border-blue-200 text-blue-800",o=d=>({progress:"İlerleme",attention:"Dikkat",recommendation:"Öneri",warning:"Uyarı"})[d]||"Bilgi",c=d=>{const p=new Date().getTime()-d.getTime(),y=Math.floor(p/6e4),v=Math.floor(p/36e5),k=Math.floor(p/864e5);return k>0?`${k} gün önce`:v>0?`${v} saat önce`:y>0?`${y} dakika önce`:"Az önce"};return e?l.jsxs(ta,{children:[l.jsx(Pb,{children:l.jsx(zb,{children:"AI Öngörüleri"})}),l.jsx(na,{children:l.jsx("div",{className:"space-y-4",children:[1,2,3].map(d=>l.jsx("div",{className:"animate-pulse border border-gray-200 rounded-lg p-4",children:l.jsxs("div",{className:"flex items-start space-x-3",children:[l.jsx("div",{className:"w-6 h-6 bg-gray-200 rounded-full"}),l.jsxs("div",{className:"flex-1",children:[l.jsx("div",{className:"h-4 bg-gray-200 rounded w-20 mb-2"}),l.jsx("div",{className:"h-3 bg-gray-200 rounded w-full mb-1"}),l.jsx("div",{className:"h-3 bg-gray-200 rounded w-3/4"})]})]})},d))})})]}):l.jsxs(ta,{children:[l.jsx(Pb,{children:l.jsxs(zb,{className:"flex items-center",children:[l.jsx(Cb,{className:"h-5 w-5 mr-2 text-primary"}),"AI Öngörüleri (",s.length,")"]})}),l.jsx(na,{children:s.length===0?l.jsxs("div",{className:"text-center py-8",children:[l.jsx(jb,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),l.jsx("p",{className:"text-gray-600 mb-2",children:"Henüz AI öngörüsü yok"}),l.jsx("p",{className:"text-sm text-gray-500",children:"Öğrenciler aktivite yaptıkça AI öngörüleri burada görünecek"})]}):l.jsx("div",{className:"space-y-4 max-h-96 overflow-y-auto",children:s.map(d=>{const f=t(d.type);return l.jsx("div",{className:`border rounded-lg p-4 ${r(d.priority,d.type)}`,children:l.jsxs("div",{className:"flex items-start space-x-3",children:[l.jsx(f,{className:"h-5 w-5 mt-0.5 flex-shrink-0"}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsxs("div",{className:"flex items-center justify-between mb-1",children:[l.jsx("h4",{className:"font-medium text-sm",children:o(d.type)}),l.jsxs("div",{className:"flex items-center text-xs opacity-75",children:[l.jsx(ja,{className:"h-3 w-3 mr-1"}),c(d.createdAt)]})]}),l.jsx("p",{className:"text-sm opacity-90",children:d.message})]})]})},d.id)})})})]})},YD=({studentName:s,students:e=[],onScheduleGenerated:t})=>{const[r,o]=T.useState(!1),[c,d]=T.useState(!1),[f,p]=T.useState([]),[y,v]=T.useState(""),[k,S]=T.useState(!1),I=T.useRef(null),q=()=>{I.current?.scrollIntoView({behavior:"smooth"})};T.useEffect(()=>{q()},[f]);const L=B=>{const F=[],ae=new Date,ne=B.toLowerCase();if(!["planla","takvim","program","zamanla","oyun planı","seans"].some(ye=>ne.includes(ye))||e.length===0)return[];const E=e.filter(ye=>ne.includes(ye.name.toLowerCase())||ne.includes(ye.name.split(" ")[0].toLowerCase())),C=E.length>0?E:e,M={count:["sayı","matematik","rakam","sayma"],conflict:["renk","renkli","çatışma","stroop"],click:["kelime","resim","word","tıklama","hızlı"],dynamic:["dikkat","odak","attention","dinamik","hareket"],colorRecognition:["renk tanıma","kamera","ai"]},z=Object.keys(M).filter(ye=>M[ye].some(O=>ne.includes(O))),j=ne.match(/(\d+)\s*(dakika|dk|minute)/),Ve=j?parseInt(j[1]):20,le=ne.match(/(\d+)\s*(kez|kere|defa)/),W=le?parseInt(le[1]):3,me=Object.entries({pazartesi:1,pzt:1,salı:2,sal:2,çarşamba:3,çar:3,perşembe:4,per:4,cuma:5,cum:5,cumartesi:6,cmt:6,pazar:0,paz:0}).filter(([ye])=>ne.includes(ye)).map(([,ye])=>ye);return C.forEach((ye,O)=>{const H=z.length>0?z:Object.keys(M),ee=Math.max(1,Math.min(W,7));for(let X=0;X<ee;X++){const fe=H[X%H.length];let _e;if(me.length>0){const pe=X%me.length,he=me[pe];_e=new Date(ae);const ge=(he-ae.getDay()+7)%7;_e.setDate(ae.getDate()+ge)}else{_e=new Date(ae);const pe=Math.floor(X*7/ee)+1;_e.setDate(ae.getDate()+pe)}const $e=14+O*2+Math.floor(X/2);_e.setHours($e,X%2===0?0:30,0,0);const je={id:`ai-chat-${Date.now()}-${O}-${X}`,studentId:ye.id,studentName:ye.name,gameType:fe,date:_e,duration:Ve,reminder:!0,status:"planned",aiGenerated:!0};F.push(je)}}),F.sort((ye,O)=>ye.date.getTime()-O.date.getTime())},P=B=>{const F=B.toLowerCase();if(["planla","takvim","program","zamanla","oyun planı","seans"].some(N=>F.includes(N))&&e.length>0){const N=L(B);if(N.length>0&&t){setTimeout(()=>{t(N)},1e3);const R={count:"🔢 Dikkat Sayma",conflict:"🎨 Çatışma Oyunu",dynamic:"⚡ Dinamik Dikkat",colorRecognition:"📷 AI Renk Tanıma"},E=N.map(C=>`• ${C.studentName} - ${R[C.gameType]} (${C.date.toLocaleDateString("tr-TR")} ${C.date.toLocaleTimeString("tr-TR",{hour:"2-digit",minute:"2-digit"})})`).join(`
`);return`✅ Mükemmel! Size ${N.length} oyun seansı planladım:

${E}

🤖 Bu seanslar otomatik olarak takvime eklenecek. Takvim sayfasında mor renkli seanslar olarak görebilirsiniz.

📅 Takvimi açmak için "Hızlı İşlemler" bölümündeki "Oyun Takvimi" butonuna tıklayabilirsiniz.`}return`Takvim planlaması için daha detaylı bilgi vermelisiniz. Örneğin:

• "Ahmet için haftada 3 kez sayı oyunları planla"
• "Her çocuk için günde 20 dakika oyun zamanla"
• "Pazartesi ve çarşamba dikkat oyunları ekle"

Hangi çocuk, hangi oyun türü ve ne sıklıkla oynamak istediğinizi belirtin.`}return F.includes("dikkat")||F.includes("odaklanma")?`Dikkat gelişimi için şunları önerebilirim:

• Dikkat sprint oyunlarını günde 10-15 dakika oynayın
• Tek bir aktiviteye odaklanma süresini kademeli olarak artırın
• Oyun sırasında çevre seslerini minimize edin
• Başarılı odaklanma anlarını ödüllendirin

${s?`${s} için özel olarak, mevcut dikkat süresi verilerinize bakarak daha detaylı öneriler verebilirim.`:""}`:F.includes("duygu")||F.includes("mood")||F.includes("üzgün")||F.includes("mutlu")?`Duygusal gelişim çok önemli. Şunları dikkate alın:

• Oyun sırasındaki duygu değişimlerini takip edin
• Pozitif duygular hakimken öğrenme daha etkili oluyor
• Negatif duygular varsa ara verin ve rahatlatıcı aktiviteler yapın
• Duyguları ifade etmeyi öğretin

${s?`${s}'in son oyunlardaki duygu analizlerine göre, genel olarak pozitif bir ruh halinde. Bu harika bir gelişim!`:""}`:F.includes("oyun")||F.includes("game")||F.includes("aktivite")?`Oyun seçimi için önerilerim:

• Çocuğun sevdiği oyun türlerini önceliklendirin
• Zorluğu kademeli olarak artırın
• Günde 30-45 dakika ideal oyun süresi
• Farklı oyun türlerini dengeleyin (sayı, renk, dikkat, kelime)

${s?`${s}'in en sevdiği oyun türü verilerinize göre kişisel öneriler hazırlayabilirim.`:""}`:F.includes("gelişim")||F.includes("ilerleme")||F.includes("başarı")?`Gelişim takibi için:

• Haftalık ilerleme grafiklerini düzenli inceleyin
• Küçük başarıları kutlayın
• Gerilemeler normaldir, sabırlı olun
• Uzun vadeli hedefler belirleyin

${s?`${s}'in son verilerine bakarak, çok iyi bir ilerleme kaydediyor!`:""}`:F.includes("merhaba")||F.includes("selam")||F.includes("hello")?`Merhaba! Ben PeakFocus AI Uzmanı. ${s?`${s}'in gelişimi`:"Çocuğunuzun gelişimi"} hakkında sorularınızı yanıtlamaya hazırım.

Size şu konularda yardımcı olabilirim:
• Dikkat gelişimi
• Duygusal durum
• Oyun önerileri
• Gelişim takibi
• Öğrenme stratejileri

Nasıl yardımcı olabilirim?`:`Anlayabildiğim kadarıyla ${F} konusunda yardım istiyorsunuz.

Ben PeakFocus AI Uzmanı olarak şu konularda detaylı yardım sağlayabilirim:

• 🎯 Dikkat ve odaklanma teknikleri
• 😊 Duygusal gelişim desteği
• 🎮 Oyun önerileri ve stratejileri
• 📈 Gelişim takibi ve değerlendirme
• 🧠 Öğrenme zorluklarına çözümler

Daha spesifik bir soru sorabilirsiniz. ${s?`${s}'in`:"Çocuğunuzun"} hangi konudaki gelişimi hakkında konuşmak istersiniz?`},K=async()=>{if(!y.trim())return;const B={id:Date.now().toString(),text:y,sender:"user",timestamp:new Date};p(F=>[...F,B]),v(""),S(!0),setTimeout(()=>{const F={id:(Date.now()+1).toString(),text:P(y),sender:"ai",timestamp:new Date};p(ae=>[...ae,F]),S(!1)},Math.random()*1e3+1e3)},U=B=>{B.key==="Enter"&&!B.shiftKey&&(B.preventDefault(),K())};return T.useEffect(()=>{if(r&&f.length===0){const B={id:"welcome",text:`Merhaba! Ben PeakFocus AI Uzmanı. ${s?`${s}'in gelişimi`:"Çocuğunuzun gelişimi"} hakkında sorularınızı yanıtlamaya hazırım.

Size nasıl yardımcı olabilirim?`,sender:"ai",timestamp:new Date};p([B])}},[r,s]),r?l.jsxs("div",{className:`fixed bottom-6 right-6 bg-white rounded-lg shadow-2xl border border-gray-200 z-50 transition-all duration-300 ${c?"w-80 h-16":"w-96 h-[600px]"}`,children:[l.jsxs("div",{className:"bg-gradient-to-r from-primary to-secondary text-white p-4 rounded-t-lg flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Pd,{className:"h-5 w-5"}),l.jsx("span",{className:"font-semibold",children:"AI Uzman Desteği"})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("button",{onClick:()=>d(!c),className:"p-1 hover:bg-white/20 rounded",children:c?l.jsx(oD,{className:"h-4 w-4"}):l.jsx(uD,{className:"h-4 w-4"})}),l.jsx("button",{onClick:()=>{o(!1),d(!1)},className:"p-1 hover:bg-white/20 rounded",children:l.jsx(ah,{className:"h-4 w-4"})})]})]}),!c&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"flex-1 p-4 space-y-4 overflow-y-auto h-[480px]",children:[f.map(B=>l.jsx("div",{className:`flex ${B.sender==="user"?"justify-end":"justify-start"}`,children:l.jsxs("div",{className:`flex items-start space-x-2 max-w-[80%] ${B.sender==="user"?"flex-row-reverse space-x-reverse":""}`,children:[l.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-white text-sm ${B.sender==="user"?"bg-primary":"bg-secondary"}`,children:B.sender==="user"?l.jsx(Di,{className:"h-4 w-4"}):l.jsx(Pd,{className:"h-4 w-4"})}),l.jsxs("div",{className:`p-3 rounded-lg ${B.sender==="user"?"bg-primary text-white":"bg-gray-100 text-gray-800"}`,children:[l.jsx("div",{className:"whitespace-pre-wrap text-sm",children:B.text}),l.jsx("div",{className:`text-xs mt-1 ${B.sender==="user"?"text-blue-100":"text-gray-500"}`,children:B.timestamp.toLocaleTimeString("tr-TR",{hour:"2-digit",minute:"2-digit"})})]})]})},B.id)),k&&l.jsx("div",{className:"flex justify-start",children:l.jsxs("div",{className:"flex items-start space-x-2",children:[l.jsx("div",{className:"w-8 h-8 rounded-full bg-secondary flex items-center justify-center text-white text-sm",children:l.jsx(Pd,{className:"h-4 w-4"})}),l.jsx("div",{className:"bg-gray-100 p-3 rounded-lg",children:l.jsxs("div",{className:"flex space-x-1",children:[l.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce"}),l.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),l.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]})})]})}),l.jsx("div",{ref:I})]}),l.jsx("div",{className:"p-4 border-t border-gray-200",children:l.jsxs("div",{className:"flex space-x-2",children:[l.jsx("textarea",{value:y,onChange:B=>v(B.target.value),onKeyPress:U,placeholder:"Uzmanımıza sorunuzu yazın...",className:"flex-1 resize-none border border-gray-300 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent",rows:2}),l.jsx("button",{onClick:K,disabled:!y.trim()||k,className:"bg-primary text-white p-2 rounded-lg hover:bg-primary/90 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:l.jsx(Lk,{className:"h-4 w-4"})})]})})]})]}):l.jsx("button",{onClick:()=>o(!0),className:"fixed bottom-6 right-6 bg-gradient-to-r from-primary to-secondary text-white p-4 rounded-full shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-200 z-40",children:l.jsx(Ok,{className:"h-6 w-6"})})},QD=({students:s,onSessionsGenerated:e})=>{const[t,r]=T.useState(""),[o,c]=T.useState(!1),[d,f]=T.useState([]),[p,y]=T.useState(!1),v={count:"🔢 Dikkat Sayma",conflict:"🎨 Çatışma Oyunu",dynamic:"⚡ Dinamik Dikkat",colorRecognition:"📷 AI Renk Tanıma"},k=["Ahmet için haftada 3 kez sayı oyunları, Ayşe için haftada 2 kez renk oyunları planla","Bu hafta her çocuk için günde 15 dakika, farklı oyun türleri ile program oluştur","Ahmet pazartesi ve çarşamba dikkat oyunları, Ayşe salı ve perşembe kelime oyunları","Hafta sonu dahil 7 gün boyunca dengeli bir oyun programı hazırla"],S=P=>{const K=[],U=new Date,B=P.toLowerCase(),F=s.filter(j=>B.includes(j.name.toLowerCase())||B.includes(j.name.split(" ")[0].toLowerCase())),ae=F.length>0?F:s,ne=Object.keys(v).filter(j=>({count:["sayı","matematik","rakam","sayma"],conflict:["renk","renkli","çatışma","stroop"],click:["kelime","resim","word","tıklama","hızlı"],dynamic:["dikkat","odak","attention","dinamik","hareket"],colorRecognition:["renk tanıma","kamera","ai"]})[j].some(le=>B.includes(le))),N=B.match(/(\d+)\s*(dakika|dk|minute)/),R=N?parseInt(N[1]):20,E=B.match(/(\d+)\s*(kez|kere|defa)/),C=E?parseInt(E[1]):3,z=Object.entries({pazartesi:1,pzt:1,salı:2,sal:2,çarşamba:3,çar:3,perşembe:4,per:4,cuma:5,cum:5,cumartesi:6,cmt:6,pazar:0,paz:0}).filter(([j])=>B.includes(j)).map(([,j])=>j);return ae.forEach((j,Ve)=>{const le=ne.length>0?ne:Object.keys(v),W=Math.max(1,Math.min(C,7));for(let de=0;de<W;de++){const me=le[de%le.length];let ye;if(z.length>0){const X=de%z.length,fe=z[X];ye=new Date(U);const _e=(fe-U.getDay()+7)%7;ye.setDate(U.getDate()+_e)}else{ye=new Date(U);const X=Math.floor(de*7/W)+1;ye.setDate(U.getDate()+X)}const H=14+Ve*2+Math.floor(de/2);ye.setHours(H,de%2===0?0:30,0,0);const ee={id:`ai-${Date.now()}-${Ve}-${de}`,studentId:j.id,studentName:j.name,gameType:me,date:ye,duration:R,reminder:!0,status:"planned",aiGenerated:!0};K.push(ee)}}),K.sort((j,Ve)=>j.date.getTime()-Ve.date.getTime())},I=async()=>{if(t.trim()){c(!0),y(!1),await new Promise(P=>setTimeout(P,2e3));try{const P=S(t);f(P),y(!0)}catch(P){console.error("Error generating schedule:",P)}finally{c(!1)}}},q=()=>{e(d),r(""),f([]),y(!1)},L=P=>{P.key==="Enter"&&!P.shiftKey&&(P.preventDefault(),I())};return l.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-blue-50 border border-purple-200 rounded-lg p-6",children:[l.jsxs("div",{className:"flex items-center mb-4",children:[l.jsx(Pd,{className:"h-6 w-6 text-purple-600 mr-2"}),l.jsx("h4",{className:"text-lg font-semibold text-purple-800",children:"AI Takvim Planlayıcısı"}),l.jsx(Ap,{className:"h-5 w-5 text-purple-500 ml-2"})]}),l.jsx("p",{className:"text-purple-700 text-sm mb-4",children:"AI'dan oyun programı isteyiniz. Hangi çocuk, hangi oyunları, ne zaman oynayacağını belirtin."}),l.jsxs("div",{className:"mb-4",children:[l.jsx("p",{className:"text-sm font-medium text-purple-700 mb-2",children:"Örnek komutlar:"}),l.jsx("div",{className:"grid grid-cols-1 gap-2",children:k.map((P,K)=>l.jsxs("button",{onClick:()=>r(P),className:"text-left text-xs bg-white/70 hover:bg-white/90 text-purple-600 p-2 rounded border border-purple-200 transition-colors",children:["💡 ",P]},K))})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-purple-700 mb-2",children:"AI Planlama Talebi"}),l.jsxs("div",{className:"flex space-x-2",children:[l.jsx("textarea",{value:t,onChange:P=>r(P.target.value),onKeyPress:L,placeholder:"Örn: Ahmet için haftada 3 kez sayı oyunları, Ayşe için haftada 2 kez renk oyunları planla...",className:"flex-1 resize-none border border-purple-300 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",rows:3}),l.jsx("button",{onClick:I,disabled:!t.trim()||o,className:"bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center",children:o?l.jsx(Ib,{className:"h-4 w-4 animate-spin"}):l.jsx(Lk,{className:"h-4 w-4"})})]})]}),o&&l.jsxs("div",{className:"bg-white/70 rounded-lg p-4 text-center",children:[l.jsxs("div",{className:"flex items-center justify-center space-x-2 text-purple-600",children:[l.jsx(Ib,{className:"h-5 w-5 animate-spin"}),l.jsx("span",{className:"text-sm font-medium",children:"AI oyun programını hazırlıyor..."})]}),l.jsx("div",{className:"text-xs text-purple-500 mt-2",children:"Çocukların geçmiş verilerini analiz ediyor ve optimal program oluşturuyor"})]}),p&&d.length>0&&l.jsxs("div",{className:"bg-white/90 rounded-lg p-4 border border-purple-200",children:[l.jsx("div",{className:"flex items-center justify-between mb-3",children:l.jsxs("h5",{className:"font-semibold text-purple-800 flex items-center",children:[l.jsx(Ik,{className:"h-5 w-5 mr-2"}),"AI Tarafından Oluşturulan Program (",d.length," seans)"]})}),l.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:d.map((P,K)=>l.jsxs("div",{className:"flex items-center justify-between p-3 bg-purple-50/70 rounded-lg border border-purple-100",children:[l.jsxs("div",{className:"flex-1",children:[l.jsxs("div",{className:"font-medium text-sm text-purple-800",children:[P.studentName," - ",v[P.gameType]]}),l.jsxs("div",{className:"text-xs text-purple-600 flex items-center space-x-4",children:[l.jsxs("span",{className:"flex items-center",children:[l.jsx(qr,{className:"h-3 w-3 mr-1"}),P.date.toLocaleDateString("tr-TR")]}),l.jsxs("span",{className:"flex items-center",children:[l.jsx(ja,{className:"h-3 w-3 mr-1"}),P.date.toLocaleTimeString("tr-TR",{hour:"2-digit",minute:"2-digit"})]}),l.jsxs("span",{className:"flex items-center",children:[l.jsx(Bn,{className:"h-3 w-3 mr-1"}),P.duration,"dk"]})]})]}),l.jsx("div",{className:"text-xs bg-purple-200 text-purple-700 px-2 py-1 rounded",children:"AI"})]},P.id))}),l.jsxs("div",{className:"mt-4 flex space-x-2",children:[l.jsx("button",{onClick:q,className:"flex-1 bg-purple-600 text-white py-2 px-4 rounded-lg hover:bg-purple-700 transition-colors font-medium",children:"✅ Programı Takvime Ekle"}),l.jsx("button",{onClick:()=>{y(!1),f([])},className:"flex-1 bg-gray-300 text-gray-700 py-2 px-4 rounded-lg hover:bg-gray-400 transition-colors",children:"❌ İptal Et"})]})]}),p&&d.length===0&&l.jsx("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4 text-center",children:l.jsx("p",{className:"text-orange-700 text-sm",children:"AI bu talep için program oluşturamadı. Lütfen daha detaylı bir açıklama deneyin."})})]})]})},Fk=({isOpen:s,onClose:e,students:t,externalSessions:r=[]})=>{const[o,c]=T.useState(new Date),[d,f]=T.useState(null),[p,y]=T.useState(!1),[v,k]=T.useState([{id:"1",studentId:"mustafa-child-1",studentName:"Ahmet Deneme",gameType:"number",date:new Date(2024,2,20,10,0),duration:20,reminder:!0,status:"planned"},{id:"2",studentId:"mustafa-child-2",studentName:"Ayşe Deneme",gameType:"color",date:new Date(2024,2,21,14,30),duration:15,reminder:!0,status:"planned"}]),[S,I]=T.useState({studentId:"",gameType:"number",date:"",time:"",duration:20,reminder:!0});if(T.useEffect(()=>{r.length>0&&k(E=>[...E,...r])},[r]),!s)return null;const q={count:"🔢 Dikkat Sayma",conflict:"🎨 Çatışma Oyunu",dynamic:"⚡ Dinamik Dikkat",colorRecognition:"📷 AI Renk Tanıma"},L=E=>{const C=E.getFullYear(),M=E.getMonth(),z=new Date(C,M,1),Ve=new Date(C,M+1,0).getDate(),le=z.getDay(),W=[];for(let me=le-1;me>=0;me--){const ye=new Date(C,M,-me);W.push({date:ye,isCurrentMonth:!1})}for(let me=1;me<=Ve;me++){const ye=new Date(C,M,me);W.push({date:ye,isCurrentMonth:!0})}const de=42-W.length;for(let me=1;me<=de;me++){const ye=new Date(C,M+1,me);W.push({date:ye,isCurrentMonth:!1})}return W},P=E=>v.filter(C=>C.date.toDateString()===E.toDateString()),K=()=>{if(!S.studentId||!S.date||!S.time)return;const E=t.find(Ve=>Ve.id===S.studentId);if(!E)return;const[C,M]=S.time.split(":").map(Number),z=new Date(S.date);z.setHours(C,M);const j={id:Date.now().toString(),studentId:S.studentId,studentName:E.name,gameType:S.gameType,date:z,duration:S.duration,reminder:S.reminder,status:"planned"};k(Ve=>[...Ve,j]),I({studentId:"",gameType:"number",date:"",time:"",duration:20,reminder:!0}),y(!1)},U=E=>{k(C=>C.filter(M=>M.id!==E))},B=E=>{k(C=>[...C,...E])},F=L(o),ae=["Ocak","Şubat","Mart","Nisan","Mayıs","Haziran","Temmuz","Ağustos","Eylül","Ekim","Kasım","Aralık"],ne=["Paz","Pzt","Sal","Çar","Per","Cum","Cmt"],N=E=>{c(C=>{const M=new Date(C);return E==="prev"?M.setMonth(C.getMonth()-1):M.setMonth(C.getMonth()+1),M})},R=E=>{E.target===E.currentTarget&&e()};return l.jsx("div",{className:"fixed inset-0 bg-black/30 backdrop-blur-sm flex items-center justify-center z-50 p-4",onClick:R,children:l.jsxs("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto shadow-2xl",onClick:E=>E.stopPropagation(),children:[l.jsx("div",{className:"bg-gradient-to-r from-primary to-secondary text-white p-6 rounded-t-lg",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx(qr,{className:"h-6 w-6"}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-2xl font-bold",children:"Oyun Takvimi"}),l.jsx("p",{className:"text-blue-100",children:"Oyun seanslarınızı planlayın ve takip edin"})]})]}),l.jsx("button",{onClick:e,className:"p-2 hover:bg-white/20 rounded-full transition-colors",children:l.jsx(ah,{className:"h-6 w-6"})})]})}),l.jsx("div",{className:"p-6",children:l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[l.jsx("div",{className:"lg:col-span-2",children:l.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsx("button",{onClick:()=>N("prev"),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:"←"}),l.jsxs("h4",{className:"text-lg font-semibold",children:[ae[o.getMonth()]," ",o.getFullYear()]}),l.jsx("button",{onClick:()=>N("next"),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:"→"})]}),l.jsx("div",{className:"grid grid-cols-7 gap-1 mb-2",children:ne.map(E=>l.jsx("div",{className:"p-2 text-center text-sm font-medium text-gray-600",children:E},E))}),l.jsx("div",{className:"grid grid-cols-7 gap-1",children:F.map(({date:E,isCurrentMonth:C},M)=>{const z=P(E),j=E.toDateString()===new Date().toDateString(),Ve=d?.toDateString()===E.toDateString();return l.jsxs("div",{onClick:()=>f(E),className:`
                          p-2 h-20 border border-gray-100 cursor-pointer transition-colors
                          ${C?"hover:bg-blue-50":"text-gray-300 bg-gray-50"}
                          ${j?"bg-blue-100 border-blue-300":""}
                          ${Ve?"bg-primary/10 border-primary":""}
                        `,children:[l.jsx("div",{className:`text-sm ${j?"font-bold text-blue-600":""}`,children:E.getDate()}),l.jsxs("div",{className:"mt-1 space-y-1",children:[z.slice(0,2).map(le=>l.jsxs("div",{className:`text-xs px-1 py-0.5 rounded truncate ${le.aiGenerated?"bg-purple-100 text-purple-700":"bg-primary/20 text-primary"}`,children:[le.aiGenerated&&"🤖 ",le.studentName.split(" ")[0]]},le.id)),z.length>2&&l.jsxs("div",{className:"text-xs text-gray-500",children:["+",z.length-2," daha"]})]})]},M)})})]})}),l.jsxs("div",{className:"space-y-4",children:[l.jsx(QD,{students:t,onSessionsGenerated:B}),l.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[l.jsx("div",{className:"flex items-center justify-between mb-4",children:l.jsxs("h5",{className:"font-semibold flex items-center",children:[l.jsx(zk,{className:"h-4 w-4 mr-2"}),"Yeni Oyun Seansı"]})}),p?l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Çocuk"}),l.jsxs("select",{value:S.studentId,onChange:E=>I(C=>({...C,studentId:E.target.value})),className:"w-full border border-gray-300 rounded-lg px-3 py-2",children:[l.jsx("option",{value:"",children:"Çocuk seçin"}),t.map(E=>l.jsx("option",{value:E.id,children:E.name},E.id))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Oyun Türü"}),l.jsx("select",{value:S.gameType,onChange:E=>I(C=>({...C,gameType:E.target.value})),className:"w-full border border-gray-300 rounded-lg px-3 py-2",children:Object.entries(q).map(([E,C])=>l.jsx("option",{value:E,children:C},E))})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tarih"}),l.jsx("input",{type:"date",value:S.date,onChange:E=>I(C=>({...C,date:E.target.value})),className:"w-full border border-gray-300 rounded-lg px-3 py-2"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Saat"}),l.jsx("input",{type:"time",value:S.time,onChange:E=>I(C=>({...C,time:E.target.value})),className:"w-full border border-gray-300 rounded-lg px-3 py-2"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Süre (dakika)"}),l.jsx("input",{type:"number",min:"5",max:"60",value:S.duration,onChange:E=>I(C=>({...C,duration:Number(E.target.value)})),className:"w-full border border-gray-300 rounded-lg px-3 py-2"})]}),l.jsxs("div",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",id:"reminder",checked:S.reminder,onChange:E=>I(C=>({...C,reminder:E.target.checked})),className:"mr-2"}),l.jsxs("label",{htmlFor:"reminder",className:"text-sm text-gray-700 flex items-center",children:[l.jsx(xg,{className:"h-4 w-4 mr-1"}),"Hatırlatma"]})]}),l.jsxs("div",{className:"flex space-x-2",children:[l.jsx("button",{onClick:K,className:"flex-1 bg-primary text-white py-2 rounded-lg hover:bg-primary/90 transition-colors",children:"Ekle"}),l.jsx("button",{onClick:()=>y(!1),className:"flex-1 bg-gray-300 text-gray-700 py-2 rounded-lg hover:bg-gray-400 transition-colors",children:"İptal"})]})]}):l.jsx("button",{onClick:()=>y(!0),className:"w-full p-3 border-2 border-dashed border-gray-300 rounded-lg text-gray-600 hover:border-primary hover:text-primary transition-colors",children:"+ Oyun Seansı Ekle"})]}),d&&l.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[l.jsxs("h5",{className:"font-semibold mb-3",children:[d.toLocaleDateString("tr-TR")," - Oyun Seansları"]}),P(d).length===0?l.jsx("p",{className:"text-gray-500 text-sm",children:"Bu gün için planlanmış oyun yok"}):l.jsx("div",{className:"space-y-2",children:P(d).map(E=>l.jsxs("div",{className:`flex items-center justify-between p-3 rounded-lg ${E.aiGenerated?"bg-purple-50 border border-purple-200":"bg-gray-50"}`,children:[l.jsxs("div",{className:"flex-1",children:[l.jsxs("div",{className:"font-medium text-sm flex items-center",children:[E.aiGenerated&&l.jsx("span",{className:"text-purple-600 mr-1",children:"🤖"}),E.studentName,E.aiGenerated&&l.jsx("span",{className:"ml-2 text-xs bg-purple-200 text-purple-700 px-2 py-0.5 rounded",children:"AI"})]}),l.jsxs("div",{className:"text-xs text-gray-600",children:[q[E.gameType]," • ",E.date.toLocaleTimeString("tr-TR",{hour:"2-digit",minute:"2-digit"})," • ",E.duration,"dk"]}),E.reminder&&l.jsxs("div",{className:"text-xs text-blue-600 flex items-center mt-1",children:[l.jsx(xg,{className:"h-3 w-3 mr-1"}),"Hatırlatma aktif"]})]}),l.jsx("button",{onClick:()=>U(E.id),className:"text-red-500 hover:text-red-700 p-1",children:l.jsx(ah,{className:"h-4 w-4"})})]},E.id))})]}),l.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-blue-50 border border-green-200 rounded-lg p-4",children:[l.jsx("h5",{className:"font-semibold text-green-800 mb-3",children:"Bu Hafta"}),l.jsxs("div",{className:"space-y-2 text-sm",children:[l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-green-700",children:"Toplam Seans:"}),l.jsx("span",{className:"font-medium",children:v.length})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-green-700",children:"Tamamlanan:"}),l.jsx("span",{className:"font-medium",children:v.filter(E=>E.status==="completed").length})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-green-700",children:"Planlanan:"}),l.jsx("span",{className:"font-medium",children:v.filter(E=>E.status==="planned").length})]})]})]})]})]})})]})})},XD=()=>{const{currentUser:s}=aa(),e=$r(),[t,r]=T.useState([]),[o,c]=T.useState([]),[d,f]=T.useState(!0),[p]=T.useState("connected"),[y,v]=T.useState(!1),[k,S]=T.useState([]),[I,q]=T.useState({weeklyProgress:85,completedActivities:24,averageSuccess:78,aiRecommendations:5}),L=T.useCallback(async()=>{if(s)try{f(!0),console.log("Current User ID:",s.id),console.log("Available mock students:",Dc);const U=Dc.slice(0,2);console.log("Filtered students for user:",U),r(U);const B=GD.filter(ne=>U.some(N=>N.id===ne.studentId));B.sort((ne,N)=>N.createdAt.getTime()-ne.createdAt.getTime()),c(B.slice(0,10));const F=U.reduce((ne,N)=>{const R=vg(N.id);return ne+R.totalGames},0),ae=U.length>0?Math.round(U.reduce((ne,N)=>{const R=vg(N.id);return ne+R.averageScore},0)/U.length):0;q({weeklyProgress:85,completedActivities:F,averageSuccess:ae,aiRecommendations:B.length})}catch(U){console.error("Error loading data:",U)}finally{f(!1)}},[s]);T.useEffect(()=>{s&&L()},[s,L]);const P=U=>{console.log("View student:",U)},K=U=>{S(B=>[...B,...U]),console.log("AI Chat'ten takvim seansları eklendi:",U)};return l.jsxs(l.Fragment,{children:[l.jsx(Wc,{aiStatus:p}),l.jsx("main",{className:"w-full py-3 px-4",children:l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-5 gap-4",children:[l.jsx("div",{className:"xl:col-span-3 bg-gradient-to-br from-blue-600 via-purple-600 to-blue-800 rounded-lg p-4 text-white shadow-lg",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex-1",children:[l.jsxs("h1",{className:"text-2xl font-bold mb-1",children:["Hoş geldiniz, ",s?.name,"! 👋"]}),l.jsx("p",{className:"text-blue-100 text-base mb-3",children:"PeakFocus AI ile çocuğunuzun gelişimini takip edin"}),l.jsxs("div",{className:"flex items-center space-x-3 text-sm",children:[l.jsxs("div",{className:"flex items-center space-x-2 bg-white/10 px-2 py-1 rounded-full",children:[l.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse"}),l.jsx("span",{className:"font-medium",children:"AI Aktif"})]}),l.jsxs("div",{className:"flex items-center space-x-2 bg-white/10 px-2 py-1 rounded-full",children:[l.jsx("div",{className:"w-2 h-2 bg-blue-400 rounded-full"}),l.jsxs("span",{className:"font-medium",children:[t.length," Çocuk"]})]})]})]}),l.jsx("div",{className:"hidden xl:block ml-4",children:l.jsx("div",{className:"w-16 h-16 bg-white/20 rounded-full flex items-center justify-center",children:l.jsx("span",{className:"text-2xl",children:"🧠"})})})]})}),l.jsxs("div",{className:"xl:col-span-2 grid grid-cols-2 xl:grid-cols-1 gap-2",children:[l.jsxs("div",{className:"bg-gradient-to-r from-emerald-500 to-green-500 rounded-lg p-3 text-white hover:shadow-md transition-shadow",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("div",{className:"text-xl font-bold",children:I.completedActivities}),l.jsx("div",{className:"text-xs text-emerald-100",children:"Oyun Seansı"})]}),l.jsx("div",{className:"text-lg",children:"🎯"})]}),l.jsxs("div",{className:"text-xs text-emerald-100 mt-1",children:["Bu hafta +",Math.floor(Math.random()*8)+5]})]}),l.jsxs("div",{className:"bg-gradient-to-r from-amber-500 to-orange-500 rounded-lg p-3 text-white hover:shadow-md transition-shadow",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsxs("div",{className:"text-xl font-bold",children:[I.averageSuccess,"%"]}),l.jsx("div",{className:"text-xs text-amber-100",children:"Başarı Oranı"})]}),l.jsx("div",{className:"text-lg",children:"⭐"})]}),l.jsx("div",{className:"text-xs text-amber-100 mt-1",children:"Hedef: %85"})]})]})]}),l.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-6 gap-4",children:[l.jsx("div",{className:"xl:col-span-3",children:l.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-100 overflow-hidden",children:[l.jsxs("div",{className:"p-4 border-b border-gray-100",children:[l.jsxs("h2",{className:"text-xl font-bold text-gray-800 flex items-center",children:["👥 Çocuklarım",l.jsxs("span",{className:"ml-2 text-xs font-normal text-gray-500 bg-blue-100 text-blue-700 px-2 py-1 rounded-full",children:[t.length," Çocuk"]})]}),l.jsx("p",{className:"text-gray-600 mt-1 text-sm",children:"Çocuklarınızın güncel durumu ve son aktiviteleri"})]}),l.jsx(Gk,{students:t,loading:d,onViewStudent:P})]})}),l.jsx("div",{className:"xl:col-span-2",children:l.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-100 overflow-hidden h-full",children:[l.jsxs("div",{className:"p-4 border-b border-gray-100",children:[l.jsxs("h2",{className:"text-xl font-bold text-gray-800 flex items-center",children:["🤖 AI Öngörüleri",l.jsx("span",{className:"ml-2 text-xs font-normal text-gray-500 bg-green-100 text-green-700 px-2 py-1 rounded-full",children:"Aktif"})]}),l.jsx("p",{className:"text-gray-600 mt-1 text-sm",children:"Gelişim analizi ve öneriler"})]}),l.jsx(KD,{insights:o,loading:d})]})}),l.jsx("div",{className:"xl:col-span-1",children:l.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-100 p-4 sticky top-6",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center",children:"⚡ Hızlı İşlemler"}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("button",{onClick:()=>e("/analytics"),className:"w-full p-3 border border-gray-200 rounded-lg hover:bg-gray-50 hover:border-blue-200 hover:shadow-sm transition-all text-left group",children:[l.jsx("div",{className:"text-blue-600 font-semibold mb-1 group-hover:text-blue-700 text-base",children:"📊"}),l.jsx("div",{className:"text-blue-600 font-medium mb-1 group-hover:text-blue-700 text-sm",children:"Gelişim Analizi"}),l.jsx("div",{className:"text-xs text-gray-600",children:"Detaylı performans grafikleri"})]}),l.jsxs("button",{className:"w-full p-3 border border-gray-200 rounded-lg hover:bg-gray-50 hover:border-orange-200 hover:shadow-sm transition-all text-left group",children:[l.jsx("div",{className:"text-orange-600 font-semibold mb-1 group-hover:text-orange-700 text-base",children:"🎯"}),l.jsx("div",{className:"text-orange-600 font-medium mb-1 group-hover:text-orange-700 text-sm",children:"Oyun Önerileri"}),l.jsx("div",{className:"text-xs text-gray-600",children:"AI destekli kişisel öneriler"})]}),l.jsxs("button",{onClick:()=>v(!0),className:"w-full p-3 border border-gray-200 rounded-lg hover:bg-gray-50 hover:border-purple-200 hover:shadow-sm transition-all text-left group",children:[l.jsx("div",{className:"text-purple-600 font-semibold mb-1 group-hover:text-purple-700 text-base",children:"📅"}),l.jsx("div",{className:"text-purple-600 font-medium mb-1 group-hover:text-purple-700 text-sm",children:"Oyun Takvimi"}),l.jsx("div",{className:"text-xs text-gray-600",children:"Oyun seanslarını planla"})]}),l.jsx("div",{className:"mt-6 pt-4 border-t border-gray-100",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-xs text-gray-600 mb-2 font-medium",children:"Haftalık İlerleme"}),l.jsxs("div",{className:"relative w-20 h-20 mx-auto",children:[l.jsxs("svg",{className:"w-20 h-20 transform -rotate-90",viewBox:"0 0 80 80",children:[l.jsx("circle",{cx:"40",cy:"40",r:"30",stroke:"currentColor",strokeWidth:"6",fill:"transparent",className:"text-gray-200"}),l.jsx("circle",{cx:"40",cy:"40",r:"30",stroke:"currentColor",strokeWidth:"6",fill:"transparent",strokeDasharray:`${2*Math.PI*30}`,strokeDashoffset:`${2*Math.PI*30*(1-I.weeklyProgress/100)}`,className:"text-blue-500",style:{transition:"stroke-dashoffset 0.5s ease-in-out"}})]}),l.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:l.jsxs("span",{className:"text-lg font-bold text-gray-800",children:[I.weeklyProgress,"%"]})})]}),l.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Hedef: %90"})]})})]})]})})]})]})}),l.jsx(YD,{studentName:t.length>0?t[0].name:void 0,students:t.map(U=>({id:U.id,name:U.name})),onScheduleGenerated:K}),l.jsx(Fk,{isOpen:y,onClose:()=>v(!1),students:t.map(U=>({id:U.id,name:U.name})),externalSessions:k})]})};class ZD{async generateAttentionSprint(e){const{performansOzeti:t,studentAge:r,sonGorevler:o=[],forcedDifficulty:c,emotionData:d}=e,f=c||this.determineDifficulty(t);c&&console.log("👤 [USER CHOICE] Kullanıcının seçtiği zorluk kullanılıyor:",c);const p=this.determineTaskVariety(o),y=this.buildAttentionSprintPrompt(t,r,f,p,d);console.log("📝 [AI PROMPT FULL]",{hasEmotionData:!!d,promptLength:y.length,emotionDataLength:d?.length||0,preview:d?`${JSON.parse(d).length} emotions`:"no emotions"}),console.log("📄 [AI PROMPT TEXT]"),console.log("=".repeat(80)),console.log(y),console.log("=".repeat(80));try{console.log("🎯 [ATTENTION SPRINT] Görev üretiliyor:",{difficulty:f,performansOzeti:t});const v=await this.callOllama(y),k=this.parseSprintResponse(v,f);return console.log("✅ [ATTENTION SPRINT] Görev üretildi:",k.gorev),k}catch(v){return console.error("❌ [ATTENTION SPRINT] Görev üretme hatası:",v),this.getFallbackTask(f,r)}}determineDifficulty(e){const{basariOrani:t,odaklanmaDurumu:r,ortalamaReaksiyonSuresi:o,son3Tur:c,sayiGorevPerformansi:d,zamanlamaPerformansi:f}=e,p=c.filter(I=>I.hizliCozum).length,y=c.some(I=>I.hedefTipi==="sayi"),v=c.some(I=>I.hedefZaman!==null),k=f?.ortalamaSapma||0,S=f?.idealZamanlamaOrani||0;if(console.log("📊 [ADAPTIVE DIFFICULTY]",{basariOrani:t,ortalamaReaksiyonSuresi:o,hizliCozumSayisi:p,sayiGoreviVarMi:y,zamanlamaGoreviVarMi:v,ortalamaSapma:k,idealZamanlamaOrani:S,sayiGorevPerformansi:d,zamanlamaPerformansi:f}),console.log("🔍 [DIFFICULTY DEBUG]",{"Test 1 (Süper)":t>=.8&&(p>=2||o<2.5),"Test 2 (İyi)":t>=.7&&(p>=1||o<4),"Test 3 (Yavaş)":t>=.8&&o<6,"Test 4 (Zayıf)":t<.5||o>8,conditions:{"basariOrani >= 0.8":t>=.8,"hizliCozumSayisi >= 2":p>=2,"ortalamaReaksiyonSuresi < 2.5":o<2.5}}),p>=2&&t>=.8&&o<2)return console.log("🚀 [DIFFICULTY] Süper hızlı - 2x atlama!"),"zor";if(d&&y){const I=this.evaluateNumberTaskPerformance(d,c);if(I.zorlukArtisi>1)return console.log(`🔢 [DIFFICULTY] Sayı görevi adaptasyonu: +${I.zorlukArtisi}`),I.onerilen}if(v&&f){if(S>=.8&&k<=.5)return console.log("🎯 [DIFFICULTY] Mükemmel zamanlama (sapma ≤0.5s) - ZOR seviye!"),"zor";if(S>=.6&&k<=1.5)return console.log("⏱️ [DIFFICULTY] İyi zamanlama (sapma ≤1.5s) - ORTA seviye!"),"orta";if(S>=.4&&k<=3)return console.log("⏰ [DIFFICULTY] Orta zamanlama (sapma ≤3s) - KOLAY/ORTA seviye!"),t>=.7?"orta":"kolay";if(k>3)return console.log("❌ [DIFFICULTY] Kötü zamanlama (sapma >3s) - KOLAY seviye!"),"kolay"}return t>=.8&&(p>=2||o<2.5)?(console.log("🔥 [DIFFICULTY] Süper performans - ZOR seviye!"),"zor"):t>=.7&&(p>=1||o<4)?(console.log("⬆️ [DIFFICULTY] İyi performans - ORTA seviye!"),"orta"):t>=.8&&o<6?(console.log("🐌 [DIFFICULTY] Yavaş ama başarılı - ORTA seviye!"),"orta"):t<.5||o>8?(console.log("📉 [DIFFICULTY] Zayıf performans - KOLAY seviye!"),"kolay"):(console.log("🎯 [DIFFICULTY] Varsayılan - ORTA seviye!"),"orta")}determineTaskVariety(e){if(e.length===1){const f=e[0];if(f==="sayma")return console.log("🎨 [VARIETY] Özel istek: Sayma oyunu"),"sayma";if(f==="dinamik-tıklama")return console.log("🎨 [VARIETY] Özel istek: Dinamik tıklama oyunu"),"dinamik-tıklama";if(f==="tıklama"||f==="tek-tıklama")return console.log("🎨 [VARIETY] Özel istek: Normal tıklama oyunu"),"tek-tıklama"}const t=e.map(f=>this.analyzeTaskType(f)),o=["renk-tıklama","şekil-tıklama","sayma","bekleme","kombinasyon","dinamik-sayma","dinamik-tıklama","sayı-tıklama"].map(f=>({tip:f,sayi:t.filter(p=>p===f).length})),c=o.filter(f=>f.sayi===Math.min(...o.map(p=>p.sayi))),d=c[Math.floor(Math.random()*c.length)];return console.log("🎨 [VARIETY] Son görevler:",t,"→ Önerilen tip:",d.tip),d.tip}analyzeTaskType(e){const t=e.toLowerCase();if(t.includes("say")||t.includes("count")||t.includes("adet"))return t.includes("tüm")||t.includes("saniye içinde")?"dinamik-sayma":"sayma";if(t.includes("tüm")&&t.includes("tıkla")&&(t.includes("saniye")||t.includes("dakika")))return"dinamik-tıklama";if(t.includes("bekle")||t.includes("wait")||t.includes("sessiz")||t.includes("dur"))return"bekleme";if(["1","2","3","4","5","6","7","8","9"].some(y=>t.includes(y)&&t.includes("tıkla")))return"sayı-tıklama";const c=["kırmızı","mavi","yeşil","sarı","mor","turuncu"],d=["daire","kare","üçgen","yıldız","kalp","elmas"],f=c.some(y=>t.includes(y)),p=d.some(y=>t.includes(y));return f&&p?"kombinasyon":f?"renk-tıklama":p?"şekil-tıklama":"renk-tıklama"}getTaskExamplesForType(e,t){const r={"renk-tıklama":{kolay:['"🔴 Kırmızı butona 2 saniye sonra bas"','"🔵 Mavi daire görünce hemen tıkla"','"🟢 Yeşil rengi gördüğünde bas"'],orta:['"🔴 3 saniye bekle, sonra kırmızı daire tıkla"','"🔵 Mavi renk çıktığında hızlıca bas"','"🟡 Sarı butonu gördüğün anda tıkla"'],zor:['"🔴 Kırmızı hedef çıktığında 1 saniye içinde bas"','"🔵 Mavi objesi belirdiğinde çok hızlı tıkla"','"🟢 Yeşil hedef görünür görünmez bas"']},"şekil-tıklama":{kolay:['"⭐ Yıldızı gördüğünde tıkla"','"🔺 Üçgen çıktığında bas"','"⭕ Daire görünce hemen tıkla"'],orta:['"⭐ Yıldız belirdiğinde 2 saniye içinde bas"','"🔺 Üçgen hedefe odaklan ve tıkla"','"💎 Elmas şeklini gördüğünde bas"'],zor:['"⭐ Yıldız çıktığında anında tıkla"','"🔺 Üçgen hedefini çok hızlı yakala"','"💎 Elmas görünür görünmez bas"']},sayma:{kolay:['"🔵 Mavi karelerin sayısını bul"','"⭐ Yıldızları say"','"🔴 Kırmızı daireleri hesapla"'],orta:['"🟢 Yeşil üçgenleri dikkatli say"','"🔵 Mavi şekillerin toplam sayısını bul"','"⭐ Sarı yıldızları say ve say"'],zor:['"🔺 Hızlı çıkan kırmızı üçgenleri say"','"🟦 Mavi kareleri çabuk hesapla"','"⭐ Parlayan yıldızları hızla say"']},bekleme:{kolay:['"⏰ 3 saniye sessizce bekle"','"🤫 5 saniye hareketsiz dur"','"⏳ 4 saniye sakin ol"'],orta:['"⏰ 6 saniye bekle, sonra başla"','"🧘 8 saniye nefes al ve bekle"','"⏳ 7 saniye odaklan ve dur"'],zor:['"⏰ 10 saniye tam konsantre bekle"','"🧘 12 saniye hiç hareket etme"','"⏳ 15 saniye mükemmel bekleme"']},kombinasyon:{kolay:['"🔴 Kırmızı daireyi tıkla"','"🔵 Mavi üçgeni bul ve bas"','"🟢 Yeşil kareyi hedefle"'],orta:['"🔴 Kırmızı yıldızı 3 saniye sonra tıkla"','"🔵 Mavi kalbi gördüğünde bas"','"🟡 Sarı elmasını yakala"'],zor:['"🔴 Kırmızı üçgeni çok hızlı yakala"','"🔵 Mavi kareyi anında tıkla"','"🟢 Yeşil yıldızı 1 saniyede bas"']},"dinamik-sayma":{kolay:['"15 saniye içinde çıkan mavi daireleri say"','"20 saniye boyunca gelen yıldızları hesapla"','"12 saniye içinde beliren şekilleri say"'],orta:['"25 saniye içinde gelen kırmızı üçgenleri say"','"30 saniye boyunca çıkan mavi kareleri hesapla"','"20 saniye içinde beliren yeşil daireleri say"'],zor:['"35 saniye içinde hızlı çıkan hedefleri say"','"40 saniye boyunca değişken objeleri hesapla"','"30 saniye içinde karışık şekilleri say"']},"dinamik-tıklama":{kolay:['"20 saniye içinde tüm 🔵 mavi daireleri tıkla"','"25 saniye içinde tüm 🟡 sarı yıldızları tıkla"','"15 saniye içinde tüm 🟢 yeşil kareleri tıkla"'],orta:['"35 saniye içinde tüm 🔺 kırmızı üçgenleri tıkla"','"40 saniye içinde tüm 🟦 mavi kareleri tıkla"','"30 saniye içinde tüm 🟢 yeşil daireleri tıkla"'],zor:['"50 saniye içinde tüm 🔺 kırmızı üçgenleri tıkla"','"60 saniye içinde tüm 🟡 sarı yıldızları tıkla"','"45 saniye içinde tüm 💜 mor kalpleri tıkla"']},"sayı-tıklama":{kolay:['"3️⃣ 3 sayısını gördüğünde tıkla"','"5️⃣ 5 rakamına bas"','"2️⃣ 2 sayısını yakala"'],orta:['"7️⃣ 7 rakamını 2 saniye sonra tıkla"','"4️⃣ 4 sayısını hızlıca yakala"','"6️⃣ 6 rakamını gördüğünde bas"'],zor:['"9️⃣ 9 sayısını çok hızlı yakala"','"8️⃣ 8 rakamını anında tıkla"','"1️⃣ 1 sayısını görür görmez bas"']}};return(r[e]?.[t]||r["renk-tıklama"][t]).join(`
`)}buildAttentionSprintPrompt(e,t,r,o,c){const d=this.formatPerformanceForPrompt(e);this.getTaskExamplesForType(o,r);const f=e.son3Tur&&e.son3Tur.length>0?`
SON GÖREVLER (BUNLARI TEKRAR ETME): ${e.son3Tur.map(y=>`"${y.hedefTipi||"bilinmiyor"} görev"`).join(", ")}`:"",p=`12 yaş ADHD çocuk için görev üret. SADECE JSON döndür.

TİP: ${o}
ZORLUK: ${r}${f}

${c?`EMOTION DATA: ${c}

EMOTION'A GÖRE gameParams AYARLA - ZORUNLU:
- happy/excited → ZORLAYICI: spawnInterval: 1500-2000, targetRatio: 0.3-0.4, visualComplexity: 0.8-1.0
- confused/tired → BASIT: spawnInterval: 3500-4000, targetRatio: 0.7-0.8, objectLifespan: 7000-8000
- focused → DENGELI: spawnInterval: 2500, targetRatio: 0.5, visualComplexity: 0.6
- sad/stressed → SAKİNLEŞTİRİCİ: objectLifespan: 6000-8000, feedbackFrequency: 2.5-3.0, spawnInterval: 3000
- angry/frustrated → YAVAŞ: spawnInterval: 3000-3500, targetRatio: 0.6-0.7, feedbackFrequency: 2.0

MUTLAKA emotion'a uygun değerler seç!`:""}

PERFORMANS'A GÖRE DE gameParams AYARLA:
- Başarı oranı ≥80% + Hızlı reaksiyon (<2s) → ZORLAŞTIR: spawnInterval: 1500-2000, targetRatio: 0.3-0.4, visualComplexity: 0.8-1.0
- Başarı oranı ≥70% + Orta reaksiyon (2-4s) → ORTA: spawnInterval: 2000-2500, targetRatio: 0.4-0.6, visualComplexity: 0.6-0.7
- Başarı oranı <50% + Yavaş reaksiyon (>4s) → KOLAYLAŞTIR: spawnInterval: 3000-4000, targetRatio: 0.6-0.8, objectLifespan: 6000-8000
- İlk görev → BAŞLANGIÇ: spawnInterval: 2500, targetRatio: 0.5, objectLifespan: 5000, visualComplexity: 0.5

KOMBINASYON KURALLAR:
- Emotion + Performans = Birleşik karar
- Kötü performans + stres = Çok basit yap
- İyi performans + mutluluk = Çok zorlaştır

MEVCUT PERFORMANS VERİLERİ:
${d}

ÇEŞİTLİLİK ZORUNLU:
- RENK SEÇENEKLERİ: kırmızı, mavi, yeşil, sarı, mor, turuncu
- ŞEKİL SEÇENEKLERİ: daire, kare, üçgen, yıldız, kalp, elmas
- HER SEFERINDE FARKLI RENK/ŞEKİL KOMBINASYONU SEÇ
- ÖNCEKI GÖREVLERLE AYNI OLMASIN
- gameParams'ı emotion'a göre ayarla

KURALLAR:
- 30-60 saniye
- Tek odak
- Basit komut
- Renkli emojiler
${o==="sayma"?"- SADECE SAYMA! tıklama yok.":""}
- MUTLAKA farklı renk/şekil kullan

${e.attentionMetrics?`PERF: Dikkat ${e.attentionMetrics.attentionScore.toFixed(0)}/100, Ekran %${e.attentionMetrics.screenLookingPercentage.toFixed(0)}`:""}

SADECE GEÇERLI JSON DÖNDÜR - COMMENT YOK!
ÖRNEK FORMAT:
{
  "gorev": "🟢 Yeşil üçgenleri say",
  "sure_saniye": 45,
  "hedefRenk": "yeşil",
  "hedefSekil": "üçgen",
  "dikkatDagitici": 0.4,
  "gameParams": {
    "spawnInterval": 2500,
    "objectLifespan": 4500,
    "targetRatio": 0.6,
    "visualComplexity": 0.5,
    "feedbackFrequency": 1.2
  }
}

FARKLI RENK/ŞEKİL KOMBİNASYONLARI KULLAN:
- 🔴🔵🟢🟡🟠🟣 (kırmızı, mavi, yeşil, sarı, turuncu, mor)
- ⚪🟤⚫ (beyaz, kahverengi, siyah)
- 🔴 + daire = 🔴, mavi + üçgen = 🔹, yeşil + kare = 🟩

12 YAŞ İÇİN GÖREV ÖRNEKLERİ (ÖNERİLEN TİP: ${o}):
${o==="sayma"?`- "🟣 Mor yıldızları say"
- "🟠 Turuncu kareleri hesapla"
- "🔹 Mavi üçgenleri bul"
- "🟤 Kahverengi daireleri say"`:o==="tek-tıklama"?`- "🟣 Mor kalp çıktığında tıkla"
- "🟠 Turuncu elmas belirdiğinde bas"
- "🔹 Mavi üçgen gördüğünde tıkla"
- "🟤 Kahverengi yıldız görünce bas"`:o==="dinamik-tıklama"?`- "40 saniye içinde tüm 🟣 mor yıldızları tıkla"
- "35 saniye içinde tüm 🟠 turuncu kalpleri yakala"
- "45 saniye içinde tüm 🔹 mavi üçgenleri tıkla"`:`- "🟣 Mor butona 3 saniye sonra bas"
- "🟠 Turuncu şekiller sayısını bul"
- "🔹 Mavi ⭐ elmasları takip et"
- "⏰ 6 saniye sessizce bekle"`}

ÇEŞİTLİLİK ZORUNLU KURALLAR:
- Her görevde FARKLI renk/şekil kombinasyonu kullan
- Aynı renk/şekil tekrarını ENGELLE
- MUTLAKA yeni renk seç: mor, turuncu, kahverengi, beyaz dahil
- gameParams'ı emotion'a göre ayarla

YAPMA:
- Aynı renk/şekil kombinasyonları
- Uzun açıklamalar
- Karmaşık çoklu adımlar
- Olumsuz kelimeler

${o==="dinamik-tıklama"?`ZORUNLU KURALLAR DİNAMİK TIKLAMA İÇİN:
- Süre MUTLAKA belirt: "30 saniye içinde" formatında
- FARKLI renk/şekil kullan: 🟣 mor, 🟠 turuncu, 🔹 mavi üçgen
- Şekil MUTLAKA spesifik: daire, kare, üçgen, yıldız, kalp, elmas
- Örnek: "45 saniye içinde tüm 🟣 mor yıldızları tıkla"
- "hedefRenk" ve "hedefSekil" alanları MUTLAKA doldur`:""}

${o==="sayma"?`ZORUNLU KURALLAR SAYMA GÖREVLERİ İÇİN:
- Sadece "say", "hesapla", "bul" eylemleri kullan
- "tıkla", "bas", "yakala" gibi eylemler YASAKta
- FARKLI renk/şekil kullan: 🟣 mor, 🟠 turuncu, 🔹 mavi üçgen
- Şekil MUTLAKA spesifik: daire, kare, üçgen, yıldız, kalp, elmas
- Örnek: "🟣 Mor kalpleri say"
- "hedefRenk" ve "hedefSekil" alanları MUTLAKA doldur`:""}`;return console.log("🤖 [AI PROMPT] ============================================================================="),console.log(p),console.log("🤖 [AI PROMPT END] ========================================================================"),p}formatPerformanceForPrompt(e){const{son3Tur:t,basariOrani:r,ortalamaReaksiyonSuresi:o,odaklanmaDurumu:c,sayiGorevPerformansi:d}=e,f=t.map((y,v)=>`Tur ${v+1}: ${y.basari?"Başarılı":"Başarısız"} - ${y.sure}s - ${y.zorluk}`).join(`
`);let p="";return d&&d.hedefYakalamaOrani!==void 0&&d.toplamHedefSayisi!==void 0&&(p=`

HEDEF YAKALAMA METRİKLERİ:
- Hedef Yakalama Oranı: ${Math.round((d.hedefYakalamaOrani||0)*100)}%
- Yakalanan Hedefler: ${d.yakalinanHedefSayisi||0}/${d.toplamHedefSayisi||0}
- Yanlış Tıklamalar: ${d.yanlisTiklamaSayisi||0}

HIZLI TIKLAMA ANALİZİ (ADHD İÇİN ÖNEMLİ) - KÜMÜLATIF PERFORMANS:
- Genel Hızlı Tıklama Oranı: ${d.hizliTiklamaOrani?Math.round(d.hizliTiklamaOrani*100):0}% (3 saniye altı)
- Toplam Hızlı Tıklamalar: ${d.hizliTiklamaSayisi||0}/${d.toplamTiklamaSayisi||0}
- Toplam Hızlı+Doğru Tıklamalar: ${d.hizliVeDogruTiklamalar||0}
- Genel Hızlı Tıklama Doğruluğu: ${d.hizliTiklamaDogrulukOrani?Math.round(d.hizliTiklamaDogrulukOrani*100):0}%

SON ROUND HIZLI TIKLAMA PERFORMANSI:
- Son Round Hızlı Tıklama Oranı: ${d.sonRoundHizliTiklamaOrani?Math.round(d.sonRoundHizliTiklamaOrani*100):0}%
- Son Round Hızlı Tıklamalar: ${d.sonRoundHizliTiklamaSayisi||0}/${d.sonRoundToplamTiklamaSayisi||0}
- Son Round Hızlı+Doğru: ${d.sonRoundHizliVeDogruTiklamalar||0}
- Son Round Hızlı Tıklama Doğruluğu: ${d.sonRoundHizliTiklamaDogrulukOrani?Math.round(d.sonRoundHizliTiklamaDogrulukOrani*100):0}%`),`Son 3 Tur:
${f}

Genel Durum:
- Başarı Oranı: ${Math.round(r*100)}%
- Ortalama Reaksiyon: ${o.toFixed(1)}s
- Odaklanma: ${c}${p}`}async callOllama(e){const o=await fetch("/ollama/generate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:"gemma2:2b",prompt:e,format:"json",stream:!1,options:{temperature:.7,top_p:.9,num_predict:250}})});if(!o.ok)throw new Error(`Ollama API hatası: ${o.status}`);return(await o.json()).response?.trim()||""}parseSprintResponse(e,t){try{console.log("🔍 [SPRINT PARSE] Ham yanıt:",e);let r=e.trim();r=r.replace(/```json\s*/g,""),r=r.replace(/```[\s\S]*$/g,""),r=r.replace(/\/\/.*$/gm,""),r=r.replace(/\/\*[\s\S]*?\*\//g,"");const o=r.indexOf("{"),c=r.lastIndexOf("}");if(o===-1||c===-1)throw new Error("JSON bulunamadı");let d=r.substring(o,c+1);d=d.replace(/,(\s*[}\]])/g,"$1"),console.log("🧹 [SPRINT PARSE] Temizlenmiş JSON:",d);const f=JSON.parse(d);if(!f.gorev||typeof f.gorev!="string")throw new Error("Geçersiz görev");const p={id:`sprint_${Date.now()}_${Math.random().toString(36).substr(2,6)}`,gorev:f.gorev,sure_saniye:Math.max(30,Math.min(60,f.sure_saniye||45)),ipuclari:Array.isArray(f.ipuclari)?f.ipuclari.slice(0,2):[],hedefRenk:f.hedefRenk||void 0,hedefSayi:f.hedefSayi||void 0,hedefSekil:f.hedefSekil||void 0,dikkatDagitici:Math.max(0,Math.min(1,f.dikkatDagitici||0)),difficulty:t,hedefTipi:this.determineTargetType(f)},y=this.validateAndCorrectTask(p);return console.log("🔍 [AI TASK] Orijinal görev:",f),console.log("✅ [AI TASK] Düzeltilmiş görev:",y),y}catch(r){throw console.error("❌ [SPRINT PARSE] Parse hatası:",r),console.error("❌ [SPRINT PARSE] Ham response:",e),new Error(`JSON parse hatası: ${r}`)}}getFallbackTask(e,t){const o={kolay:[{gorev:"🔴 Kırmızı butona bas",sure_saniye:30,ipuclari:["Kırmızı rengi ara","Büyük buton olacak"],hedefRenk:"kırmızı",dikkatDagitici:0},{gorev:"⭐ Yıldızları say",sure_saniye:35,ipuclari:["Sarı yıldızları bul","Parmakla işaret et"],hedefSekil:"yıldız",dikkatDagitici:0}],orta:[{gorev:"🟢 Yeşil kareler sayısını bul",sure_saniye:45,ipuclari:["Sadece yeşil olanlar","Sessizce say"],hedefRenk:"yeşil",hedefSekil:"kare",dikkatDagitici:.3},{gorev:"🎯 Ortadaki hedefe 3 saniye odaklan",sure_saniye:40,ipuclari:["Gözlerini hedeften ayırma","Nefes al"],dikkatDagitici:.5}],zor:[{gorev:"🔵 Mavi daireler gözükünce hızla tıkla",sure_saniye:50,ipuclari:["Hazır ol","Hızlı reaksiyon göster"],hedefRenk:"mavi",hedefSekil:"daire",dikkatDagitici:.7},{gorev:"🟡⭐ Sarı yıldızları takip et ve say",sure_saniye:55,ipuclari:["Hareket eden yıldızları takip et","Sayıyı unutma"],hedefRenk:"sarı",hedefSekil:"yıldız",dikkatDagitici:.8}]}[e],c=o[Math.floor(Math.random()*o.length)];return{id:`fallback_sprint_${Date.now()}`,...c,difficulty:e,hedefTipi:c.hedefRenk?"renk":c.hedefSekil?"sekil":c.hedefSayi?"sayi":"genel"}}determineTargetType(e){return e.hedefRenk&&e.hedefSekil||e.hedefRenk?"renk":e.hedefSekil?"sekil":e.hedefSayi?"sayi":"genel"}validateAndCorrectTask(e){const t=e.gorev.toLowerCase(),r=["kırmızı","mavi","yeşil","sarı","mor","turuncu"].find(f=>t.includes(f)),o=["yıldız","daire","kare","üçgen","kalp","elmas"].find(f=>t.includes(f));let c=null;if(t.includes("tane")||t.includes("adet")||t.includes("say")){const f=t.match(/(\d+)\s*(tane|adet|say)/);c=f?parseInt(f[1]):null}else if(t.includes("numar")||t.includes("rakam")){const f=t.match(/(\d+)\s*(numar|rakam)/);c=f?parseInt(f[1]):null}console.log("🔍 [TEXT ANALYSIS]",{görev:e.gorev,detectedColors:r,detectedShapes:o,detectedNumbers:c,originalTask:{hedefRenk:e.hedefRenk,hedefSekil:e.hedefSekil,hedefSayi:e.hedefSayi}});const d={...e};return r&&o?(console.log(`🔧 [TASK FIX] Karma hedef: ${r} ${o}`),d.hedefRenk=r,d.hedefSekil=o,d.hedefSayi=void 0,d.gorev=d.gorev.replace(/(\d+)\s*(tane|adet)/g,"").replace(/\s+/g," ").trim()):r&&!o?(console.log(`🔧 [TASK FIX] Sadece renk: ${r}`),d.hedefRenk=r,d.hedefSekil=void 0,d.hedefSayi=void 0,d.gorev=d.gorev.replace(/(\d+)\s*(tane|adet)/g,"").replace(/\s+/g," ").trim()):o&&!r&&(console.log(`🔧 [TASK FIX] Sadece şekil: ${o}`),d.hedefSekil=o,d.hedefRenk=void 0,d.hedefSayi=void 0,d.gorev=d.gorev.replace(/(\d+)\s*(tane|adet)/g,"").replace(/\s+/g," ").trim()),c&&(!e.hedefSayi||e.hedefSayi!==c)?(console.log(`🔧 [TASK FIX] Sayı düzeltmesi: ${e.hedefSayi} → ${c}`),d.hedefSayi=c,d.hedefRenk=void 0,d.hedefSekil=void 0):e.hedefSayi&&!c&&(r||o)&&(console.log(`🔧 [TASK FIX] Yanlış sayı temizleme: hedefSayi ${e.hedefSayi} silindi`),d.hedefSayi=void 0,d.gorev=d.gorev.replace(/(\d+)\s*(tane|adet)/g,"").replace(/\s+/g," ").trim()),d}evaluateNumberTaskPerformance(e,t){const{ortalamaSayiZorlugu:r,sayiBasariOrani:o,ortalamaReaksiyonSuresiSayi:c,hizliCozumSayisi:d}=e,f=t.filter(v=>v.hedefTipi==="sayi");f[f.length-1];let p=0,y="orta";return d>=2&&c<2?(p=3,y="zor"):o>=.8&&c<4?(p=2,y=r<5?"orta":"zor"):o>=.6&&c<6?(p=1,y="orta"):(o<.5||c>8)&&(p=-1,y="kolay"),{zorlukArtisi:p,onerilen:y}}determineNumberDifficulty(e,t,r){const c=Math.max(1,Math.min(3,(e==="kolay"?1:e==="orta"?2:3)+r)),d={1:{min:1,max:3},2:{min:2,max:5},3:{min:3,max:7},4:{min:5,max:9}};return d[Math.min(4,c)]||d[2]}}const _g=new ZD;class WD{constructor(){this.emotions=[],this.gameStartTime=0,this.lastAnalysisTime=0,this.currentGameSession=[],this.currentRoundSession=[],this.isGameActive=!1,this.roundStartTime=0}startGameSession(){this.gameStartTime=Date.now(),this.currentGameSession=[],this.lastAnalysisTime=this.gameStartTime,this.isGameActive=!0,console.log("🎮 [EMOTION] Oyun seansı başladı, emotion tracking aktif")}startRoundSession(){this.roundStartTime=Date.now(),this.currentRoundSession=[],console.log("🔄 [EMOTION] Round seansı başladı, round emotion tracking aktif")}addEmotionResult(e){if(!this.isGameActive){console.log("⏸️ [EMOTION] Oyun aktif değil, emotion kaydedilmiyor");return}this.emotions.push(e),this.currentGameSession.push(e),this.currentRoundSession.push(e),console.log("📥 [EMOTION ADDED]",{emotion:e.emotion,confidence:(e.confidence*100).toFixed(1)+"%",gazeStatus:e.gazeStatus,lookingAtScreen:e.lookingAtScreen,gameActive:this.isGameActive,gameTotal:this.currentGameSession.length,roundTotal:this.currentRoundSession.length,timestamp:new Date(e.timestamp).toLocaleTimeString()});const t=this.currentRoundSession[this.currentRoundSession.length-2];(!t||t.emotion!==e.emotion)&&console.log(`😊 [EMOTION] ${e.emotion} (${(e.confidence*100).toFixed(1)}%) - ${e.gazeStatus} [Round: ${this.currentRoundSession.length}]`)}getCurrentGameMetrics(){if(this.currentGameSession.length===0)return this.getEmptyMetrics();const e=(Date.now()-this.gameStartTime)/1e3,t=this.groupEmotionsByType(this.currentGameSession),r=this.currentGameSession.filter(v=>v.lookingAtScreen),o=e/this.currentGameSession.length,c=r.length*o,d=c/e*100;console.log("👁️ [SCREEN LOOKING DEBUG]",{totalEmotions:this.currentGameSession.length,lookingEmotions:r.length,totalGameTime:e.toFixed(1)+"s",avgEmotionDuration:o.toFixed(1)+"s",screenLookingTime:c.toFixed(1)+"s",screenLookingPercentage:d.toFixed(1)+"%",calculationCheck:`${r.length}/${this.currentGameSession.length} = ${(r.length/this.currentGameSession.length*100).toFixed(1)}%`,sampleEmotions:this.currentGameSession.slice(-3).map(v=>({emotion:v.emotion,lookingAtScreen:v.lookingAtScreen,timestamp:new Date(v.timestamp).toLocaleTimeString()}))});const f=this.getDominantEmotion(t),p=this.calculateAttentionScore(d,f,this.countDistractionEvents());return{totalGameTime:e,screenLookingTime:c,screenLookingPercentage:d,emotionStats:this.formatEmotionStats(t,e),dominantEmotion:f,attentionScore:p,distractionEvents:this.countDistractionEvents()}}endGameSession(){const e=this.getCurrentGameMetrics();return this.isGameActive=!1,console.log("🏁 [EMOTION] Oyun seansı bitti",{totalTime:`${e.totalGameTime.toFixed(1)}s`,attentionScore:e.attentionScore,dominantEmotion:e.dominantEmotion,totalEmotions:this.currentGameSession.length}),e}groupEmotionsByType(e){return e.reduce((t,r)=>(t[r.emotion]||(t[r.emotion]=[]),t[r.emotion].push(r),t),{})}getDominantEmotion(e){let t=0,r="neutral";for(const[o,c]of Object.entries(e))c.length>t&&(t=c.length,r=o);return r}calculateAttentionScore(e,t,r){let o=0;o+=Math.min(e*.5,50),o+={focused:30,happy:28,neutral:25,surprised:20,confused:15,bored:10,sad:5,angry:0}[t]||15;const d=Math.min(r*2,20);return o-=d,Math.max(0,Math.min(100,o))}countDistractionEvents(){let e=0,t=!0;for(const r of this.currentGameSession)t&&!r.lookingAtScreen&&e++,t=r.lookingAtScreen;return e}formatEmotionStats(e,t){const r=Object.values(e).reduce((o,c)=>o+c.length,0);return Object.entries(e).map(([o,c])=>{const d=c.length/r*100,f=c.filter(y=>y.lookingAtScreen),p=c.length>0?f.length/c.length*100:0;return{emotion:o,totalTime:c.length,lookingTime:f.length,percentage:d,lookingPercentage:p}}).sort((o,c)=>c.totalTime-o.totalTime)}getEmptyMetrics(){return{totalGameTime:0,screenLookingTime:0,screenLookingPercentage:0,emotionStats:[],dominantEmotion:"neutral",attentionScore:50,distractionEvents:0}}clearHistory(){this.emotions=[],this.currentGameSession=[],console.log("🗑️ [EMOTION] Emotion history temizlendi")}isGameActiveStatus(){return this.isGameActive}getCurrentRoundEmotions(){return[...this.currentRoundSession]}getFullGameEmotions(){return[...this.currentGameSession]}endRoundSession(){const e=[...this.currentRoundSession];return console.log("🏁 [EMOTION] Round seansı bitti",{roundEmotions:e.length,totalGameEmotions:this.currentGameSession.length,roundDuration:this.roundStartTime?`${((Date.now()-this.roundStartTime)/1e3).toFixed(1)}s`:"N/A"}),e}getRecentEmotionTrend(){const e=this.currentGameSession.slice(-10);if(e.length===0)return{emotion:"neutral",confidence:.5,lookingAtScreen:!0};const t={};let r=0,o=0;for(const d of e)t[d.emotion]=(t[d.emotion]||0)+1,d.lookingAtScreen&&r++,o+=d.confidence;return{emotion:Object.entries(t).sort(([,d],[,f])=>f-d)[0][0],confidence:o/e.length,lookingAtScreen:r/e.length>.5}}}const We=new WD;class JD{constructor(){this.performanceHistory=[],this.baseSettings={kolay:{speed:.8,objectCount:3,duration:20},orta:{speed:1,objectCount:4,duration:30},zor:{speed:1.5,objectCount:6,duration:40}}}calculateDifficultyAdjustment(e,t){console.log("🎯 [ADAPTIVE] Zorluk analizi başlıyor...",{currentDifficulty:e,accuracy:t.accuracy,attentionScore:t.attentionMetrics.attentionScore});const r=this.analyzeEmotionState(t.attentionMetrics),o=this.analyzeGamePerformance(t),c=this.analyzeAttentionLevel(t.attentionMetrics),d=this.calculateAdjustment(e,r,o,c);return this.performanceHistory.push(t),this.performanceHistory.length>5&&this.performanceHistory.shift(),console.log("✅ [ADAPTIVE] Zorluk ayarlaması tamamlandı:",{newDifficulty:d.newDifficulty,reason:d.reason,speedMultiplier:d.speedMultiplier}),d}analyzeEmotionState(e){const{dominantEmotion:t,attentionScore:r}=e;let o=0,c="neutral";o={happy:10,surprised:8,neutral:6,confused:4,bored:2,sad:1,angry:0}[t]||5,o>=8?c="positive":o>=4?c="neutral":c="negative";let f="maintain";return c==="positive"&&r>70?f="increase":c==="negative"||r<30?f="decrease":t==="bored"&&r>50&&(f="increase"),{score:o,type:c,recommendation:f}}analyzeGamePerformance(e){const{accuracy:t,avgReactionTime:r}=e;let o="average",c="maintain";return t>.8&&r<1.5?(o="excellent",c="increase"):t>.6&&r<2?(o="good",c="maintain"):t>.4||r<3?(o="average",c="maintain"):(o="poor",c="decrease"),{level:o,recommendation:c}}analyzeAttentionLevel(e){const{screenLookingPercentage:t,distractionEvents:r,attentionScore:o}=e;let c="medium",d="maintain";return t>80&&r<3&&o>70?(c="high",d="increase"):t>60&&r<5&&o>50?(c="medium",d="maintain"):(c="low",d="decrease"),{level:c,recommendation:d}}calculateAdjustment(e,t,r,o){const c=[t.recommendation,r.recommendation,o.recommendation],d=c.filter(q=>q==="increase").length,f=c.filter(q=>q==="decrease").length;let p=e,y="",v=[];d>=2?(e==="kolay"?p="orta":e==="orta"&&(p="zor"),y="Performansın mükemmel! Daha zorlu görevler deniyoruz 🎯",v=["Harika gidiyorsun! 🌟","Dikkatini toplamayı başarıyorsun","Daha hızlı objeler gelecek"]):f>=2?(e==="zor"?p="orta":e==="orta"&&(p="kolay"),y="Odaklanma konusunda zorluk yaşıyorsun. Daha kolay görevlerle devam edelim 💪",v=["Merak etme, adım adım öğreniyoruz","Nefes al ve odaklanmaya çalış","Objeler daha yavaş gelecek"]):(y="Performansın dengeli, mevcut zorlukta devam ediyoruz 👍",v=["İyi gidiyorsun!","Bu tempoda devam et","Dikkatini korumaya çalış"]);const k=this.baseSettings[p];let S=k.speed,I=k.objectCount;return t.type==="negative"?(S*=.8,I=Math.max(2,I-1)):t.type==="positive"&&o.level==="high"&&(S*=1.2,I=Math.min(8,I+1)),o.level==="low"&&(S*=.7,I=Math.max(2,I-1)),{newDifficulty:p,speedMultiplier:Number(S.toFixed(1)),objectCount:I,reason:y,suggestions:v}}formatForPrompt(e,t){const r=e.attentionMetrics;return`
DUYGU VE DİKKAT ANALİZİ:
- Baskın Duygu: ${r.dominantEmotion} (${r.emotionStats[0]?.percentage.toFixed(1)||"0"}% süre)
- Ekrana Bakma: %${r.screenLookingPercentage.toFixed(1)} (${r.screenLookingTime.toFixed(1)}s)
- Dikkat Skoru: ${r.attentionScore}/100
- Dikkat Dağılması: ${r.distractionEvents} kez ekrandan baktı
- Oyun Performansı: %${(e.accuracy*100).toFixed(1)} doğruluk, ${e.avgReactionTime.toFixed(1)}s ortalama tepki

ZORLUK AYARLAMA:
- Mevcut Zorluk → Yeni Zorluk: ${t.newDifficulty}
- Hız Çarpanı: ${t.speedMultiplier}x
- Sebep: ${t.reason}

ADHD İÇİN ÖPTİMİZASYON GEREKSİNİMLERİ:
${this.getADHDOptimizations(r,e)}`}getADHDOptimizations(e,t){const r=[];return e.screenLookingPercentage<60&&(r.push("- DİKKAT: Çok dikkat dağınıklığı var, daha büyük ve renkli objeler kullan"),r.push("- Görevde daha açık talimatlar ve görsel ipuçları ekle")),e.dominantEmotion==="bored"&&(r.push("- SIKINTI: Oyuncu sıkılmış, daha eğlenceli ve değişken görevler sun"),r.push("- Motivasyon artırıcı pozitif geri bildirimler kullan")),e.dominantEmotion==="confused"&&(r.push("- KARIŞIKLIK: Görevler karmaşık gelmiş, daha basit ve net talimatlar ver"),r.push("- Adım adım açıklamalar ve örnek göster")),t.accuracy<.5&&(r.push("- PERFORMANS: Başarı oranı düşük, daha kolay hedefler ve daha uzun süre ver"),r.push("- Pozitif teşvik ve cesaretlendirme mesajları ekle")),e.distractionEvents>5&&(r.push("- DİKKAT DAĞINIKLIGI: Çok sık ekrandan bakıyor, daha ilgi çekici görevler tasarla"),r.push("- Kısa süreli görevler ve sık ara verme imkanı sun")),r.length>0?r.join(`
`):"- Mevcut ayarlar ADHD için uygun görünüyor"}getRealtimeFeedback(e){return e.screenLookingPercentage<40?{message:"Ekrana odaklanmaya çalış! 👀",type:"warning",suggestion:"Gözlerini ekrandaki renklere odakla"}:e.dominantEmotion==="bored"?{message:"Sıkılıyor gibisin, devam et! 🎯",type:"info",suggestion:"Bu görev bittikten sonra daha eğlenceli bir görev gelecek"}:e.attentionScore>70?{message:"Harika odaklanıyorsun! 🌟",type:"success",suggestion:"Bu tempoda devam et"}:{message:"İyi gidiyorsun! 👍",type:"info",suggestion:"Dikkatini korumaya devam et"}}}const qk=new JD;class e4{constructor(){this.isActive=!1,this.isAnalysisActive=!1,this.pythonServerUrl="/api",this.pollInterval=null,this.videoRef=null,this.lastAnalysisTime=0,this.ANALYSIS_INTERVAL=3e3}async checkCameraAvailability(){try{return(await navigator.mediaDevices.getUserMedia({video:!0})).getTracks().forEach(t=>t.stop()),!0}catch(e){return console.log("📷 [CAMERA] Kamera erişimi yok:",e),!1}}async checkPythonServer(){try{const e=`${this.pythonServerUrl}/health`;return(await fetch(e,{method:"GET",timeout:2e3})).ok}catch{return!1}}async startEmotionTracking(e,t){if(console.log("🎭 [EMOTION] Real-time tracking başlatılıyor..."),!await this.checkCameraAvailability())return console.log("❌ [EMOTION] Kamera erişimi yok, mock mode kullanılacak"),!1;if(!await this.checkPythonServer())return console.log("❌ [EMOTION] Python server çalışmıyor, mock mode kullanılacak"),!1;try{const c=await navigator.mediaDevices.getUserMedia({video:{width:640,height:480,facingMode:"user"}});return e.srcObject=c,await e.play(),this.onEmotionCallback=t,this.isActive=!0,this.pollInterval=setInterval(()=>{this.captureAndAnalyzeFrame(e)},1e3),console.log("✅ [EMOTION] Real-time kamera tracking aktif"),!0}catch(c){return console.error("❌ [EMOTION] Kamera başlatma hatası:",c),!1}}async captureAndAnalyzeFrame(e){if(!this.isActive||!this.isAnalysisActive)return;if(!We.isGameActiveStatus()){console.log("⏸️ [CAMERA FRAME] Oyun aktif değil, frame analizi atlanıyor");return}const t=Date.now();if(this.lastAnalysisTime>0&&t-this.lastAnalysisTime<this.ANALYSIS_INTERVAL){console.log("⏱️ [TIMING] Analiz çok erken, atlanıyor",{timeSinceLastAnalysis:`${t-this.lastAnalysisTime}ms`,required:`${this.ANALYSIS_INTERVAL}ms`});return}this.lastAnalysisTime=t;try{const r=document.createElement("canvas");r.width=640,r.height=480;const o=r.getContext("2d");if(!o)return;o.drawImage(e,0,0,r.width,r.height);const c=r.toDataURL("image/jpeg",.8),d=await fetch(`${this.pythonServerUrl}/analyze_frame`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({frame:c.split(",")[1]})});if(d.ok){const f=await d.json(),p=this.convertToEmotionResult(f);console.log("✅ [FRAME ANALYSIS] Analiz tamamlandı",{emotion:p.emotion,confidence:`${(p.confidence*100).toFixed(1)}%`,gaze:p.gazeStatus,timeSinceLastAnalysis:`${Date.now()-this.lastAnalysisTime}ms`}),this.onEmotionCallback&&this.onEmotionCallback(p)}}catch(r){console.log("🔍 [FRAME] Frame analiz hatası:",r)}}async pollEmotionData(){if(this.isActive)try{const e=await fetch(`${this.pythonServerUrl}/emotion_data`,{method:"GET",headers:{"Content-Type":"application/json"}});if(e.ok){const t=await e.json(),r=this.convertToEmotionResult(t);this.onEmotionCallback&&this.onEmotionCallback(r)}}catch{}}convertToEmotionResult(e){const r={happy:"happy",sad:"sad",bored:"bored",confused:"confused",surprised:"surprised",angry:"angry",neutral:"neutral",focused:"focused",frustrated:"angry"}[e.emotion]||"neutral";let o="no-face";const c=e.lookingAtScreen||e.looking_at_screen||!1;return e.faceDetected&&(o=c?"looking":"not-looking"),console.log("🔍 [GAZE MAPPING DEBUG]",{faceDetected:e.faceDetected,lookingAtScreen_snake:e.looking_at_screen,lookingAtScreen_camel:e.lookingAtScreen,finalLookingAtScreen:c,gazeStatus:o}),{emotion:r,confidence:e.confidence,timestamp:new Date,gazeStatus:o,gazeX:e.gaze_x,lookingAtScreen:c}}stopEmotionTracking(){console.log("⏹️ [EMOTION] Real-time tracking durduruluyor..."),this.isActive=!1,this.isAnalysisActive=!1,this.pollInterval&&(clearInterval(this.pollInterval),this.pollInterval=null),fetch(`${this.pythonServerUrl}/stop_camera`,{method:"POST",headers:{"Content-Type":"application/json"}}).catch(()=>{}),this.onEmotionCallback=void 0}startMockEmotionSimulation(e,t){console.log("🎭 [MOCK] Mock emotion simulation başlatılıyor...");let r="neutral",o=0;const c=()=>{if(!this.isActive)return;o+=1;const{correctClicks:d,wrongClicks:f,timeLeft:p,isPlaying:y}=t,v=d+f>0?d/(d+f):.5;y?v>.8&&d>5?r=Math.random()>.7?"happy":"neutral":v<.3&&f>3?r=Math.random()>.6?"confused":Math.random()>.5?"sad":"neutral":p<10&&v>.6?r=Math.random()>.7?"surprised":"neutral":o>30&&v<.5&&(r=Math.random()>.6?"bored":"neutral"):r="neutral";const S=!(Math.random()<.15),I={emotion:r,confidence:.7+Math.random()*.25,timestamp:new Date,gazeStatus:S?"looking":"not-looking",gazeX:S?320+(Math.random()-.5)*100:Math.random()*640,lookingAtScreen:S};e(I)};this.isActive=!0,this.pollInterval=setInterval(c,1e3),console.log("✅ [MOCK] Mock emotion simulation aktif")}startFrameAnalysis(){if(!this.isActive){console.log("⚠️ [CAMERA] Kamera bağlantısı yok, frame analizi başlatılamıyor");return}this.isAnalysisActive=!0,this.lastAnalysisTime=0,console.log("🎥 [CAMERA] Frame analizi başlatıldı, strict 3s timing aktif")}stopFrameAnalysis(){this.isAnalysisActive=!1,console.log("⏸️ [CAMERA] Frame analizi durduruldu")}isTrackingActive(){return this.isActive}isFrameAnalysisActive(){return this.isAnalysisActive}}const Dt=new e4,t4=({studentId:s,studentAge:e=12,difficulty:t,onGameComplete:r,onEmotionDetected:o})=>{const[c,d]=T.useState(null),[f,p]=T.useState("ready"),[y,v]=T.useState(0),[k,S]=T.useState([]),[I,q]=T.useState(0),[L,P]=T.useState(0),[K,U]=T.useState([]),B=T.useRef([]),[F]=T.useState(Date.now()),[ae,ne]=T.useState(3),[N,R]=T.useState(!1),[E,C]=T.useState(!1),[M,z]=T.useState(null),[j,Ve]=T.useState(null),[le,W]=T.useState(""),[de,me]=T.useState([]),[ye,O]=T.useState(""),[H,ee]=T.useState(0),[X,fe]=T.useState(0),[_e,Ee]=T.useState(!1),[$e,je]=T.useState(t),[pe,he]=T.useState(1),[ge,Ze]=T.useState(()=>t==="kolay"?2:t==="orta"?3:5),[Me,Ie]=T.useState([]),gt=T.useRef(0),Je=T.useRef(!1),pt=T.useRef(!1),kt=T.useRef(!1),it=T.useRef(null),Mt=T.useRef(null),Gt=T.useRef(null),En=5,yn=T.useCallback(async()=>{console.log("🎭 [EMOTION] Emotion tracking başlatılıyor..."),C(!0);const ke=Ke=>{if(!We.isGameActiveStatus())return;z(Ke),We.addEmotionResult(Ke);const et=We.getCurrentGameMetrics();Ve(et);const re=qk.getRealtimeFeedback(et);W(re.message);const De={emotion:Ke.emotion,confidence:Ke.confidence,timestamp:Ke.timestamp};U(Se=>{const Le=[...Se.slice(-10),De];return B.current=Le,Le}),o?.(De)};let Oe=!1;Gt.current&&(Oe=await Dt.startEmotionTracking(Gt.current,ke)),Oe||(console.log("📱 [EMOTION] Gerçek kamera bulunamadı - Python server çalışıyor mu?"),console.log("💡 [TIP] Terminal'de çalıştır: python emotion_server.py")),console.log("✅ [EMOTION] Emotion tracking aktif")},[o]),Mn=T.useCallback(()=>{console.log("⏹️ [EMOTION] Emotion tracking durduruluyor..."),Dt.stopEmotionTracking(),C(!1);const ke=We.endGameSession();Ve(ke),console.log("🏁 [EMOTION] Final metrics:",ke)},[]),Gn=T.useCallback(async ke=>{if(pt.current){console.log("🚫 [DUPLICATE CALL] generateFirstTask already running, skipping");return}console.log("🎬 [TASK GENERATION] Starting task generation"),pt.current=!0,R(!0);const Oe=k.reduce((we,He)=>we+(He.success?1:0),0),Ke=k.length,et=Ke>0?Oe/Ke:.7,re=k.length>0?k.reduce((we,He)=>we+He.reactionTime,0)/k.length:15,De=k.length>0?k.reduce((we,He)=>we+He.countingDuration,0)/k.length:15,Se=k.length>0?k.reduce((we,He)=>we+He.answerTime,0)/k.length:5,Le=k.reduce((we,He)=>we+He.objectsDisplayed,0),Ne=k.reduce((we,He)=>we+He.targetObjectsDisplayed,0),be=k.slice(-3).map(we=>({basari:we.success,sure:we.reactionTime,zorluk:t,hedefTipi:"sayma",hizliCozum:we.reactionTime<10,zamanlamaSapmasi:Math.abs(we.reactionTime-re),hedefZaman:De})),Ae=We.getCurrentGameMetrics(),Pe={son3Tur:be,ortalamaReaksiyonSuresi:re,basariOrani:et,odaklanmaDurumu:"ai-analiz",attentionMetrics:Ae,saymaGorevPerformansi:{saymaDogrulugu:et,ortalamaSaymaSuresi:De,ortalamaCevapSuresi:Se,toplamObjeGosterilen:Le,toplamHedefObje:Ne,saymaHizi:De>0?Ne/De:0,toplamTur:Ke,basariliTur:Oe,ortalamaDikkatSuresi:De}};try{const we=ke||We.getCurrentRoundEmotions(),He=We.getFullGameEmotions(),yt=we.length>0?JSON.stringify(we):void 0;console.log("🤖 [AI PROMPT DATA]",{hasEmotionData:!!yt,roundEmotionCount:we.length,fullGameEmotionCount:He.length,roundsCount:k.length,accuracy:et,avgReactionTime:re,avgCountingDuration:De,passedRoundEmotions:ke?ke.length:0,emotionsSource:ke?"passed-from-previous-round":"current-round-service"});const Ut=await _g.generateAttentionSprint({performansOzeti:Pe,studentAge:e,sonGorevler:["sayma"],emotionData:yt}),Ft={...Ut,difficulty:t,gorev:st(Ut.gorev),hedefRenk:ft(Ut.gorev)||Ut.hedefRenk,hedefSekil:Kt(Ut.gorev)||Ut.hedefSekil,hedefSayi:void 0};console.log("🔢 [COUNT GAME] Generated counting task:",Ft.gorev),d(Ft),v(Ft.sure_saniye)}catch(we){console.error("İlk görev üretme hatası:",we),d(Xt())}finally{pt.current=!1,R(!1)}},[e,t,k]);T.useEffect(()=>(!Je.current&&!N&&(Je.current=!0,Gn()),()=>{it.current&&(clearInterval(it.current),it.current=null),Mt.current&&(clearInterval(Mt.current),Mt.current=null)}),[Gn]);const st=ke=>{const Oe=ke.toLowerCase();if(Oe.includes("say")||Oe.includes("count")||Oe.includes("adet")||Oe.includes("hesapla"))return ke;const Ke=[{turkish:"mavi",emoji:"🔵"},{turkish:"kırmızı",emoji:"🔴"},{turkish:"yeşil",emoji:"🟢"},{turkish:"sarı",emoji:"🟡"}],et=[{turkish:"daire",emoji:"⭕"},{turkish:"kare",emoji:"⬜"},{turkish:"üçgen",emoji:"🔺"},{turkish:"yıldız",emoji:"⭐"}],re=Ke[Math.floor(Math.random()*Ke.length)],De=et[Math.floor(Math.random()*et.length)];return`${re.emoji} ${re.turkish} ${De.turkish}leri say`},ft=ke=>["kırmızı","mavi","yeşil","sarı","mor","turuncu"].find(Ke=>ke.toLowerCase().includes(Ke)),Kt=ke=>["yıldız","daire","kare","üçgen","kalp","elmas"].find(Ke=>ke.toLowerCase().includes(Ke)),Xt=()=>{const Oe={kolay:[{gorev:"🔵 Mavi daireleri say",hedefRenk:"mavi",hedefSekil:"daire"},{gorev:"🟢 Yeşil kareleri say",hedefRenk:"yeşil",hedefSekil:"kare"},{gorev:"⭐ Yıldızları say",hedefSekil:"yıldız"}],orta:[{gorev:"🔴 Kırmızı üçgenleri dikkatli say",hedefRenk:"kırmızı",hedefSekil:"üçgen"},{gorev:"🟡 Sarı daireleri hesapla",hedefRenk:"sarı",hedefSekil:"daire"},{gorev:"🔵 Mavi kareleri hızla say",hedefRenk:"mavi",hedefSekil:"kare"}],zor:[{gorev:"🟢 Hızlı çıkan yeşil yıldızları say",hedefRenk:"yeşil",hedefSekil:"yıldız"},{gorev:"🔴 Karışık kırmızı daireleri hesapla",hedefRenk:"kırmızı",hedefSekil:"daire"},{gorev:"🔵 Parlayan mavi üçgenleri say",hedefRenk:"mavi",hedefSekil:"üçgen"}]}[t],Ke=Oe[Math.floor(Math.random()*Oe.length)];return{id:`count_fallback_${Date.now()}`,...Ke,sure_saniye:t==="kolay"?20:t==="orta"?25:30,ipuclari:["Dikkatli say","Unutma sayıları"],dikkatDagitici:t==="kolay"?.2:t==="orta"?.4:.6,difficulty:t,hedefTipi:"renk"}},tr=ke=>{if(Me.length<1)return ke;const Oe=Me.slice(-3),Ke=Oe.filter(Se=>Se.correct).length,et=Oe.reduce((Se,Le)=>Se+Le.accuracy,0)/Oe.length;let re=pe;console.log("⏱️ [GAME DURATION] Analiz:",{recent3Count:Oe.length,correctCount:Ke,avgAccuracy:et.toFixed(2),currentMultiplier:pe.toFixed(2),baseDuration:ke}),Oe.length<2?console.log("⏸️ [DURATION] Henüz yeterli veri yok - süre sabit kalıyor"):et>.9?(re=Math.min(1.5,pe+.2),console.log("⬆️ [DURATION] Mükemmel performans - oyunu uzatıyorum!")):et>.8?(re=Math.min(1.3,pe+.1),console.log("↗️ [DURATION] İyi performans - hafif uzatıyorum")):et>.6?console.log("➡️ [DURATION] Dengeli performans - süre sabit"):et<.5?(re=Math.max(.7,pe-.1),console.log("⬇️ [DURATION] Zayıf performans - oyunu kısaltıyorum")):et<.3&&(re=Math.max(.6,pe-.2),console.log("↘️ [DURATION] Çok kötü performans - fazla kısaltıyorum")),he(re);const De=Math.round(ke*re);if(Oe.length>=2){const Se={kolay:2,orta:3,zor:5};let Le=ge;et>.9?(Le=Math.min(Se[t]+2,t==="zor"?6:4),console.log("⬆️ [MAX OBJECTS] Mükemmel performans - daha fazla obje!")):et>.8?(Le=Math.min(Se[t]+1,t==="zor"?6:4),console.log("↗️ [MAX OBJECTS] İyi performans - obje sayısı artırıldı")):et<.5?(Le=Math.max(Se[t]-1,2),console.log("⬇️ [MAX OBJECTS] Zayıf performans - obje sayısı azaltıldı")):(Le=Se[t],console.log("➡️ [MAX OBJECTS] Normal performans - varsayılan obje sayısı")),Le!==ge&&(console.log("🎯 [MAX OBJECTS] Ayarlandı:",{difficulty:t,oldMax:ge,newMax:Le,avgAccuracy:et.toFixed(2)}),Ze(Le))}return console.log("🎯 [DURATION] Süre ayarlandı:",{baseDuration:ke,multiplier:re.toFixed(2),adjustedDuration:De}),De},ys=(ke,Oe)=>{const Ke=tr(Oe),re=Math.max((Ke-5)*1e3,1e4),De={kolay:{totalObjectsRatio:4,targetCountRatio:8,spawnInterval:3e3,objectLifespan:6e3,persistanceChance:0},orta:{totalObjectsRatio:3,targetCountRatio:6,spawnInterval:2500,objectLifespan:5e3,persistanceChance:.35},zor:{totalObjectsRatio:2,targetCountRatio:4,spawnInterval:2e3,objectLifespan:4e3,persistanceChance:.7}},Se=De[ke]||De.orta,Le={totalObjects:Math.ceil(Ke/Se.totalObjectsRatio),targetCount:Math.ceil(Ke/Se.targetCountRatio),spawnInterval:Se.spawnInterval,objectLifespan:Se.objectLifespan,spawnDuration:re,persistanceChance:Se.persistanceChance,adjustedGameDuration:Ke};return console.log("🎮 [PARAMS] Süre bazlı parametreler:",{baseParams:Se,baseDurationSeconds:Oe,adjustedGameDuration:Ke,durationMultiplier:pe.toFixed(2),adjustedParams:Le}),Le},Ca=async()=>{if(!c)return;p("countdown"),ne(3),await yn();const ke=setInterval(()=>{ne(Oe=>Oe<=1?(clearInterval(ke),Ga(),0):Oe-1)},1e3)},ma=()=>{it.current&&(clearInterval(it.current),it.current=null),gt.current=Date.now(),it.current=setInterval(()=>{v(ke=>ke<=1?(it.current&&(clearInterval(it.current),it.current=null),Fa(!1),0):(ke===6&&(Ee(!0),console.log("⏰ [COUNTING] Son 5 saniye! Cevabını hazırla.")),ke-1))},1e3)},fa=()=>({x:Math.random()*70+15,y:Math.random()*60+20}),On=()=>{if(!c)return;Mt.current&&(console.log("🚫 [DUPLICATE SPAWN] Spawn already running, clearing previous"),clearInterval(Mt.current),Mt.current=null),console.log("🎬 [SPAWN START] Starting counting spawn");const ke=ys(t,c.sure_saniye);let Oe=0,Ke=0;console.log("🔢 [COUNTING SPAWN] Parametreler:",{gameDuration:c.sure_saniye,totalObjects:ke.totalObjects,targetCount:ke.targetCount,spawnDuration:ke.spawnDuration,spawnInterval:ke.spawnInterval,persistanceChance:ke.persistanceChance,answerTime:"5 saniye (son kısım)"}),ee(0),fe(Date.now()),Dt.startFrameAnalysis?.(),Mt.current=setInterval(()=>{if(Oe>=ke.totalObjects){clearInterval(Mt.current),Mt.current=null;return}me(Se=>{let Le=Se,Ne=0;return t==="kolay"?(Le=Se.filter(be=>{const Ae=Math.random()<.3;return!Ae&&be.isTarget&&Ne++,Ae}),Ne>0&&console.log("🔄 [KOLAY MOD] Bazı eski objeler kaldırılıyor:",Ne,"(sayım değişmiyor)")):(Le=Se.filter(be=>{const Ae=Math.random()<ke.persistanceChance;return!Ae&&be.isTarget&&Ne++,Ae}),Ne>0&&console.log(`🔄 [${t.toUpperCase()} MOD] Rastgele objeler kaldırılıyor:`,Ne,"(sayım değişmiyor)")),Le});let et=1;if(t==="orta")Math.random()<.2&&(et=2,console.log("🎲 [ORTA MOD] Çoklu spawn! 2 obje birden"));else if(t==="zor"){const Se=Math.random();Se<.05?(et=3,console.log("🎲 [ZOR MOD] Süper spawn! 3 obje birden")):Se<.2&&(et=2,console.log("🎲 [ZOR MOD] Çoklu spawn! 2 obje birden"))}const re=de.length,De=ge-re;if(et=Math.min(et,De),et<=0){console.log("🚫 [MAX LIMIT] Maksimum obje sayısına ulaşıldı:",ge,"spawn bekliyor");return}console.log(`🎯 [SPAWN COUNT] ${et} obje spawn edilecek (maks: ${ge}, mevcut: ${re})`);for(let Se=0;Se<et;Se++){const Ne=Ke<ke.targetCount&&(Math.random()<.4||Oe>=ke.totalObjects-(ke.targetCount-Ke));Ne&&(Ke++,ee(we=>we+1));const be=fa();let Ae="";if(c?.hedefRenk&&c?.hedefSekil)if(Ne)c.hedefRenk==="yeşil"&&c.hedefSekil==="daire"?Ae="🟢":c.hedefRenk==="yeşil"&&c.hedefSekil==="kare"?Ae="🟩":c.hedefRenk==="sarı"&&c.hedefSekil==="daire"?Ae="🟡":c.hedefRenk==="sarı"&&c.hedefSekil==="kare"?Ae="🟨":c.hedefRenk==="mavi"&&c.hedefSekil==="üçgen"?Ae="🔹":c.hedefRenk==="kırmızı"&&c.hedefSekil==="daire"?Ae="🔴":c.hedefRenk==="kırmızı"&&c.hedefSekil==="kare"?Ae="🟥":c.hedefRenk==="mavi"&&c.hedefSekil==="daire"?Ae="🔵":c.hedefRenk==="mavi"&&c.hedefSekil==="kare"?Ae="🟦":Ae="🔴";else{const we=c.hedefRenk;let He=[];we==="mavi"?He=["🔴","🟢","🟡","🟣","🟠"]:we==="kırmızı"?He=["🔵","🟢","🟡","🟣","🟠"]:we==="yeşil"?He=["🔴","🔵","🟡","🟣","🟠"]:we==="sarı"?He=["🔴","🔵","🟢","🟣","🟠"]:He=["🔴","🔵","🟢","🟡"],Ae=He[Math.floor(Math.random()*He.length)]}else if(c?.hedefRenk){const we={kırmızı:"🔴",mavi:"🔵",yeşil:"🟢",sarı:"🟡",mor:"🟣",turuncu:"🟠"};if(Ne)Ae=we[c.hedefRenk]||"🟢";else{const He=Object.values(we).filter(yt=>yt!==we[c.hedefRenk]);Ae=He[Math.floor(Math.random()*He.length)]}}else if(c?.hedefSekil){const we={yıldız:"⭐",daire:"⭕",kare:"⬜",üçgen:"🔺",kalp:"❤️",elmas:"💎"};if(Ne)Ae=we[c.hedefSekil]||"🔺";else{const He=Object.values(we).filter(yt=>yt!==we[c.hedefSekil]);Ae=He[Math.floor(Math.random()*He.length)]}}const Pe={id:`counting-${Date.now()}-${Math.random()}-${Se}`,x:be.x,y:be.y,value:Ae,isTarget:Ne,createdAt:Date.now(),lifespan:ke.objectLifespan};me(we=>[...we,Pe]),console.log("➕ [SPAWN]",{spawnIndex:Se+1,spawnTotal:et,isTarget:Ne,value:Ae,targetSpawnedCount:Ke,totalTargetCountCurrent:H,spawnedCount:Oe+1,totalObjects:ke.totalObjects}),setTimeout(()=>{me(we=>{const He=we.filter(yt=>yt.id!==Pe.id);return Pe.isTarget&&console.log("⏱️ [LIFESPAN END] Hedef obje yaşam süresi bitti, ekrandan kaldırılıyor (sayım değişmiyor)"),He})},ke.objectLifespan)}Oe+=et},ke.spawnInterval),setTimeout(()=>{Mt.current&&(clearInterval(Mt.current),Mt.current=null,console.log("⏹️ [SPAWN END] Spawn duration ended, clearing interval"))},ke.spawnDuration)},Ga=()=>{if(!c)return;const Oe=ys(t,c.sure_saniye).adjustedGameDuration;p("active"),v(Oe),O(""),Ee(!1),We.startGameSession(),We.startRoundSession(),console.log("🚀 [COUNT GAME START] Oyun başlıyor:",{originalDuration:c.sure_saniye,adjustedDuration:Oe,answerTime:5,emotionTrackingActive:E}),On(),ma()},Ia=ke=>{if(ke.preventDefault(),ye.trim()==="")return;const Oe=parseInt(ye),Ke=Oe===H,et=(Date.now()-gt.current)/1e3;console.log("🔢 [COUNTING RESULT]",{userAnswer:Oe,correctAnswer:H,isCorrect:Ke,reactionTime:et,currentObjectsOnScreen:de.length,targetObjectsOnScreen:de.filter(re=>re.isTarget).length}),Fa(Ke,et,Oe)},xs=ke=>{const Oe=ke.target.value;(Oe===""||/^\d+$/.test(Oe))&&O(Oe)},Fa=(ke,Oe,Ke)=>{if(!c||kt.current)return;kt.current=!0,it.current&&(clearInterval(it.current),it.current=null);const et=Oe||(Date.now()-gt.current)/1e3,re=Ke||parseInt(ye)||0,De=H>0?Math.max(0,1-Math.abs(re-H)/H):0,Se={correct:ke,accuracy:De,round:I+1};Ie(be=>[...be.slice(-4),Se]),console.log("📈 [PERFORMANCE] Yeni kayıt:",{round:I+1,correct:ke,accuracy:De.toFixed(2),userAnswer:re,correctAnswer:H,currentDurationMultiplier:pe.toFixed(2)});const Le={task:c,startTime:gt.current,endTime:Date.now(),success:ke,reactionTime:et,userAnswer:re,correctAnswer:H};S(be=>[...be,Le]);const Ne=We.endRoundSession();if(console.log("🏁 [ROUND ENDED] Round emotion data:",Ne.length),Dt.stopFrameAnalysis?.(),I+1>=En){const be=We.endGameSession();Ve(be),console.log("⏹️ [GAME ENDED] Emotion kaydetme durdu, final metrics:",be)}if(ke){P(Ae=>Ae+1);const be={emotion:"happy",confidence:.9,timestamp:new Date};U(Ae=>[...Ae,be]),o?.(be)}else{const be={emotion:"confused",confidence:.7,timestamp:new Date};U(Ae=>[...Ae,be]),o?.(be)}p("waiting"),setTimeout(()=>{I+1>=En?vs():(q(be=>be+1),me([]),O(""),ee(0),fe(0),We.startRoundSession(),Gn(Ne),p("ready")),kt.current=!1},2e3)},vs=()=>{p("completed"),Mn();const ke=Math.floor((Date.now()-F)/1e3);r(L,ke,K)},sa=()=>{it.current&&(clearInterval(it.current),it.current=null),Mn(),S([]),q(0),P(0),U([]),B.current=[],p("ready"),C(!1),z(null),Ve(null),W(""),me([]),O(""),ee(0),fe(0),je(t),he(1),Ie([]),Je.current=!1,pt.current=!1,kt.current=!1,Gn()};return f==="completed"?l.jsx(ta,{className:"max-w-2xl mx-auto",children:l.jsxs(na,{className:"text-center py-12",children:[l.jsxs("div",{className:"mb-6",children:[l.jsx("div",{className:"w-24 h-24 mx-auto mb-4 bg-gradient-to-r from-green-500 to-blue-500 rounded-full flex items-center justify-center",children:l.jsx(Bn,{className:"h-12 w-12 text-white"})}),l.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Dikkat Sayma Oyunu Tamamlandı!"}),l.jsx("p",{className:"text-gray-600",children:"Sayma becerin gelişiyor!"})]}),l.jsx("div",{className:"bg-gray-50 rounded-lg p-6 mb-6",children:l.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[l.jsxs("div",{children:[l.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:[L,"/",En]}),l.jsx("div",{className:"text-sm text-gray-600",children:"Doğru Sayım"})]}),l.jsxs("div",{children:[l.jsxs("div",{className:"text-2xl font-bold text-green-600",children:[Math.round(L/En*100),"%"]}),l.jsx("div",{className:"text-sm text-gray-600",children:"Başarı Oranı"})]}),l.jsxs("div",{children:[l.jsxs("div",{className:"text-2xl font-bold text-purple-600",children:[k.length>0?(k.reduce((ke,Oe)=>ke+Oe.reactionTime,0)/k.length).toFixed(1):"0.0","s"]}),l.jsx("div",{className:"text-sm text-gray-600",children:"Ort. Süre"})]})]})}),l.jsxs(ea,{onClick:sa,size:"lg",children:[l.jsx(Sh,{className:"h-5 w-5 mr-2"}),"Tekrar Oyna"]})]})}):l.jsxs("div",{className:"max-w-2xl mx-auto space-y-6",children:[l.jsx("video",{ref:Gt,autoPlay:!0,playsInline:!0,muted:!0,style:{display:"none"}}),l.jsx(ta,{children:l.jsx(na,{children:l.jsx("div",{className:"flex items-center justify-between",children:l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsxs("div",{className:"text-sm text-gray-600",children:["Tur ",I+1,"/",En]}),l.jsxs("div",{className:"text-sm font-medium text-gray-800",children:["Skor: ",L]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Jn,{className:"h-4 w-4 text-purple-600"}),l.jsxs("span",{className:"text-xs text-purple-600",children:["Zorluk: ",t,pe!==1&&l.jsxs("span",{className:"ml-1 text-xs bg-purple-100 px-1 rounded",children:["⏱️ ",pe>1?"⬆️":"⬇️"," ",pe.toFixed(1),"x"]})]})]})]})})})}),l.jsx(ta,{children:l.jsx(na,{className:"text-center py-12",children:N?l.jsxs("div",{className:"space-y-4",children:[l.jsx("div",{className:"w-16 h-16 border-4 border-green-500 border-t-transparent rounded-full animate-spin mx-auto"}),l.jsx("p",{className:"text-gray-600",children:"Senin için özel sayma görevi hazırlanıyor..."})]}):f==="ready"?l.jsxs("div",{className:"space-y-6",children:[l.jsx("div",{className:"w-20 h-20 mx-auto mb-4 bg-gradient-to-r from-green-500 to-emerald-500 rounded-full flex items-center justify-center",children:l.jsx(Pk,{className:"h-10 w-10 text-white"})}),l.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Dikkat Sayma"}),l.jsx("p",{className:"text-gray-600 mb-6",children:"Beliren objeleri dikkatli şekilde say ve konsantrasyonunu geliştir!"}),c&&l.jsxs("div",{className:"bg-green-50 rounded-lg p-4 mb-6",children:[l.jsx("h3",{className:"font-medium text-green-800 mb-2",children:"Görevin:"}),l.jsx("p",{className:"text-green-700",children:c.gorev}),c.ipuclari.length>0&&l.jsxs("div",{className:"mt-3",children:[l.jsx("p",{className:"text-xs text-green-600 font-medium mb-1",children:"İpuçları:"}),c.ipuclari.map((ke,Oe)=>l.jsxs("p",{className:"text-xs text-green-600",children:["• ",ke]},Oe))]})]}),l.jsxs(ea,{onClick:Ca,size:"lg",disabled:!c,children:[l.jsx(Mi,{className:"h-5 w-5 mr-2"}),"Başla"]})]}):f==="countdown"?l.jsxs("div",{className:"space-y-6",children:[l.jsx("h2",{className:"text-4xl font-bold text-gray-800",children:"Hazırlan!"}),l.jsx("div",{className:"text-6xl font-bold text-green-600 animate-bounce",children:ae})]}):f==="active"?l.jsxs("div",{className:"space-y-6",children:[l.jsx("h2",{className:"text-xl font-bold text-gray-800",children:c?.gorev}),l.jsx("div",{className:"relative w-full h-96 bg-gray-50 rounded-lg overflow-hidden",children:de.map(ke=>l.jsx("div",{className:"absolute w-8 h-8 text-2xl animate-bounce transition-all duration-500",style:{left:`${ke.x}%`,top:`${ke.y}%`,transform:"translate(-50%, -50%)",animationDuration:`${1+Math.random()}s`},children:ke.value},ke.id))}),l.jsx("form",{onSubmit:Ia,className:"space-y-4",children:l.jsxs("div",{className:"flex items-center justify-center space-x-4",children:[l.jsx("label",{className:"text-lg font-medium",children:"Toplam:"}),l.jsx("input",{type:"text",value:ye,onChange:xs,className:"w-20 h-12 text-center text-xl font-bold border-2 border-green-400 rounded-lg focus:outline-none focus:border-green-600",placeholder:"0",maxLength:2}),l.jsx("button",{type:"submit",disabled:ye.trim()==="",className:"px-6 py-2 bg-green-500 text-white rounded-lg font-medium hover:bg-green-600 disabled:bg-gray-300 disabled:cursor-not-allowed",children:"Gönder"})]})}),l.jsxs("div",{className:"flex items-center justify-center space-x-2 text-lg",children:[l.jsx(ja,{className:"h-5 w-5 text-green-600"}),l.jsxs("span",{className:"font-mono font-bold text-green-600",children:[y,"s"]})]}),_e&&l.jsxs("div",{className:"bg-orange-100 border-2 border-orange-300 rounded-lg p-4 animate-pulse",children:[l.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[l.jsx(ja,{className:"h-5 w-5 text-orange-600 animate-spin"}),l.jsxs("p",{className:"text-orange-700 font-bold text-lg",children:["⏰ Son ",y," saniye! Cevabını yaz ve gönder!"]})]}),l.jsx("p",{className:"text-orange-600 text-sm mt-2",children:"Objeler artık çıkmıyor, şimdi sayını gir"})]})]}):f==="waiting"?l.jsxs("div",{className:"space-y-4",children:[k.length>0&&k[k.length-1].success?l.jsxs("div",{className:"text-green-600",children:[l.jsx(Ic,{className:"h-12 w-12 mx-auto mb-2"}),l.jsx("h3",{className:"text-xl font-bold",children:"Mükemmel!"}),l.jsxs("p",{children:["Doğru cevap: ",k[k.length-1].correctAnswer]}),l.jsxs("p",{children:["Senin cevabın: ",k[k.length-1].userAnswer]})]}):l.jsxs("div",{className:"text-orange-600",children:[l.jsx(Bn,{className:"h-12 w-12 mx-auto mb-2"}),l.jsx("h3",{className:"text-xl font-bold",children:"Bir daha deneyelim!"}),k.length>0&&l.jsxs(l.Fragment,{children:[l.jsxs("p",{children:["Doğru cevap: ",k[k.length-1].correctAnswer]}),l.jsxs("p",{children:["Senin cevabın: ",k[k.length-1].userAnswer]})]})]}),l.jsx("p",{className:"text-sm text-gray-600",children:"Sonraki görev hazırlanıyor..."})]}):null})})]})},n4=({className:s})=>l.jsx("span",{className:s,children:"❌"}),a4=({studentId:s,studentAge:e=12,difficulty:t,onGameComplete:r,onEmotionDetected:o})=>{const[c,d]=T.useState(null),[f,p]=T.useState("ready"),[y,v]=T.useState(0),[k,S]=T.useState([]),[I,q]=T.useState(0),[L,P]=T.useState(0),[K,U]=T.useState([]),B=T.useRef([]),[F]=T.useState(Date.now()),[ae,ne]=T.useState(2),[N,R]=T.useState(!1),[E,C]=T.useState(!1),[M,z]=T.useState(null),[j,Ve]=T.useState(null),[le,W]=T.useState(null),[de,me]=T.useState(""),[ye,O]=T.useState([]),[H,ee]=T.useState(0),[X,fe]=T.useState(0),_e=T.useRef(0),Ee=T.useRef(0),[$e,je]=T.useState(0),[pe,he]=T.useState(0),ge=T.useRef(0),[Ze,Me]=T.useState([]),Ie=T.useRef([]),[gt,Je]=T.useState([]),pt=T.useRef([]),[kt,it]=T.useState(null),Mt=re=>({kırmızı:"#dc2626",mavi:"#2563eb",yeşil:"#16a34a",sarı:"#eab308",mor:"#9333ea",turuncu:"#ea580c"})[re]||"#dc2626",Gt=re=>{if(re.includes("-")){const[Le,Ne]=re.split("-"),be=Mt(Ne);switch(Le){case"triangle":return l.jsx("div",{className:"w-0 h-0",style:{borderLeft:"15px solid transparent",borderRight:"15px solid transparent",borderBottom:`30px solid ${be}`}});case"circle":return l.jsx("div",{className:"w-8 h-8 rounded-full",style:{backgroundColor:be}});case"square":return l.jsx("div",{className:"w-8 h-8",style:{backgroundColor:be}});case"star":return l.jsx("div",{className:"relative w-8 h-8",style:{clipPath:"polygon(50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%)",backgroundColor:be}});case"heart":return l.jsxs("div",{className:"relative w-8 h-8",style:{transform:"rotate(-45deg)"},children:[l.jsx("div",{className:"w-6 h-6 rounded-full absolute top-0 left-1",style:{backgroundColor:be}}),l.jsx("div",{className:"w-6 h-6 rounded-full absolute top-1 left-0",style:{backgroundColor:be}}),l.jsx("div",{className:"w-4 h-4 absolute top-3 left-2",style:{backgroundColor:be}})]});case"diamond":return l.jsx("div",{className:"w-8 h-8 transform rotate-45",style:{backgroundColor:be}});case"hexagon":return l.jsx("div",{className:"w-8 h-8",style:{clipPath:"polygon(50% 0%, 100% 25%, 100% 75%, 50% 100%, 0% 75%, 0% 25%)",backgroundColor:be}});case"oval":return l.jsx("div",{className:"w-10 h-6 rounded-full",style:{backgroundColor:be}});default:return l.jsx("div",{className:"w-8 h-8 rounded-full",style:{backgroundColor:"#6b7280"}})}}const Se={"🔴":"#dc2626","🔵":"#2563eb","🟢":"#16a34a","🟡":"#eab308","🟣":"#9333ea","🟠":"#ea580c"}[re]||"#6b7280";return l.jsx("div",{className:"w-8 h-8 rounded-full",style:{backgroundColor:Se}})},En=T.useRef(0),yn=T.useRef(!1),Mn=T.useRef(!1),Gn=T.useRef(!1),st=T.useRef(null),ft=T.useRef(null),Kt=5,Xt=3e3,tr=T.useCallback(async()=>{console.log("🎭 [EMOTION] Emotion tracking başlatılıyor..."),C(!0);const re=Se=>{if(!We.isGameActiveStatus())return;z(Se),We.addEmotionResult(Se);const Le=We.getCurrentGameMetrics();Ve(Le);const Ne=qk.getRealtimeFeedback(Le);me(Ne.message);const be={emotion:Se.emotion,confidence:Se.confidence,timestamp:Se.timestamp};U(Ae=>{const Pe=[...Ae.slice(-10),be];return B.current=Pe,Pe}),o?.(be)};let De=!1;ft.current&&(De=await Dt.startEmotionTracking(ft.current,re)),De||(console.log("📱 [EMOTION] Gerçek kamera bulunamadı - Python server çalışıyor mu?"),console.log("💡 [TIP] Terminal'de çalıştır: python emotion_server.py")),console.log("✅ [EMOTION] Emotion tracking aktif")},[o]),ys=T.useCallback(()=>{console.log("⏹️ [EMOTION] Emotion tracking durduruluyor..."),Dt.stopEmotionTracking(),C(!1);const re=We.endGameSession();Ve(re),console.log("🏁 [EMOTION] Final metrics:",re)},[]);T.useEffect(()=>(!yn.current&&!N&&(console.log("🤖 [TASK] İlk görev AI'dan yükleniyor (emotion data olmadan)"),yn.current=!0,ma()),()=>{st.current&&(clearInterval(st.current),st.current=null)}),[]);const Ca=T.useCallback(async(re,De,Se)=>{if(Mn.current)return;Mn.current=!0,R(!0);const Le=De??H,Ne=Se??X,be=re.reduce((xe,nt)=>xe+nt.correctClicks,0),Ae=re.reduce((xe,nt)=>xe+nt.wrongClicks,0),Pe=re.reduce((xe,nt)=>xe+nt.targetSpawned,0),we=be+Le,He=Ae+Ne,yt=Pe+(ge.current||0),Ut=we+He,Ft=Ut>0?we/Ut:.5,Zt=yt>0?we/yt:.5,Wt=[...Ie.current];re.forEach(xe=>{xe.avgReactionTimeMs&&Wt.push(xe.avgReactionTimeMs)});const dn=Wt.length>0?Wt.reduce((xe,nt)=>xe+nt,0)/Wt.length/1e3:2.5;Ie.current.length>0&&Ie.current.reduce((xe,nt)=>xe+nt,0)/Ie.current.length;const xn=re.slice(-3).map(xe=>({basari:xe.success,sure:xe.reactionTime,zorluk:t,hedefTipi:"renk",hizliCozum:xe.reactionTime<2,zamanlamaSapmasi:Math.abs(xe.reactionTime-(c?.sure_saniye||30)),hedefZaman:c?.sure_saniye||30})),Jt=xn.filter(xe=>xe.hizliCozum).length,Ot=We.getCurrentGameMetrics(),Ge={son3Tur:xn,ortalamaReaksiyonSuresi:dn,basariOrani:Ft,odaklanmaDurumu:"ai-analiz",attentionMetrics:Ot,sayiGorevPerformansi:{ortalamaSayiZorlugu:t==="kolay"?3:t==="orta"?5:7,sayiBasariOrani:Ft,ortalamaReaksiyonSuresiSayi:dn,hizliCozumSayisi:Jt,hedefYakalamaOrani:Zt,toplamHedefSayisi:yt,yakalinanHedefSayisi:we,yanlisTiklamaSayisi:He,hizliTiklamaOrani:re.length>0?re.reduce((xe,nt)=>xe+nt.fastClickRate,0)/re.length:0,hizliTiklamaSayisi:re.reduce((xe,nt)=>xe+nt.fastClicks,0),toplamTiklamaSayisi:re.reduce((xe,nt)=>xe+nt.totalClicksAnalyzed,0),hizliVeDogruTiklamalar:re.reduce((xe,nt)=>xe+nt.correctFastClicks,0),hizliTiklamaDogrulukOrani:re.length>0?re.reduce((xe,nt)=>xe+nt.fastAccuracyRate,0)/re.length:0,sonRoundHizliTiklamaOrani:re.length>0?re[re.length-1].fastClickRate:0,sonRoundHizliTiklamaSayisi:re.length>0?re[re.length-1].fastClicks:0,sonRoundToplamTiklamaSayisi:re.length>0?re[re.length-1].totalClicksAnalyzed:0,sonRoundHizliVeDogruTiklamalar:re.length>0?re[re.length-1].correctFastClicks:0,sonRoundHizliTiklamaDogrulukOrani:re.length>0?re[re.length-1].fastAccuracyRate:0,odaklanmaSayisi:re.length}};try{const xe=We.getCurrentRoundEmotions(),nt=We.getFullGameEmotions(),Pn=xe.length>0?JSON.stringify(xe):void 0;console.log("🤖 [AI PROMPT DATA WITH UPDATED ROUNDS]",{hasEmotionData:!!Pn,roundEmotionCount:xe.length,fullGameEmotionCount:nt.length,legacyEmotionCount:K.length,roundsCount:re.length,kumulatifFastClickData:{hizliTiklamaOrani:Ge.sayiGorevPerformansi?.hizliTiklamaOrani,hizliTiklamaSayisi:Ge.sayiGorevPerformansi?.hizliTiklamaSayisi,toplamTiklamaSayisi:Ge.sayiGorevPerformansi?.toplamTiklamaSayisi},sonRoundFastClickData:{sonRoundHizliTiklamaOrani:Ge.sayiGorevPerformansi?.sonRoundHizliTiklamaOrani,sonRoundHizliTiklamaSayisi:Ge.sayiGorevPerformansi?.sonRoundHizliTiklamaSayisi,sonRoundToplamTiklamaSayisi:Ge.sayiGorevPerformansi?.sonRoundToplamTiklamaSayisi}});const qa=await _g.generateAttentionSprint({performansOzeti:Ge,studentAge:e,sonGorevler:["dinamik-tıklama"],emotionData:Pn}),bs=fa(qa.gorev),$a={...qa,difficulty:t,gorev:bs,sure_saniye:qa.sure_saniye};d($a),v($a.sure_saniye)}catch(xe){console.error("İlk görev üretme hatası:",xe),d(On())}finally{Mn.current=!1,R(!1)}},[e,t,H,X]),ma=T.useCallback(async(re,De)=>{if(Mn.current)return;Mn.current=!0,R(!0);const Se=re??H,Le=De??X,Ne=k.reduce((Ge,xe)=>Ge+xe.correctClicks,0),be=k.reduce((Ge,xe)=>Ge+xe.wrongClicks,0),Ae=k.reduce((Ge,xe)=>Ge+xe.targetSpawned,0),Pe=Ne+Se,we=be+Le,He=Ae+(ge.current||0),yt=Pe+we,Ut=yt>0?Pe/yt:.5,Ft=He>0?Pe/He:.5,Zt=[...Ie.current];k.forEach(Ge=>{Ge.avgReactionTimeMs&&Zt.push(Ge.avgReactionTimeMs)});const Wt=Zt.length>0?Zt.reduce((Ge,xe)=>Ge+xe,0)/Zt.length/1e3:2.5;Ie.current.length>0&&Ie.current.reduce((Ge,xe)=>Ge+xe,0)/Ie.current.length;const dn=k.slice(-3).map(Ge=>({basari:Ge.success,sure:Ge.reactionTime,zorluk:t,hedefTipi:"renk",hizliCozum:Ge.reactionTime<2,zamanlamaSapmasi:Math.abs(Ge.reactionTime-(c?.sure_saniye||30)),hedefZaman:c?.sure_saniye||30})),xn=dn.filter(Ge=>Ge.hizliCozum).length,Jt=We.getCurrentGameMetrics(),Ot={son3Tur:dn,ortalamaReaksiyonSuresi:Wt,basariOrani:Ut,odaklanmaDurumu:"ai-analiz",attentionMetrics:Jt,sayiGorevPerformansi:{ortalamaSayiZorlugu:t==="kolay"?3:t==="orta"?5:7,sayiBasariOrani:Ut,ortalamaReaksiyonSuresiSayi:Wt,hizliCozumSayisi:xn,hedefYakalamaOrani:Ft,toplamHedefSayisi:He,yakalinanHedefSayisi:Pe,yanlisTiklamaSayisi:we,hizliTiklamaOrani:k.length>0?k.reduce((Ge,xe)=>Ge+xe.fastClickRate,0)/k.length:0,hizliTiklamaSayisi:k.reduce((Ge,xe)=>Ge+xe.fastClicks,0),toplamTiklamaSayisi:k.reduce((Ge,xe)=>Ge+xe.totalClicksAnalyzed,0),hizliVeDogruTiklamalar:k.reduce((Ge,xe)=>Ge+xe.correctFastClicks,0),hizliTiklamaDogrulukOrani:k.length>0?k.reduce((Ge,xe)=>Ge+xe.fastAccuracyRate,0)/k.length:0,odaklanmaSayisi:k.length}};try{const Ge=We.getCurrentRoundEmotions(),xe=We.getFullGameEmotions(),nt=Ge.length>0?JSON.stringify(Ge):void 0;console.log("🤖 [AI PROMPT DATA]",{hasEmotionData:!!nt,roundEmotionCount:Ge.length,fullGameEmotionCount:xe.length,legacyEmotionCount:K.length,isFirstTask:!k.length});const Pn=await _g.generateAttentionSprint({performansOzeti:Ot,studentAge:e,sonGorevler:["dinamik-tıklama"],emotionData:nt}),qa=fa(Pn.gorev),bs={...Pn,difficulty:t,gorev:qa,sure_saniye:Pn.sure_saniye};d(bs),v(bs.sure_saniye)}catch(Ge){console.error("İlk görev üretme hatası:",Ge),d(On())}finally{Mn.current=!1,R(!1)}},[e,t,k,H,X]),fa=re=>{const De=re.toLowerCase();if(De.includes("tıkla")||De.includes("yakala"))return re;const Se=[{turkish:"mavi",emoji:"🔵"},{turkish:"kırmızı",emoji:"🔴"},{turkish:"yeşil",emoji:"🟢"},{turkish:"sarı",emoji:"🟡"}],Le=[{turkish:"daire",emoji:"⭕"},{turkish:"kare",emoji:"⬜"},{turkish:"üçgen",emoji:"🔺"},{turkish:"yıldız",emoji:"⭐"}],Ne=Se[Math.floor(Math.random()*Se.length)],be=Le[Math.floor(Math.random()*Le.length)];return`${t==="kolay"?"20 saniye":t==="orta"?"30 saniye":"40 saniye"} içinde tüm ${Ne.emoji} ${Ne.turkish} ${be.turkish}leri tıkla`},On=()=>{const De={kolay:[{gorev:"20 saniye içinde tüm mavi daireleri tıkla",hedefRenk:"mavi",hedefSekil:"daire",sure:20},{gorev:"20 saniye içinde tüm yeşil kareleri yakala",hedefRenk:"yeşil",hedefSekil:"kare",sure:20},{gorev:"20 saniye içinde tüm sarı yıldızları tıkla",hedefRenk:"sarı",hedefSekil:"yıldız",sure:20}],orta:[{gorev:"30 saniye içinde tüm kırmızı üçgenleri tıkla",hedefRenk:"kırmızı",hedefSekil:"üçgen",sure:30},{gorev:"30 saniye içinde tüm mavi kareleri yakala",hedefRenk:"mavi",hedefSekil:"kare",sure:30},{gorev:"30 saniye içinde tüm yeşil daireleri tıkla",hedefRenk:"yeşil",hedefSekil:"daire",sure:30}],zor:[{gorev:"40 saniye içinde tüm hızlı hedefleri yakala",hedefRenk:"kırmızı",hedefSekil:"yıldız",sure:40},{gorev:"40 saniye içinde tüm mavi üçgenleri tıkla",hedefRenk:"mavi",hedefSekil:"üçgen",sure:40},{gorev:"40 saniye içinde tüm karışık hedefleri yakala",hedefRenk:"yeşil",hedefSekil:"kare",sure:40}]}[t],Se=De[Math.floor(Math.random()*De.length)];return{id:`dynamic_fallback_${Date.now()}`,...Se,sure_saniye:Se.sure,ipuclari:["Hızlı ol","Doğru hedefleri seç"],dikkatDagitici:t==="kolay"?.3:t==="orta"?.5:.7,difficulty:t,hedefTipi:"renk"}},Ga=re=>{switch(re){case"kolay":return{spawnInterval:3e3,objectLifespan:6e3,targetRatio:.7};case"orta":return{spawnInterval:2500,objectLifespan:5e3,targetRatio:.6};case"zor":return{spawnInterval:2e3,objectLifespan:4e3,targetRatio:.5};default:return{spawnInterval:2500,objectLifespan:5e3,targetRatio:.6}}},Ia=async()=>{if(!c)return;p("countdown"),ne(2),await tr();const re=setInterval(()=>{ne(De=>De<=1?(clearInterval(re),sa(),0):De-1)},1e3)},xs=()=>{st.current&&(clearInterval(st.current),st.current=null),En.current=Date.now(),st.current=setInterval(()=>{v(re=>re<=1?(st.current&&(clearInterval(st.current),st.current=null),Oe(!0),0):re-1)},1e3)},Fa=()=>({x:Math.random()*70+15,y:Math.random()*60+20}),vs=()=>{const re=c?.gameParams?{spawnInterval:c.gameParams.spawnInterval,objectLifespan:c.gameParams.objectLifespan,targetRatio:c.gameParams.targetRatio}:Ga(t);console.log("🎮 [GAME PARAMS]",{source:c?.gameParams?"AI-emotion-based":"default-difficulty",spawnInterval:`${re.spawnInterval}ms`,objectLifespan:`${re.objectLifespan}ms`,targetRatio:`${(re.targetRatio*100).toFixed(1)}%`,aiParams:c?.gameParams}),ee(0),fe(0),je(0),he(0),ge.current=0;const De=()=>{const Le=Math.random()<re.targetRatio,Ne=Fa();let be="";if(c?.hedefRenk&&c?.hedefSekil)if(Le)c.hedefSekil==="daire"?be=`circle-${c.hedefRenk}`:c.hedefSekil==="kare"?be=`square-${c.hedefRenk}`:c.hedefSekil==="üçgen"?be=`triangle-${c.hedefRenk}`:c.hedefSekil==="yıldız"?be=`star-${c.hedefRenk}`:c.hedefSekil==="kalp"?be=`heart-${c.hedefRenk}`:c.hedefSekil==="elmas"?be=`diamond-${c.hedefRenk}`:be="🔴";else{const Pe=["circle","square","triangle","star","heart","diamond"],we=["kırmızı","mavi","yeşil","sarı","mor","turuncu"];let He,yt;do He=Pe[Math.floor(Math.random()*Pe.length)],yt=we[Math.floor(Math.random()*we.length)];while(He===c.hedefSekil&&yt===c.hedefRenk);be=`${He}-${yt}`}else if(c?.hedefRenk){const Pe=["circle","square","triangle","star","heart","diamond"],we=Pe[Math.floor(Math.random()*Pe.length)];if(Le)be=`${we}-${c.hedefRenk}`;else{const He=["kırmızı","mavi","yeşil","sarı","mor","turuncu"].filter(Ut=>Ut!==c.hedefRenk),yt=He[Math.floor(Math.random()*He.length)];be=`${we}-${yt}`}}else if(c?.hedefSekil){const Pe=["kırmızı","mavi","yeşil","sarı","mor","turuncu"],we=Pe[Math.floor(Math.random()*Pe.length)];if(Le)be=`${c.hedefSekil==="daire"?"circle":c.hedefSekil==="kare"?"square":c.hedefSekil==="üçgen"?"triangle":c.hedefSekil==="yıldız"?"star":c.hedefSekil==="kalp"?"heart":c.hedefSekil==="elmas"?"diamond":"circle"}-${we}`;else{const He=["circle","square","triangle","star","heart","diamond"],yt=c.hedefSekil==="daire"?"circle":c.hedefSekil==="kare"?"square":c.hedefSekil==="üçgen"?"triangle":c.hedefSekil==="yıldız"?"star":c.hedefSekil==="kalp"?"heart":c.hedefSekil==="elmas"?"diamond":"circle";be=`${He.filter(Ft=>Ft!==yt)[Math.floor(Math.random()*(He.length-1))]}-${we}`}}const Ae={id:`clicking-${Date.now()}-${Math.random()}`,x:Ne.x,y:Ne.y,value:be,isTarget:Le,createdAt:Date.now(),lifespan:re.objectLifespan};O(Pe=>[...Pe,Ae]),je(Pe=>Pe+1),Le&&(he(Pe=>Pe+1),ge.current+=1),setTimeout(()=>{O(Pe=>Pe.filter(we=>we.id!==Ae.id))},re.objectLifespan)};De(),Dt.startFrameAnalysis?.();const Se=setInterval(De,re.spawnInterval);setTimeout(()=>{clearInterval(Se)},(c?.sure_saniye||30)*1e3)},sa=()=>{c&&(p("active"),v(c.sure_saniye),je(0),We.startGameSession(),We.startRoundSession(),vs(),xs())},ke=(re,De)=>{const Se=Date.now(),Le=ye.find(Pe=>Pe.id===re);if(!Le)return;const Ne=Se-Le.createdAt,be=Ne<Xt;console.log(`⚡ [FAST CLICK DEBUG] Reaction: ${Ne}ms, Threshold: ${Xt}ms, IsFast: ${be}`),it({id:`feedback-${Date.now()}`,isCorrect:De,x:Le.x,y:Le.y}),setTimeout(()=>{it(null)},1e3),Ie.current.push(Ne),Me(Pe=>[...Pe,Ne]);const Ae={timestamp:Date.now(),reactionTime:Ne,isCorrect:De,isFast:be};pt.current.push(Ae),Je(Pe=>[...Pe,Ae]),O(Pe=>Pe.filter(we=>we.id!==re)),De?(_e.current+=1,ee(Pe=>Pe+1)):(Ee.current+=1,fe(Pe=>Pe+1))},Oe=(re,De)=>{if(console.log("🚨 [END ROUND CALLED]",{success:re,reactionTime:De,currentTask:!!c,isEndingRound:Gn.current}),!c||Gn.current)return;Gn.current=!0;const Se=_e.current,Le=Ee.current,Ne=ge.current;st.current&&(clearInterval(st.current),st.current=null);const be=(Date.now()-En.current)/1e3,Ae=Se+Le,we=(Ae>0?Se/Ae:0)>=.5&&Ae>=3,He=Ie.current.length>0?Ie.current.reduce((xe,nt)=>xe+nt,0)/Ie.current.length:0,yt=Ne>0?Se/Ne:0,Ut=pt.current,Ft=Ut.length,Zt=Ut.filter(xe=>xe.isFast).length,Wt=Ut.filter(xe=>xe.isFast&&xe.isCorrect).length,dn=Ft>0?Zt/Ft:0,xn=Zt>0?Wt/Zt:0;console.log("📊 [FAST CLICK DETAILS]",{totalClicks:Ft,fastClicks:Zt,correctFastClicks:Wt,fastClickRate:`${(dn*100).toFixed(1)}%`,fastAccuracyRate:`${(xn*100).toFixed(1)}%`,allClicks:Ut.map(xe=>({reaction:`${xe.reactionTime}ms`,isFast:xe.isFast,isCorrect:xe.isCorrect}))});const Jt={task:c,startTime:En.current,endTime:Date.now(),success:we,reactionTime:be,correctClicks:Se,wrongClicks:Le,totalSpawned:$e,targetSpawned:Ne,targetHitRate:yt,avgReactionTimeMs:He,fastClicks:Zt,totalClicksAnalyzed:Ft,fastClickRate:dn,correctFastClicks:Wt,fastAccuracyRate:xn},Ot=We.endRoundSession();if(console.log("🏁 [ROUND ENDED] Round emotion data:",Ot.length),Dt.stopFrameAnalysis?.(),I+1>=Kt){const xe=We.endGameSession();Ve(xe),console.log("⏹️ [GAME ENDED] Emotion kaydetme durdu, final metrics:",xe)}S(xe=>{const nt=[...xe,Jt];return I+1<Kt&&setTimeout(()=>{Ca(nt,Se,Le)},100),nt});const Ge=we?{emotion:"happy",confidence:.9,timestamp:new Date}:{emotion:"confused",confidence:.7,timestamp:new Date};U(xe=>{const nt=[...xe,Ge];return B.current=nt,nt}),o?.(Ge),p("waiting"),setTimeout(()=>{I+1>=Kt?Ke():(q(xe=>xe+1),O([]),ee(0),fe(0),_e.current=0,Ee.current=0,Me([]),Ie.current=[],je(0),he(0),ge.current=0,Je([]),pt.current=[],it(null),We.startRoundSession(),p("ready")),Gn.current=!1},2e3)},Ke=()=>{p("completed"),ys();const re=Math.floor((Date.now()-F)/1e3);r(L,re,K)},et=()=>{st.current&&(clearInterval(st.current),st.current=null),ys(),S([]),q(0),P(0),U([]),B.current=[],p("ready"),C(!1),z(null),Ve(null),W(null),me(""),O([]),ee(0),fe(0),je(0),he(0),ge.current=0,Je([]),pt.current=[],it(null),yn.current=!1,Mn.current=!1,Gn.current=!1,ma()};return f==="completed"?l.jsx(ta,{className:"max-w-2xl mx-auto",children:l.jsxs(na,{className:"text-center py-12",children:[l.jsxs("div",{className:"mb-6",children:[l.jsx("div",{className:"w-24 h-24 mx-auto mb-4 bg-gradient-to-r from-purple-500 to-pink-500 rounded-full flex items-center justify-center",children:l.jsx(Bn,{className:"h-12 w-12 text-white"})}),l.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Dinamik Dikkat Oyunu Tamamlandı!"}),l.jsx("p",{className:"text-gray-600",children:"Hızlı karar verme becerin gelişiyor!"})]}),l.jsx("div",{className:"bg-gray-50 rounded-lg p-6 mb-6",children:l.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[l.jsxs("div",{children:[l.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:[L,"/",Kt]}),l.jsx("div",{className:"text-sm text-gray-600",children:"Başarılı Tur"})]}),l.jsxs("div",{children:[l.jsxs("div",{className:"text-2xl font-bold text-green-600",children:[Math.round(L/Kt*100),"%"]}),l.jsx("div",{className:"text-sm text-gray-600",children:"Başarı Oranı"})]}),l.jsxs("div",{children:[l.jsx("div",{className:"text-2xl font-bold text-purple-600",children:k.length>0?Math.round(k.reduce((re,De)=>re+De.correctClicks,0)/k.length):0}),l.jsx("div",{className:"text-sm text-gray-600",children:"Ort. Doğru Tıklama"})]})]})}),l.jsxs(ea,{onClick:et,size:"lg",children:[l.jsx(Sh,{className:"h-5 w-5 mr-2"}),"Tekrar Oyna"]})]})}):l.jsxs("div",{className:"max-w-2xl mx-auto space-y-6",children:[l.jsx("video",{ref:ft,autoPlay:!0,playsInline:!0,muted:!0,style:{display:"none"}}),l.jsx(ta,{children:l.jsx(na,{children:l.jsx("div",{className:"flex items-center justify-between",children:l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsxs("div",{className:"text-sm text-gray-600",children:["Tur ",I+1,"/",Kt]}),l.jsxs("div",{className:"text-sm font-medium text-gray-800",children:["Skor: ",L]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Jn,{className:"h-4 w-4 text-purple-600"}),l.jsxs("span",{className:"text-xs text-purple-600",children:["Zorluk: ",t]})]}),E&&l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("div",{className:`w-2 h-2 rounded-full ${Dt.isTrackingActive()&&Dt.isFrameAnalysisActive?.()?"bg-green-500":Dt.isTrackingActive()?"bg-yellow-500":"bg-orange-500"}`}),l.jsx(os,{className:"h-4 w-4 text-green-600"}),l.jsx("span",{className:"text-xs text-green-600",children:Dt.isTrackingActive()&&Dt.isFrameAnalysisActive?.()?"Analiz Aktif":Dt.isTrackingActive()?"Kamera Bağlı":"Mock Mode"})]}),M&&l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Cc,{className:`h-4 w-4 ${M.lookingAtScreen?"text-green-600":"text-red-600"}`}),l.jsxs("span",{className:"text-xs text-gray-600",children:[M.emotion," (",(M.confidence*100).toFixed(0),"%)"]})]})]})})})}),l.jsx(ta,{children:l.jsx(na,{className:"text-center py-12",children:N?l.jsxs("div",{className:"space-y-4",children:[l.jsx("div",{className:"w-16 h-16 border-4 border-purple-500 border-t-transparent rounded-full animate-spin mx-auto"}),l.jsx("p",{className:"text-gray-600",children:"Senin için özel dinamik görev hazırlanıyor..."})]}):f==="ready"?l.jsxs("div",{className:"space-y-6",children:[l.jsx("div",{className:"w-20 h-20 mx-auto mb-4 bg-gradient-to-r from-purple-500 to-pink-500 rounded-full flex items-center justify-center",children:l.jsx(Pk,{className:"h-10 w-10 text-white"})}),l.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Dinamik Dikkat"}),l.jsx("p",{className:"text-gray-600 mb-6",children:"Sürekli çıkan hedefleri hızlıca yakala ve reflexlerini geliştir!"}),c&&l.jsxs("div",{className:"bg-purple-50 rounded-lg p-4 mb-6",children:[l.jsx("h3",{className:"font-medium text-purple-800 mb-2",children:"Görevin:"}),l.jsx("p",{className:"text-purple-700",children:c.gorev}),c.ipuclari?.length>0&&l.jsxs("div",{className:"mt-3",children:[l.jsx("p",{className:"text-xs text-purple-600 font-medium mb-1",children:"İpuçları:"}),c.ipuclari.map((re,De)=>l.jsxs("p",{className:"text-xs text-purple-600",children:["• ",re]},De))]})]}),l.jsxs(ea,{onClick:Ia,size:"lg",disabled:!c,children:[l.jsx(Mi,{className:"h-5 w-5 mr-2"}),"Başla"]})]}):f==="countdown"?l.jsxs("div",{className:"space-y-6",children:[l.jsx("h2",{className:"text-4xl font-bold text-gray-800",children:"Hazırlan!"}),l.jsx("div",{className:"text-6xl font-bold text-purple-600 animate-bounce",children:ae})]}):f==="active"?l.jsxs("div",{className:"space-y-6",children:[l.jsx("h2",{className:"text-xl font-bold text-gray-800",children:c?.gorev}),l.jsxs("div",{className:"relative w-full h-96 bg-gray-50 rounded-lg overflow-hidden",children:[ye.map(re=>l.jsx("button",{onClick:()=>ke(re.id,re.isTarget),className:"absolute w-12 h-12 rounded-full transition-all duration-300 flex items-center justify-center text-2xl shadow-lg border-2 bg-white border-gray-300 hover:bg-gray-50 hover:scale-110 animate-bounce",style:{left:`${re.x}%`,top:`${re.y}%`,transform:"translate(-50%, -50%)",animationDuration:`${.8+Math.random()*.4}s`},children:Gt(re.value)},re.id)),kt&&l.jsx("div",{className:`absolute w-16 h-16 rounded-full flex items-center justify-center text-2xl font-bold animate-ping pointer-events-none ${kt.isCorrect?"bg-green-500 text-white":"bg-red-500 text-white"}`,style:{left:`${kt.x}%`,top:`${kt.y}%`,transform:"translate(-50%, -50%)",zIndex:1e3},children:kt.isCorrect?"✓":"✗"})]}),l.jsxs("div",{className:"flex items-center justify-center space-x-8",children:[l.jsxs("div",{className:"flex items-center space-x-2 text-green-600",children:[l.jsx(Ic,{className:"h-5 w-5"}),l.jsxs("span",{className:"text-lg font-bold",children:["Doğru: ",H]})]}),l.jsxs("div",{className:"flex items-center space-x-2 text-red-600",children:[l.jsx(n4,{className:"h-5 w-5"}),l.jsxs("span",{className:"text-lg font-bold",children:["Yanlış: ",X]})]}),l.jsxs("div",{className:"flex items-center space-x-2 text-blue-600",children:[l.jsx(Bn,{className:"h-5 w-5"}),l.jsxs("span",{className:"text-lg font-bold",children:["Toplam Çıkan: ",$e]})]})]}),l.jsxs("div",{className:"flex items-center justify-center space-x-2 text-lg",children:[l.jsx(ja,{className:"h-5 w-5 text-purple-600"}),l.jsxs("span",{className:"font-mono font-bold text-purple-600",children:[y,"s"]})]})]}):f==="waiting"?l.jsxs("div",{className:"space-y-4",children:[k.length>0&&k[k.length-1].success?l.jsxs("div",{className:"text-green-600",children:[l.jsx(Ic,{className:"h-12 w-12 mx-auto mb-2"}),l.jsx("h3",{className:"text-xl font-bold",children:"Mükemmel!"}),l.jsxs("p",{children:["Doğru: ",k[k.length-1].correctClicks,", Yanlış: ",k[k.length-1].wrongClicks]}),l.jsxs("p",{children:["Hedef Yakalama: ",k[k.length-1].correctClicks,"/",k[k.length-1].targetSpawned," (",Math.round(k[k.length-1].targetHitRate*100),"%)"]}),l.jsxs("p",{children:["Hızlı Tıklama: ",k[k.length-1].fastClicks,"/",k[k.length-1].totalClicksAnalyzed," (",Math.round(k[k.length-1].fastClickRate*100),"%)"]}),l.jsxs("p",{children:["Hızlı+Doğru: ",k[k.length-1].correctFastClicks," (",Math.round(k[k.length-1].fastAccuracyRate*100),"%)"]})]}):l.jsxs("div",{className:"text-orange-600",children:[l.jsx(Bn,{className:"h-12 w-12 mx-auto mb-2"}),l.jsx("h3",{className:"text-xl font-bold",children:"Daha iyi yapabilirsin!"}),k.length>0&&l.jsxs(l.Fragment,{children:[l.jsxs("p",{children:["Doğru: ",k[k.length-1].correctClicks,", Yanlış: ",k[k.length-1].wrongClicks]}),l.jsxs("p",{children:["Hedef Yakalama: ",k[k.length-1].correctClicks,"/",k[k.length-1].targetSpawned," (",Math.round(k[k.length-1].targetHitRate*100),"%)"]}),l.jsxs("p",{children:["Hızlı Tıklama: ",k[k.length-1].fastClicks,"/",k[k.length-1].totalClicksAnalyzed," (",Math.round(k[k.length-1].fastClickRate*100),"%)"]}),l.jsx("p",{children:"Daha dikkatli olmaya çalış"})]})]}),l.jsx("p",{className:"text-sm text-gray-600",children:"Sonraki görev hazırlanıyor..."})]}):null})})]})};class s4{constructor(){this.modelName="llama3.2:1b"}async getAdaptiveDifficulty(e,t){const r=this.buildDifficultyPrompt(e,t);try{const o=await this.callOllama(r),c=this.parseAIResponse(o);return console.log("🤖 AI Zorluk Önerisi:",c),c}catch(o){return console.error("❌ AI Zorluk Analizi hatası:",o),this.getFallbackDifficulty(e)}}buildDifficultyPrompt(e,t){const r=e.totalAttempts>0?e.correctAttempts/e.totalAttempts*100:0;this.analyzeErrorPatterns(e.recentErrors);let o="";return t&&(o=`

KAMERA VERİSİ - TÜM DUYGUSAL DURUMLAR (Oyun süresince):
${t}

DİKKAT: Bu emotion data'dan çok boyutlu analiz yap:

DUYGUSAL DURUM ANALİZİ:
- Hangi duygu baskın? Son trend nasıl?
- Emotion stabilite: Sabit mi değişken mi?
- Pozitif/negatif emotion dengesi?

ÖĞRENME STİLİ ÇIKARIMI:
- confused→happy geçişi = Yavaş öğrenen ama başarılı mı?
- happy→bored pattern = Hızla sıkılan, challenge isteyen mi?
- surprised spike'ları = Yenilikçi görevleri seven mi?

MOTİVASYON/STRES ANALİZİ:
- İçsel motivasyon: happy/neutral dominant mı?
- Frustration tolerance: angry/confused nasıl?
- Kaygı seviyesi: emotion volatility yüksek mi?

ATTENTION SPAN PATTERNİ:
- Emotion değişim hızı = Dikkat süresi ipucu
- Bored'a kadar geçen süre = Natural attention span
- Cognitive load: neutral→confused geçiş noktası

Bu analizlere göre en uygun zorluk stratejisini belirle:

Bu analizine göre çocuğun mevcut duygusal durumuna uygun zorluk ayarla:
- Mutlu/heyecanlı ise: Momentum sürdürecek, biraz daha zorlayıcı görevler
- Kafa karışık/yorgun ise: Basit, net talimatlar, daha az dikkat dağıtıcı
- Odaklanmış ise: Bu durumu koruyacak dengeli görevler
- Stresli/sinirli ise: Sakinleştirici, pozitif, başarıya odaklı görevler`),`Adjust difficulty for ADHD child Stroop game.

DATA: ${r.toFixed(1)}% accuracy, ${e.averageReactionTime}ms reaction${o}

RULES:
- If accuracy >80% AND reaction <2000ms: increase difficulty
- If accuracy <50% OR reaction >2500ms: decrease difficulty
- If reaction <700ms: slow down (impulsive)
- If reaction >2800ms: motivate (struggling)

OUTPUT JSON:
{
  "newSettings": {"boxCount": ${r>80&&e.averageReactionTime<2e3?6:r<50?4:5}, "commandVisibilityDuration": ${e.averageReactionTime<700?3500:e.averageReactionTime>2800?2e3:2500}, "conflictRate": ${r>80?.6:r<50?.3:.5}, "distractorCount": ${r>80?1:0}, "distractorTypes": ["${r>80?"text":"none"}"], "pauseTime": ${e.averageReactionTime<700?800:400}},
  "reasoning": "Based on ${r.toFixed(1)}% accuracy and ${e.averageReactionTime}ms reaction",
  "encouragement": "Keep going!",
  "tips": ["Focus", "Read carefully"]
}`}analyzeErrorPatterns(e){if(!e.length)return"Henüz hata analizi için yeterli veri yok";const t={colorCommand:0,textCommand:0,quickClicks:0,slowClicks:0};e.forEach(c=>{c.includes("color")&&t.colorCommand++,c.includes("text")&&t.textCommand++,c.includes("quick")&&t.quickClicks++,c.includes("slow")&&t.slowClicks++});const r=Object.entries(t).reduce((c,d)=>t[c[0]]>t[d[0]]?c:d);return{colorCommand:"Renk komutlarında zorluk",textCommand:"Kelime komutlarında zorluk",quickClicks:"Çok hızlı tıklama eğilimi",slowClicks:"Yavaş reaksiyon gösterme"}[r[0]]||"Karma hata türleri"}async callOllama(e){const t="http://172.16.0.4:11434/api/generate",r={model:this.modelName,prompt:e,format:"json",stream:!1,options:{temperature:.1,top_p:.7,num_predict:100}};try{const o=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!o.ok)throw new Error(`Ollama API hatası: ${o.status}`);return(await o.json()).response.trim()}catch(o){throw new Error(`Ollama bağlantı hatası: ${o}`)}}parseAIResponse(e){try{let t;try{t=JSON.parse(e.trim())}catch{const c=e.match(/\{[\s\S]*\}/);if(!c)throw new Error("JSON bulunamadı");t=JSON.parse(c[0])}if(!t.newSettings)throw new Error("newSettings eksik");const r=t.newSettings;r.boxCount=Math.max(2,Math.min(10,r.boxCount||4)),r.commandVisibilityDuration=Math.max(1500,Math.min(4e3,r.commandVisibilityDuration||2500)),r.conflictRate=Math.max(.2,Math.min(.9,r.conflictRate||.5)),r.distractorCount=Math.max(0,Math.min(3,r.distractorCount||0)),r.pauseTime=Math.max(200,Math.min(1200,r.pauseTime||600));const o=["emoji","text","shape","none"];return Array.isArray(r.distractorTypes)?(r.distractorTypes=r.distractorTypes.filter(c=>o.includes(c)),r.distractorTypes.length===0&&(r.distractorTypes=["none"])):r.distractorTypes=["none"],{newSettings:r,reasoning:t.reasoning||"AI tarafından optimize edildi",encouragement:t.encouragement||"Harika gidiyorsun! Devam et!",tips:Array.isArray(t.tips)?t.tips:["Odaklan ve sakin ol","Her cevap öğrenme fırsatı"]}}catch(t){throw console.error("AI response parse hatası:",t),new Error(`AI yanıtı parse edilemedi: ${t}`)}}getFallbackDifficulty(e){const t=e.totalAttempts>0?e.correctAttempts/e.totalAttempts:0;let r=5,o=2500,c=.5,d=0,f=600;return t>.8?(r=6,c=.6,d=1):t<.5&&(r=4,c=.3,o=3e3,f=800),{newSettings:{boxCount:r,commandVisibilityDuration:o,conflictRate:c,distractorCount:d,distractorTypes:d>0?["emoji"]:["none"],pauseTime:f},reasoning:"AI mevcut değil, basit algoritma kullanıldı",encouragement:t>.7?"Harika devam ediyorsun!":"Güzel, pratik yapmaya devam et!",tips:["Komutları dikkatli oku","Acele etme, doğruluğa odaklan","Her seferinde biraz daha iyi oluyorsun"]}}setModel(e){this.modelName=e}}const r4=new s4,Sa=["KIRMIZI","MAVİ","YEŞİL","SARI","TURUNCU","PEMBE"],i4={KIRMIZI:"#DC2626",MAVİ:"#2563EB",YEŞİL:"#16A34A",SARI:"#CA8A04",TURUNCU:"#EA580C",PEMBE:"#DB2777"},Lb=["🎯","⚠️","?","⭐","🔥","💎","🎪","⚡"],o4=({studentId:s,studentAge:e=12,difficulty:t="orta",onGameComplete:r,onEmotionDetected:o})=>{const c=T.useRef(null),d=T.useRef([]),f=T.useRef(0),p=T.useRef(null),[y,v]=T.useState(!1),[k,S]=T.useState(null),[I,q]=T.useState(null),[L,P]=T.useState({boxCount:6,commandVisibilityDuration:2500,conflictRate:.5,distractorCount:0,distractorTypes:["none"],pauseTime:600}),[K,U]=T.useState({correctAttempts:0,totalAttempts:0,averageReactionTime:0,streakCounter:0,bestStreak:0,timeSpent:0,difficultyLevel:5,recentErrors:[]}),[B,F]=T.useState(""),[ae,ne]=T.useState([]);T.useMemo(()=>({kolay:L,orta:L,zor:L}),[L]);const[N,R]=T.useState({boxes:[],command:"",commandType:"color",targetColor:"KIRMIZI",score:0,timeRemaining:60,gameStarted:!1,gameEnded:!1,currentLevel:1,consecutiveCorrect:0,consecutiveWrong:0,commandVisible:!0,commandTimeLeft:L.commandVisibilityDuration,boxesVisible:!1,totalAttempts:0,correctAttempts:0,streakCounter:0,bestStreak:0,aiAnalyzing:!1,feedback:{show:!1,type:"correct",message:""}}),E=T.useRef([]),C=T.useRef(0),M=T.useCallback(H=>{const ee=c.current;if(!ee)return console.log("⚠️ [DEBUG] Container not found, using default position"),{x:50+Math.random()*400,y:50+Math.random()*300};const X=ee.getBoundingClientRect(),fe=100,_e=20;if(X.width===0||X.height===0)return console.log("⚠️ [DEBUG] Container has no dimensions, using fallback"),{x:50+Math.random()*400,y:50+Math.random()*300};let Ee=0,$e;do $e={x:Math.random()*(X.width-fe-2*_e)+_e,y:Math.random()*(X.height-fe-2*_e)+_e},Ee++;while(Ee<50&&H.some(je=>Math.abs(je.x-$e.x)<fe+10&&Math.abs(je.y-$e.y)<fe+10));return Ee>10&&console.log("📍 [DEBUG] Position generation took",Ee,"attempts"),$e},[]),z=T.useCallback(async()=>{console.log("🎭 [EMOTION] Emotion tracking başlatılıyor..."),v(!0);const H=X=>{if(!We.isGameActiveStatus())return;S(X),We.addEmotionResult(X);const fe=We.getCurrentGameMetrics();q(fe);const _e={emotion:X.emotion,confidence:X.confidence,timestamp:X.timestamp};d.current=[...d.current.slice(-10),_e],o?.(_e)};let ee=!1;p.current&&(ee=await Dt.startEmotionTracking(p.current,H)),ee||(console.log("📱 [EMOTION] Gerçek kamera bulunamadı - Python server çalışıyor mu?"),console.log("💡 [TIP] Terminal'de çalıştır: python emotion_server.py")),console.log("✅ [EMOTION] Emotion tracking aktif")},[o]),j=T.useCallback(()=>{console.log("⏹️ [EMOTION] Emotion tracking durduruluyor..."),Dt.stopEmotionTracking(),v(!1);const H=We.endGameSession();q(H),console.log("🏁 [EMOTION] Final metrics:",H)},[]),Ve=T.useCallback((H,ee)=>{const X=L,fe=[],_e=[];console.log("🎯 [DEBUG] Generating boxes for:",{targetColor:H,commandType:ee,settings:X});const Ee=M(_e);_e.push(Ee);const $e={id:0,textLabel:H,textColor:H,position:Ee,isCorrect:!0};if(ee==="text"){$e.textLabel=H;const ge=Sa.filter(Ze=>Ze!==H);$e.textColor=ge[Math.floor(Math.random()*ge.length)]}else{$e.textColor=H;const ge=Sa.filter(Ze=>Ze!==H);$e.textLabel=ge[Math.floor(Math.random()*ge.length)]}console.log("✅ [DEBUG] Correct box created:",$e),fe.push($e);const je=Math.max(2,X.boxCount-1-(X.distractorCount||0));console.log("📊 [DEBUG] Generating",je,"normal boxes + 1 correct box =",je+1,"total");for(let ge=1;ge<=je;ge++){const Ze=M(_e);_e.push(Ze);const Me=Math.random()<X.conflictRate;let Ie,gt,Je=0;do{if(Je++,Me){Ie=Sa[Math.floor(Math.random()*Sa.length)];do gt=Sa[Math.floor(Math.random()*Sa.length)];while(gt===Ie)}else{const kt=Sa[Math.floor(Math.random()*Sa.length)];Ie=kt,gt=kt}if(!(ee==="color"?gt===H:Ie===H))break;if(Je>=10){if(ee==="color"){const kt=Sa.filter(it=>it!==H);gt=kt[Math.floor(Math.random()*kt.length)]}else{const kt=Sa.filter(it=>it!==H);Ie=kt[Math.floor(Math.random()*kt.length)]}break}}while(Je<20);fe.push({id:ge,textLabel:Ie,textColor:gt,position:Ze,isCorrect:!1})}const pe=X.distractorCount;if(pe>0&&!X.distractorTypes.includes("none"))for(let ge=je+1;ge<=je+pe;ge++){const Ze=M(_e);_e.push(Ze);let Me;const Ie=X.distractorTypes[Math.floor(Math.random()*X.distractorTypes.length)];switch(Ie){case"emoji":Me=Lb[Math.floor(Math.random()*Lb.length)];break;case"text":Me="?";break;case"shape":Me="●";break;default:continue}fe.push({id:ge,textLabel:Me,textColor:"KIRMIZI",position:Ze,isCorrect:!1,isDistractor:!0}),console.log(`🎭 [DEBUG] Distractor box ${ge} created with type ${Ie}`)}const he=fe.filter(ge=>ge.isCorrect);return console.log("🔍 [DEBUG] Final boxes check:",{totalBoxes:fe.length,correctBoxes:he.length,normalBoxes:fe.filter(ge=>!ge.isCorrect&&!ge.isDistractor).length,distractorBoxes:fe.filter(ge=>ge.isDistractor).length}),he.length===0&&(console.error("❌ [ERROR] No correct boxes found! This should not happen."),fe.length>0&&(fe[0].isCorrect=!0,ee==="text"?fe[0].textLabel=H:fe[0].textColor=H)),fe},[L,M]),le=T.useCallback(()=>{if(!c.current){setTimeout(()=>le(),100);return}const H=Math.random()>.5?"color":"text",ee=Sa[Math.floor(Math.random()*Sa.length)],X=H==="color"?`${ee} renkli yazana tıkla`:`${ee} yazısını seç`,fe=Ve(ee,H);We.startRoundSession(),R(_e=>({..._e,boxes:fe,command:X,commandType:H,targetColor:ee,commandVisible:!0,commandTimeLeft:L.commandVisibilityDuration,boxesVisible:!1,feedback:{show:!1,type:"correct",message:""}})),setTimeout(()=>{R(_e=>({..._e,commandVisible:!1,boxesVisible:!0})),C.current=Date.now()},L.commandVisibilityDuration)},[Ve,L]),W=T.useCallback(H=>{const ee=N.boxes.find(je=>je.id===H);if(!ee||N.gameEnded||N.aiAnalyzing||!N.boxesVisible)return;const X=ee.isCorrect,_e=Date.now()-C.current;E.current.push(_e);const Ee=We.endRoundSession();console.log("🏁 [CONFLICT ROUND ENDED] Round emotion data:",Ee.length),R(je=>{const pe={...je};if(pe.totalAttempts+=1,X){pe.correctAttempts+=1,pe.streakCounter+=1,pe.bestStreak=Math.max(pe.bestStreak,pe.streakCounter);const he=Math.max(0,Math.floor(je.commandTimeLeft/100*10));pe.score+=100+he,pe.consecutiveCorrect+=1,pe.consecutiveWrong=0,pe.feedback={show:!0,type:"correct",message:`Doğru! +${100+he} puan`}}else{pe.streakCounter=0,pe.score=Math.max(0,pe.score-50),pe.timeRemaining=Math.max(0,pe.timeRemaining-2),pe.consecutiveWrong+=1,pe.consecutiveCorrect=0;const he=`${je.commandType}_error_${_e<1e3?"quick":"slow"}`;pe.feedback={show:!0,type:"incorrect",message:"Yanlış! -50 puan, -2 saniye"},U(ge=>({...ge,recentErrors:[...ge.recentErrors.slice(-4),he]}))}return pe}),U(je=>({...je,correctAttempts:X?je.correctAttempts+1:je.correctAttempts,totalAttempts:je.totalAttempts+1,averageReactionTime:E.current.length>0?E.current.reduce((he,ge)=>he+ge,0)/E.current.length:0,streakCounter:X?je.streakCounter+1:0,bestStreak:Math.max(je.bestStreak,X?je.streakCounter+1:0),timeSpent:Date.now()-f.current,difficultyLevel:Math.round(((L.boxCount-2)/8+L.conflictRate)*5)}));const $e=N.totalAttempts+1;$e>=5&&$e%3===0?(console.log("🚀 AI Tetikleniyor! Deneme sayısı:",$e),R(je=>({...je,aiAnalyzing:!0,boxesVisible:!0})),de().then(()=>{R(je=>({...je,aiAnalyzing:!1,boxesVisible:!1})),setTimeout(()=>{le()},L.pauseTime)})):($e<5&&console.log("📊 Veri toplaniyor... Deneme:",$e,"/5"),setTimeout(()=>{le()},L.pauseTime))},[N.boxes,N.gameEnded,N.boxesVisible,N.aiAnalyzing,N.totalAttempts,L,le]),de=T.useCallback(async()=>{if(K.totalAttempts<3){console.log("⚠️ Yetersiz veri, AI analizi atlanıyor. Deneme:",K.totalAttempts),F("Daha fazla veri toplanıyor... 📊"),setTimeout(()=>F(""),2e3);return}try{console.log("🤖 AI Adaptasyon kontrolü başlıyor...",K),F("AI analiz ediyor... 🤖");const H=We.getCurrentRoundEmotions(),ee=We.getFullGameEmotions(),X=ee.length>0?JSON.stringify(ee):void 0;console.log("🤖 [CONFLICT AI PROMPT DATA]",{hasEmotionData:!!X,roundEmotionCount:H.length,fullGameEmotionCount:ee.length,performanceMetrics:K,emotionsSource:"full-game-emotions"});const fe=await r4.getAdaptiveDifficulty(K,X);P(fe.newSettings),F(fe.encouragement),ne(fe.tips),console.log("✅ AI Adaptasyon tamamlandı:",{newSettings:fe.newSettings,reasoning:fe.reasoning,oldSettings:L,emotionDataUsed:!!X}),console.log("🧹 [EMOTION RESET] AI analizi sonrası emotion data temizleniyor"),We.clearHistory(),setTimeout(()=>{F("")},5e3)}catch(H){console.error("❌ AI Adaptasyon hatası:",H);const ee=K.totalAttempts>0?K.correctAttempts/K.totalAttempts:0;ee>.8?(P(X=>({...X,boxCount:Math.min(8,X.boxCount+1),conflictRate:Math.min(.9,X.conflictRate+.1)})),F("Harika performans! Zorluk artırıldı 🚀")):ee<.5?(P(X=>({...X,boxCount:Math.max(3,X.boxCount-1),conflictRate:Math.max(.3,X.conflictRate-.1)})),F("Kolaylaştırdım, sen yapabilirsin! 💪")):F("Güzel devam ediyorsun! 👍"),setTimeout(()=>{F("")},4e3)}},[K,L]),me=T.useCallback(async()=>{await z(),U({correctAttempts:0,totalAttempts:0,averageReactionTime:0,streakCounter:0,bestStreak:0,timeSpent:0,difficultyLevel:5,recentErrors:[]}),E.current=[],We.startGameSession(),We.startRoundSession(),R(H=>({...H,gameStarted:!0,gameEnded:!1,score:0,timeRemaining:60,currentLevel:1,consecutiveCorrect:0,consecutiveWrong:0,totalAttempts:0,correctAttempts:0,streakCounter:0,bestStreak:0,boxesVisible:!1})),f.current=Date.now(),d.current=[],Dt.startFrameAnalysis?.(),le()},[le]),ye=T.useCallback(()=>{Dt.stopFrameAnalysis?.(),j(),R(ee=>({...ee,gameEnded:!0}));const H=Date.now()-f.current;r(N.score,H,d.current)},[N.score,r,j]),O=T.useCallback(()=>{P({boxCount:6,commandVisibilityDuration:2500,conflictRate:.5,distractorCount:0,distractorTypes:["none"],pauseTime:600}),F(""),ne([]),v(!1),S(null),q(null),d.current=[],R(H=>({...H,gameStarted:!1,gameEnded:!1,score:0,timeRemaining:60,currentLevel:1,consecutiveCorrect:0,consecutiveWrong:0,totalAttempts:0,correctAttempts:0,streakCounter:0,bestStreak:0,aiAnalyzing:!1,boxesVisible:!1,boxes:[]}))},[]);return T.useEffect(()=>{if(!N.gameStarted||N.gameEnded||N.aiAnalyzing)return;const H=setInterval(()=>{R(ee=>ee.timeRemaining<=1?{...ee,timeRemaining:0}:{...ee,timeRemaining:ee.timeRemaining-1})},1e3);return()=>clearInterval(H)},[N.gameStarted,N.gameEnded,N.aiAnalyzing]),T.useEffect(()=>{N.gameStarted&&N.timeRemaining===0&&!N.gameEnded&&ye()},[N.gameStarted,N.timeRemaining,N.gameEnded,ye]),T.useEffect(()=>{if(N.feedback.show){const H=setTimeout(()=>{R(ee=>({...ee,feedback:{...ee.feedback,show:!1}}))},1500);return()=>clearTimeout(H)}},[N.feedback.show]),N.gameStarted?N.gameEnded?l.jsxs("div",{className:"max-w-2xl mx-auto space-y-6",children:[l.jsx("video",{ref:p,autoPlay:!0,playsInline:!0,muted:!0,style:{display:"none"}}),l.jsx(ta,{children:l.jsxs(na,{className:"text-center py-8",children:[l.jsx("div",{className:"mb-6",children:l.jsx("div",{className:"w-20 h-20 mx-auto bg-gradient-to-r from-green-500 to-blue-500 rounded-full flex items-center justify-center",children:l.jsx(nh,{className:"h-10 w-10 text-white"})})}),l.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-4",children:"Oyun Tamamlandı!"}),l.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 max-w-2xl mx-auto mb-6",children:[l.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[l.jsx("div",{className:"text-2xl font-bold text-blue-600",children:N.score}),l.jsx("div",{className:"text-sm text-blue-800",children:"Toplam Puan"})]}),l.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[l.jsxs("div",{className:"text-2xl font-bold text-green-600",children:["%",N.totalAttempts>0?Math.round(N.correctAttempts/N.totalAttempts*100):0]}),l.jsx("div",{className:"text-sm text-green-800",children:"Doğruluk"})]}),l.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg",children:[l.jsx("div",{className:"text-2xl font-bold text-purple-600",children:N.bestStreak}),l.jsx("div",{className:"text-sm text-purple-800",children:"En İyi Seri"})]}),l.jsxs("div",{className:"bg-orange-50 p-4 rounded-lg",children:[l.jsxs("div",{className:"text-2xl font-bold text-orange-600",children:[K.averageReactionTime>0?Math.round(K.averageReactionTime):0,"ms"]}),l.jsx("div",{className:"text-sm text-orange-800",children:"Ort. Reaksiyon"})]})]}),ae.length>0&&l.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 p-4 rounded-lg max-w-md mx-auto mb-6",children:[l.jsxs("div",{className:"flex items-center mb-2",children:[l.jsx(Jn,{className:"h-5 w-5 text-blue-600 mr-2"}),l.jsx("span",{className:"font-semibold text-blue-800",children:"AI Analizi"})]}),l.jsx("div",{className:"space-y-1",children:ae.map((H,ee)=>l.jsxs("div",{className:"text-sm text-blue-700",children:["• ",H]},ee))})]}),l.jsxs("div",{className:"flex gap-4 justify-center",children:[l.jsxs(ea,{onClick:O,className:"bg-gradient-to-r from-blue-500 to-purple-500 hover:from-blue-600 hover:to-purple-600 text-white",children:[l.jsx(Sh,{className:"h-4 w-4 mr-2"}),"Tekrar Oyna"]}),l.jsx(ea,{onClick:()=>r(N.score,Date.now()-f.current,d.current),variant:"outline",children:"Bitir"})]})]})})]}):l.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-purple-50 p-4",children:[l.jsx("video",{ref:p,autoPlay:!0,playsInline:!0,muted:!0,style:{display:"none"}}),l.jsx("div",{className:"max-w-6xl mx-auto mb-6",children:l.jsx(ta,{children:l.jsx(na,{className:"py-4",children:l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsxs("div",{className:"flex items-center space-x-6",children:[N.commandVisible&&l.jsxs("div",{className:"bg-gradient-to-r from-blue-500 to-purple-500 text-white px-8 py-4 rounded-xl shadow-lg",children:[l.jsx("div",{className:"font-bold text-2xl text-center",children:N.command}),l.jsx("div",{className:"text-sm text-center mt-2 opacity-90",children:"Komutu oku ve hatırla!"})]}),!N.commandVisible&&!N.boxesVisible&&l.jsx("div",{className:"bg-gradient-to-r from-orange-500 to-red-500 text-white px-6 py-3 rounded-lg",children:l.jsx("div",{className:"font-bold text-lg text-center",children:"Kutular hazırlanıyor..."})}),!N.commandVisible&&N.boxesVisible&&l.jsx("div",{className:"text-gray-600 italic text-lg font-semibold",children:"Komutu hatırla ve doğru kutuyu seç!"})]}),l.jsxs("div",{className:"flex items-center space-x-6 text-sm",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(ja,{className:"h-4 w-4 text-blue-600"}),l.jsxs("span",{className:"font-semibold",children:[N.timeRemaining,"s"]})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(nh,{className:"h-4 w-4 text-green-600"}),l.jsx("span",{className:"font-semibold",children:N.score})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Bn,{className:"h-4 w-4 text-purple-600"}),l.jsxs("span",{className:"font-semibold",children:[N.totalAttempts>0?Math.round(N.correctAttempts/N.totalAttempts*100):0,"% Doğru"]})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Ii,{className:"h-4 w-4 text-orange-600"}),l.jsxs("span",{className:"font-semibold",children:["Seri: ",N.streakCounter]})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Jn,{className:"h-4 w-4 text-indigo-600"}),l.jsxs("span",{className:"font-semibold text-xs",children:["AI: ",L.boxCount," kutu, %",Math.round(L.conflictRate*100)," çatışma"]})]}),y&&l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("div",{className:`w-2 h-2 rounded-full ${Dt.isTrackingActive()&&Dt.isFrameAnalysisActive?.()?"bg-green-500":Dt.isTrackingActive()?"bg-yellow-500":"bg-orange-500"}`}),l.jsx(os,{className:"h-4 w-4 text-green-600"}),l.jsx("span",{className:"text-xs text-green-600",children:Dt.isTrackingActive()&&Dt.isFrameAnalysisActive?.()?"Analiz Aktif":Dt.isTrackingActive()?"Kamera Bağlı":"Mock Mode"})]}),k&&l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Cc,{className:`h-4 w-4 ${k.lookingAtScreen?"text-green-600":"text-red-600"}`}),l.jsxs("span",{className:"text-xs text-gray-600",children:[k.emotion," (",(k.confidence*100).toFixed(0),"%)"]})]})]})]})})})}),l.jsx("div",{className:"max-w-6xl mx-auto",children:l.jsx("div",{ref:c,className:"relative w-full h-[600px] bg-white rounded-xl shadow-lg overflow-hidden",style:{position:"relative"},children:N.boxesVisible&&N.boxes.map(H=>l.jsx("div",{className:"absolute cursor-pointer transform hover:scale-105 transition-transform duration-150",style:{left:H.position.x,top:H.position.y,width:"100px",height:"100px"},onClick:()=>W(H.id),children:l.jsx("div",{className:"w-full h-full bg-white rounded-lg shadow-md border-2 border-gray-200 flex items-center justify-center hover:shadow-lg",children:H.isDistractor?l.jsx("div",{className:"text-4xl",children:H.textLabel}):l.jsx("div",{className:"text-xl font-bold",style:{color:i4[H.textColor]},children:H.textLabel})})},H.id))})}),N.aiAnalyzing&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-gradient-to-r from-blue-500 to-purple-500 text-white px-8 py-6 rounded-xl shadow-lg",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"w-6 h-6 border-2 border-white border-t-transparent rounded-full animate-spin"}),l.jsx(Jn,{className:"h-6 w-6"}),l.jsx("span",{className:"font-semibold text-lg",children:"AI performansını analiz ediyor..."})]}),l.jsx("div",{className:"text-center mt-2 text-blue-100 text-sm",children:"Oyun kısa sürede devam edecek"})]})}),B&&!N.aiAnalyzing&&l.jsx("div",{className:"fixed top-20 left-1/2 transform -translate-x-1/2 z-40 pointer-events-none",children:l.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-purple-500 text-white px-6 py-3 rounded-xl shadow-lg",children:l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Jn,{className:"h-5 w-5"}),l.jsx("span",{className:"font-semibold",children:B})]})})}),N.feedback.show&&l.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-50 pointer-events-none",children:l.jsx("div",{className:`
            px-8 py-4 rounded-xl text-white text-xl font-bold shadow-lg
            ${N.feedback.type==="correct"?"bg-gradient-to-r from-green-500 to-emerald-500":"bg-gradient-to-r from-red-500 to-pink-500"}
          `,children:N.feedback.message})})]}):l.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[l.jsx("video",{ref:p,autoPlay:!0,playsInline:!0,muted:!0,style:{display:"none"}}),l.jsx(ta,{children:l.jsxs(na,{className:"text-center py-8",children:[l.jsx("div",{className:"mb-6",children:l.jsx("div",{className:"w-20 h-20 mx-auto bg-gradient-to-r from-red-500 to-orange-500 rounded-full flex items-center justify-center",children:l.jsx(Jn,{className:"h-10 w-10 text-white"})})}),l.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-4",children:"Çatışma Oyunu"}),l.jsx("p",{className:"text-gray-600 text-lg mb-6",children:"Stroop etkisiyle dikkatini geliştir! Yazan kelimeyle renk farklı olabilir."}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 max-w-2xl mx-auto mb-6",children:[l.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[l.jsx(Bn,{className:"h-6 w-6 text-blue-600 mx-auto mb-2"}),l.jsx("h3",{className:"font-semibold text-blue-800 mb-1",children:"Renk Odaklı"}),l.jsx("p",{className:"text-sm text-blue-600",children:"Belirtilen renkteki yazıyı bul"})]}),l.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[l.jsx(Jn,{className:"h-6 w-6 text-green-600 mx-auto mb-2"}),l.jsx("h3",{className:"font-semibold text-green-800 mb-1",children:"Kelime Odaklı"}),l.jsx("p",{className:"text-sm text-green-600",children:"Belirtilen kelimeyi bul"})]}),l.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg",children:[l.jsx(ja,{className:"h-6 w-6 text-purple-600 mx-auto mb-2"}),l.jsx("h3",{className:"font-semibold text-purple-800 mb-1",children:"Zamana Karşı"}),l.jsx("p",{className:"text-sm text-purple-600",children:"60 saniyede en yüksek skoru yap"})]})]}),l.jsxs("div",{className:"mb-6 p-4 bg-yellow-50 rounded-lg max-w-md mx-auto",children:[l.jsx("h4",{className:"font-semibold text-yellow-800 mb-2",children:"Nasıl Oynanır?"}),l.jsxs("ul",{className:"text-sm text-yellow-700 space-y-1",children:[l.jsx("li",{children:"• Ekranda çıkan komutu oku"}),l.jsx("li",{children:"• Komuta uygun kutuyu tıkla"}),l.jsx("li",{children:"• Dikkat: Kelime ve renk farklı olabilir!"}),l.jsx("li",{children:"• Doğru: +100 puan, Yanlış: -50 puan"})]})]}),l.jsxs("div",{className:"flex flex-col gap-4 items-center",children:[l.jsxs(ea,{onClick:me,size:"lg",className:"bg-gradient-to-r from-red-500 to-orange-500 hover:from-red-600 hover:to-orange-600 text-white px-8 py-3",children:[l.jsx(Bn,{className:"h-5 w-5 mr-2"}),"Oyunu Başlat - ",t==="kolay"?"Kolay":t==="orta"?"Orta":"Zor"]}),l.jsxs(ea,{onClick:()=>de(),variant:"outline",size:"sm",className:"text-blue-600 border-blue-600 hover:bg-blue-50",children:[l.jsx(Jn,{className:"h-4 w-4 mr-2"}),"AI Test Et"]})]})]})})]})};class l4{constructor(){this.modelName="gemma2:2b"}async generateQuestion(e){const{subject:t,difficulty:r,questionType:o="çoktan seçmeli"}=e;console.log("🤖 [OLLAMA DEBUG] Soru üretimi başlıyor:",{subject:t,difficulty:r,questionType:o,timestamp:new Date().toISOString(),stack:new Error().stack?.split(`
`).slice(1,5).join(`
`)});const c=this.buildPrompt(t,r,o);try{const d=await this.callOllama(c),f=this.parseOllamaResponse(d);return console.log("✅ [OLLAMA DEBUG] Soru başarıyla üretildi:",f.question),{id:`ollama_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,question:f.question,options:f.options,correctAnswer:f.correctIndex,confidence:.9,gameType:"word-image",difficulty:this.mapDifficultyToEnglish(r),source:"ollama"}}catch(d){throw console.error("❌ [OLLAMA DEBUG] Soru üretme hatası:",d),new Error(`Ollama servisi ile soru üretilemedi: ${d}`)}}buildPrompt(e,t,r){return`Aşağıdaki talimatları tamamen uygula ve yalnızca istenen biçimde yanıt ver.

Profil (hedef kitle)
Yaş: 12 (ortaokul 5–6. sınıf).
Dikkat süresi için: tek görev, tek cümle, somut/giriş düzeyi soyut kavramlar.
Kelime dağarcığı: B1 düzeyi; günlük ve dersle ilişkili sözcükler.

Dil ve karakterler
Yanıt yalnızca Türkçe olmalıdır.
Çin/Japon tipi karakter ve noktalama kullanma (örn. ： ， ︿ ＜ ＞).
ASCII soru işareti ? kullan.

Çıktı formatı (zorunlu)
Sadece tek bir JSON nesnesi döndür; açıklama/ek metin yok.
Şema: {"question": string, "options": [string,string,string,string], "correctIndex": number}

Kurallar:
question: 6–8 kelime, kısa ve net.
options: tam 4 seçenek, Türkçe ve emoji ile görsel zengin.
Seçenekler benzersiz, benzer uzunlukta; sadece 1 doğru.
correctIndex: 0–3 arası tamsayı.

ADHD'ye uygun tasarım
Olumsuz kalıp kullanma ("hangisi değildir" yok).
Belirsiz/iki anlamlı ifadeler yok.
Aynı veya çok benzer emojiler kullanma (karışıklık oluşturma).
Gereksiz süsleme ve uzun cümleler yok.

Zorluk haritalaması (12 yaş):
kolay: doğrudan tanıma/isimlendirme; açık farklar; 1 adım.
orta: temel sınıflama/özdeşlik; yakın ama ayrılabilir çeldiriciler.
zor: kısa bağlam ipucu veya 2 adımlı basit akıl yürütme (yine kısa).

Kalite kontrolleri
Soru "hangi / ne / kim / nerede / nedir / nasıl" kalıbı içersin.
Seçenekler dilbilgisel olarak tutarlı (hepsi kısa söz öbekleri).
Soruda cevabı açık etmeyin (ipucu sızıntısı yok).
Doğru cevabın konumu rastgele olsun; sabit pozisyon kullanma.

Konu: ${e}
Zorluk: ${t}

DOĞRU örnek
{"question":"🐶 hangi ses çıkarır?","options":["Hav hav","Miyav","Möö","Cik cik"],"correctIndex":0}

YANLIŞ örnekler (yapma)
Ek açıklama/metin döndürmek.
Çin tipi noktalama: ： ， ︿ ＜ ＞
Uzun/iki görevli sorular.
Birden çok doğru cevap.`}getADHDGuidelines(e){switch(e){case"kolay":return`
- Çok basit, günlük yaşamdan konular
- Büyük, kontrastlı emojiler kullan
- Sadece bir odak noktası
- Pozitif, eğlenceli dil`;case"orta":return`
- Bilinen konulardan biraz farklı örnekler
- Rengarenk emojiler
- Hafif düşündürücü ama yorucu değil
- Teşvik edici ifadeler`;case"zor":return`
- Dikkat gerektiren detaylar
- Çoklu görsel ipuçları
- Problem çözme odaklı
- Başarı hissi verecek zorlukta`;default:return"- Temel ADHD uyumlu tasarım prensiplerine uygun"}}async callOllama(e){const t="/ollama/generate";console.log("📡 [OLLAMA DEBUG] API çağrısı başlıyor...");const r={model:this.modelName,prompt:e,format:"json",stream:!1,options:{temperature:.7,top_p:.9,num_predict:150,top_k:40}};try{const o=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!o.ok)throw new Error(`Ollama API hatası: ${o.status} ${o.statusText}`);const c=await o.json();if(!c.response)throw new Error("Ollama boş yanıt döndürdü");return console.log("📨 [OLLAMA DEBUG] API yanıtı alındı"),c.response.trim()}catch(o){throw o instanceof Error?new Error(`Ollama API hatası: ${o.message}`):o}}parseOllamaResponse(e){console.log("🔍 [OLLAMA DEBUG] Parse edilecek yanıt:",e);try{let t;try{t=JSON.parse(e.trim())}catch{const c=e.match(/\{[\s\S]*\}/);if(!c)throw new Error(`JSON bulunamadı. Ham yanıt: ${e}`);const d=c[0];t=JSON.parse(d)}if(!t?.question||typeof t.question!="string")throw new Error(`Geçersiz question: ${t?.question}`);const r=/[\u4e00-\u9fff\uff00-\uffef：，＞︿＜]/;if(r.test(t.question))throw new Error(`Soru Çince karakter içeriyor: ${t.question}`);if(!Array.isArray(t?.options))throw new Error(`Options array değil: ${t?.options}`);if(t.options.length!==4)throw new Error(`4 seçenek gerekli, ${t.options.length} bulundu: ${JSON.stringify(t.options)}`);for(const o of t.options){if(typeof o!="string")throw new Error(`Seçenek string değil: ${o}`);if(r.test(o))throw new Error(`Seçenek Çince karakter içeriyor: ${o}`)}if(typeof t?.correctIndex!="number")throw new Error(`correctIndex sayı değil: ${t?.correctIndex}`);if(t.correctIndex<0||t.correctIndex>3)throw new Error(`correctIndex 0-3 arasında olmalı: ${t.correctIndex}`);return console.log("✅ [OLLAMA DEBUG] JSON başarıyla parse edildi"),t}catch(t){throw console.error("❌ [OLLAMA DEBUG] JSON parse hatası:",t),console.error("🔍 [OLLAMA DEBUG] Ham yanıt:",e),new Error(`Model JSON döndürmedi veya format hatalı: ${t}`)}}mapDifficultyToEnglish(e){return{kolay:"easy",orta:"medium",zor:"hard"}[e]||"medium"}setModel(e){this.modelName=e}getCurrentModel(){return this.modelName}async checkOllamaStatus(){try{const e=await fetch("/ollama/tags",{method:"GET",headers:{"Content-Type":"application/json"}});return e.ok?((await e.json()).models||[]).some(o=>o.name.includes(this.modelName.split(":")[0])):!1}catch(e){return console.error("Ollama status kontrolü hatası:",e),!1}}async generateSimpleResponse(e){console.log("🤖 [OLLAMA DEBUG] Basit yanıt üretimi başlıyor:",e);const t=`${e}

ÖNEMLI TALİMATLAR:
- Sadece tek kelime renk ismi söyle
- Hiç açıklama yapma
- <think> tag'i kullanma
- "Hmm" gibi düşünce belirteci kullanma
- Sadece renk ismini yaz ve dur

Örnek: "Mavi" veya "Kırmızı"`;try{const r="/ollama/generate",o={model:this.modelName,prompt:t,stream:!1,options:{temperature:.3,top_p:.5,num_predict:20,top_k:20}},c=await fetch(r,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});if(!c.ok)throw new Error(`Ollama API hatası: ${c.status} ${c.statusText}`);const d=await c.json();if(!d.response)throw new Error("Ollama boş yanıt döndürdü");return console.log("✅ [OLLAMA DEBUG] Basit yanıt alındı:",d.response.trim()),d.response.trim()}catch(r){throw console.error("❌ [OLLAMA DEBUG] Basit yanıt hatası:",r),new Error(`Ollama servisi yanıt veremedi: ${r}`)}}async generateMultipleQuestions(e,t=5){const r=[];for(let o=0;o<t;o++)try{const c=await this.generateQuestion(e);r.push(c),await new Promise(d=>setTimeout(d,1e3))}catch(c){console.error(`${o+1}. soru üretme hatası:`,c)}if(r.length===0)throw new Error("Hiç soru üretilemedi");return r}}const c4=new l4,Ar=[{name:"Kırmızı",hex:"#FF0000",bgColor:"bg-red-500"},{name:"Mavi",hex:"#0000FF",bgColor:"bg-blue-500"},{name:"Yeşil",hex:"#00FF00",bgColor:"bg-green-500"},{name:"Sarı",hex:"#FFFF00",bgColor:"bg-yellow-500"},{name:"Turuncu",hex:"#FFA500",bgColor:"bg-orange-500"},{name:"Mor",hex:"#800080",bgColor:"bg-purple-500"},{name:"Pembe",hex:"#FFC0CB",bgColor:"bg-pink-500"},{name:"Beyaz",hex:"#FFFFFF",bgColor:"bg-white"},{name:"Siyah",hex:"#000000",bgColor:"bg-black"}],u4=({studentId:s,studentAge:e=6,onGameComplete:t,onEmotionDetected:r})=>{const[o,c]=T.useState("idle"),[d,f]=T.useState(null),[p,y]=T.useState(5),[v,k]=T.useState(60),[S,I]=T.useState(0),[q,L]=T.useState(1),[P]=T.useState(Date.now()),[K,U]=T.useState([]),[B,F]=T.useState(!1);T.useEffect(()=>{console.log("🎬 isVideoActive değişti:",B)},[B]);const[ae,ne]=T.useState(!1),[N,R]=T.useState(""),[E,C]=T.useState(0),[M,z]=T.useState(""),[j,Ve]=T.useState(null),le=T.useRef(null),W=T.useRef(null),de=T.useRef(null),me=T.useRef(null),ye=T.useRef(null),O=T.useRef(null),H=T.useCallback(async()=>{if(console.log("🎥 Kamera başlatılmaya çalışılıyor..."),console.log("🔍 Video ref durumu:",{current:!!le.current,isConnected:le.current?.isConnected,parentElement:!!le.current?.parentElement}),!le.current){console.error("❌ Video element henüz mevcut değil, DOM mount bekleniyor..."),z("Video element henüz hazır değil"),setTimeout(()=>{le.current&&(console.log("🔄 Video element bulundu, tekrar deneniyor..."),H())},500);return}if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia){const he="Browser kamera desteği yok. Lütfen modern bir tarayıcı kullanın.";console.error("❌",he),z(he),F(!1);return}try{const he=await navigator.mediaDevices.getUserMedia({video:!0,audio:!1});if(console.log("✅ Kamera akışı alındı:",he),le.current){console.log("🎬 Video element bulundu, stream atanıyor..."),console.log("🏗️ Video element DOM durumu:",{isConnected:le.current.isConnected,parentElement:!!le.current.parentElement,tagName:le.current.tagName,autoplay:le.current.autoplay,playsInline:le.current.playsInline,muted:le.current.muted}),console.log("📊 Video element durumu:",{readyState:le.current.readyState,networkState:le.current.networkState,videoWidth:le.current.videoWidth,videoHeight:le.current.videoHeight}),le.current.srcObject=he,le.current.onloadedmetadata=null,le.current.onerror=null;const ge=()=>{console.log("📹 Video metadata yüklendi"),console.log("📏 Video boyutları:",le.current?.videoWidth,"x",le.current?.videoHeight),console.log("📊 Video readyState:",le.current?.readyState),le.current&&le.current.play().then(()=>{console.log("▶️ Video oynatılmaya başladı"),console.log("✅ setIsVideoActive(true) çağrılıyor"),F(!0),z("")}).catch(Je=>{console.error("❌ Video oynatma hatası:",Je),z("Video oynatılamıyor. Lütfen tarayıcıyı yenileyin."),F(!1)})},Ze=Je=>{console.error("❌ Video element hatası:",Je),z("Video element hatası oluştu."),F(!1)};console.log("🔧 Event listener'lar ekleniyor..."),le.current.addEventListener("loadedmetadata",ge),le.current.addEventListener("error",Ze),console.log("📊 Stream atama sonrası durum:",{readyState:le.current.readyState,networkState:le.current.networkState,srcObject:!!le.current.srcObject}),le.current.readyState>=1?(console.log("📹 Metadata zaten yüklü, direkt oynatılıyor"),ge()):console.log("⏳ Metadata yüklenmesi bekleniyor..."),setTimeout(()=>{le.current&&le.current.srcObject&&(console.log("🚀 Immediate play attempt..."),le.current.play().then(()=>{console.log("✅ Immediate play başarılı"),B||(F(!0),z(""))}).catch(Je=>{console.log("⏸️ Immediate play başarısız (normal):",Je.message)}))},100);const Ie=()=>{console.log("✅ Video oynatılabilir durumda"),console.log("🔍 isVideoActive mevcut değeri:",B),B||(console.log("📺 setIsVideoActive(true) çağrılıyor (canplay event)"),F(!0),z(""))};le.current.addEventListener("canplay",Ie);const gt=()=>{if(le.current&&!B&&(console.log("🔄 Agresif kontrol...",{readyState:le.current.readyState,videoWidth:le.current.videoWidth,videoHeight:le.current.videoHeight,srcObject:!!le.current.srcObject,currentTime:le.current.currentTime}),le.current.srcObject&&(le.current.readyState>=1||le.current.videoWidth>0||le.current.currentTime>0))){console.log("🚀 AGRESIF AKTİFLEŞTİRME: setIsVideoActive(true)"),F(!0),z("");return}B||setTimeout(gt,500)};setTimeout(gt,500)}}catch(he){console.error("❌ Kamera erişimi başarısız:",he),console.error("Hata tipi:",he.name),console.error("Hata mesajı:",he.message);let ge="";he.name==="NotAllowedError"?ge="Kamera izni reddedildi. Lütfen tarayıcı ayarlarından kamera iznini aktifleştirin.":he.name==="NotFoundError"?ge="Kamera bulunamadı. Lütfen kameranızın bağlı ve çalışır durumda olduğunu kontrol edin.":he.name==="NotSupportedError"?ge="HTTPS gerekli. Lütfen sayfayı HTTPS üzerinden açın.":ge=`Kamera hatası: ${he.message}`,z(ge),F(!1)}},[]),ee=T.useCallback(()=>{console.log("🛑 Kamera durduruluyor..."),le.current?.srcObject&&(le.current.srcObject.getTracks().forEach(ge=>{console.log("⏹️ Track durduruluyor:",ge.kind),ge.stop()}),le.current.srcObject=null),le.current&&(le.current.removeEventListener("loadedmetadata",()=>{}),le.current.removeEventListener("error",()=>{}),le.current.removeEventListener("canplay",()=>{})),F(!1),z("")},[]),X=T.useCallback(()=>{c("completed");const he=Math.floor((Date.now()-P)/1e3);ye.current&&clearInterval(ye.current),me.current&&clearInterval(me.current),ee(),t(S,he,K)},[S,K,P,t,ee]),fe=T.useCallback(async()=>{c("asking-ai"),k(60),await H(),ye.current=setInterval(()=>{k(he=>he<=1?(X(),0):he-1)},1e3),$e()},[H,X]),_e=T.useCallback(()=>{if(!le.current||!W.current||!d)return console.log("🔍 detectColor: Eksik element",{video:!!le.current,canvas:!!W.current,targetColor:!!d}),!1;const he=W.current,ge=he.getContext("2d"),Ze=le.current;if(!ge)return console.log("❌ Canvas context alınamadı"),!1;if(Ze.videoWidth===0||Ze.videoHeight===0)return console.log("⚠️ Video boyutları henüz yüklenmedi:",Ze.videoWidth,"x",Ze.videoHeight),!1;try{he.width=Ze.videoWidth,he.height=Ze.videoHeight,ge.drawImage(Ze,0,0);const Me=he.width/2,Ie=he.height/2,gt=80,Je=ge.getImageData(Me-gt/2,Ie-gt/2,gt,gt);let pt=0,kt=0,it=0;const Mt=Je.data.length/4;for(let yn=0;yn<Je.data.length;yn+=4)pt+=Je.data[yn],kt+=Je.data[yn+1],it+=Je.data[yn+2];pt=Math.round(pt/Mt),kt=Math.round(kt/Mt),it=Math.round(it/Mt),Ve({r:pt,g:kt,b:it});const Gt=je(d.hex);if(!Gt)return console.log("❌ Target RGB dönüştürülemedi:",d.hex),!1;const En=Math.sqrt(Math.pow(pt-Gt.r,2)+Math.pow(kt-Gt.g,2)+Math.pow(it-Gt.b,2));return Math.random()<.05&&console.log("🎨 Renk analizi:",{detected:`rgb(${pt}, ${kt}, ${it})`,target:`rgb(${Gt.r}, ${Gt.g}, ${Gt.b})`,targetName:d.name,distance:En.toFixed(1),threshold:130,match:En<130}),En<130}catch(Me){return console.error("❌ Renk algılama hatası:",Me),!1}},[d]),Ee=T.useCallback(()=>{if(!d){console.log("⚠️ Target color henüz belirlenmedi, renk algılama başlatılamıyor");return}if(me.current){console.log("⚠️ Renk algılama zaten çalışıyor, yeni başlatılmıyor");return}console.log("🎯 Renk algılama başlatılıyor...",{targetColor:d?.name,gameTimeLeft:v}),C(0),ne(!1),me.current=setInterval(()=>{_e()?(console.log("✅ Renk eşleşti!"),ne(!0),C(ge=>{const Ze=ge+.2;if(Ze>=5){console.log("🎉 5 saniye tamamlandı! Başarı!"),me.current&&(clearInterval(me.current),me.current=null),c("success"),I(Ie=>Ie+1);const Me={emotion:"happy",confidence:.9,timestamp:new Date};U(Ie=>[...Ie,Me]),r?.(Me),setTimeout(()=>{v>0?(console.log("🔄 Yeni renk seçiliyor..."),$e()):console.log("⏰ Oyun süresi doldu")},2e3)}return Ze})):(ae&&console.log("❌ Renk kaybedildi, süre sıfırlanıyor"),ne(!1),C(0))},200),console.log("✅ Renk algılama interval başlatıldı")},[_e,r,v,d,ae]),$e=T.useCallback(async()=>{console.log("🤖 AI renk seçimi başlıyor..."),c("asking-ai"),R("");try{const he=Ar.map(Je=>Je.name).join(", "),ge=Math.floor(Math.random()*1e3),Ze=`SADECE TEK KELİME RENK İSMİ SÖYLE!

Renkler: ${he}

SADECE BİR RENGİN İSMİNİ YAZ, BAŞKA HİÇBİR ŞEY YAZMA!
Örnek: Mavi
Örnek: Kırmızı

Şimdi sadece bir renk ismi yaz:`;console.log("📤 AI'ya gönderilen prompt:",Ze);const Me=await c4.generateSimpleResponse(Ze);console.log("📥 AI'dan gelen ham yanıt:",Me);let Ie=Me.replace(/<think>[\s\S]*?<\/think>/gs,"").replace(/<think>[\s\S]*/gs,"").replace(/<.*?>/g,"").replace(/Tamam,.*$/gs,"").replace(/Hmm,.*$/gs,"").replace(/Oyun #\d+.*$/gs,"").replace(/kullanıcı.*$/gs,"").replace(/.*?listesi.*$/gs,"").replace(/.*?seç.*$/gs,"").replace(/\n+/g," ").trim();if(!Ie||Ie.length<2){console.log("🎲 AI yanıtı boş/kısa, direkt fallback kullanılıyor");const Je=Ar[Math.floor(Math.random()*Ar.length)];console.log("🎲 Rastgele seçilen renk:",Je.name),f(Je),c("counting");return}console.log("🧹 Temizlenmiş AI yanıtı:",Ie),R(Ie);const gt=Ar.find(Je=>Ie.toLowerCase().includes(Je.name.toLowerCase())||Je.name.toLowerCase().includes(Ie.toLowerCase()));if(gt)console.log("✅ AI renk seçimi başarılı:",gt.name),f(gt),c("counting");else{console.log("⚠️ AI yanıtından renk bulunamadı, fallback kullanılıyor"),console.log("🔍 Aranan response:",Ie);const Je=Ar[Math.floor(Math.random()*Ar.length)];console.log("🎲 Rastgele seçilen renk:",Je.name),f(Je),c("counting")}}catch(he){console.error("❌ AI renk seçimi başarısız:",he);const ge=Ar[Math.floor(Math.random()*Ar.length)];console.log("🎲 Hata sonrası rastgele seçilen renk:",ge.name),f(ge),c("counting")}},[]),je=he=>{const ge=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(he);return ge?{r:parseInt(ge[1],16),g:parseInt(ge[2],16),b:parseInt(ge[3],16)}:null};T.useEffect(()=>{if(d&&o==="counting"){console.log("🎯 Target color değişti, renk algılama başlatılıyor:",d.name),me.current&&(clearInterval(me.current),me.current=null);const he=setTimeout(()=>{Ee()},100);return()=>{clearTimeout(he)}}},[d,o]),T.useEffect(()=>{console.log("🚀 Component mount oldu, kamera başlatılıyor...");const he=setTimeout(()=>{H()},100);return()=>clearTimeout(he)},[]),T.useEffect(()=>()=>{de.current&&clearInterval(de.current),me.current&&clearInterval(me.current),ye.current&&clearInterval(ye.current),O.current&&clearInterval(O.current),ee()},[ee]);const pe=()=>{I(0),L(1),U([]),c("idle"),f(null),k(60),C(0),ne(!1),z(""),ye.current&&clearInterval(ye.current),me.current&&clearInterval(me.current),ee()};return o==="completed"?l.jsx(ta,{className:"max-w-2xl mx-auto",children:l.jsxs(na,{className:"text-center py-12",children:[l.jsxs("div",{className:"mb-6",children:[l.jsx("div",{className:"w-24 h-24 mx-auto mb-4 bg-gradient-to-r from-purple-500 to-pink-500 rounded-full flex items-center justify-center",children:l.jsx(Sp,{className:"h-12 w-12 text-white"})}),l.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"1 Dakika Tamamlandı!"}),l.jsx("p",{className:"text-gray-600",children:"AI ile renk tanıma oyununu başarıyla bitirdin!"})]}),l.jsx("div",{className:"bg-gray-50 rounded-lg p-6 mb-6",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-4xl font-bold text-purple-600 mb-2",children:S}),l.jsx("div",{className:"text-sm text-gray-600",children:"Başarılı Renk Tanıma"}),l.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"1 dakika içinde"})]})}),l.jsxs(ea,{onClick:pe,size:"lg",children:[l.jsx(Sh,{className:"h-5 w-5 mr-2"}),"Tekrar Oyna"]})]})}):l.jsxs("div",{className:"max-w-2xl mx-auto space-y-6",children:[l.jsx("video",{ref:le,autoPlay:!0,playsInline:!0,muted:!0,style:{display:"none"}}),l.jsx(ta,{children:l.jsx(na,{children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsxs("div",{className:"text-sm text-gray-600",children:["Süre: ",Math.floor(v/60),":",(v%60).toString().padStart(2,"0")]}),l.jsxs("div",{className:"text-sm font-medium text-gray-800",children:["Skor: ",S]}),o==="counting"&&d&&l.jsxs("div",{className:"text-sm text-blue-600",children:[d.name,": ",E.toFixed(1),"/5.0s"]})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Jn,{className:"h-4 w-4 text-purple-600"}),l.jsx("span",{className:"text-sm text-gray-600",children:"AI Destekli"}),B&&l.jsx(os,{className:"h-4 w-4 text-green-600"})]})]})})}),l.jsx(ta,{children:l.jsxs(na,{className:"text-center py-8",children:[o==="idle"&&l.jsxs("div",{className:"space-y-6",children:[l.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full flex items-center justify-center",children:l.jsx(Bn,{className:"h-8 w-8 text-white"})}),l.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"AI Renk Tanıma Oyunu"}),l.jsxs("p",{className:"text-gray-600",children:["1 dakika süresince AI'nin seçtiği renkleri kameraya göster!",l.jsx("br",{}),"Her rengi 5 saniye tuttuğunda puan kazanırsın."]}),M?l.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[l.jsxs("div",{className:"flex items-center space-x-2 text-red-700 mb-2",children:[l.jsx(os,{className:"h-5 w-5"}),l.jsx("span",{className:"font-medium",children:"Kamera Sorunu"})]}),l.jsx("p",{className:"text-red-600 text-sm mb-3",children:M}),l.jsx(ea,{onClick:H,size:"sm",className:"bg-red-600 hover:bg-red-700",children:"Kamerayı Tekrar Dene"})]}):B?l.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:l.jsxs("div",{className:"flex items-center space-x-2 text-green-700",children:[l.jsx(os,{className:"h-5 w-5"}),l.jsx("span",{className:"font-medium",children:"Kamera Hazır ✓"})]})}):l.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[l.jsxs("div",{className:"flex items-center space-x-2 text-blue-700 mb-2",children:[l.jsx(os,{className:"h-5 w-5"}),l.jsx("span",{className:"font-medium",children:"Kamera Gerekli"})]}),l.jsx("p",{className:"text-blue-600 text-sm mb-3",children:"Bu oyun kamera erişimi gerektirir"}),l.jsx(ea,{onClick:H,size:"sm",className:"bg-blue-600 hover:bg-blue-700",children:"Kamerayı Test Et"})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs(ea,{onClick:fe,size:"lg",disabled:!B,className:`${B?"":"opacity-50 cursor-not-allowed"}`,children:[l.jsx(os,{className:"h-5 w-5 mr-2"}),"Oyunu Başlat"]}),l.jsxs("div",{className:"text-xs text-gray-500 bg-gray-100 p-2 rounded space-y-1",children:[l.jsxs("div",{children:["Debug: isVideoActive = ",B.toString()]}),l.jsxs("div",{children:["Video ref: ",le.current?"mevcut":"yok"]}),le.current&&l.jsxs("div",{children:["Video readyState: ",le.current.readyState]}),M&&l.jsxs("div",{className:"text-red-500",children:["Error: ",M]})]}),B&&l.jsx("div",{className:"relative inline-block",children:l.jsxs("div",{className:"w-60 h-45 rounded-lg border-2 border-gray-300 shadow-lg bg-black relative overflow-hidden",children:[l.jsx("video",{autoPlay:!0,playsInline:!0,muted:!0,className:"w-full h-full object-cover",ref:he=>{he&&le.current?.srcObject&&(he.srcObject=le.current.srcObject)}}),l.jsx("div",{className:"absolute bottom-2 left-2 bg-black bg-opacity-50 text-white text-xs px-2 py-1 rounded",children:"Kamera Hazır"})]})})]})]}),o==="asking-ai"&&l.jsxs("div",{className:"space-y-4",children:[l.jsx("div",{className:"w-16 h-16 border-4 border-purple-500 border-t-transparent rounded-full animate-spin mx-auto"}),l.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"AI Renk Seçiyor..."}),l.jsx("p",{className:"text-gray-600",children:"Gemma 9B model çalışıyor"})]}),o==="counting"&&d&&l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"space-y-4",children:[N&&l.jsx("div",{className:"bg-blue-50 p-3 rounded-lg",children:l.jsxs("p",{className:"text-blue-800 font-medium",children:['AI: "',N,'"']})}),l.jsx("div",{className:`w-32 h-32 mx-auto rounded-full ${d.bgColor} shadow-xl border-4 border-gray-300`}),l.jsx("h2",{className:"text-3xl font-bold text-gray-800",children:d.name})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[l.jsx(ja,{className:"h-5 w-5 text-gray-600"}),l.jsx("p",{className:"text-gray-600",children:"Bu rengi kameraya 5 saniye göster!"})]}),l.jsx("div",{className:"w-full bg-gray-200 rounded-full h-4",children:l.jsx("div",{className:`h-4 rounded-full transition-all duration-100 ${ae?"bg-green-500":"bg-gray-400"}`,style:{width:`${E/5*100}%`}})}),l.jsx("div",{className:"text-center",children:l.jsxs("span",{className:`text-2xl font-bold ${ae?"text-green-600":"text-gray-500"}`,children:[E.toFixed(1),"/5.0s"]})}),ae&&l.jsx("div",{className:"text-green-600 font-medium",children:"✅ Renk algılandı! Tutmaya devam et..."}),j&&l.jsxs("div",{className:"text-xs bg-gray-100 p-2 rounded space-y-1",children:[l.jsxs("div",{children:["Algılanan: rgb(",j.r,", ",j.g,", ",j.b,")"]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{children:"Örnek:"}),l.jsx("div",{className:"w-8 h-4 border rounded",style:{backgroundColor:`rgb(${j.r}, ${j.g}, ${j.b})`}})]}),d&&l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{children:"Hedef:"}),l.jsx("div",{className:"w-8 h-4 border rounded",style:{backgroundColor:d.hex}}),l.jsx("span",{children:d.hex})]})]})]}),l.jsx("div",{className:"space-y-4",children:B?l.jsx("div",{className:"relative inline-block",children:l.jsxs("div",{className:"w-80 h-60 rounded-lg border-4 border-gray-300 shadow-lg bg-black relative overflow-hidden",children:[l.jsx("video",{autoPlay:!0,playsInline:!0,muted:!0,className:"w-full h-full object-cover",ref:he=>{he&&le.current?.srcObject&&(he.srcObject=le.current.srcObject)}}),l.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2",children:l.jsx("div",{className:`w-16 h-16 border-4 ${ae?"border-green-400":"border-yellow-400"} rounded-lg pointer-events-none animate-pulse`,children:l.jsx("div",{className:"w-full h-full bg-transparent"})})}),l.jsx("div",{className:"absolute top-2 right-2",children:l.jsx("div",{className:`w-8 h-8 rounded-full ${d.bgColor} border-2 border-white shadow-md`})})]})}):l.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[l.jsxs("div",{className:"flex items-center justify-center space-x-2 text-red-700 mb-2",children:[l.jsx(os,{className:"h-5 w-5"}),l.jsx("span",{className:"font-medium",children:"Kamera Problemi"})]}),l.jsx("p",{className:"text-red-600 text-sm mb-3",children:M||"Kamera erişilemedi"}),l.jsx(ea,{onClick:H,size:"sm",className:"bg-red-600 hover:bg-red-700",children:"Kamerayı Yeniden Başlat"})]})})]}),o==="success"&&l.jsxs("div",{className:"space-y-6",children:[l.jsx("div",{className:"w-24 h-24 mx-auto bg-green-500 rounded-full flex items-center justify-center",children:l.jsx(Ic,{className:"h-12 w-12 text-white"})}),l.jsx("h2",{className:"text-2xl font-bold text-green-600",children:"Başarılı!"}),l.jsx("p",{className:"text-gray-600",children:"+1 Puan! Yeni renk yükleniyor... 🌈"}),l.jsx("div",{className:"w-16 h-16 border-4 border-green-500 border-t-transparent rounded-full animate-spin mx-auto"})]})]})}),l.jsx("canvas",{ref:W,style:{display:"none"}})]})};class d4{constructor(){this.apiEndpoint="/ollama/generate",this.fallbackScenes=[{id:1,story:"Ali büyülü bir ormana girdi. Önünde iki kapı belirdi.",question:"Ali hangi kapıyı seçmeli?",choices:[{id:"a",text:"🟢 Yeşil Kapı",color:"#10B981",mood:"maceracı"},{id:"b",text:"🔴 Kırmızı Kapı",color:"#EF4444",mood:"temkinli"}]},{id:2,story:"Ali doğru renge sahip kapıdan geçmeli.",question:"Hangi seçenek doğru RENGE sahip?",choices:[{id:"a",text:"MAVİ",color:"#EF4444",mood:"dikkatli",stroopConflict:!0},{id:"b",text:"YEŞİL",color:"#10B981",mood:"meraklı"}]},{id:3,story:"Ali köprüden geçerken dikkatli olmalı. Tehlikeli yaratıklar var!",question:"Ali hangi köprüyü seçmeli?",choices:[{id:"a",text:"🌉 Güvenli Köprü",mood:"sakin"},{id:"b",text:"⚡ Yıldırım Köprü",mood:"cesur"}],backgroundTask:{targetSymbol:"🐍",instruction:"Yılan göründüğünde DOKUNMA!"}},{id:4,story:"Ejderha aniden ortaya çıktı! Hızla kaçmak gerekiyor!",question:"Acil durum! Ne yapmalı?",choices:[{id:"a",text:"🏃‍♂️ KAÇ",mood:"temkinli"},{id:"b",text:"⚔️ SAVAŞ",mood:"cesur"}],emergencyTask:{symbol:"🚨",duration:2e3,instruction:"HIZLA KAÇ butonuna bas!"}},{id:5,story:"Ali hazine odasına ulaştı. Doğru renkteki sandığı seçmeli.",question:"Hangi renk yazısı doğru renkte yazılmış?",choices:[{id:"a",text:"SARI",color:"#10B981",mood:"dikkatli",stroopConflict:!0},{id:"b",text:"PEMBE",color:"#EC4899",mood:"meraklı"}]},{id:6,story:"Ali büyücünün testine girdi. Aynı anda iki işi yapması gerekiyor!",question:"Ali hangi büyüyü seçmeli?",choices:[{id:"a",text:"✨ İyileştirme Büyüsü",mood:"sakin"},{id:"b",text:"💥 Patlama Büyüsü",mood:"maceracı"}],backgroundTask:{targetSymbol:"🦉",instruction:"Baykuş göründüğünde DOKUNMA!"}}]}async generateStory(e){try{const t=await this.callAIService(e);return t.scenes&&t.scenes.length>0?t:(console.warn("AI service returned empty scenes, using fallback"),this.generateFallbackStory(e))}catch(t){return console.warn("AI Story Service failed, using fallback:",t),this.generateFallbackStory(e)}}async generateNextScene(e){try{return await this.callDynamicSceneService(e)}catch(t){return console.warn("Dynamic scene generation failed, using fallback:",t),this.generateFallbackScene(e)}}async callAIService(e){const t=this.constructPrompt(e),r=await fetch(this.apiEndpoint,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:"gemma2:2b",prompt:t,stream:!1,options:{num_ctx:2048,num_batch:512,num_predict:200,temperature:.6,top_p:.8,repeat_penalty:1.1,stop:["}]}","```"]}})});if(!r.ok){const c=await r.text();throw console.error("Ollama error response:",c),new Error(`Ollama Service responded with status: ${r.status} - ${c}`)}const o=await r.json();return console.log("Ollama response:",o),this.parseOllamaResponse(o,e)}async callDynamicSceneService(e){const t=this.constructDynamicPrompt(e),r=await fetch(this.apiEndpoint,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:"gemma2:2b",prompt:t,stream:!1,options:{num_ctx:512,num_batch:256,num_predict:250,temperature:.9,top_p:.95,top_k:50,repeat_penalty:1.3,num_thread:4,seed:Math.floor(Math.random()*1e6)}})});if(!r.ok){const c=await r.text();throw console.error("Dynamic scene error:",c),new Error(`Dynamic Scene Service error: ${r.status}`)}const o=await r.json();return console.log("Dynamic scene response:",o),this.parseDynamicSceneResponse(o,e)}constructDynamicPrompt(e){console.log("🔍 [DEBUG] Scene request:",{sceneNumber:e.sceneNumber,theme:e.theme,previousStory:e.previousStory?.substring(0,50),userChoice:e.userChoice});const t=this.getThemeDetails(e.theme);let r=`CRITICAL: ONLY TURKISH LANGUAGE! ESPAÑOL PROHIBIDO!

TÜRKÇE ZORUNLU: ${e.studentAge} yaşındaki çocuk için ${e.theme} temalı hikaye devamı oluştur.

DİL KURALI: Sadece Türkçe kullan. İngilizce, İspanyolca, Fransızca YASAK!
SPANISH FORBIDDEN! NO ESPAÑOL! ONLY TURKISH!

${t}

Sahne ${e.sceneNumber}:`;return e.previousStory&&e.userChoice?r+=`
Önceki durum: ${e.previousStory}
Çocuğun seçimi: ${e.userChoice}

Bu seçime göre hikayeyi devam ettir.`:r+=`
Bu hikayenin başlangıç sahnesi. Çocuk için ilginç bir durumla başla.`,e.emotionData?(console.log("🎭 [AI SERVICE DEBUG] Emotion data AI prompt'a ekleniyor:"),console.log("🎭 [AI SERVICE DEBUG] Emotion data uzunluğu:",e.emotionData.length),console.log("🎭 [AI SERVICE DEBUG] Emotion data içeriği:",e.emotionData),r+=`

KAMERA VERİSİ - ÇOCUĞUN DUYGUSAL DURUMU (Son sahne boyunca):
${e.emotionData}

DİKKAT: Bu emotion data'dan çok boyutlu analiz yap:

DUYGUSAL DURUM ANALİZİ:
- Hangi duygu baskın? Son trend nasıl?
- Emotion stabilite: Sabit mi değişken mi?
- Pozitif/negatif emotion dengesi?

ÖĞRENME STİLİ ÇIKARIMI:
- confused→happy geçişi = Yavaş öğrenen ama başarılı mı?
- happy→bored pattern = Hızla sıkılan, challenge isteyen mi?
- surprised spike'ları = Yenilikçi görevleri seven mi?

MOTİVASYON/STRES ANALİZİ:
- İçsel motivasyon: happy/neutral dominant mı?
- Frustration tolerance: angry/confused nasıl?
- Kaygı seviyesi: emotion volatility yüksek mi?

HİKAYE ADAPTASYONU:
Bu analizlere göre hikaye yolunu belirle:
- Mutlu/heyecanlı ise: Momentum sürdürecek, biraz daha heyecanlı macera
- Kafa karışık/yorgun ise: Basit, net hikaye, az seçenek
- Odaklanmış ise: Bu durumu koruyacak dengeli macera
- Stresli/sinirli ise: Sakinleştirici, pozitif, başarıya odaklı hikaye yolu

Çocuğun mevcut duygusal durumuna uygun hikaye yolunu seç.`):console.log("🎭 [AI SERVICE DEBUG] Emotion data yok - genel hikaye modu kullanılacak"),r+=`

MOOD BELİRLEME KURALLARI:
Emotion analizine göre her seçenek için uygun mood seç:
- Mutlu/Heyecanlı çocuk → "maceracı", "cesur" mood'ları kullan
- Sakin/Yorgun çocuk → "sakin", "temkinli" mood'ları kullan
- Meraklı/Odaklı çocuk → "meraklı", "dikkatli" mood'ları kullan
- Karışık/Stresli çocuk → "sakin", "temkinli" mood'ları kullan

PLACEHOLDER KULLANMA! Direkt mood kelimesini yaz!

ZORUNLU DİL KURALLARI:
- Tüm metin Türkçe olacak
- İngilizce, İspanyolca, Fransızca kelime kullanma
- Sadece Türkçe karakterler ve kelimeler
- SORU TÜRKÇE OLMALI! ¿ kullanma!

Tek bir sahne JSON'ı döndür:
{
  "id": ${e.sceneNumber},
  "story": "Türkçe kısa hikaye (1-2 cümle)",
  "question": "Ali ne yapmalı? (TÜRKÇE SORU)",
  "choices": [
    {"id": "a", "text": "🟢 Türkçe Seçenek 1", "mood": "maceracı"},
    {"id": "b", "text": "🔴 Türkçe Seçenek 2", "mood": "sakin"}
  ]
}

UYARI: İspanyolca soru yazarsan sistem çökecek!
NO SPANISH QUESTIONS! TÜRKÇE SORU YAZ!
Mood seçenekleri: maceracı, temkinli, meraklı, sakin, cesur, dikkatli
Sadece Türkçe JSON döndür.`,r}getThemeDetails(e){switch(e){case"Orman Macerası":return`
KARAKTER: Ali - Cesur ve meraklı çocuk
ORTAM: Büyülü orman, ağaçlar, hayvanlar, gizli yollar
HİKAYE STILI: Doğa macerası, keşif, dostluk
ÖZELLİKLER: 🌳 Ağaçlar, 🦋 Kelebekler, 🐿️ Sincaplar, 🌸 Çiçekler`;case"Uzay Keşfi":return`
KARAKTER: Aylin - Zeki ve cesur uzay kaşifi
ORTAM: Uzay gemisi, gezegenler, yıldızlar, uzay istasyonu
HİKAYE STILI: Bilim kurgu macerası, teknoloji, keşif
ÖZELLİKLER: 🚀 Uzay gemisi, 🌟 Yıldızlar, 🛸 Uzay aracı, 🪐 Gezegenler`;case"Deniz Altı Maceraları":return`
KARAKTER: Cem - Denizci ve cesur dalış uzmanı
ORTAM: Okyanusun derinlikleri, mercan resifleri, su altı mağaraları
HİKAYE STILI: Su altı keşfi, deniz canlıları, hazine avcılığı
ÖZELLİKLER: 🐠 Balıklar, 🐙 Ahtapot, 🏝️ Ada, 💎 Hazine`;default:return`
KARAKTER: Ali - Cesur ve meraklı çocuk
ORTAM: Fantastik dünya
HİKAYE STILI: Macera ve keşif`}}parseDynamicSceneResponse(e,t){try{const r=e.response||"";console.log("Dynamic scene response text:",r);let o=r;o=o.replace(/```json\s*/g,""),o=o.replace(/```[\s\S]*/g,"");const c=o.indexOf("{"),d=o.lastIndexOf("}");if(c===-1||d===-1||c>=d)throw new Error("No valid JSON found in dynamic scene response");let f=o.substring(c,d+1);if(f.includes('"choices": [')){if(/"choices":\s*\[\s*{[^}]*}[^}\]]*$/.test(f)){const k=f.lastIndexOf("}");k>0&&(f=f.substring(0,k+1),f+=',{"id":"b","text":"🔴 Devam et","mood":"sakin"}]')}f=f.replace(/"text":\s*"([^"]*)"(?![^}]*"mood")/g,'"text": "$1", "mood": "sakin"');const v=["maceracı","temkinli","meraklı","sakin","cesur","dikkatli"];f=f.replace(/"mood":\s*"EMOTION_ANALİZİNE_GÖRE_BELİRLE"/g,()=>`"mood": "${v[Math.floor(Math.random()*v.length)]}"`),f.endsWith("]}")||(f.endsWith("]")||(f+="]"),f.endsWith("}")||(f+="}"))}if(f.includes('"isCorrect"'))throw new Error("Model hala isCorrect kullanıyor, mood kullanması gerekiyor");f=f.replace(/,(\s*[}\]])/g,"$1"),f=f.trim(),f.match(/"text":\s*"[^"]*$/)&&(f+='", "mood": "sakin"}]'),f=f.replace(/\s*}]}\s*$/,"").trim(),f.endsWith("}")||(f+="}"),console.log("Cleaned JSON for parsing:",f);const p=JSON.parse(f);return{id:p.id||t.sceneNumber,story:p.story||`Sahne ${t.sceneNumber}`,question:p.question||"Ne yapmalı?",choices:p.choices?.map((y,v)=>({id:y.id||String.fromCharCode(97+v),text:y.text||`Seçenek ${v+1}`,color:y.color,mood:y.mood||"normal",isDistractor:y.isDistractor||!1,stroopConflict:y.stroopConflict||!1}))||[{id:"a",text:"🟢 Devam et",mood:"normal",isDistractor:!1,stroopConflict:!1},{id:"b",text:"🔴 Dur",mood:"temkinli",isDistractor:!1,stroopConflict:!1}],emergencyTask:p.emergencyTask,backgroundTask:p.backgroundTask}}catch(r){throw console.error("Dynamic scene parse error:",r),r}}generateFallbackScene(e){const r=[{story:`Ali yeni bir yola çıktı. (Sahne ${e.sceneNumber})`,question:"Hangi yönde gitmeli?",choices:[{id:"a",text:"🟢 Sağa git",mood:"maceracı"},{id:"b",text:"🔴 Sola git",mood:"temkinli"}]},{story:`Ali ilginç bir yaratıkla karşılaştı. (Sahne ${e.sceneNumber})`,question:"Ne yapmalı?",choices:[{id:"a",text:"🟢 Dostça yaklaş",mood:"cesur"},{id:"b",text:"🔴 Kaç",mood:"dikkatli"}]}][e.sceneNumber%2];return{id:e.sceneNumber,story:r.story,question:r.question,choices:r.choices.map((o,c)=>({...o,isDistractor:!1,stroopConflict:!1}))}}constructPrompt(e){return`${e.studentAge} yaş çocuk için hikaye. ${e.sceneCount||4} sahne.

Tema: ${e.theme||"Ali macera"}

ÖNEMLİ: mood field kullan, isCorrect kullanma!

{"scenes":[{"id":1,"story":"Hikaye","question":"Soru?","choices":[{"id":"a","text":"🟢 Seçenek","mood":"maceracı"},{"id":"b","text":"🔴 Seçenek","mood":"sakin"}]}]}

Mood: maceracı,temkinli,meraklı,sakin,cesur,dikkatli`}parseOllamaResponse(e,t){try{const r=e.response||"";console.log("Full Ollama response text:",r);let o=r;o.includes("```json")&&(o=o.replace(/```json\s*/,"")),o.includes("```")&&(o=o.replace(/```\s*$/,""));let c=o.match(/\{[\s\S]*\}/);if(!c)throw console.error("No valid JSON found in response"),new Error("No JSON found in Ollama response");let d=c[0];return d=d.replace(/,(\s*[}\]])/g,"$1"),d=d.trim(),console.log("Cleaned JSON text:",d),{scenes:(JSON.parse(d).scenes||[]).map((y,v)=>({id:y.id||v+1,story:y.story||`Sahne ${v+1}`,question:y.question||"Ne yapmalı?",choices:y.choices?.map((k,S)=>({id:k.id||String.fromCharCode(97+S),text:k.text||`Seçenek ${S+1}`,color:k.color,mood:k.mood||"normal",isDistractor:k.isDistractor||!1,stroopConflict:k.stroopConflict||!1}))||[{id:"a",text:"🟢 Devam et",mood:"normal",isDistractor:!1,stroopConflict:!1},{id:"b",text:"🔴 Dur",mood:"temkinli",isDistractor:!1,stroopConflict:!1}],emergencyTask:y.emergencyTask,backgroundTask:y.backgroundTask})),difficulty:this.calculateDifficulty(t.attentionLevel),estimatedDuration:(t.sceneCount||4)*90,theme:t.theme||"Adventure"}}catch(r){throw console.error("Failed to parse Ollama response:",r),console.error("Original response:",e),r}}parseAIResponse(e,t){try{return{scenes:(e.scenes||e.content?.scenes||[]).map((o,c)=>({id:o.id||c+1,story:o.story||"",question:o.question||"",choices:o.choices?.map((d,f)=>({id:d.id||String.fromCharCode(97+f),text:d.text||"",color:d.color,mood:d.mood||"normal",isDistractor:d.isDistractor||!1,stroopConflict:d.stroopConflict||!1}))||[],emergencyTask:o.emergencyTask,backgroundTask:o.backgroundTask})),difficulty:this.calculateDifficulty(t.attentionLevel),estimatedDuration:(t.sceneCount||4)*90,theme:t.theme||"Adventure"}}catch(r){throw console.error("Failed to parse AI response:",r),r}}generateFallbackStory(e){let t=this.fallbackScenes;return e.sceneCount&&e.sceneCount<this.fallbackScenes.length&&(t=this.fallbackScenes.slice(0,e.sceneCount)),e.studentAge<6&&(t=t.map(r=>({...r,choices:r.choices.filter(o=>!o.stroopConflict),emergencyTask:void 0}))),{scenes:t,difficulty:this.calculateDifficulty(e.attentionLevel),estimatedDuration:t.length*90,theme:e.theme||"Macera"}}calculateDifficulty(e){switch(e){case"beginner":return"Kolay";case"intermediate":return"Orta";case"advanced":return"Zor";default:return"Orta"}}generateTemplate(e,t){const r={adventure:{theme:"Ali'nin büyülü orman macerası",sceneCount:t<6?3:t<8?4:6},space:{theme:"Uzay kahramanı Aylin'in gezegen keşfi",sceneCount:t<6?3:t<8?4:6},underwater:{theme:"Denizaltı kaşifi Cem'in okyanus yolculuğu",sceneCount:t<6?3:t<8?4:6}};return r[e]||r.adventure}}const h4=new d4,m4=({studentId:s,studentAge:e,onGameComplete:t})=>{const[r,o]=T.useState(null),[c,d]=T.useState(!1),[f,p]=T.useState("adventure"),[y,v]=T.useState(1),[k,S]=T.useState(""),[I,q]=T.useState(!1),[L,P]=T.useState(!1),[K,U]=T.useState({selectiveAttention:0,sustainedAttention:0,dividedAttention:0,impulseControl:0,reactionTime:[],distractorClicks:0,correctChoices:0,totalChoices:0}),[B,F]=T.useState(0),[ae,ne]=T.useState(!1),[N,R]=T.useState(!1),[E,C]=T.useState(!1),[M,z]=T.useState(null),j=T.useRef(null),[Ve,le]=T.useState(!1),[W,de]=T.useState(null),[me,ye]=T.useState(null),O=T.useCallback(async()=>{console.log("🎭 [EMOTION] Emotion tracking başlatılıyor..."),le(!0);const pe=ge=>{if(!We.isGameActiveStatus())return;de(ge),We.addEmotionResult(ge);const Ze=We.getCurrentGameMetrics();ye(Ze)};let he=!1;j.current&&(he=await Dt.startEmotionTracking(j.current,pe)),he||(console.log("📱 [EMOTION] Gerçek kamera bulunamadı - Python server çalışıyor mu?"),console.log("💡 [TIP] Terminal'de çalıştır: python emotion_server.py")),console.log("✅ [EMOTION] Emotion tracking aktif")},[]),H=T.useCallback(()=>{console.log("⏹️ [EMOTION] Emotion tracking durduruluyor..."),Dt.stopEmotionTracking(),le(!1);const pe=We.endGameSession();ye(pe),console.log("🏁 [EMOTION] Final metrics:",pe)},[]),ee=T.useCallback(async pe=>{const he=pe||M;if(console.log("🚨 [DEBUG] generateNextScene called:",{sceneNumber:y,isLoadingStory:c,currentSceneId:r?.id}),c){console.log("Already loading story, skipping...");return}d(!0);try{const ge={adventure:"Orman Macerası",space:"Uzay Keşfi",underwater:"Deniz Altı Maceraları"};let Ze="";const Me=Array.isArray(he)?he:he?.emotions;Me&&Me.length>0&&(Ze=Me.map((Je,pt)=>`${pt+1}. ${Je.timestamp}: ${Je.emotion} (${(Je.confidence*100).toFixed(1)}%)`).join(`
`));const Ie={studentAge:e,theme:ge[f],previousStory:r?.story||void 0,userChoice:k,sceneNumber:y,emotionData:Ze||void 0};console.log("🎭 [EMOTION DEBUG] Sahne emotion verisi detayı:"),console.log("🎭 [EMOTION DEBUG] Ham sceneEmotionData:",pe),console.log("🎭 [EMOTION DEBUG] PendingEmotionData:",M),console.log("🎭 [EMOTION DEBUG] EmotionDataToUse:",he),console.log("🎭 [EMOTION DEBUG] Emotion array uzunluğu:",Me?.length||0),console.log("🎭 [EMOTION DEBUG] Emotions array:",Me),console.log("🎭 [EMOTION DEBUG] AI'ya gönderilen emotion string:"),console.log(Ze||"BOŞ - Emotion data yok"),console.log("🎭 [EMOTION DEBUG] Request object:",Ie);const gt=await h4.generateNextScene(Ie);o(gt),console.log("🎭 [STORY GAME] Yeni sahne başladı, emotion session başlatılıyor..."),We.startRoundSession(),he&&z(null)}catch(ge){console.error("Dynamic scene generation failed:",ge)}finally{d(!1)}},[e,f,k,c,r?.story,y,M]);T.useEffect(()=>{I&&!L&&y>1&&!c&&r?.id!==y&&(console.log("Generating next scene for scene number:",y),setTimeout(()=>{c||ee()},200))},[y,I,L,ee,c,r]),T.useEffect(()=>{if(L&&E){const he=(Me=>{const Ie=Me.reactionTime.length>0?Me.reactionTime.reduce((Mt,Gt)=>Mt+Gt,0)/Me.reactionTime.length:0,gt=Me.totalChoices>0?Me.correctChoices/Me.totalChoices*100:0,Je=Math.max(0,100-Me.distractorClicks*20),pt=Math.max(0,100-(Me.reactionTime.length-Me.correctChoices)*10),kt=Math.max(0,100-Me.distractorClicks*15),it=Math.max(0,100-Me.impulseControl*25);return{...Me,selectiveAttention:Je,sustainedAttention:pt,dividedAttention:kt,impulseControl:it,avgReactionTime:Ie,accuracy:gt}})(K);U(he);const ge=(he.accuracy+he.selectiveAttention+he.sustainedAttention+he.dividedAttention+he.impulseControl)/5,Ze={studentId:s,studentAge:e,gameType:"story-attention",score:Math.round(ge),duration:Date.now()-B,storyTheme:f,attentionData:{selectiveAttention:he.selectiveAttention,sustainedAttention:he.sustainedAttention,dividedAttention:he.dividedAttention,impulseControl:he.impulseControl,avgReactionTime:he.avgReactionTime||0,accuracy:he.accuracy||0,distractorClicks:he.distractorClicks,correctChoices:he.correctChoices,totalChoices:he.totalChoices},timestamp:new Date().toISOString()};xI(Ze).catch(Me=>{console.error("Failed to save story attention game data:",Me)})}},[L,E,K,s,e,B,f]),T.useEffect(()=>{if(I&&!L&&r){if(F(Date.now()),r.backgroundTask){const pe=setInterval(()=>{ne(!0),setTimeout(()=>ne(!1),1500)},3e3+Math.random()*2e3);return()=>clearInterval(pe)}if(r.emergencyTask){const pe=setTimeout(()=>{R(!0),setTimeout(()=>{R(!1),Ee()},r.emergencyTask.duration)},2e3+Math.random()*3e3);return()=>clearTimeout(pe)}}},[y,I,L,r]);const X=T.useCallback(pe=>{if(console.log("Choice clicked:",pe),!r||N||c)return;const he=Date.now()-B,ge=r.choices.find(Me=>Me.id===pe);if(!ge)return;console.log("Selected choice:",ge.text),S(ge.text),console.log("🎭 [STORY GAME] Sahne tamamlandı, emotion verisi alınıyor...");const Ze=We.endRoundSession();console.log("🎭 [STORY GAME] Sahne emotion verisi:",Ze),z(Ze),U(Me=>{const Ie={...Me,reactionTime:[...Me.reactionTime,he],totalChoices:Me.totalChoices+1};return Ie.correctChoices++,ge.isDistractor&&Ie.distractorClicks++,he<500&&(Ie.impulseControl+=1),Ie}),Ee()},[r,B,N]),fe=T.useCallback(()=>{U(pe=>({...pe,distractorClicks:pe.distractorClicks+1})),ne(!1)},[]),_e=T.useCallback(()=>{const pe=Date.now()-B;U(he=>({...he,reactionTime:[...he.reactionTime,pe]})),R(!1),Ee()},[B]),Ee=T.useCallback(()=>{console.log("Handling next scene. Current scene number:",y),y>=5?(console.log("Game ending - reached max scenes"),P(!0),C(!0)):(console.log("Moving to next scene:",y+1),v(pe=>pe+1))},[y]);T.useEffect(()=>{L&&(console.log("🏁 [STORY GAME] Oyun bitti, emotion tracking durduruluyor..."),Dt.stopFrameAnalysis?.(),H())},[L,H]);const $e=async(pe="adventure")=>{await O(),p(pe),q(!0),v(1),S(""),We.startGameSession(),We.startRoundSession(),Dt.startFrameAnalysis?.(),await ee()},je=()=>{q(!1),P(!1),v(1),o(null),C(!1),S(""),d(!1),le(!1),de(null),ye(null),U({selectiveAttention:0,sustainedAttention:0,dividedAttention:0,impulseControl:0,reactionTime:[],distractorClicks:0,correctChoices:0,totalChoices:0})};return E?l.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 to-pink-50 p-4",children:[l.jsx("video",{ref:j,autoPlay:!0,playsInline:!0,muted:!0,style:{display:"none"}}),l.jsx("div",{className:"max-w-4xl mx-auto",children:l.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8",children:[l.jsxs("div",{className:"text-center mb-8",children:[l.jsx("div",{className:"text-6xl mb-4",children:"🎯"}),l.jsx("h2",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Hikaye Tamamlandı!"}),l.jsx("p",{className:"text-gray-600",children:"Dikkat becerilerinin analizi"})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[l.jsxs("div",{className:"bg-gradient-to-r from-blue-500 to-blue-600 p-6 rounded-lg text-white",children:[l.jsx(Cc,{className:"h-8 w-8 mb-4"}),l.jsx("h3",{className:"text-lg font-bold",children:"Seçici Dikkat"}),l.jsxs("p",{className:"text-2xl font-bold",children:[Math.round(K.selectiveAttention),"%"]}),l.jsx("p",{className:"text-blue-100 text-sm",children:"Çeldiricileri görmezden gelme"})]}),l.jsxs("div",{className:"bg-gradient-to-r from-green-500 to-green-600 p-6 rounded-lg text-white",children:[l.jsx(Bn,{className:"h-8 w-8 mb-4"}),l.jsx("h3",{className:"text-lg font-bold",children:"Sürekli Dikkat"}),l.jsxs("p",{className:"text-2xl font-bold",children:[Math.round(K.sustainedAttention),"%"]}),l.jsx("p",{className:"text-green-100 text-sm",children:"Dikkatin devamlılığı"})]}),l.jsxs("div",{className:"bg-gradient-to-r from-purple-500 to-purple-600 p-6 rounded-lg text-white",children:[l.jsx(Mi,{className:"h-8 w-8 mb-4"}),l.jsx("h3",{className:"text-lg font-bold",children:"Bölünmüş Dikkat"}),l.jsxs("p",{className:"text-2xl font-bold",children:[Math.round(K.dividedAttention),"%"]}),l.jsx("p",{className:"text-purple-100 text-sm",children:"Çoklu görev yetisi"})]}),l.jsxs("div",{className:"bg-gradient-to-r from-orange-500 to-red-500 p-6 rounded-lg text-white",children:[l.jsx(Db,{className:"h-8 w-8 mb-4"}),l.jsx("h3",{className:"text-lg font-bold",children:"Dürtü Kontrolü"}),l.jsxs("p",{className:"text-2xl font-bold",children:[Math.round(K.impulseControl),"%"]}),l.jsx("p",{className:"text-orange-100 text-sm",children:"Hızlı karar verme kontrolü"})]})]}),l.jsxs("div",{className:"bg-gray-50 rounded-lg p-6 mb-8",children:[l.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:"Detaylı Analiz"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[l.jsxs("div",{children:[l.jsxs("p",{children:[l.jsx("span",{className:"font-medium",children:"Toplam Doğru Cevap:"})," ",K.correctChoices,"/",K.totalChoices]}),l.jsxs("p",{children:[l.jsx("span",{className:"font-medium",children:"Başarı Oranı:"})," ",Math.round(K.correctChoices/K.totalChoices*100),"%"]})]}),l.jsxs("div",{children:[l.jsxs("p",{children:[l.jsx("span",{className:"font-medium",children:"Çeldirici Tıklama:"})," ",K.distractorClicks]}),l.jsxs("p",{children:[l.jsx("span",{className:"font-medium",children:"Ortalama Tepki Süresi:"})," ",Math.round(K.reactionTime.reduce((pe,he)=>pe+he,0)/K.reactionTime.length),"ms"]})]})]})]}),l.jsxs("div",{className:"flex gap-4 justify-center",children:[l.jsx("button",{onClick:je,className:"bg-blue-500 hover:bg-blue-600 text-white px-6 py-3 rounded-lg font-medium transition-colors",children:"Tekrar Oyna"}),l.jsx("button",{onClick:()=>t(Math.round((K.selectiveAttention+K.sustainedAttention+K.dividedAttention+K.impulseControl)/4),Date.now()-B,K),className:"bg-gray-500 hover:bg-gray-600 text-white px-6 py-3 rounded-lg font-medium transition-colors",children:"Ana Menüye Dön"})]})]})})]}):I?l.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 to-pink-50 p-4",children:[l.jsx("video",{ref:j,autoPlay:!0,playsInline:!0,muted:!0,style:{display:"none"}}),ae&&r?.backgroundTask&&l.jsx("div",{className:"fixed top-20 right-20 text-4xl cursor-pointer animate-bounce z-10",onClick:fe,children:r.backgroundTask.targetSymbol}),N&&r?.emergencyTask&&l.jsx("div",{className:"fixed inset-0 bg-red-500/80 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-white rounded-lg p-8 text-center animate-pulse",children:[l.jsx("div",{className:"text-6xl mb-4",children:r.emergencyTask.symbol}),l.jsx("h3",{className:"text-2xl font-bold text-red-600 mb-4",children:r.emergencyTask.instruction}),l.jsx("button",{onClick:_e,className:"bg-red-500 hover:bg-red-600 text-white px-8 py-4 rounded-lg font-bold text-lg animate-pulse",children:"🏃‍♂️ KAÇ!"})]})}),l.jsxs("div",{className:"max-w-4xl mx-auto",children:[l.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-4 mb-6",children:[l.jsxs("div",{className:"flex justify-between items-center mb-2",children:[l.jsxs("span",{className:"text-sm font-medium text-gray-700",children:["Sahne ",y," / 5"]}),l.jsxs("span",{className:"text-sm text-gray-500",children:[Math.round(y/5*100),"%"]})]}),l.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:l.jsx("div",{className:"bg-purple-600 h-3 rounded-full transition-all duration-500",style:{width:`${y/5*100}%`}})})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8",children:[Ve&&l.jsxs("div",{className:"mb-4 flex items-center justify-between bg-blue-50 border border-blue-200 rounded-lg p-3",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(os,{className:"h-5 w-5 text-blue-600"}),l.jsx("span",{className:"text-blue-800 font-medium",children:"Kamera Aktif"})]}),W&&l.jsxs("div",{className:"text-sm text-blue-700",children:[l.jsx("span",{className:"font-medium",children:"Şu an:"})," ",W.dominantEmotion||"Analiz ediliyor...",W.confidence&&l.jsxs("span",{className:"ml-1",children:["(",(W.confidence*100).toFixed(0),"%)"]})]})]}),l.jsxs("div",{className:"text-center mb-8",children:[l.jsx("div",{className:"text-4xl mb-4",children:"📚"}),l.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:r?.story}),l.jsx("p",{className:"text-lg text-gray-600 mb-6",children:r?.question})]}),c&&l.jsxs("div",{className:"text-center py-8",children:[l.jsx("div",{className:"text-4xl mb-4",children:"✨"}),l.jsx("h3",{className:"text-xl font-bold text-purple-600 mb-2",children:"Hikaye devam ediyor..."}),l.jsx("p",{className:"text-gray-600",children:"Seçiminize göre yeni macera hazırlanıyor!"}),l.jsx("div",{className:"w-8 h-8 border-4 border-purple-600 border-t-transparent rounded-full animate-spin mx-auto mt-4"})]}),k&&!c&&y>1&&l.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 mb-6",children:l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"text-2xl",children:"✅"}),l.jsxs("div",{children:[l.jsxs("h4",{className:"font-bold text-green-800",children:["Seçimin: ",k]}),l.jsx("p",{className:"text-green-700 text-sm",children:"Hikaye bu seçiminle devam ediyor..."})]})]})}),!c&&l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:r?.choices.map(pe=>l.jsx("button",{onClick:()=>X(pe.id),className:`p-6 rounded-lg border-2 transition-all duration-200 hover:shadow-lg ${pe.isDistractor?"border-yellow-300 bg-yellow-50 hover:bg-yellow-100":pe.stroopConflict?"border-red-300 bg-red-50 hover:bg-red-100":"border-purple-300 bg-purple-50 hover:bg-purple-100"} ${c?"opacity-50 cursor-not-allowed":""}`,style:pe.color?{borderColor:pe.color,backgroundColor:pe.color+"20"}:{},disabled:N||c,children:l.jsx("span",{className:"text-lg font-bold",style:pe.color&&pe.stroopConflict?{color:pe.color}:{},children:pe.text})},pe.id))}),r?.backgroundTask&&l.jsx("div",{className:"mt-6 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:l.jsxs("p",{className:"text-center text-yellow-800 font-medium",children:["⚠️ ",r.backgroundTask.instruction]})})]})]})]}):l.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 to-pink-50 p-4",children:[l.jsx("video",{ref:j,autoPlay:!0,playsInline:!0,muted:!0,style:{display:"none"}}),l.jsx("div",{className:"max-w-2xl mx-auto",children:l.jsx("div",{className:"bg-white rounded-lg shadow-lg p-8",children:l.jsxs("div",{className:"text-center",children:[l.jsx(jI,{className:"h-16 w-16 text-purple-600 mx-auto mb-6"}),l.jsx("h2",{className:"text-3xl font-bold text-gray-800 mb-4",children:"Hikaye Tabanlı Dikkat Oyunu"}),l.jsx("p",{className:"text-gray-600 mb-8",children:"Ali'nin macerasında ona yardım et! Bu oyun dikkat becerilerini ölçer:"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-8 text-left",children:[l.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[l.jsx(Cc,{className:"h-6 w-6 text-blue-600 mb-2"}),l.jsx("h3",{className:"font-bold text-blue-800",children:"Seçici Dikkat"}),l.jsx("p",{className:"text-blue-700 text-sm",children:"Çeldiricileri görmezden gel"})]}),l.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[l.jsx(Bn,{className:"h-6 w-6 text-green-600 mb-2"}),l.jsx("h3",{className:"font-bold text-green-800",children:"Sürekli Dikkat"}),l.jsx("p",{className:"text-green-700 text-sm",children:"Dikkati uzun süre koru"})]}),l.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg",children:[l.jsx(Mi,{className:"h-6 w-6 text-purple-600 mb-2"}),l.jsx("h3",{className:"font-bold text-purple-800",children:"Bölünmüş Dikkat"}),l.jsx("p",{className:"text-purple-700 text-sm",children:"Aynı anda iki işi yap"})]}),l.jsxs("div",{className:"bg-orange-50 p-4 rounded-lg",children:[l.jsx(Db,{className:"h-6 w-6 text-orange-600 mb-2"}),l.jsx("h3",{className:"font-bold text-orange-800",children:"Dürtü Kontrolü"}),l.jsx("p",{className:"text-orange-700 text-sm",children:"Düşünmeden hareket etme"})]})]}),l.jsxs("div",{className:"space-y-6",children:[l.jsx("h3",{className:"text-lg font-bold text-gray-800 text-center mb-4",children:"Hangi hikayeyi oynamak istiyorsun?"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[l.jsxs("button",{onClick:()=>$e("adventure"),disabled:c,className:"bg-green-500 hover:bg-green-600 text-white p-4 rounded-lg font-medium transition-colors disabled:opacity-50",children:[l.jsx("div",{className:"text-3xl mb-2",children:"🌲"}),l.jsx("h4",{className:"font-bold",children:"Orman Macerası"}),l.jsx("p",{className:"text-sm text-green-100",children:"Ali'nin büyülü orman yolculuğu"})]}),l.jsxs("button",{onClick:()=>$e("space"),disabled:c,className:"bg-blue-500 hover:bg-blue-600 text-white p-4 rounded-lg font-medium transition-colors disabled:opacity-50",children:[l.jsx("div",{className:"text-3xl mb-2",children:"🚀"}),l.jsx("h4",{className:"font-bold",children:"Uzay Keşfi"}),l.jsx("p",{className:"text-sm text-blue-100",children:"Aylin'in gezegen maceraları"})]}),l.jsxs("button",{onClick:()=>$e("underwater"),disabled:c,className:"bg-teal-500 hover:bg-teal-600 text-white p-4 rounded-lg font-medium transition-colors disabled:opacity-50",children:[l.jsx("div",{className:"text-3xl mb-2",children:"🐠"}),l.jsx("h4",{className:"font-bold",children:"Deniz Altı"}),l.jsx("p",{className:"text-sm text-teal-100",children:"Cem'in okyanus keşfi"})]})]}),c&&l.jsxs("div",{className:"text-center py-4",children:[l.jsx("div",{className:"w-8 h-8 border-4 border-purple-600 border-t-transparent rounded-full animate-spin mx-auto mb-2"}),l.jsx("p",{className:"text-gray-600",children:"Hikaye hazırlanıyor..."})]})]})]})})})]})},f4=()=>{const{currentUser:s,logout:e}=aa(),[t,r]=T.useState(null),[o]=T.useState({gamesPlayed:12,totalScore:850,averageScore:71,timeSpent:145}),c=async()=>{try{await e()}catch(p){console.error("Çıkış yapılırken hata:",p)}},d=(p,y,v)=>{r(null),p!==void 0&&console.log("Oyun tamamlandı:",{score:p,duration:y,emotions:v})},f=()=>{if(!s?.id)return null;switch(t){case"attention-count":return l.jsx(t4,{studentId:s.id,studentAge:s.age||12,difficulty:"orta",onGameComplete:d});case"attention-dynamic":return l.jsx(a4,{studentId:s.id,studentAge:s.age||12,difficulty:"orta",onGameComplete:d});case"conflict":return l.jsx(o4,{studentId:s.id,studentAge:s.age||12,difficulty:"orta",onGameComplete:d});case"color-recognition":return l.jsx(u4,{studentId:s.id,studentAge:s.age||12,onGameComplete:d});case"story-attention":return l.jsx(m4,{studentId:s.id,studentAge:s.age||8,onGameComplete:d});default:return null}};return t?l.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50",children:l.jsxs("div",{className:"container mx-auto px-4 py-8",children:[l.jsx("button",{onClick:()=>r(null),className:"mb-4 bg-white text-gray-700 px-4 py-2 rounded-lg shadow hover:shadow-md transition-shadow",children:"← Geri Dön"}),f()]})}):l.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50",children:[l.jsx("div",{className:"bg-white shadow-sm border-b",children:l.jsx("div",{className:"container mx-auto px-4 py-4",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-primary to-secondary rounded-full flex items-center justify-center",children:l.jsx(Jn,{className:"h-6 w-6 text-white"})}),l.jsxs("div",{children:[l.jsx("h1",{className:"text-xl font-bold text-gray-800",children:"PeakFocus AI"}),l.jsx("p",{className:"text-sm text-gray-600",children:"Öğrenci Paneli"})]})]}),l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsxs("div",{className:"flex items-center space-x-2 text-gray-600",children:[l.jsx(Di,{className:"h-5 w-5"}),l.jsx("span",{className:"hidden sm:inline",children:s?.name})]}),l.jsxs("button",{onClick:c,className:"flex items-center space-x-2 bg-gray-100 hover:bg-gray-200 px-4 py-2 rounded-lg transition-colors",children:[l.jsx(Ep,{className:"h-4 w-4"}),l.jsx("span",{className:"hidden sm:inline",children:"Çıkış"})]})]})]})})}),l.jsxs("div",{className:"container mx-auto px-4 py-8",children:[l.jsxs("div",{className:"mb-8 text-center",children:[l.jsxs("h2",{className:"text-3xl font-bold text-gray-800 mb-4",children:["Hoş Geldin, ",s?.name,"! 🌟"]}),l.jsx("p",{className:"text-gray-600 text-lg",children:"Hangi oyunu oynamak istiyorsun?"})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[l.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-600",children:"Oynanan Oyun"}),l.jsx("p",{className:"text-2xl font-bold text-primary",children:o.gamesPlayed})]}),l.jsx(zd,{className:"h-8 w-8 text-primary"})]})}),l.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-600",children:"Toplam Puan"}),l.jsx("p",{className:"text-2xl font-bold text-success",children:o.totalScore})]}),l.jsx(zd,{className:"h-8 w-8 text-success"})]})}),l.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-600",children:"Ortalama Puan"}),l.jsx("p",{className:"text-2xl font-bold text-warning",children:o.averageScore})]}),l.jsx(zd,{className:"h-8 w-8 text-warning"})]})}),l.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-600",children:"Geçirilen Süre"}),l.jsxs("p",{className:"text-2xl font-bold text-purple-600",children:[o.timeSpent,"dk"]})]}),l.jsx(ja,{className:"h-8 w-8 text-purple-600"})]})})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[l.jsxs("div",{className:"bg-white rounded-lg shadow-lg overflow-hidden hover:shadow-xl transition-shadow",children:[l.jsxs("div",{className:"bg-gradient-to-r from-green-500 to-emerald-500 p-6 text-white",children:[l.jsx(QI,{className:"h-12 w-12 mb-4"}),l.jsx("h3",{className:"text-xl font-bold mb-2",children:"Dikkat Sayma"}),l.jsx("p",{className:"text-green-100",children:"Beliren objeleri sayarak konsantrasyon geliştirme"})]}),l.jsxs("div",{className:"p-6",children:[l.jsxs("div",{className:"mb-4",children:[l.jsxs("div",{className:"flex justify-between text-sm text-gray-600 mb-1",children:[l.jsx("span",{children:"Özellik"}),l.jsx("span",{children:"Sayısal Dikkat"})]}),l.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:l.jsx("div",{className:"bg-green-500 h-2 rounded-full",style:{width:"100%"}})}),l.jsx("div",{className:"mt-2 text-xs text-gray-600",children:"Sayısal dikkat • Görsel takip • Konsantrasyon • Bellek"})]}),l.jsx("button",{onClick:()=>r("attention-count"),className:"w-full bg-green-500 hover:bg-green-600 text-white py-3 px-4 rounded-lg font-medium transition-colors",children:"Oyunu Başlat"})]})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow-lg overflow-hidden hover:shadow-xl transition-shadow",children:[l.jsxs("div",{className:"bg-gradient-to-r from-purple-500 to-pink-500 p-6 text-white",children:[l.jsx(Mi,{className:"h-12 w-12 mb-4"}),l.jsx("h3",{className:"text-xl font-bold mb-2",children:"Dinamik Dikkat"}),l.jsx("p",{className:"text-purple-100",children:"Sürekli çıkan hedefleri hızla yakalama"})]}),l.jsxs("div",{className:"p-6",children:[l.jsxs("div",{className:"mb-4",children:[l.jsxs("div",{className:"flex justify-between text-sm text-gray-600 mb-1",children:[l.jsx("span",{children:"Özellik"}),l.jsx("span",{children:"Çoklu Hedef"})]}),l.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:l.jsx("div",{className:"bg-purple-500 h-2 rounded-full",style:{width:"100%"}})}),l.jsx("div",{className:"mt-2 text-xs text-gray-600",children:"Çoklu hedef takibi • Hızlı karar • Refleks • Sürekli dikkat"})]}),l.jsx("button",{onClick:()=>r("attention-dynamic"),className:"w-full bg-purple-500 hover:bg-purple-600 text-white py-3 px-4 rounded-lg font-medium transition-colors",children:"Oyunu Başlat"})]})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow-lg overflow-hidden hover:shadow-xl transition-shadow",children:[l.jsxs("div",{className:"bg-gradient-to-r from-red-500 to-orange-500 p-6 text-white",children:[l.jsx(Sp,{className:"h-12 w-12 mb-4"}),l.jsx("h3",{className:"text-xl font-bold mb-2",children:"Çatışma Oyunu"}),l.jsx("p",{className:"text-red-100",children:"Stroop etkisi ile dikkat geliştirme"})]}),l.jsxs("div",{className:"p-6",children:[l.jsxs("div",{className:"mb-4",children:[l.jsxs("div",{className:"flex justify-between text-sm text-gray-600 mb-1",children:[l.jsx("span",{children:"Özellik"}),l.jsx("span",{children:"Stroop Etkisi"})]}),l.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:l.jsx("div",{className:"bg-red-500 h-2 rounded-full",style:{width:"100%"}})}),l.jsx("div",{className:"mt-2 text-xs text-gray-600",children:"Stroop etkisi • Renk-kelime çatışması • Bilişsel esneklik"})]}),l.jsx("button",{onClick:()=>r("conflict"),className:"w-full bg-red-500 hover:bg-red-600 text-white py-3 px-4 rounded-lg font-medium transition-colors",children:"Oyunu Başlat"})]})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow-lg overflow-hidden hover:shadow-xl transition-shadow",children:[l.jsxs("div",{className:"bg-gradient-to-r from-indigo-500 to-purple-500 p-6 text-white",children:[l.jsx(os,{className:"h-12 w-12 mb-4"}),l.jsx("h3",{className:"text-xl font-bold mb-2",children:"AI Renk Tanıma"}),l.jsx("p",{className:"text-indigo-100",children:"AI seçtiği rengi kameraya gösterme oyunu"})]}),l.jsxs("div",{className:"p-6",children:[l.jsxs("div",{className:"mb-4",children:[l.jsxs("div",{className:"flex justify-between text-sm text-gray-600 mb-1",children:[l.jsx("span",{children:"Özellik"}),l.jsx("span",{children:"AI Destekli"})]}),l.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:l.jsx("div",{className:"bg-indigo-500 h-2 rounded-full",style:{width:"100%"}})}),l.jsx("div",{className:"mt-2 text-xs text-gray-600",children:"AI renk seçimi • Gerçek zamanlı tanıma • Kamera etkileşimi"})]}),l.jsx("button",{onClick:()=>r("color-recognition"),className:"w-full bg-indigo-500 hover:bg-indigo-600 text-white py-3 px-4 rounded-lg font-medium transition-colors",children:"Oyunu Başlat"})]})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow-lg overflow-hidden hover:shadow-xl transition-shadow",children:[l.jsxs("div",{className:"bg-gradient-to-r from-pink-500 to-purple-600 p-6 text-white",children:[l.jsx(Ap,{className:"h-12 w-12 mb-4"}),l.jsx("h3",{className:"text-xl font-bold mb-2",children:"Hikaye Dikkat Oyunu"}),l.jsx("p",{className:"text-pink-100",children:"Ali'nin macerasında dikkat becerilerini test et"})]}),l.jsxs("div",{className:"p-6",children:[l.jsxs("div",{className:"mb-4",children:[l.jsxs("div",{className:"flex justify-between text-sm text-gray-600 mb-1",children:[l.jsx("span",{children:"Dikkat Türü"}),l.jsx("span",{children:"4 Boyut"})]}),l.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:l.jsx("div",{className:"bg-pink-500 h-2 rounded-full",style:{width:"100%"}})}),l.jsx("div",{className:"mt-2 text-xs text-gray-600",children:"Seçici • Sürekli • Bölünmüş • Dürtü Kontrolü"})]}),l.jsx("button",{onClick:()=>r("story-attention"),className:"w-full bg-pink-500 hover:bg-pink-600 text-white py-3 px-4 rounded-lg font-medium transition-colors",children:"Hikayeyi Başlat"})]})]})]}),l.jsxs("div",{className:"mt-12 text-center bg-white rounded-lg p-8 shadow-sm",children:[l.jsx("div",{className:"text-6xl mb-4",children:"🎯"}),l.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Harika İş Çıkarıyorsun!"}),l.jsx("p",{className:"text-gray-600",children:"Her oyun oynayışında daha da iyi oluyorsun. Böyle devam et! 🌟"})]})]})]})},g4=({students:s})=>{const[e,t]=T.useState("week"),[r,o]=T.useState("all"),[c,d]=T.useState(new Set(["filters"])),f=F=>{const ae=new Set(c);ae.has(F)?ae.delete(F):ae.add(F),d(ae)},y=(()=>{let F=al;r!=="all"&&(F=F.filter(ne=>ne.studentId===r));const ae=new Date;if(e==="week"){const ne=new Date(ae.getTime()-6048e5);F=F.filter(N=>N.createdAt>=ne)}else if(e==="month"){const ne=new Date(ae.getTime()-2592e6);F=F.filter(N=>N.createdAt>=ne)}return F})(),v=()=>Array.from({length:30},(ae,ne)=>{const N=new Date;return N.setDate(N.getDate()-(29-ne)),{date:N.toLocaleDateString("tr-TR",{day:"2-digit",month:"2-digit"}),score:Math.floor(Math.random()*30)+70,activities:Math.floor(Math.random()*5)+1}}),k=()=>{const F=y.reduce((ne,N)=>(ne[N.gameType]=(ne[N.gameType]||0)+1,ne),{}),ae={count:"Dikkat Sayma",dynamic:"Dinamik Dikkat",conflict:"Çatışma Oyunu",colorRecognition:"AI Renk Tanıma"};return Object.entries(F).map(([ne,N])=>({name:ae[ne]||ne,value:N,percentage:Math.round(N/y.length*100)}))},S=()=>["happy","focused","neutral","confused","sad"].map(ae=>({emotion:ae,data:Array.from({length:7},(ne,N)=>({day:["Pzt","Sal","Çar","Per","Cum","Cmt","Paz"][N],value:Math.floor(Math.random()*80)+20}))})),I=()=>Array.from({length:24},(ae,ne)=>({hour:ne,activities:Math.floor(Math.random()*10),performance:Math.floor(Math.random()*40)+60})),q=()=>["click","count","dynamic","conflict","colorRecognition"].map(ae=>{const ne=y.filter(R=>R.gameType===ae),N=ne.length>0?ne.reduce((R,E)=>R+E.score,0)/ne.length:0;return{type:ae,name:{count:"Dikkat Sayma",dynamic:"Dinamik Dikkat",conflict:"Çatışma Oyunu",colorRecognition:"AI Renk Tanıma"}[ae],score:Math.round(N),count:ne.length}}),L=v(),P=k();S();const K=I(),U=q(),B=({id:F,title:ae,icon:ne,children:N,defaultOpen:R=!1})=>{const E=c.has(F),C=T.useRef(null),M=z=>{z.preventDefault(),z.stopPropagation();const Ve=window.scrollY;f(F),(()=>{requestAnimationFrame(()=>{Math.abs(window.scrollY-Ve)>10&&window.scrollTo(0,Ve),requestAnimationFrame(()=>{Math.abs(window.scrollY-Ve)>10&&window.scrollTo(0,Ve)})})})()};return l.jsxs("div",{ref:C,className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[l.jsxs("button",{type:"button",onClick:M,className:"w-full flex items-center justify-between p-4 hover:bg-gray-50 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-inset",children:[l.jsxs("div",{className:"flex items-center",children:[ne,l.jsx("h3",{className:"text-lg font-semibold text-gray-800 ml-2",children:ae})]}),l.jsx("div",{className:`transform transition-transform duration-200 ${E?"rotate-180":""}`,children:l.jsx("svg",{className:"w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),l.jsx("div",{className:`overflow-hidden transition-all duration-200 ease-in-out ${E?"max-h-[2000px] opacity-100":"max-h-0 opacity-0"}`,children:l.jsx("div",{className:"p-4 border-t border-gray-100",children:N})})]})};return l.jsxs("div",{className:"space-y-4",style:{scrollBehavior:"smooth"},children:[l.jsx(B,{id:"filters",title:"Filtreler ve Ayarlar",icon:l.jsx(jc,{className:"h-5 w-5 text-blue-500"}),defaultOpen:!0,children:l.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[l.jsxs("div",{className:"flex-1",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Çocuk Seçimi"}),l.jsxs("select",{value:r,onChange:F=>o(F.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2",children:[l.jsx("option",{value:"all",children:"Tüm Çocuklar"}),s.map(F=>l.jsx("option",{value:F.id,children:F.name},F.id))]})]}),l.jsxs("div",{className:"flex-1",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Zaman Aralığı"}),l.jsx("div",{className:"flex bg-gray-100 rounded-lg p-1",children:["week","month","all"].map(F=>l.jsx("button",{onClick:()=>t(F),className:`flex-1 py-2 px-4 rounded-md text-sm font-medium transition-colors ${e===F?"bg-primary text-white":"text-gray-600 hover:text-gray-800"}`,children:{week:"Son 7 Gün",month:"Son 30 Gün",all:"Tüm Zamanlar"}[F]},F))})]})]})}),l.jsx(B,{id:"performance",title:"Performans Trendi (Son 30 Gün)",icon:l.jsx(Ii,{className:"h-5 w-5 text-green-500"}),children:l.jsx("div",{className:"h-64 flex items-end space-x-1",children:L.map((F,ae)=>l.jsxs("div",{className:"flex-1 flex flex-col items-center",children:[l.jsxs("div",{className:"relative w-full bg-gray-100 rounded-t-sm",style:{height:"200px"},children:[l.jsx("div",{className:"absolute bottom-0 w-full bg-gradient-to-t from-primary to-blue-400 rounded-t-sm transition-all duration-500",style:{height:`${F.score/100*100}%`}}),l.jsx("div",{className:"absolute -top-6 left-1/2 transform -translate-x-1/2 text-xs font-medium text-gray-600",children:F.score})]}),l.jsx("div",{className:"text-xs text-gray-500 mt-1",children:F.date})]},ae))})}),l.jsx(B,{id:"gameDistribution",title:"Oyun Türü Dağılımı",icon:l.jsx(zI,{className:"h-5 w-5 text-purple-500"}),children:l.jsx("div",{className:"space-y-3",children:P.map((F,ae)=>{const ne=["bg-blue-500","bg-green-500","bg-yellow-500","bg-purple-500"];return l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:`w-4 h-4 rounded ${ne[ae%ne.length]}`}),l.jsx("span",{className:"text-sm font-medium",children:F.name})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("div",{className:"w-24 bg-gray-200 rounded-full h-2",children:l.jsx("div",{className:`h-2 rounded-full ${ne[ae%ne.length].replace("bg-","bg-")}`,style:{width:`${F.percentage}%`}})}),l.jsxs("span",{className:"text-sm text-gray-600 w-8",children:[F.percentage,"%"]})]})]},F.name)})})}),l.jsx(B,{id:"successRates",title:"Oyun Türüne Göre Başarı Oranları",icon:l.jsx(Bn,{className:"h-5 w-5 text-orange-500"}),children:l.jsx("div",{className:"space-y-4",children:U.map((F,ae)=>l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"flex justify-between text-sm",children:[l.jsx("span",{className:"font-medium",children:F.name}),l.jsxs("span",{className:"text-gray-600",children:[F.score,"% (",F.count," oyun)"]})]}),l.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:l.jsx("div",{className:`h-3 rounded-full transition-all duration-500 ${F.score>=80?"bg-green-500":F.score>=60?"bg-yellow-500":"bg-red-500"}`,style:{width:`${F.score}%`}})})]},F.type))})}),l.jsx(B,{id:"attention",title:"Dikkat Süresi Analizi",icon:l.jsx(Rb,{className:"h-5 w-5 text-indigo-500"}),children:l.jsx("div",{className:"space-y-4",children:Array.from({length:7},(F,ae)=>{const ne=["Pzt","Sal","Çar","Per","Cum","Cmt","Paz"][ae],N=Math.floor(Math.random()*15)+5,R=Math.floor(Math.random()*8)+2;return l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("span",{className:"text-sm font-medium w-8",children:ne}),l.jsx("div",{className:"flex-1",children:l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("div",{className:"w-32 bg-gray-200 rounded-full h-2",children:l.jsx("div",{className:`h-2 rounded-full ${N>=15?"bg-green-500":N>=10?"bg-yellow-500":"bg-red-500"}`,style:{width:`${N/20*100}%`}})}),l.jsxs("span",{className:"text-sm text-gray-600",children:[N," dk"]})]})})]}),l.jsxs("div",{className:"text-xs text-gray-500",children:[R," dikkat dağılması"]})]},ae)})})}),l.jsx(B,{id:"emotion",title:"Duygu-Performans İlişkisi",icon:l.jsx(Rb,{className:"h-5 w-5 text-pink-500"}),children:l.jsx("div",{className:"space-y-3",children:[{emotion:"😊 Mutlu",score:85,color:"bg-green-500"},{emotion:"🎯 Odaklanmış",score:92,color:"bg-blue-500"},{emotion:"😐 Nötr",score:72,color:"bg-gray-500"},{emotion:"😕 Şaşkın",score:58,color:"bg-yellow-500"},{emotion:"😢 Üzgün",score:45,color:"bg-red-500"}].map((F,ae)=>l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("span",{className:"text-sm w-20",children:F.emotion}),l.jsx("div",{className:"w-32 bg-gray-200 rounded-full h-3",children:l.jsx("div",{className:`h-3 rounded-full ${F.color}`,style:{width:`${F.score}%`}})})]}),l.jsxs("span",{className:"text-sm font-medium",children:[F.score,"%"]})]},ae))})}),l.jsx(B,{id:"hyperfocus",title:"Hiperfokus vs Normal Dikkat Analizi",icon:l.jsx(Mi,{className:"h-5 w-5 text-yellow-500"}),children:l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-3xl font-bold text-purple-600 mb-2",children:"4"}),l.jsx("div",{className:"text-sm text-gray-600",children:"Hiperfokus Seansları"}),l.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Ortalama 25 dk"})]}),l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-3xl font-bold text-blue-600 mb-2",children:"18"}),l.jsx("div",{className:"text-sm text-gray-600",children:"Normal Seanslar"}),l.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Ortalama 12 dk"})]}),l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-3xl font-bold text-green-600 mb-2",children:"%78"}),l.jsx("div",{className:"text-sm text-gray-600",children:"Hiperfokus Başarısı"}),l.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Normal: %65"})]})]})}),l.jsxs(B,{id:"reactionTime",title:"Tepki Süresi Değişkenliği",icon:l.jsx(Bn,{className:"h-5 w-5 text-red-500"}),children:[l.jsx("div",{className:"h-32 flex items-end space-x-1",children:Array.from({length:20},(F,ae)=>{const ne=Math.floor(Math.random()*800)+200;return l.jsxs("div",{className:"flex-1 flex flex-col items-center",children:[l.jsx("div",{className:"relative w-full bg-gray-100 rounded-t-sm",style:{height:"100px"},children:l.jsx("div",{className:`absolute bottom-0 w-full rounded-t-sm ${ne>700?"bg-red-400":ne>500?"bg-yellow-400":"bg-green-400"}`,style:{height:`${ne/1e3*100}%`}})}),l.jsx("div",{className:"text-xs text-gray-500 mt-1",children:ae+1})]},ae)})}),l.jsxs("div",{className:"mt-4 grid grid-cols-3 gap-4 text-center",children:[l.jsxs("div",{children:[l.jsx("div",{className:"text-lg font-semibold text-green-600",children:"425ms"}),l.jsx("div",{className:"text-xs text-gray-500",children:"Ortalama"})]}),l.jsxs("div",{children:[l.jsx("div",{className:"text-lg font-semibold text-yellow-600",children:"±180ms"}),l.jsx("div",{className:"text-xs text-gray-500",children:"Standart Sapma"})]}),l.jsxs("div",{children:[l.jsx("div",{className:"text-lg font-semibold text-blue-600",children:"2.1"}),l.jsx("div",{className:"text-xs text-gray-500",children:"Değişkenlik Katsayısı"})]})]})]}),l.jsxs(B,{id:"dailyPattern",title:"Günlük Aktivite Deseni",icon:l.jsx(qr,{className:"h-5 w-5 text-cyan-500"}),children:[l.jsx("div",{className:"h-32 flex items-end space-x-1",children:K.filter(F=>F.hour>=8&&F.hour<=20).map(F=>l.jsxs("div",{className:"flex-1 flex flex-col items-center",children:[l.jsx("div",{className:"relative w-full bg-gray-100 rounded-t-sm",style:{height:"100px"},children:l.jsx("div",{className:"absolute bottom-0 w-full bg-gradient-to-t from-purple-500 to-purple-300 rounded-t-sm",style:{height:`${F.activities/10*100}%`}})}),l.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[F.hour,":00"]})]},F.hour))}),l.jsx("div",{className:"mt-2 text-sm text-gray-600 text-center",children:"En aktif saatler: 14:00-16:00 arası"})]}),l.jsx(B,{id:"quickStats",title:"Hızlı İstatistikler",icon:l.jsx(nh,{className:"h-5 w-5 text-emerald-500"}),children:l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[l.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-blue-600 rounded-lg p-4 text-white",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("div",{className:"text-2xl font-bold",children:y.length}),l.jsx("div",{className:"text-blue-100 text-sm",children:"Toplam Oyun"})]}),l.jsx(nh,{className:"h-8 w-8 text-blue-200"})]})}),l.jsx("div",{className:"bg-gradient-to-r from-green-500 to-green-600 rounded-lg p-4 text-white",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsxs("div",{className:"text-2xl font-bold",children:[Math.round(y.reduce((F,ae)=>F+ae.score,0)/y.length)||0,"%"]}),l.jsx("div",{className:"text-green-100 text-sm",children:"Ortalama Başarı"})]}),l.jsx(Ii,{className:"h-8 w-8 text-green-200"})]})}),l.jsx("div",{className:"bg-gradient-to-r from-purple-500 to-purple-600 rounded-lg p-4 text-white",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsxs("div",{className:"text-2xl font-bold",children:[Math.round(y.reduce((F,ae)=>F+ae.duration,0)/60)," dk"]}),l.jsx("div",{className:"text-purple-100 text-sm",children:"Toplam Süre"})]}),l.jsx(qr,{className:"h-8 w-8 text-purple-200"})]})}),l.jsx("div",{className:"bg-gradient-to-r from-yellow-500 to-yellow-600 rounded-lg p-4 text-white",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("div",{className:"text-2xl font-bold",children:r==="all"?s.length:1}),l.jsx("div",{className:"text-yellow-100 text-sm",children:"Aktif Çocuk"})]}),l.jsx(Mi,{className:"h-8 w-8 text-yellow-200"})]})})]})})]})},p4=()=>{const{currentUser:s}=aa(),e=$r(),[t,r]=T.useState([]),[o,c]=T.useState(!0),[d]=T.useState("connected"),f=T.useCallback(async()=>{if(s)try{c(!0);const p=Dc.slice(0,2);r(p)}catch(p){console.error("Error loading data:",p)}finally{c(!1)}},[s]);return T.useEffect(()=>{s&&f()},[s,f]),l.jsxs(l.Fragment,{children:[l.jsx(Wc,{aiStatus:d}),l.jsx("main",{className:"max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"space-y-6",children:[l.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsx("button",{onClick:()=>e("/dashboard"),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:l.jsx(Th,{className:"h-5 w-5 text-gray-600"})}),l.jsxs("div",{children:[l.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center",children:["📊 Gelişim Analizi",l.jsx("span",{className:"ml-3 text-sm font-normal text-gray-500 bg-green-100 text-green-700 px-3 py-1 rounded-full",children:"Gerçek Zamanlı"})]}),l.jsxs("p",{className:"text-gray-600 mt-1",children:[s?.name," - Çocuklarınızın oyun performansı ve dikkat gelişimi"]})]})]}),l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsxs("div",{className:"flex items-center space-x-2 text-sm text-blue-600 bg-blue-50 px-3 py-2 rounded-lg",children:[l.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse"}),l.jsx("span",{children:"Canlı Veriler"})]}),l.jsxs("div",{className:"text-sm text-gray-500",children:[t.length," çocuk takip ediliyor"]})]})]})}),l.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:o?l.jsxs("div",{className:"flex items-center justify-center py-12",children:[l.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"}),l.jsx("span",{className:"ml-3 text-gray-600",children:"Analitik veriler yükleniyor..."})]}):l.jsx(g4,{students:t.map(p=>({id:p.id,name:p.name}))})})]})})]})},y4=()=>{const{currentUser:s}=aa(),e=$r(),[t,r]=T.useState([]),[o,c]=T.useState(!0),[d]=T.useState("connected"),[f,p]=T.useState([]),y=T.useCallback(async()=>{if(s)try{c(!0);const v=Dc.slice(0,2);r(v)}catch(v){console.error("Error loading data:",v)}finally{c(!1)}},[s]);return T.useEffect(()=>{s&&y()},[s,y]),l.jsxs(l.Fragment,{children:[l.jsx(Wc,{aiStatus:d}),l.jsx("main",{className:"max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"space-y-6",children:[l.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsx("button",{onClick:()=>e("/dashboard"),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:l.jsx(Th,{className:"h-5 w-5 text-gray-600"})}),l.jsxs("div",{children:[l.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center",children:["📅 Oyun Takvimi",l.jsx("span",{className:"ml-3 text-sm font-normal text-gray-500 bg-purple-100 text-purple-700 px-3 py-1 rounded-full",children:"AI Planlayıcı"})]}),l.jsxs("p",{className:"text-gray-600 mt-1",children:[s?.name," - Çocuklarınızın oyun seanslarını planlayın ve takip edin"]})]})]}),l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsxs("div",{className:"flex items-center space-x-2 text-sm text-purple-600 bg-purple-50 px-3 py-2 rounded-lg",children:[l.jsx("div",{className:"w-2 h-2 bg-purple-500 rounded-full animate-pulse"}),l.jsx("span",{children:"AI Aktif"})]}),l.jsxs("div",{className:"text-sm text-gray-500",children:[t.length," çocuk için planlama"]})]})]})}),l.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:o?l.jsxs("div",{className:"flex items-center justify-center py-12",children:[l.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-purple-500"}),l.jsx("span",{className:"ml-3 text-gray-600",children:"Takvim yükleniyor..."})]}):l.jsx(Fk,{isOpen:!0,onClose:()=>{},students:t.map(v=>({id:v.id,name:v.name})),externalSessions:f})})]})})]})},x4=()=>{const{currentUser:s}=aa(),e=$r(),[t,r]=T.useState([]),[o,c]=T.useState(!0),[d]=T.useState("connected"),[f,p]=T.useState(null),y=T.useCallback(async()=>{if(s)try{c(!0);const k=Dc.slice(0,2);r(k)}catch(k){console.error("Error loading data:",k)}finally{c(!1)}},[s]);T.useEffect(()=>{s&&y()},[s,y]);const v=k=>{p(k)};return l.jsxs(l.Fragment,{children:[l.jsx(Wc,{aiStatus:d}),l.jsx("main",{className:"max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"space-y-6",children:[l.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsx("button",{onClick:()=>e("/dashboard"),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:l.jsx(Th,{className:"h-5 w-5 text-gray-600"})}),l.jsxs("div",{children:[l.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center",children:["👥 Çocuklarım",l.jsxs("span",{className:"ml-3 text-sm font-normal text-gray-500 bg-blue-100 text-blue-700 px-3 py-1 rounded-full",children:[t.length," Çocuk"]})]}),l.jsxs("p",{className:"text-gray-600 mt-1",children:[s?.name," - Çocuklarınızın profilleri ve detaylı gelişim takibi"]})]})]}),l.jsx("div",{className:"flex items-center space-x-4",children:l.jsxs("button",{className:"flex items-center space-x-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:[l.jsx(zk,{className:"h-4 w-4"}),l.jsx("span",{children:"Yeni Çocuk Ekle"})]})})]})}),l.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-6",children:[l.jsx("div",{className:"xl:col-span-2",children:l.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100",children:o?l.jsxs("div",{className:"flex items-center justify-center py-12",children:[l.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"}),l.jsx("span",{className:"ml-3 text-gray-600",children:"Çocuk bilgileri yükleniyor..."})]}):l.jsx(Gk,{students:t,loading:o,onViewStudent:v})})}),l.jsx("div",{className:"xl:col-span-1",children:l.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6 sticky top-6",children:f?l.jsxs("div",{children:[l.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:[f.name," - Detaylar"]}),l.jsx(Hk,{student:f,onClose:()=>p(null)})]}):l.jsxs("div",{className:"text-center py-12",children:[l.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full mx-auto mb-4 flex items-center justify-center",children:l.jsx("span",{className:"text-2xl",children:"👥"})}),l.jsx("h3",{className:"text-lg font-medium text-gray-800 mb-2",children:"Çocuk Seçin"}),l.jsx("p",{className:"text-gray-600 text-sm",children:"Detaylı bilgiler için soldaki listeden bir çocuk seçin"})]})})})]})]})})]})},v4=()=>{const{currentUser:s,logout:e}=aa(),t=$r(),[r]=T.useState("connected"),[o,c]=T.useState("profile"),d=async()=>{try{await e(),t("/auth")}catch(p){console.error("Logout error:",p)}},f=[{id:"profile",label:"Profil",icon:Di},{id:"notifications",label:"Bildirimler",icon:xg},{id:"privacy",label:"Gizlilik",icon:bD},{id:"appearance",label:"Görünüm",icon:Sp}];return l.jsxs(l.Fragment,{children:[l.jsx(Wc,{aiStatus:r}),l.jsx("main",{className:"max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"space-y-6",children:[l.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsx("button",{onClick:()=>t("/dashboard"),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:l.jsx(Th,{className:"h-5 w-5 text-gray-600"})}),l.jsxs("div",{children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900 flex items-center",children:"⚙️ Ayarlar"}),l.jsxs("p",{className:"text-gray-600 mt-1",children:[s?.name," - Hesap ve uygulama ayarlarınızı yönetin"]})]})]}),l.jsxs("button",{onClick:d,className:"flex items-center space-x-2 text-red-600 hover:bg-red-50 px-4 py-2 rounded-lg transition-colors",children:[l.jsx(Ep,{className:"h-4 w-4"}),l.jsx("span",{children:"Çıkış Yap"})]})]})}),l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[l.jsx("div",{className:"lg:col-span-1",children:l.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-4",children:l.jsx("nav",{className:"space-y-2",children:f.map(p=>{const y=p.icon;return l.jsxs("button",{onClick:()=>c(p.id),className:`w-full flex items-center space-x-3 px-3 py-2 rounded-lg transition-colors ${o===p.id?"bg-blue-50 text-blue-600 border border-blue-200":"text-gray-700 hover:bg-gray-50"}`,children:[l.jsx(y,{className:"h-4 w-4"}),l.jsx("span",{children:p.label})]},p.id)})})})}),l.jsx("div",{className:"lg:col-span-3",children:l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:[o==="profile"&&l.jsxs("div",{className:"space-y-6",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Profil Bilgileri"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Ad Soyad"}),l.jsx("input",{type:"text",defaultValue:s?.name,className:"w-full border border-gray-300 rounded-lg px-3 py-2"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"E-posta"}),l.jsx("input",{type:"email",defaultValue:s?.email,className:"w-full border border-gray-300 rounded-lg px-3 py-2"})]})]}),l.jsx("div",{className:"flex justify-end",children:l.jsx("button",{className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"Değişiklikleri Kaydet"})})]}),o==="notifications"&&l.jsxs("div",{className:"space-y-6",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Bildirim Ayarları"}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"font-medium text-gray-800",children:"E-posta Bildirimleri"}),l.jsx("p",{className:"text-sm text-gray-600",children:"Çocuğunuzun gelişimi hakkında e-posta alın"})]}),l.jsx("input",{type:"checkbox",defaultChecked:!0,className:"rounded"})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"font-medium text-gray-800",children:"Haftalık Rapor"}),l.jsx("p",{className:"text-sm text-gray-600",children:"Haftalık gelişim raporu e-postası"})]}),l.jsx("input",{type:"checkbox",defaultChecked:!0,className:"rounded"})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"font-medium text-gray-800",children:"AI Önerileri"}),l.jsx("p",{className:"text-sm text-gray-600",children:"Yeni oyun önerileri ve ipuçları"})]}),l.jsx("input",{type:"checkbox",defaultChecked:!0,className:"rounded"})]})]})]}),o==="privacy"&&l.jsxs("div",{className:"space-y-6",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Gizlilik Ayarları"}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"font-medium text-gray-800",children:"Veri Paylaşımı"}),l.jsx("p",{className:"text-sm text-gray-600",children:"Gelişim verilerinin anonim olarak paylaşılması"})]}),l.jsx("input",{type:"checkbox",className:"rounded"})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"font-medium text-gray-800",children:"Analitik Çerezler"}),l.jsx("p",{className:"text-sm text-gray-600",children:"Uygulama performansını iyileştirmek için"})]}),l.jsx("input",{type:"checkbox",defaultChecked:!0,className:"rounded"})]})]})]}),o==="appearance"&&l.jsxs("div",{className:"space-y-6",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Görünüm Ayarları"}),l.jsx("div",{className:"space-y-4",children:l.jsxs("div",{children:[l.jsx("h3",{className:"font-medium text-gray-800 mb-2",children:"Tema"}),l.jsxs("div",{className:"flex space-x-4",children:[l.jsxs("button",{className:"p-3 border-2 border-blue-500 rounded-lg bg-white",children:[l.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-blue-500 to-purple-500 rounded"}),l.jsx("span",{className:"text-sm mt-1 block",children:"Açık"})]}),l.jsxs("button",{className:"p-3 border-2 border-gray-200 rounded-lg bg-gray-800",children:[l.jsx("div",{className:"w-8 h-8 bg-gray-600 rounded"}),l.jsx("span",{className:"text-sm mt-1 block text-white",children:"Koyu"})]})]})]})})]})]})})]})]})})]})},b4=()=>{const[s,e]=T.useState(!1),t=$r(),r=Js(),o=[{id:"dashboard",label:"Ana Sayfa",icon:WI,path:"/dashboard",description:"Genel durum ve özet"},{id:"analytics",label:"Gelişim Analizi",icon:jc,path:"/analytics",description:"Detaylı performans raporları"},{id:"calendar",label:"Oyun Takvimi",icon:qr,path:"/calendar",description:"Oyun seansları planlama"},{id:"students",label:"Çocuklarım",icon:Uk,path:"/students",description:"Çocuk profilleri ve detayları"},{id:"chat",label:"Uzman Chat",icon:Ok,path:"/chat",description:"AI uzman desteği"},{id:"settings",label:"Ayarlar",icon:xD,path:"/settings",description:"Hesap ve uygulama ayarları"}],c=d=>{t(d)};return l.jsxs("div",{className:`fixed left-0 top-0 h-full bg-white border-r border-gray-200 shadow-lg z-40 transition-all duration-300 ${s?"w-72":"w-16"}`,onMouseEnter:()=>e(!0),onMouseLeave:()=>e(!1),children:[l.jsxs("div",{className:"h-16 flex items-center border-b border-gray-200 px-3",children:[l.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-blue-500 to-purple-500 rounded-lg flex items-center justify-center flex-shrink-0",children:l.jsx(Jn,{className:"h-6 w-6 text-white"})}),l.jsx("div",{className:`ml-3 overflow-hidden transition-all duration-300 ${s?"w-48 opacity-100":"w-0 opacity-0"}`,children:l.jsxs("div",{className:"whitespace-nowrap",children:[l.jsx("div",{className:"text-lg font-bold text-gray-800",children:"PeakFocus"}),l.jsx("div",{className:"text-xs text-gray-500",children:"AI Eğitim Platformu"})]})})]}),l.jsx("nav",{className:"py-4",children:o.map(d=>{const f=d.icon,p=r.pathname===d.path;return l.jsxs("button",{onClick:()=>c(d.path),className:`w-full flex items-center py-3 mx-2 rounded-lg transition-all duration-200 group ${p?"bg-blue-50 text-blue-600":"text-gray-700 hover:bg-gray-50 hover:text-blue-600"}`,children:[l.jsx("div",{className:"flex items-center justify-center w-10 h-10 ml-1 flex-shrink-0",children:l.jsx(f,{className:`h-5 w-5 transition-colors ${p?"text-blue-600":"text-gray-600 group-hover:text-blue-600"}`})}),l.jsx("div",{className:`ml-3 flex-1 overflow-hidden transition-all duration-300 ${s?"w-48 opacity-100":"w-0 opacity-0"}`,children:l.jsxs("div",{className:"whitespace-nowrap",children:[l.jsx("div",{className:`font-medium ${p?"text-blue-600":"text-gray-900"}`,children:d.label}),l.jsx("div",{className:"text-xs text-gray-500",children:d.description})]})}),l.jsx("div",{className:`mr-2 transition-all duration-300 ${s?"w-4 opacity-100":"w-0 opacity-0"}`,children:s&&l.jsx(BI,{className:`h-4 w-4 transition-colors ${p?"text-blue-600":"text-gray-400 group-hover:text-blue-600"}`})})]},d.id)})}),l.jsx("div",{className:`absolute bottom-4 left-0 right-0 px-4 transition-all duration-300 overflow-hidden ${s?"opacity-100":"opacity-0 pointer-events-none"}`,children:l.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 rounded-lg p-3",children:[l.jsxs("div",{className:"flex items-center space-x-2 text-blue-600",children:[l.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse flex-shrink-0"}),l.jsx("span",{className:"text-sm font-medium whitespace-nowrap",children:"AI Aktif"})]}),l.jsx("div",{className:"text-xs text-gray-600 mt-1 whitespace-nowrap",children:"Tüm sistemler çalışıyor"})]})})]})},No=({children:s,showSidebar:e=!0,allowedRoles:t=["parent","student"]})=>{const{currentUser:r,loading:o}=aa();return o?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"w-16 h-16 border-4 border-primary border-t-transparent rounded-full animate-spin mx-auto mb-4"}),l.jsx("p",{className:"text-gray-600",children:"Yükleniyor..."})]})}):r?t.includes(r.role)?l.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e&&l.jsx(b4,{}),l.jsx("div",{className:e?"ml-16":"",children:s})]}):r.role==="student"?l.jsx(Dr,{to:"/dashboard/student",replace:!0}):l.jsx(Dr,{to:"/dashboard",replace:!0}):l.jsx(Dr,{to:"/auth",replace:!0})},_4=({children:s})=>{const{currentUser:e,loading:t}=aa();return t?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"w-16 h-16 border-4 border-primary border-t-transparent rounded-full animate-spin mx-auto mb-4"}),l.jsx("p",{className:"text-gray-600",children:"Yükleniyor..."})]})}):e?e.role==="student"?l.jsx(Dr,{to:"/dashboard/student",replace:!0}):l.jsx(Dr,{to:"/dashboard",replace:!0}):l.jsx(l.Fragment,{children:s})},k4=()=>{const{currentUser:s,loading:e}=aa();return e?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"w-16 h-16 border-4 border-primary border-t-transparent rounded-full animate-spin mx-auto mb-4"}),l.jsx("p",{className:"text-gray-600",children:"Yükleniyor..."})]})}):s?s.role==="student"?l.jsx(Dr,{to:"/dashboard/student",replace:!0}):l.jsx(Dr,{to:"/dashboard",replace:!0}):l.jsx(Dr,{to:"/auth",replace:!0})};function T4(){return l.jsx(vI,{children:l.jsx(UE,{children:l.jsx("div",{className:"App",children:l.jsxs(yE,{children:[l.jsx(Hs,{path:"/auth",element:l.jsx(_4,{children:l.jsx(BD,{})})}),l.jsx(Hs,{path:"/dashboard",element:l.jsx(No,{allowedRoles:["parent"],children:l.jsx(XD,{})})}),l.jsx(Hs,{path:"/analytics",element:l.jsx(No,{allowedRoles:["parent"],children:l.jsx(p4,{})})}),l.jsx(Hs,{path:"/calendar",element:l.jsx(No,{allowedRoles:["parent"],children:l.jsx(y4,{})})}),l.jsx(Hs,{path:"/students",element:l.jsx(No,{allowedRoles:["parent"],children:l.jsx(x4,{})})}),l.jsx(Hs,{path:"/settings",element:l.jsx(No,{allowedRoles:["parent"],children:l.jsx(v4,{})})}),l.jsx(Hs,{path:"/dashboard/student",element:l.jsx(No,{showSidebar:!1,allowedRoles:["student"],children:l.jsx(f4,{})})}),l.jsx(Hs,{path:"/",element:l.jsx(k4,{})})]})})})})}Aw.createRoot(document.getElementById("root")).render(l.jsx(T4,{}));
